{"version":3,"file":"5.12L5526h.js","sources":["../../../../../../src/routes/learn/+page.svelte"],"sourcesContent":["<script lang=\"ts\">\n  import { onMount } from 'svelte';\n  import { goto } from '$app/navigation';\n  import { base } from '$app/paths';\n  import { vocabularyDb } from '$lib/data/db.svelte';\n  import { appState } from '$lib/state/app-state';\n  import VocabularyCard from '$lib/components/ui/VocabularyCard.svelte';\n  import ActionButton from '$lib/components/ui/ActionButton.svelte';\n  import type { VocabularyItem } from '$lib/types/vocabulary';\n  import PathBrowser from '$lib/components/learning/PathBrowser.svelte';\n  import type { LearningPath, LearningPathProgress } from '$lib/types/learning-path';\n  import { getLearningPaths, getLearningPathProgress } from '$lib/services/learning-paths';\n\n  let isLoading = $state(true);\n  let recentWords = $state<VocabularyItem[]>([]);\n  let recommendedWords = $state<VocabularyItem[]>([]);\n  let paths = $state<LearningPath[]>([]);\n  let pathProgress = $state<Map<string, LearningPathProgress>>(new Map());\n  let pathsLoading = $state(true);\n  let pathsError = $state<string | null>(null);\n\n  const ui = $derived(appState.languageMode === 'DE_BG'\n    ? {\n        title: 'Lernen',\n        subtitle: 'W√§hle W√∂rter zum Lernen oder starte eine zuf√§llige √úbungssitzung',\n        recentTitle: 'Zuletzt angesehen',\n        recommendedTitle: 'Empfohlen f√ºr dich',\n        pathsTitle: 'Lernpfade',\n        quickPractice: 'üé≤ Schnell √ºben',\n        browseVocab: 'üìö Vokabular durchsuchen',\n        noRecent: 'Keine k√ºrzlich angesehenen W√∂rter',\n        noRecommended: 'Alle W√∂rter sind gemeistert! üéâ',\n        essentialA1: 'Essenzielle A1 W√∂rter',\n        essentialA2: 'Essenzielle A2 W√∂rter',\n        intermediateB1: 'Zwischenstufe B1',\n        advancedB2: 'Fortgeschritten B2',\n        words: 'W√∂rter',\n        complete: 'Fertig',\n        inProgress: 'In Bearbeitung'\n      }\n    : {\n        title: '–£—á–µ–Ω–µ',\n        subtitle: '–ò–∑–±–µ—Ä–µ—Ç–µ –¥—É–º–∏ –∑–∞ —É—á–µ–Ω–µ –∏–ª–∏ –∑–∞–ø–æ—á–Ω–µ—Ç–µ —Å–ª—É—á–∞–π–Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞',\n        recentTitle: '–û—Ç—Å–∫–æ—Ä–æ —Ä–∞–∑–≥–ª–µ–∂–¥–∞–Ω–æ',\n        recommendedTitle: '–ü—Ä–µ–ø–æ—Ä—ä—á–∞–Ω–æ –∑–∞ —Ç–µ–±',\n        pathsTitle: '–ü—ä—Ç–µ–∫–∏ –∑–∞ —É—á–µ–Ω–µ',\n        quickPractice: 'üé≤ –ë—ä—Ä–∑–∞ –ø—Ä–∞–∫—Ç–∏–∫–∞',\n        browseVocab: 'üìö –ü—Ä–µ–≥–ª–µ–¥ –Ω–∞ —Ä–µ—á–Ω–∏–∫–∞',\n        noRecent: '–ù—è–º–∞—Ç–µ –æ—Ç—Å–∫–æ—Ä–æ —Ä–∞–∑–≥–ª–µ–∂–¥–∞–Ω–∏ –¥—É–º–∏',\n        noRecommended: '–í—Å–∏—á–∫–∏ –¥—É–º–∏ —Å–∞ —É—Å–≤–æ–µ–Ω–∏! üéâ',\n        essentialA1: '–û—Å–Ω–æ–≤–Ω–∏ –¥—É–º–∏ A1',\n        essentialA2: '–û—Å–Ω–æ–≤–Ω–∏ –¥—É–º–∏ A2',\n        intermediateB1: '–ú–µ–∂–¥–∏–Ω–Ω–∞ —Å—Ç–µ–ø–µ–Ω B1',\n        advancedB2: '–ù–∞–ø—Ä–µ–¥–Ω–∞ —Å—Ç–µ–ø–µ–Ω B2',\n        words: '–¥—É–º–∏',\n        complete: '–ó–∞–≤—ä—Ä—à–µ–Ω–æ',\n        inProgress: '–í —Ö–æ–¥'\n      });\n\n  onMount(async () => {\n    try {\n      isLoading = true;\n      \n      // Initialize vocabulary database\n      await vocabularyDb.initialize();\n      const allVocab = vocabularyDb.getVocabulary();\n\n      // Get recent words from progress tracking (fallback to recent searches)\n      const recentIds = appState.practiceStats?.keys() ? Array.from(appState.practiceStats.keys()).slice(0, 6) : [];\n      recentWords = recentIds\n        .map(id => allVocab.find(v => v.id === id))\n        .filter(Boolean) as VocabularyItem[];\n\n      // If no recent words, show some from recent searches\n      if (recentWords.length === 0) {\n        const searchTerms = appState.recentSearches?.slice(0, 3) || [];\n        recentWords = searchTerms\n          .map(term => allVocab.find(v => v.german?.toLowerCase().includes(term.toLowerCase()) || v.bulgarian?.toLowerCase().includes(term.toLowerCase())))\n          .filter(Boolean) as VocabularyItem[];\n      }\n\n      // Get recommended words (A1/A2 difficulty, not yet mastered)\n      const masteredIds = new Set(\n        Array.from(appState.practiceStats?.entries() || [])\n          .filter(([, stats]) => stats && stats.correct >= 3)\n          .map(([id]) => id)\n      );\n\n      recommendedWords = allVocab\n        .filter(v => (v.cefrLevel === 'A1' || v.cefrLevel === 'A2') && !masteredIds.has(v.id))\n        .sort(() => Math.random() - 0.5)\n        .slice(0, 6);\n\n      // Real learning paths from service\n      try {\n        const loadedPaths = await getLearningPaths();\n        const progressMap = new Map<string, LearningPathProgress>();\n\n        for (const path of loadedPaths) {\n          const progress = await getLearningPathProgress(path.id);\n          progressMap.set(path.id, progress);\n        }\n\n        paths = loadedPaths;\n        pathProgress = progressMap;\n      } catch (err) {\n        pathsError = (err as Error).message ?? 'Failed to load learning paths';\n      } finally {\n        pathsLoading = false;\n      }\n    } catch (e) {\n      console.error('Error in Learn page onMount:', e);\n    } finally {\n      isLoading = false;\n    }\n  });\n\n  function handleCardClick(item: VocabularyItem) {\n    goto(`${base}/learn/${item.id}`);\n  }\n\n  function handleQuickPractice() {\n    // Get all vocabulary items and select a random one\n    const items = vocabularyDb.getVocabulary();\n      if (!items || items.length === 0) return;\n\n    // Select random vocabulary item\n    const randomItem = items[Math.floor(Math.random() * items.length)];\n      if (randomItem) {\n        // Navigate to vocabulary detail view which shows the learning hub\n        goto(`${base}/vocabulary/${randomItem.id}`);\n      }\n  }\n\n  function handleBrowseVocab() {\n    goto(`${base}/vocabulary`);\n  }\n\n  function handlePathOpen(pathId: string) {\n    goto(`${base}/learn/paths/${pathId}`);\n  }\n</script>\n\n<svelte:head>\n  <title>{ui.title}</title>\n</svelte:head>\n\n<div class=\"learn-hub\">\n\n  <header class=\"learn-header\">\n    <h1>{ui.title}</h1>\n    <p class=\"subtitle\">{ui.subtitle}</p>\n  </header>\n\n  {#if isLoading}\n    <div class=\"loading\">\n      <p>{ui.title === 'Lernen' ? 'W√∂rter werden geladen...' : '–î—É–º–∏—Ç–µ —Å–µ –∑–∞—Ä–µ–∂–¥–∞—Ç...'}</p>\n    </div>\n  {:else}\n    <section class=\"quick-actions\">\n      <ActionButton\n        label={ui.quickPractice}\n        icon=\"üé≤\"\n        onclick={handleQuickPractice}\n        variant=\"primary\"\n      />\n      <ActionButton\n        label={ui.browseVocab}\n        icon=\"üìö\"\n        onclick={handleBrowseVocab}\n        variant=\"secondary\"\n      />\n    </section>\n\n    {#if recentWords.length > 0}\n      <section class=\"recent-section\">\n        <h2>{ui.recentTitle}</h2>\n        <div class=\"word-grid\">\n          {#each recentWords as word (word.id)}\n            <div class=\"card-wrapper\">\n              <VocabularyCard item={word} variant=\"grid\" onOpenDetail={() => handleCardClick(word)} />\n            </div>\n          {/each}\n        </div>\n      </section>\n    {/if}\n\n    {#if recommendedWords.length > 0}\n      <section class=\"recommended-section\">\n        <h2>{ui.recommendedTitle}</h2>\n        <div class=\"word-grid\">\n          {#each recommendedWords as word (word.id)}\n            <div class=\"card-wrapper\">\n              <VocabularyCard item={word} variant=\"grid\" onOpenDetail={() => handleCardClick(word)} />\n            </div>\n          {/each}\n        </div>\n      </section>\n    {:else}\n      <section class=\"no-recommended\">\n        <p>{ui.noRecommended}</p>\n      </section>\n    {/if}\n\n    <section class=\"paths-section\">\n      <h2>{ui.pathsTitle}</h2>\n      {#if pathsLoading}\n        <div class=\"loading\">\n          <p>{ui.title === 'Lernen' ? 'Lernpfade werden geladen‚Ä¶' : '–ü—ä—Ç–µ–∫–∏—Ç–µ —Å–µ –∑–∞—Ä–µ–∂–¥–∞—Ç‚Ä¶'}</p>\n        </div>\n      {:else if pathsError}\n        <div class=\"loading error\">{pathsError}</div>\n      {:else}\n        <PathBrowser paths={paths} pathProgress={pathProgress} onPathSelect={handlePathOpen} />\n      {/if}\n    </section>\n  {/if}\n</div>\n\n<style>\n  .learn-hub {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 2rem 1rem;\n  }\n\n  .learn-header {\n    text-align: center;\n    margin-bottom: 3rem;\n  }\n\n  .learn-header h1 {\n    font-size: 2.5rem;\n    font-weight: 700;\n    margin-bottom: 0.5rem;\n    color: var(--color-text-primary);\n  }\n\n  .subtitle {\n    font-size: 1.1rem;\n    color: var(--color-text-secondary);\n    margin: 0;\n  }\n\n  .loading {\n    text-align: center;\n    padding: 4rem 2rem;\n    color: var(--color-text-secondary);\n  }\n\n  .quick-actions {\n    display: flex;\n    gap: 1rem;\n    justify-content: center;\n    margin-bottom: 3rem;\n    flex-wrap: wrap;\n  }\n\n  .recent-section,\n  .recommended-section,\n  .no-recommended,\n  .paths-section {\n    margin-bottom: 3rem;\n  }\n\n  .recent-section h2,\n  .recommended-section h2,\n  .paths-section h2 {\n    font-size: 1.5rem;\n    font-weight: 600;\n    margin-bottom: 1.5rem;\n    color: var(--color-text-primary);\n  }\n\n  .word-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n    gap: 1rem;\n  }\n\n  .card-wrapper {\n    cursor: pointer;\n    border-radius: 0.5rem;\n    transition: transform 0.2s, box-shadow 0.2s;\n  }\n\n  .card-wrapper:hover,\n  .card-wrapper:focus-visible {\n    transform: translateY(-2px);\n    outline: none;\n  }\n\n  .no-recommended {\n    text-align: center;\n    padding: 2rem;\n    background: var(--color-background-secondary);\n    border-radius: 0.5rem;\n    color: var(--color-text-secondary);\n  }\n\n  .paths-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n    gap: 1.5rem;\n  }\n\n  .path-card {\n    background: var(--color-background-secondary);\n    border: 1px solid var(--color-border);\n    border-radius: 0.75rem;\n    padding: 1.5rem;\n    text-align: left;\n    cursor: pointer;\n    transition: all 0.2s;\n    font-family: inherit;\n  }\n\n  .path-card:hover,\n  .path-card:focus-visible {\n    background: var(--color-background-tertiary);\n    border-color: var(--color-primary);\n    outline: none;\n  }\n\n  .path-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: flex-start;\n    margin-bottom: 1rem;\n  }\n\n  .path-header h3 {\n    margin: 0;\n    font-size: 1.1rem;\n    font-weight: 600;\n    color: var(--color-text-primary);\n    flex: 1;\n  }\n\n  .word-count {\n    background: var(--color-primary-light);\n    color: var(--color-primary-dark);\n    padding: 0.25rem 0.75rem;\n    border-radius: 1rem;\n    font-size: 0.85rem;\n    font-weight: 500;\n    white-space: nowrap;\n  }\n\n  .progress-bar {\n    height: 6px;\n    background: var(--color-background);\n    border-radius: 3px;\n    overflow: hidden;\n    margin-bottom: 0.75rem;\n  }\n\n  .progress-fill {\n    height: 100%;\n    background: var(--color-success);\n    transition: width 0.3s;\n    border-radius: 3px;\n  }\n\n  .progress-text {\n    font-size: 0.85rem;\n    color: var(--color-text-secondary);\n  }\n\n  @media (max-width: 768px) {\n    .learn-hub {\n      padding: 1rem;\n    }\n\n    .learn-header h1 {\n      font-size: 1.75rem;\n    }\n\n    .word-grid {\n      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));\n      gap: 0.75rem;\n    }\n\n    .paths-grid {\n      grid-template-columns: 1fr;\n    }\n\n    .quick-actions {\n      flex-direction: column;\n    }\n  }\n</style>\n"],"names":["isLoading","$.state","recentWords","$.proxy","recommendedWords","paths","pathProgress","Map","pathsLoading","pathsError","ui","$.derived","appState","languageMode","title","subtitle","recentTitle","recommendedTitle","pathsTitle","quickPractice","browseVocab","noRecent","noRecommended","essentialA1","essentialA2","intermediateB1","advancedB2","words","complete","inProgress","handleCardClick","item","goto","base","id","handleQuickPractice","items","vocabularyDb","getVocabulary","length","randomItem","Math","floor","random","handleBrowseVocab","handlePathOpen","pathId","onMount","async","$.set","initialize","allVocab","recentIds","practiceStats","keys","Array","from","slice","map","find","v","filter","Boolean","$.get","searchTerms","recentSearches","term","german","toLowerCase","includes","bulgarian","masteredIds","Set","entries","stats","correct","cefrLevel","has","sort","loadedPaths","getLearningPaths","progressMap","path","progress","getLearningPathProgress","set","err","message","e","console","error","div","root","$.head","$$anchor","header","h1","p","div_1","root_2","p_1","$.template_effect","$.set_text","text_2","section","$.first_child","fragment","ActionButton","node_1","node_2","section_1","root_4","h2","div_2","word","div_3","root_5","VocabularyCard","node_4","onOpenDetail","text_3","consequent_1","section_2","root_6","h2_1","div_4","div_5","root_7","node_6","text_4","section_3","root_8","p_2","text_5","consequent_2","$$render","alternate","section_4","$.sibling","node_5","h2_2","div_6","root_9","p_3","text_7","div_7","root_11","PathBrowser","consequent_4","alternate_1","consequent_3","alternate_2","text_6","consequent","alternate_3","text","text_1"],"mappings":"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"}