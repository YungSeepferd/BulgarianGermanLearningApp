{"version":3,"file":"12.C1Zmcm0I.js","sources":["../../../../../../node_modules/.pnpm/svelte@5.46.0/node_modules/svelte/src/attachments/index.js","../../../../../../node_modules/.pnpm/svelte@5.46.0/node_modules/svelte/src/reactivity/map.js","../../../../../../src/lib/components/LessonCard.svelte","../../../../../../src/lib/components/GeneratedLesson.svelte","../../../../../../src/lib/schemas/lesson.js","../../../../../../src/lib/services/lesson.ts","../../../../../../src/lib/services/enhanced-lesson.ts","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/is.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/box/box-extras.svelte.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/compose-handlers.js","../../../../../../node_modules/.pnpm/inline-style-parser@0.2.7/node_modules/inline-style-parser/esm/index.mjs","../../../../../../node_modules/.pnpm/style-to-object@1.0.14/node_modules/style-to-object/esm/index.mjs","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/strings.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/css-to-style-obj.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/execute-callbacks.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/style-to-css.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/style.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/event-list.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/merge-props.js","../../../../../../node_modules/.pnpm/runed@0.35.1_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5.46.0_vite_171f3819cc77cc61df35dfd1a2d1c877/node_modules/runed/dist/internal/configurable-globals.js","../../../../../../node_modules/.pnpm/runed@0.35.1_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5.46.0_vite_171f3819cc77cc61df35dfd1a2d1c877/node_modules/runed/dist/utilities/active-element/active-element.svelte.js","../../../../../../node_modules/.pnpm/runed@0.35.1_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5.46.0_vite_171f3819cc77cc61df35dfd1a2d1c877/node_modules/runed/dist/internal/utils/dom.js","../../../../../../node_modules/.pnpm/runed@0.35.1_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5.46.0_vite_171f3819cc77cc61df35dfd1a2d1c877/node_modules/runed/dist/utilities/context/context.js","../../../../../../node_modules/.pnpm/runed@0.35.1_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5.46.0_vite_171f3819cc77cc61df35dfd1a2d1c877/node_modules/runed/dist/utilities/watch/watch.svelte.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/on-destroy-effect.svelte.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/after-tick.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/dom.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/dom-context.svelte.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/attach-ref.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/attrs.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/kbd-constants.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/is.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/animations-complete.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/presence-manager.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/noop.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/create-id.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/dialog/dialog.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/dialog/components/dialog-title.svelte","../../../../../../node_modules/.pnpm/svelte@5.46.0/node_modules/svelte/src/internal/client/dom/blocks/key.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/portal/portal-consumer.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/config/bits-config.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/config/prop-resolvers.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/portal/portal.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/debounce.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/elements.js","../../../../../../node_modules/.pnpm/tabbable@6.3.0/node_modules/tabbable/dist/index.esm.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/menu/menu.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/dismissible-layer/use-dismissable-layer.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/dom.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.5_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_9553ede0df4fe17b1e5655c141004aea/node_modules/svelte-toolbelt/dist/utils/after-sleep.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/escape-layer/use-escape-layer.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/focus-scope/focus-scope-manager.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/focus-scope/focus-scope.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/text-selection-layer/use-text-selection-layer.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/use-id.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/shared-state.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/internal/body-scroll-lock.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/scroll-lock/scroll-lock.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/dialog/components/dialog-overlay.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/dialog/components/dialog-description.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/dialog/components/dialog.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/dialog/components/dialog-close.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/dialog/components/dialog-content.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/escape-layer/escape-layer.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/dismissible-layer/dismissible-layer.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/text-selection-layer/text-selection-layer.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.5_@sveltejs+vite-plugi_5ed4ca17f5c74300c94a2f7ef5faeb4a/node_modules/bits-ui/dist/bits/utilities/focus-scope/focus-scope.svelte","../../../../../../src/lib/components/ui/dialog/dialog-content.svelte","../../../../../../src/lib/components/ui/dialog/dialog-portal.svelte","../../../../../../src/lib/components/ui/dialog/dialog-overlay.svelte","../../../../../../src/lib/components/ui/icons/X.svelte","../../../../../../src/lib/components/LessonGenerator.svelte","../../../../../../src/lib/components/ui/dialog/dialog.svelte","../../../../../../src/lib/components/ui/dialog/dialog-header.svelte","../../../../../../src/lib/components/ui/dialog/dialog-title.svelte","../../../../../../src/lib/components/ui/dialog/dialog-description.svelte","../../../../../../src/lib/components/ui/dialog/dialog-footer.svelte","../../../../../../src/routes/lessons/+page.svelte"],"sourcesContent":["/** @import { Action, ActionReturn } from '../action/public' */\n/** @import { Attachment } from './public' */\nimport { noop, render_effect } from 'svelte/internal/client';\nimport { ATTACHMENT_KEY } from '../constants.js';\nimport { untrack } from '../index-client.js';\nimport { teardown } from '../internal/client/reactivity/effects.js';\n\n/**\n * Creates an object key that will be recognised as an attachment when the object is spread onto an element,\n * as a programmatic alternative to using `{@attach ...}`. This can be useful for library authors, though\n * is generally not needed when building an app.\n *\n * ```svelte\n * <script>\n * \timport { createAttachmentKey } from 'svelte/attachments';\n *\n * \tconst props = {\n * \t\tclass: 'cool',\n * \t\tonclick: () => alert('clicked'),\n * \t\t[createAttachmentKey()]: (node) => {\n * \t\t\tnode.textContent = 'attached!';\n * \t\t}\n * \t};\n * </script>\n *\n * <button {...props}>click me</button>\n * ```\n * @since 5.29\n */\nexport function createAttachmentKey() {\n\treturn Symbol(ATTACHMENT_KEY);\n}\n\n/**\n * Converts an [action](https://svelte.dev/docs/svelte/use) into an [attachment](https://svelte.dev/docs/svelte/@attach) keeping the same behavior.\n * It's useful if you want to start using attachments on components but you have actions provided by a library.\n *\n * Note that the second argument, if provided, must be a function that _returns_ the argument to the\n * action function, not the argument itself.\n *\n * ```svelte\n * <!-- with an action -->\n * <div use:foo={bar}>...</div>\n *\n * <!-- with an attachment -->\n * <div {@attach fromAction(foo, () => bar)}>...</div>\n * ```\n * @template {EventTarget} E\n * @template {unknown} T\n * @overload\n * @param {Action<E, T> | ((element: E, arg: T) => void | ActionReturn<T>)} action The action function\n * @param {() => T} fn A function that returns the argument for the action\n * @returns {Attachment<E>}\n */\n/**\n * Converts an [action](https://svelte.dev/docs/svelte/use) into an [attachment](https://svelte.dev/docs/svelte/@attach) keeping the same behavior.\n * It's useful if you want to start using attachments on components but you have actions provided by a library.\n *\n * Note that the second argument, if provided, must be a function that _returns_ the argument to the\n * action function, not the argument itself.\n *\n * ```svelte\n * <!-- with an action -->\n * <div use:foo={bar}>...</div>\n *\n * <!-- with an attachment -->\n * <div {@attach fromAction(foo, () => bar)}>...</div>\n * ```\n * @template {EventTarget} E\n * @overload\n * @param {Action<E, void> | ((element: E) => void | ActionReturn<void>)} action The action function\n * @returns {Attachment<E>}\n */\n/**\n * Converts an [action](https://svelte.dev/docs/svelte/use) into an [attachment](https://svelte.dev/docs/svelte/@attach) keeping the same behavior.\n * It's useful if you want to start using attachments on components but you have actions provided by a library.\n *\n * Note that the second argument, if provided, must be a function that _returns_ the argument to the\n * action function, not the argument itself.\n *\n * ```svelte\n * <!-- with an action -->\n * <div use:foo={bar}>...</div>\n *\n * <!-- with an attachment -->\n * <div {@attach fromAction(foo, () => bar)}>...</div>\n * ```\n *\n * @template {EventTarget} E\n * @template {unknown} T\n * @param {Action<E, T> | ((element: E, arg: T) => void | ActionReturn<T>)} action The action function\n * @param {() => T} fn A function that returns the argument for the action\n * @returns {Attachment<E>}\n * @since 5.32\n */\nexport function fromAction(action, fn = /** @type {() => T} */ (noop)) {\n\treturn (element) => {\n\t\tconst { update, destroy } = untrack(() => action(element, fn()) ?? {});\n\n\t\tif (update) {\n\t\t\tvar ran = false;\n\t\t\trender_effect(() => {\n\t\t\t\tconst arg = fn();\n\t\t\t\tif (ran) update(arg);\n\t\t\t});\n\t\t\tran = true;\n\t\t}\n\n\t\tif (destroy) {\n\t\t\tteardown(destroy);\n\t\t}\n\t};\n}\n","/** @import { Source } from '#client' */\nimport { DEV } from 'esm-env';\nimport { set, source, state, increment } from '../internal/client/reactivity/sources.js';\nimport { label, tag } from '../internal/client/dev/tracing.js';\nimport { get, update_version } from '../internal/client/runtime.js';\n\n/**\n * A reactive version of the built-in [`Map`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) object.\n * Reading contents of the map (by iterating, or by reading `map.size` or calling `map.get(...)` or `map.has(...)` as in the [tic-tac-toe example](https://svelte.dev/playground/0b0ff4aa49c9443f9b47fe5203c78293) below) in an [effect](https://svelte.dev/docs/svelte/$effect) or [derived](https://svelte.dev/docs/svelte/$derived)\n * will cause it to be re-evaluated as necessary when the map is updated.\n *\n * Note that values in a reactive map are _not_ made [deeply reactive](https://svelte.dev/docs/svelte/$state#Deep-state).\n *\n * ```svelte\n * <script>\n * \timport { SvelteMap } from 'svelte/reactivity';\n * \timport { result } from './game.js';\n *\n * \tlet board = new SvelteMap();\n * \tlet player = $state('x');\n * \tlet winner = $derived(result(board));\n *\n * \tfunction reset() {\n * \t\tplayer = 'x';\n * \t\tboard.clear();\n * \t}\n * </script>\n *\n * <div class=\"board\">\n * \t{#each Array(9), i}\n * \t\t<button\n * \t\t\tdisabled={board.has(i) || winner}\n * \t\t\tonclick={() => {\n * \t\t\t\tboard.set(i, player);\n * \t\t\t\tplayer = player === 'x' ? 'o' : 'x';\n * \t\t\t}}\n * \t\t>{board.get(i)}</button>\n * \t{/each}\n * </div>\n *\n * {#if winner}\n * \t<p>{winner} wins!</p>\n * \t<button onclick={reset}>reset</button>\n * {:else}\n * \t<p>{player} is next</p>\n * {/if}\n * ```\n *\n * @template K\n * @template V\n * @extends {Map<K, V>}\n */\nexport class SvelteMap extends Map {\n\t/** @type {Map<K, Source<number>>} */\n\t#sources = new Map();\n\t#version = state(0);\n\t#size = state(0);\n\t#update_version = update_version || -1;\n\n\t/**\n\t * @param {Iterable<readonly [K, V]> | null | undefined} [value]\n\t */\n\tconstructor(value) {\n\t\tsuper();\n\n\t\tif (DEV) {\n\t\t\t// If the value is invalid then the native exception will fire here\n\t\t\tvalue = new Map(value);\n\n\t\t\ttag(this.#version, 'SvelteMap version');\n\t\t\ttag(this.#size, 'SvelteMap.size');\n\t\t}\n\n\t\tif (value) {\n\t\t\tfor (var [key, v] of value) {\n\t\t\t\tsuper.set(key, v);\n\t\t\t}\n\t\t\tthis.#size.v = super.size;\n\t\t}\n\t}\n\n\t/**\n\t * If the source is being created inside the same reaction as the SvelteMap instance,\n\t * we use `state` so that it will not be a dependency of the reaction. Otherwise we\n\t * use `source` so it will be.\n\t *\n\t * @template T\n\t * @param {T} value\n\t * @returns {Source<T>}\n\t */\n\t#source(value) {\n\t\treturn update_version === this.#update_version ? state(value) : source(value);\n\t}\n\n\t/** @param {K} key */\n\thas(key) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\n\t\tif (s === undefined) {\n\t\t\tvar ret = super.get(key);\n\t\t\tif (ret !== undefined) {\n\t\t\t\ts = this.#source(0);\n\n\t\t\t\tif (DEV) {\n\t\t\t\t\ttag(s, `SvelteMap get(${label(key)})`);\n\t\t\t\t}\n\n\t\t\t\tsources.set(key, s);\n\t\t\t} else {\n\t\t\t\t// We should always track the version in case\n\t\t\t\t// the Set ever gets this value in the future.\n\t\t\t\tget(this.#version);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tget(s);\n\t\treturn true;\n\t}\n\n\t/**\n\t * @param {(value: V, key: K, map: Map<K, V>) => void} callbackfn\n\t * @param {any} [this_arg]\n\t */\n\tforEach(callbackfn, this_arg) {\n\t\tthis.#read_all();\n\t\tsuper.forEach(callbackfn, this_arg);\n\t}\n\n\t/** @param {K} key */\n\tget(key) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\n\t\tif (s === undefined) {\n\t\t\tvar ret = super.get(key);\n\t\t\tif (ret !== undefined) {\n\t\t\t\ts = this.#source(0);\n\n\t\t\t\tif (DEV) {\n\t\t\t\t\ttag(s, `SvelteMap get(${label(key)})`);\n\t\t\t\t}\n\n\t\t\t\tsources.set(key, s);\n\t\t\t} else {\n\t\t\t\t// We should always track the version in case\n\t\t\t\t// the Set ever gets this value in the future.\n\t\t\t\tget(this.#version);\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}\n\n\t\tget(s);\n\t\treturn super.get(key);\n\t}\n\n\t/**\n\t * @param {K} key\n\t * @param {V} value\n\t * */\n\tset(key, value) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\t\tvar prev_res = super.get(key);\n\t\tvar res = super.set(key, value);\n\t\tvar version = this.#version;\n\n\t\tif (s === undefined) {\n\t\t\ts = this.#source(0);\n\n\t\t\tif (DEV) {\n\t\t\t\ttag(s, `SvelteMap get(${label(key)})`);\n\t\t\t}\n\n\t\t\tsources.set(key, s);\n\t\t\tset(this.#size, super.size);\n\t\t\tincrement(version);\n\t\t} else if (prev_res !== value) {\n\t\t\tincrement(s);\n\n\t\t\t// if not every reaction of s is a reaction of version we need to also include version\n\t\t\tvar v_reactions = version.reactions === null ? null : new Set(version.reactions);\n\t\t\tvar needs_version_increase =\n\t\t\t\tv_reactions === null ||\n\t\t\t\t!s.reactions?.every((r) =>\n\t\t\t\t\t/** @type {NonNullable<typeof v_reactions>} */ (v_reactions).has(r)\n\t\t\t\t);\n\t\t\tif (needs_version_increase) {\n\t\t\t\tincrement(version);\n\t\t\t}\n\t\t}\n\n\t\treturn res;\n\t}\n\n\t/** @param {K} key */\n\tdelete(key) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\t\tvar res = super.delete(key);\n\n\t\tif (s !== undefined) {\n\t\t\tsources.delete(key);\n\t\t\tset(this.#size, super.size);\n\t\t\tset(s, -1);\n\t\t\tincrement(this.#version);\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tclear() {\n\t\tif (super.size === 0) {\n\t\t\treturn;\n\t\t}\n\t\t// Clear first, so we get nice console.log outputs with $inspect\n\t\tsuper.clear();\n\t\tvar sources = this.#sources;\n\t\tset(this.#size, 0);\n\t\tfor (var s of sources.values()) {\n\t\t\tset(s, -1);\n\t\t}\n\t\tincrement(this.#version);\n\t\tsources.clear();\n\t}\n\n\t#read_all() {\n\t\tget(this.#version);\n\n\t\tvar sources = this.#sources;\n\t\tif (this.#size.v !== sources.size) {\n\t\t\tfor (var key of super.keys()) {\n\t\t\t\tif (!sources.has(key)) {\n\t\t\t\t\tvar s = this.#source(0);\n\t\t\t\t\tif (DEV) {\n\t\t\t\t\t\ttag(s, `SvelteMap get(${label(key)})`);\n\t\t\t\t\t}\n\n\t\t\t\t\tsources.set(key, s);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor ([, s] of this.#sources) {\n\t\t\tget(s);\n\t\t}\n\t}\n\n\tkeys() {\n\t\tget(this.#version);\n\t\treturn super.keys();\n\t}\n\n\tvalues() {\n\t\tthis.#read_all();\n\t\treturn super.values();\n\t}\n\n\tentries() {\n\t\tthis.#read_all();\n\t\treturn super.entries();\n\t}\n\n\t[Symbol.iterator]() {\n\t\treturn this.entries();\n\t}\n\n\tget size() {\n\t\tget(this.#size);\n\t\treturn super.size;\n\t}\n}\n","<script lang=\"ts\">\n  /**\n   * LessonCard Component\n   *\n   * Displays a lesson with vocabulary items and progress tracking.\n   */\n\n  import type { Lesson, LessonDifficulty, LessonType } from '../schemas/lesson';\n\n  // Props\n  let { lesson, onStart } = $props<{ lesson: Lesson; onStart?: () => void }>();\n\n  // State\n  let isFlipped = $state(false);\n  let currentVocabularyIndex = $state(0);\n  let showAllVocabulary = $state(false);\n\n  // Computed\n  let vocabularyItems = $derived(\n    lesson.vocabulary.map((vocab: any) => {\n      if (typeof vocab === 'string') {\n        return {\n          id: vocab,\n          german: vocab.split('-')[0] || vocab,\n          bulgarian: vocab.split('-')[1] || vocab,\n          partOfSpeech: 'noun',\n          difficulty: 1\n        };\n      } else if (vocab && typeof vocab === 'object') {\n        return {\n          id: vocab.id || `vocab-${Date.now()}`,\n          german: vocab.german || vocab.bulgarian || 'Unknown',\n          bulgarian: vocab.bulgarian || vocab.german || 'Unknown',\n          partOfSpeech: vocab.partOfSpeech || 'noun',\n          difficulty: vocab.difficulty || 1\n        };\n      } else {\n        return {\n          id: `vocab-${Date.now()}`,\n          german: 'Unknown',\n          bulgarian: 'Unknown',\n          partOfSpeech: 'noun',\n          difficulty: 1\n        };\n      }\n    })\n  );\n\n  // Ensure vocabularyItems is never empty and currentVocabulary is always valid\n  let safeVocabularyItems = $derived(vocabularyItems.length > 0 ? vocabularyItems : [{\n    id: 'fallback-vocab',\n    german: 'Example',\n    bulgarian: '–ü—Ä–∏–º–µ—Ä',\n    partOfSpeech: 'noun',\n    difficulty: 1\n  }]);\n\n  let currentVocabulary = $derived(safeVocabularyItems[currentVocabularyIndex] || safeVocabularyItems[0]);\n  let completionPercentage = $derived(\n    Math.round((lesson.objectives.filter((obj: any) => obj.isCompleted).length / lesson.objectives.length) * 100)\n  );\n\n  // Methods\n  function toggleFlip() {\n    isFlipped = !isFlipped;\n  }\n\n  function nextVocabulary() {\n    if (currentVocabularyIndex < vocabularyItems.length - 1) {\n      currentVocabularyIndex++;\n    }\n  }\n\n  function prevVocabulary() {\n    if (currentVocabularyIndex > 0) {\n      currentVocabularyIndex--;\n    }\n  }\n\n  function toggleObjective(objectiveId: string) {\n    lesson.objectives = lesson.objectives.map((obj: any) =>\n      obj.id === objectiveId ? { ...obj, isCompleted: !obj.isCompleted } : obj\n    );\n    lesson.updatedAt = new Date();\n  }\n\n  function getDifficultyColor(difficulty: LessonDifficulty): string {\n    const colors: Record<LessonDifficulty, string> = {\n      'A1': 'bg-green-100 text-green-800 border-green-300',\n      'A2': 'bg-green-200 text-green-900 border-green-400',\n      'B1': 'bg-blue-100 text-blue-800 border-blue-300',\n      'B2': 'bg-blue-200 text-blue-900 border-blue-400',\n      'C1': 'bg-purple-100 text-purple-800 border-purple-300'\n    };\n    return colors[difficulty] || 'bg-gray-100 text-gray-800 border-gray-300';\n  }\n\n  function getLessonTypeIcon(type: LessonType): string {\n    const icons: Record<LessonType, string> = {\n      'vocabulary': 'üìö',\n      'grammar': 'üìñ',\n      'conversation': 'üí¨',\n      'reading': 'üìÑ',\n      'listening': 'üîä',\n      'writing': '‚úçÔ∏è',\n      'culture': 'üèõÔ∏è',\n      'mixed': 'üîÑ',\n      'contextual': 'üåê'\n    };\n    return icons[type] || 'üìö';\n  }\n</script>\n\n<!-- Lesson Card Container -->\n<div class=\"lesson-card-container\">\n  <!-- Lesson Card -->\n  <div\n    class=\"lesson-card {isFlipped ? 'flipped' : ''}\"\n    tabindex=\"0\"\n    onkeydown={e => e.key === 'Enter' || e.key === ' ' ? toggleFlip() : null}\n    aria-label={`Lesson: ${lesson.title}`}\n    role=\"button\"\n  >\n    <!-- Front Side -->\n    <div class=\"lesson-card-front\">\n      <div class=\"lesson-header\">\n        <div class=\"lesson-badge {getDifficultyColor(lesson.difficulty)}\">\n          {lesson.difficulty} ‚Ä¢ {lesson.duration} min\n        </div>\n        <div class=\"lesson-type-icon\" aria-label={`Lesson type: ${lesson.type}`}>\n          {getLessonTypeIcon(lesson.type)}\n        </div>\n      </div>\n\n      <h3 class=\"lesson-title\">{lesson.title}</h3>\n\n      <p class=\"lesson-description\">\n        {lesson.description}\n      </p>\n\n      <div class=\"lesson-progress\">\n        <div class=\"progress-bar-container\">\n          <div\n            class=\"progress-bar\"\n            style={`width: ${completionPercentage}%`}\n            role=\"progressbar\"\n            aria-valuenow={completionPercentage}\n            aria-valuemin=\"0\"\n            aria-valuemax=\"100\"\n          ></div>\n        </div>\n        <span class=\"progress-text\">{completionPercentage}% complete</span>\n      </div>\n\n      <div class=\"lesson-vocabulary-preview\">\n        <div class=\"vocabulary-tags\">\n          {#if showAllVocabulary}\n            {#each vocabularyItems.slice(0, 5) as vocab}\n              <span class=\"vocabulary-tag\" title={vocab.german}>\n                {vocab.german}\n              </span>\n            {/each}\n            {#if vocabularyItems.length > 5}\n              <span class=\"vocabulary-tag more\">+{vocabularyItems.length - 5}</span>\n            {/if}\n          {:else}\n            {#each vocabularyItems.slice(0, 3) as vocab}\n              <span class=\"vocabulary-tag\" title={vocab.german}>\n                {vocab.german}\n              </span>\n            {/each}\n            {#if vocabularyItems.length > 3}\n              <button\n                class=\"show-more-button\"\n                onclick={() => showAllVocabulary = true}\n                aria-label={`Show all ${vocabularyItems.length} vocabulary items`}\n              >\n                +{vocabularyItems.length - 3}\n              </button>\n            {/if}\n          {/if}\n        </div>\n      </div>\n\n      <div class=\"lesson-actions\">\n        <button\n          class=\"action-button primary\"\n          onclick={toggleFlip}\n          aria-label=\"View lesson details\"\n        >\n          View Details\n        </button>\n        <button\n          class=\"action-button secondary\"\n          onclick={() => onStart?.()}\n          aria-label=\"Start this lesson\"\n        >\n          ‚ñ∂Ô∏è Start\n        </button>\n      </div>\n    </div>\n\n    <!-- Back Side -->\n    <div class=\"lesson-card-back\">\n      <div class=\"lesson-header\">\n        <button\n          class=\"back-button\"\n          onclick={toggleFlip}\n          aria-label=\"Back to lesson overview\"\n        >\n          ‚Üê Back\n        </button>\n        <div class=\"lesson-badge {getDifficultyColor(lesson.difficulty)}\">\n          {lesson.difficulty} ‚Ä¢ {lesson.duration} min\n        </div>\n      </div>\n\n      <h3 class=\"lesson-title\">{lesson.title}</h3>\n\n      <div class=\"lesson-objectives\">\n        <h4>Learning Objectives</h4>\n        <ul class=\"objectives-list\">\n          {#each lesson.objectives as objective (objective.id)}\n            <li class=\"objective-item\">\n              <label class=\"objective-checkbox\">\n                <input\n                  type=\"checkbox\"\n                  checked={objective.isCompleted}\n                  onchange={() => toggleObjective(objective.id)}\n                />\n                <span class:completed={objective.isCompleted}>\n                  {objective.description}\n                </span>\n              </label>\n            </li>\n          {/each}\n        </ul>\n      </div>\n\n      <div class=\"lesson-vocabulary-details\">\n        <h4>Vocabulary ({vocabularyItems.length})</h4>\n\n        <div class=\"vocabulary-navigation\">\n          <button\n            onclick={prevVocabulary}\n            disabled={currentVocabularyIndex === 0}\n            aria-label=\"Previous vocabulary item\"\n          >\n            ‚óÄÔ∏è\n          </button>\n          <span class=\"vocabulary-counter\">\n            {currentVocabularyIndex + 1} / {vocabularyItems.length}\n          </span>\n          <button\n            onclick={nextVocabulary}\n            disabled={currentVocabularyIndex === vocabularyItems.length - 1}\n            aria-label=\"Next vocabulary item\"\n          >\n            ‚ñ∂Ô∏è\n          </button>\n        </div>\n\n        <div class=\"vocabulary-card\">\n          <div class=\"vocabulary-language german\">\n            {currentVocabulary.german}\n          </div>\n          <div class=\"vocabulary-language bulgarian\">\n            {currentVocabulary.bulgarian}\n          </div>\n          <div class=\"vocabulary-meta\">\n            {#if currentVocabulary?.partOfSpeech}\n              <span class=\"part-of-speech\">\n                {currentVocabulary.partOfSpeech}\n              </span>\n            {/if}\n            {#if currentVocabulary?.difficulty}\n              <span class=\"difficulty-indicator\">\n                {'‚≠ê'.repeat(currentVocabulary.difficulty)}\n              </span>\n            {/if}\n          </div>\n        </div>\n\n        <div class=\"vocabulary-list\">\n          {#each vocabularyItems as vocab, index}\n            <div\n              class=\"vocabulary-list-item {index === currentVocabularyIndex ? 'active' : ''}\"\n              onclick={() => currentVocabularyIndex = index}\n              role=\"button\"\n              tabindex=\"0\"\n              onkeydown={e => e.key === 'Enter' ? currentVocabularyIndex = index : null}\n            >\n              <span class=\"vocab-german\">{vocab?.german || 'Unknown'}</span>\n              <span class=\"vocab-bulgarian\">{vocab?.bulgarian || 'Unknown'}</span>\n            </div>\n          {/each}\n        </div>\n      </div>\n\n      <div class=\"lesson-actions\">\n        <button\n          class=\"action-button primary\"\n          onclick={() => onStart?.()}\n          aria-label=\"Start this lesson\"\n        >\n          Start Lesson\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<!-- Styles -->\n<style>\n  .lesson-card-container {\n    perspective: 1000px;\n    width: 100%;\n    max-width: 400px;\n    height: 500px;\n  }\n\n  .lesson-card {\n    width: 100%;\n    height: 100%;\n    position: relative;\n    transform-style: preserve-3d;\n    transition: transform 0.6s;\n    border-radius: 12px;\n    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\n    background: white;\n    overflow: hidden;\n  }\n\n  .lesson-card.flipped {\n    transform: rotateY(180deg);\n  }\n\n  .lesson-card-front, .lesson-card-back {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    backface-visibility: hidden;\n    padding: 20px;\n    display: flex;\n    flex-direction: column;\n    overflow-y: auto;\n  }\n\n  .lesson-card-front {\n    z-index: 2;\n  }\n\n  .lesson-card-back {\n    transform: rotateY(180deg);\n    background: #f8fafc;\n  }\n\n  .lesson-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 12px;\n  }\n\n  .lesson-badge {\n    padding: 4px 10px;\n    border-radius: 20px;\n    font-size: 0.75rem;\n    font-weight: 600;\n    border: 1px solid;\n    display: inline-block;\n  }\n\n  .lesson-type-icon {\n    font-size: 1.5rem;\n    width: 36px;\n    height: 36px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 50%;\n    background: rgba(59, 130, 246, 0.1);\n  }\n\n  .lesson-title {\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 8px;\n    line-height: 1.5;\n  }\n\n  .lesson-description {\n    color: #64748b;\n    font-size: 0.875rem;\n    line-height: 1.5;\n    margin-bottom: 16px;\n  }\n\n  .lesson-progress {\n    margin-bottom: 16px;\n  }\n\n  .progress-bar-container {\n    height: 6px;\n    background: #e2e8f0;\n    border-radius: 3px;\n    margin-bottom: 6px;\n    overflow: hidden;\n  }\n\n  .progress-bar {\n    height: 100%;\n    background: #3b82f6;\n    border-radius: 3px;\n    transition: width 0.3s ease;\n  }\n\n  .progress-text {\n    font-size: 0.75rem;\n    color: #64748b;\n    font-weight: 500;\n  }\n\n  .lesson-vocabulary-preview {\n    margin-bottom: 16px;\n  }\n\n  .vocabulary-tags {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 6px;\n  }\n\n  .vocabulary-tag {\n    padding: 4px 10px;\n    background: #f1f5f9;\n    border-radius: 20px;\n    font-size: 0.75rem;\n    color: #475569;\n    border: 1px solid #e2e8f0;\n    max-width: 100px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  .vocabulary-tag.more {\n    background: #e2e8f0;\n  }\n\n  .show-more-button {\n    padding: 4px 8px;\n    background: #f1f5f9;\n    border-radius: 20px;\n    font-size: 0.75rem;\n    color: #475569;\n    border: 1px solid #e2e8f0;\n    cursor: pointer;\n    margin-left: 4px;\n  }\n\n  .lesson-actions {\n    display: flex;\n    gap: 8px;\n    margin-top: auto;\n  }\n\n  .action-button {\n    flex: 1;\n    padding: 10px;\n    border-radius: 8px;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    border: none;\n    font-size: 0.875rem;\n  }\n\n  .action-button.primary {\n    background: #3b82f6;\n    color: white;\n  }\n\n  .action-button.primary:hover {\n    background: #2563eb;\n  }\n\n  .action-button.secondary {\n    background: #e2e8f0;\n    color: #475569;\n  }\n\n  .action-button.secondary:hover {\n    background: #cbd5e1;\n  }\n\n  .back-button {\n    padding: 6px 12px;\n    background: #f1f5f9;\n    border-radius: 6px;\n    font-size: 0.875rem;\n    color: #475569;\n    border: 1px solid #e2e8f0;\n    cursor: pointer;\n  }\n\n  .lesson-objectives {\n    margin-bottom: 20px;\n  }\n\n  .lesson-objectives h4 {\n    font-size: 1rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 12px;\n  }\n\n  .objectives-list {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n  }\n\n  .objective-item {\n    margin-bottom: 8px;\n  }\n\n  .objective-checkbox {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    cursor: pointer;\n  }\n\n  .objective-checkbox input {\n    margin: 0;\n  }\n\n  .objective-checkbox span {\n    font-size: 0.875rem;\n    color: #475569;\n  }\n\n  .objective-checkbox span.completed {\n    text-decoration: line-through;\n    color: #94a3b8;\n  }\n\n  .lesson-vocabulary-details h4 {\n    font-size: 1rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 12px;\n  }\n\n  .vocabulary-navigation {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    gap: 16px;\n    margin-bottom: 16px;\n  }\n\n  .vocabulary-counter {\n    font-size: 0.875rem;\n    color: #64748b;\n  }\n\n  .vocabulary-navigation button {\n    padding: 6px;\n    background: #f1f5f9;\n    border-radius: 50%;\n    border: 1px solid #e2e8f0;\n    cursor: pointer;\n    width: 32px;\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .vocabulary-navigation button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .vocabulary-card {\n    background: white;\n    border-radius: 12px;\n    padding: 20px;\n    margin-bottom: 16px;\n    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);\n    text-align: center;\n  }\n\n  .vocabulary-language {\n    font-size: 1.5rem;\n    font-weight: 600;\n    margin-bottom: 8px;\n  }\n\n  .vocabulary-language.german {\n    color: #1e293b;\n  }\n\n  .vocabulary-language.bulgarian {\n    color: #3b82f6;\n    font-size: 1.25rem;\n  }\n\n  .vocabulary-meta {\n    display: flex;\n    justify-content: center;\n    gap: 8px;\n    margin-top: 12px;\n  }\n\n  .part-of-speech {\n    padding: 2px 8px;\n    background: #f1f5f9;\n    border-radius: 12px;\n    font-size: 0.75rem;\n    color: #475569;\n  }\n\n  .difficulty-indicator {\n    color: #f59e0b;\n  }\n\n  .vocabulary-list {\n    max-height: 200px;\n    overflow-y: auto;\n    border: 1px solid #e2e8f0;\n    border-radius: 8px;\n  }\n\n  .vocabulary-list-item {\n    padding: 12px 16px;\n    border-bottom: 1px solid #e2e8f0;\n    cursor: pointer;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n\n  .vocabulary-list-item:last-child {\n    border-bottom: none;\n  }\n\n  .vocabulary-list-item.active {\n    background: #f1f5f9;\n  }\n\n  .vocabulary-list-item:hover {\n    background: #f8fafc;\n  }\n\n  .vocab-german {\n    font-weight: 500;\n    color: #1e293b;\n  }\n\n  .vocab-bulgarian {\n    color: #64748b;\n    font-size: 0.875rem;\n  }\n\n  @media (max-width: 640px) {\n    .lesson-card-container {\n      height: 480px;\n    }\n\n    .lesson-title {\n      font-size: 1.125rem;\n    }\n  }\n</style>","<script>\n  /**\n   * GeneratedLesson Component\n   *\n   * Displays a dynamically generated lesson with all its sections and content.\n   * Supports different section types (introduction, vocabulary, grammar, exercise, cultural, summary)\n   * and provides a rich, interactive learning experience with bilingual support.\n   */\n\n  import { t } from '$lib/services/localization';\n  import { appState } from '$lib/state/app-state';\n\n  // Language adapter functions\n  function getSourceText(item) {\n    return appState.languageMode === 'DE_BG' ? item.german : item.bulgarian;\n  }\n\n  function getTargetText(item) {\n    return appState.languageMode === 'DE_BG' ? item.bulgarian : item.german;\n  }\n\n  function correctPartOfSpeech(pos) {\n    const parts = {\n      'noun': 'Noun', 'verb': 'Verb', 'adjective': 'Adjective',\n      'adverb': 'Adverb', 'preposition': 'Preposition', 'conjunction': 'Conjunction'\n    };\n    return parts[pos] || pos;\n  }\n\n  // Props\n  let { lesson } = $props();\n\n  // Error state\n  let hasError = $state(false);\n  let errorMessage = $state(null);\n\n  // Simple error handler\n  function handleError(error, context) {\n    console.error(`[${context}]`, error);\n  }\n\n  // State\n  let currentSectionIndex = $state(0);\n  let showAllVocabulary = $state(false);\n  let showAllObjectives = $state(false);\n  let showSectionDetails = $state({});\n\n  // Initialize with error handling\n  $effect(() => {\n    try {\n      // Validate lesson data on initialization\n      if (!lesson) {\n        throw new Error('Lesson data is required');\n      }\n    } catch (err) {\n      handleError(err, 'Failed to initialize GeneratedLesson component');\n      hasError = true;\n      errorMessage = err instanceof Error ? err.message : 'Invalid lesson data';\n    }\n  });\n\n  // Computed\n  // Derived state with error handling\n  let sections = $derived.by(() => {\n    try {\n      if (!lesson.sections || lesson.sections.length === 0) {\n        return [{\n          id: 'default-section',\n          title: 'Lesson Content',\n          content: lesson.content || 'No content available',\n          type: 'summary',\n          metadata: {}\n        }];\n      }\n      return lesson.sections;\n    } catch (err) {\n      handleError(err, 'Failed to derive lesson sections');\n      hasError = true;\n      errorMessage = 'Failed to load lesson sections';\n      return [{\n        id: 'error-section',\n        title: 'Error',\n        content: 'Failed to load lesson content',\n        type: 'summary',\n        metadata: {}\n      }];\n    }\n  });\n\n  // Current section with error handling\n  let currentSection = $derived.by(() => {\n    try {\n      return sections[currentSectionIndex] || null;\n    } catch (err) {\n      handleError(err, 'Failed to get current section');\n      hasError = true;\n      errorMessage = 'Failed to load section content';\n      return null;\n    }\n  });\n  // Completion percentage with error handling\n  let completionPercentage = $derived.by(() => {\n    try {\n      if (!lesson.objectives || lesson.objectives.length === 0) return 0;\n      return Math.round((lesson.objectives.filter((obj) => obj.isCompleted).length / lesson.objectives.length) * 100);\n    } catch (err) {\n      handleError(err, 'Failed to calculate completion percentage');\n      hasError = true;\n      errorMessage = 'Failed to calculate progress';\n      return 0;\n    }\n  });\n  // Vocabulary items with error handling\n  let vocabularyItems = $derived.by(() => {\n    try {\n      return lesson.vocabulary || [];\n    } catch (err) {\n      handleError(err, 'Failed to load vocabulary items');\n      hasError = true;\n      errorMessage = 'Failed to load vocabulary';\n      return [];\n    }\n  });\n  // Derived boolean states with error handling\n  let hasVocabulary = $derived.by(() => {\n    try {\n      return vocabularyItems.length > 0;\n    } catch (err) {\n      handleError(err, 'Failed to check vocabulary availability');\n      return false;\n    }\n  });\n\n  let hasObjectives = $derived.by(() => {\n    try {\n      return lesson.objectives && lesson.objectives.length > 0;\n    } catch (err) {\n      handleError(err, 'Failed to check objectives availability');\n      return false;\n    }\n  });\n\n  let hasSections = $derived.by(() => {\n    try {\n      return sections.length > 0;\n    } catch (err) {\n      handleError(err, 'Failed to check sections availability');\n      return false;\n    }\n  });\n\n  let isFallbackLesson = $derived.by(() => {\n    try {\n      return lesson.metadata?.fallback === true;\n    } catch (err) {\n      handleError(err, 'Failed to check fallback status');\n      return false;\n    }\n  });\n\n  // Methods\n  /**\n   * Toggle objective completion status with error handling\n   */\n  function toggleObjective(objectiveId) {\n    try {\n      if (!lesson.objectives) {\n        throw new Error('Lesson objectives are not available');\n      }\n\n      lesson.objectives = lesson.objectives.map((obj) =>\n        obj.id === objectiveId ? { ...obj, isCompleted: !obj.isCompleted } : obj\n      );\n      lesson.updatedAt = new Date();\n    } catch (err) {\n      handleError(err, 'Failed to toggle objective');\n      hasError = true;\n      errorMessage = 'Failed to update objective status';\n    }\n  }\n\n  /**\n   * Navigate to next section with error handling\n   */\n  function nextSection() {\n    try {\n      if (currentSectionIndex < sections.length - 1) {\n        currentSectionIndex++;\n      }\n    } catch (err) {\n      handleError(err, 'Failed to navigate to next section');\n      hasError = true;\n      errorMessage = 'Failed to navigate sections';\n    }\n  }\n\n  /**\n   * Navigate to previous section with error handling\n   */\n  function prevSection() {\n    try {\n      if (currentSectionIndex > 0) {\n        currentSectionIndex--;\n      }\n    } catch (err) {\n      handleError(err, 'Failed to navigate to previous section');\n      hasError = true;\n      errorMessage = 'Failed to navigate sections';\n    }\n  }\n\n  /**\n   * Toggle section details visibility with error handling\n   */\n  function toggleSectionDetails(sectionId) {\n    try {\n      showSectionDetails[sectionId] = !showSectionDetails[sectionId];\n    } catch (err) {\n      handleError(err, 'Failed to toggle section details');\n      hasError = true;\n      errorMessage = 'Failed to toggle section details';\n    }\n  }\n\n  function getSectionIcon(type) {\n    const icons = {\n      'introduction': 'üìò',\n      'vocabulary': 'üìö',\n      'grammar': 'üìñ',\n      'exercise': '‚úèÔ∏è',\n      'cultural': 'üèõÔ∏è',\n      'summary': 'üìù',\n      'conversation': 'üí¨',\n      'reading': 'üìÑ',\n      'listening': 'üîä',\n      'writing': '‚úçÔ∏è'\n    };\n    return icons[type] || 'üìñ';\n  }\n\n  function getDifficultyColor(difficulty) {\n    const colors = {\n      'A1': 'bg-green-100 text-green-800 border-green-300',\n      'A2': 'bg-green-200 text-green-900 border-green-400',\n      'B1': 'bg-blue-100 text-blue-800 border-blue-300',\n      'B2': 'bg-blue-200 text-blue-900 border-blue-400',\n      'C1': 'bg-purple-100 text-purple-800 border-purple-300'\n    };\n    return colors[difficulty] || 'bg-gray-100 text-gray-800 border-gray-300';\n  }\n\n  function getLessonTypeIcon(type) {\n    const icons = {\n      'vocabulary': 'üìö',\n      'grammar': 'üìñ',\n      'conversation': 'üí¨',\n      'reading': 'üìÑ',\n      'listening': 'üîä',\n      'writing': '‚úçÔ∏è',\n      'culture': 'üèõÔ∏è',\n      'mixed': 'üéØ',\n      'contextual': 'üåç'\n    };\n    return icons[type] || 'üìö';\n  }\n\n  // Reactive section names using Svelte 5 runes\n  const sectionNames = $derived({\n    'introduction': t('sections.introduction') || 'Introduction',\n    'vocabulary': t('sections.vocabulary') || 'Vocabulary',\n    'grammar': t('sections.grammar') || 'Grammar',\n    'exercise': t('sections.exercise') || 'Exercise',\n    'cultural': t('sections.cultural_note') || 'Cultural Note',\n    'summary': t('sections.summary') || 'Summary',\n    'conversation': t('sections.conversation') || 'Conversation',\n    'reading': t('sections.reading') || 'Reading',\n    'listening': t('sections.listening') || 'Listening',\n    'writing': t('sections.writing') || 'Writing'\n  });\n\n  function getSectionTypeName(type) {\n    return sectionNames[type] || type;\n  }\n\n  function renderSectionContent(content) {\n    // Simple markdown-like rendering for basic formatting\n    return content\n      .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n      .replace(/`(.*?)`/g, '<code>$1</code>')\n      .replace(/\\n/g, '<br>');\n  }\n\n  function getVocabularyPreview(count) {\n    if (vocabularyItems.length === 0) return '';\n\n    const previewItems = vocabularyItems.slice(0, count);\n    // Show only the source language based on current direction\n    return previewItems.map((item) => getSourceText(item)).join(', ');\n  }\n</script>\n\n<div class=\"generated-lesson-container\">\n  {#if hasError}\n    <div class=\"error-message\">\n      <div class=\"error-icon\">‚ö†Ô∏è</div>\n      <h3>{t('errors.lesson_load_error')}</h3>\n      <p>{errorMessage || t('errors.unknown_error')}</p>\n      <button class=\"btn btn-secondary\" onclick={() => window.location.reload()}>\n        {t('common.reload_page')}\n      </button>\n    </div>\n  {:else if isFallbackLesson}\n    <div class=\"fallback-lesson-message\">\n      <div class=\"fallback-icon\">‚ö†Ô∏è</div>\n      <h3>{t('lesson.unavailable')}</h3>\n      <p>{lesson.description}</p>\n      <button class=\"btn btn-secondary\" onclick={() => window.location.reload()}>\n        {t('common.try_again')}\n      </button>\n    </div>\n  {:else}\n    <div class=\"lesson-header\">\n      <div class=\"lesson-title-section\">\n        <div class=\"lesson-type-icon\" aria-label={`Lesson type: ${lesson.type}`}>\n          {getLessonTypeIcon(lesson.type)}\n        </div>\n        <h1 class=\"lesson-title\">{lesson.title}</h1>\n      </div>\n\n      <div class=\"lesson-meta\">\n        <div class=\"lesson-badge {getDifficultyColor(lesson.difficulty)}\">\n          {lesson.difficulty} ‚Ä¢ {lesson.duration} {t('common.minutes')}\n        </div>\n        {#if lesson.metadata?.tags && lesson.metadata.tags.length > 0}\n          <div class=\"lesson-tags\">\n            {#each lesson.metadata.tags.slice(0, 3) as tag}\n              <span class=\"lesson-tag\">{tag}</span>\n            {/each}\n            {#if lesson.metadata.tags.length > 3}\n              <span class=\"lesson-tag more\">+{lesson.metadata.tags.length - 3}</span>\n            {/if}\n          </div>\n        {/if}\n      </div>\n    </div>\n\n    <div class=\"lesson-description\">\n      {lesson.description}\n    </div>\n\n    <div class=\"lesson-progress-container\">\n      <div class=\"progress-bar-container\">\n        <div\n          class=\"progress-bar\"\n          style={`width: ${completionPercentage}%`}\n          role=\"progressbar\"\n          aria-valuenow={completionPercentage}\n          aria-valuemin=\"0\"\n          aria-valuemax=\"100\"\n        ></div>\n      </div>\n      <span class=\"progress-text\">{completionPercentage}% complete</span>\n    </div>\n\n    {#if hasObjectives}\n      <div class=\"lesson-objectives\">\n        <div class=\"objectives-header\">\n          <h3>{t('sections.learning_objectives')}</h3>\n          <button\n            class=\"toggle-objectives\"\n            onclick={() => showAllObjectives = !showAllObjectives}\n          >\n            {showAllObjectives ? t('common.show_less') : t('common.show_all')}\n          </button>\n        </div>\n\n        <ul class=\"objectives-list\">\n          {#each (showAllObjectives ? lesson.objectives : lesson.objectives.slice(0, 3)) as objective (objective.id)}\n            <li class=\"objective-item\">\n              <label class=\"objective-checkbox\">\n                <input\n                  type=\"checkbox\"\n                  checked={objective.isCompleted}\n                  onchange={() => toggleObjective(objective.id)}\n                />\n                <span class:completed={objective.isCompleted}>\n                  {objective.description}\n                </span>\n              </label>\n            </li>\n          {/each}\n          {#if lesson.objectives.length > 3 && !showAllObjectives}\n            <li class=\"objective-item more-objectives\">\n              <button onclick={() => showAllObjectives = true}>\n                +{lesson.objectives.length - 3} {t('common.more_objectives')}\n              </button>\n            </li>\n          {/if}\n        </ul>\n      </div>\n    {/if}\n\n    {#if hasVocabulary}\n      <div class=\"lesson-vocabulary\">\n        <div class=\"vocabulary-header\">\n          <h3>{t('sections.vocabulary')} ({vocabularyItems.length})</h3>\n          <button\n            class=\"toggle-vocabulary\"\n            onclick={() => showAllVocabulary = !showAllVocabulary}\n          >\n            {showAllVocabulary ? t('common.show_less') : t('common.show_all')}\n          </button>\n        </div>\n\n        <div class=\"vocabulary-preview\">\n          {getVocabularyPreview(showAllVocabulary ? vocabularyItems.length : 5)}\n          {#if vocabularyItems.length > 5 && !showAllVocabulary}\n            <span class=\"more-vocabulary\">+{vocabularyItems.length - 5} {t('common.more_words')}</span>\n          {/if}\n        </div>\n\n        {#if showAllVocabulary}\n          <div class=\"vocabulary-list\">\n            {#each vocabularyItems as vocab (vocab.german)}\n              <div class=\"vocabulary-item\">\n                <!-- Show source language prominently -->\n                <div class=\"vocabulary-source\">\n                  {getSourceText(vocab)}\n                </div>\n                <!-- Show target language on hover/click or as secondary info -->\n                <div class=\"vocabulary-target\">\n                  {getTargetText(vocab)}\n                </div>\n                {#if vocab.partOfSpeech}\n                  <div class=\"vocabulary-part-of-speech\">\n                    {correctPartOfSpeech(vocab.partOfSpeech)}\n                  </div>\n                {/if}\n                {#if vocab.difficulty}\n                  <div class=\"vocabulary-difficulty\">\n                    {'‚≠ê'.repeat(Math.round(vocab.difficulty))}\n                  </div>\n                {/if}\n              </div>\n            {/each}\n          </div>\n        {/if}\n      </div>\n    {/if}\n\n    {#if hasSections}\n      <div class=\"lesson-sections\">\n        <div class=\"sections-navigation\">\n          <button\n            onclick={prevSection}\n            disabled={currentSectionIndex === 0}\n            aria-label={t('common.previous_section')}\n          >\n            ‚óÄÔ∏è {t('common.previous')}\n          </button>\n\n          <div class=\"section-indicator\">\n            {t('common.section')} {currentSectionIndex + 1} {t('common.of')} {sections.length}\n          </div>\n\n          <button\n            onclick={nextSection}\n            disabled={currentSectionIndex === sections.length - 1}\n            aria-label={t('common.next_section')}\n          >\n            {t('common.next')} ‚ñ∂Ô∏è\n          </button>\n        </div>\n\n        <div class=\"section-content\">\n          <div class=\"section-header\">\n            <div class=\"section-icon\">\n              {getSectionIcon(currentSection.type)}\n            </div>\n            <h2 class=\"section-title\">\n              {currentSection.title}\n            </h2>\n            <div class=\"section-type\">\n              {getSectionTypeName(currentSection.type)}\n            </div>\n          </div>\n\n          <div class=\"section-body\">\n            <div class=\"section-content-text\" innerHTML={renderSectionContent(currentSection.content)}></div>\n\n            {#if currentSection.metadata?.templateId}\n              <div class=\"section-meta\">\n                <span class=\"template-id\">\n                  Template: {currentSection.metadata.templateId}\n                </span>\n              </div>\n            {/if}\n          </div>\n        </div>\n\n        <div class=\"sections-overview\">\n          <h3>Lesson Sections</h3>\n          <div class=\"sections-list\">\n            {#each sections as section, index (section.id)}\n              <div\n                class=\"section-overview-item {index === currentSectionIndex ? 'active' : ''}\"\n                onclick={() => currentSectionIndex = index}\n                role=\"button\"\n                tabindex=\"0\"\n                onkeydown={e => e.key === 'Enter' || e.key === ' ' ? currentSectionIndex = index : null}\n              >\n                <div class=\"section-overview-icon\">\n                  {getSectionIcon(section.type)}\n                </div>\n                <div class=\"section-overview-title\">\n                  {section.title}\n                </div>\n                <div class=\"section-overview-type\">\n                  {getSectionTypeName(section.type)}\n                </div>\n              </div>\n            {/each}\n          </div>\n        </div>\n      </div>\n    {:else}\n      <div class=\"no-sections-message\">\n        {t('lesson.no_sections')}\n      </div>\n    {/if}\n\n    <div class=\"lesson-actions\">\n      <button class=\"btn btn-secondary\" onclick={() => window.history.back()}>\n        {t('common.back_to_lessons')}\n      </button>\n      <button class=\"btn btn-primary\" onclick={() => alert(t('lesson.start_alert'))}>\n        {t('common.start_lesson')}\n      </button>\n    </div>\n  {/if}\n</div>\n\n<style>\n  .generated-lesson-container {\n    max-width: 800px;\n    margin: 0 auto;\n    padding: 2rem;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  }\n\n  .fallback-lesson-message {\n    text-align: center;\n    padding: 2rem;\n    background: #fef2f2;\n    border-radius: 12px;\n    margin: 2rem 0;\n  }\n\n  .fallback-icon {\n    font-size: 3rem;\n    margin-bottom: 1rem;\n  }\n\n  .lesson-header {\n    margin-bottom: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n  }\n\n  .lesson-title-section {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n  }\n\n  .lesson-type-icon {\n    font-size: 2rem;\n    width: 50px;\n    height: 50px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 50%;\n    background: rgba(59, 130, 246, 0.1);\n  }\n\n  .lesson-title {\n    font-size: 2rem;\n    font-weight: 700;\n    color: #1e293b;\n    margin: 0;\n  }\n\n  .lesson-meta {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n    align-items: center;\n  }\n\n  .lesson-badge {\n    padding: 0.25rem 0.75rem;\n    border-radius: 20px;\n    font-size: 0.875rem;\n    font-weight: 600;\n    border: 1px solid;\n    display: inline-block;\n  }\n\n  .lesson-tags {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n  }\n\n  .lesson-tag {\n    padding: 0.25rem 0.75rem;\n    background: #f1f5f9;\n    border-radius: 20px;\n    font-size: 0.75rem;\n    color: #475569;\n    border: 1px solid #e2e8f0;\n  }\n\n  .lesson-tag.more {\n    background: #e2e8f0;\n  }\n\n  .lesson-description {\n    color: #64748b;\n    font-size: 1rem;\n    line-height: 1.6;\n    margin-bottom: 1.5rem;\n  }\n\n  .lesson-progress-container {\n    margin-bottom: 2rem;\n  }\n\n  .progress-text {\n    display: block;\n    text-align: right;\n    font-size: 0.875rem;\n    color: #64748b;\n    margin-top: 0.5rem;\n  }\n\n  .lesson-objectives {\n    background: #f8fafc;\n    border-radius: 12px;\n    padding: 1.5rem;\n    margin-bottom: 2rem;\n  }\n\n  .objectives-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n  }\n\n  .objectives-header h3 {\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin: 0;\n  }\n\n  .toggle-objectives {\n    background: none;\n    border: none;\n    color: #3b82f6;\n    cursor: pointer;\n    font-size: 0.875rem;\n    text-decoration: underline;\n  }\n\n  .objectives-list {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n  }\n\n  .objective-item {\n    margin-bottom: 0.75rem;\n    padding: 0.5rem 0;\n  }\n\n  .objective-item:last-child {\n    margin-bottom: 0;\n  }\n\n  .objective-checkbox {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    cursor: pointer;\n  }\n\n  .objective-checkbox input {\n    margin: 0;\n  }\n\n  .objective-checkbox span {\n    font-size: 0.95rem;\n    color: #475569;\n  }\n\n  .objective-checkbox span.completed {\n    text-decoration: line-through;\n    color: #94a3b8;\n  }\n\n  .more-objectives {\n    color: #3b82f6;\n    font-size: 0.875rem;\n  }\n\n  .more-objectives button {\n    background: none;\n    border: none;\n    color: #3b82f6;\n    cursor: pointer;\n    text-decoration: underline;\n    padding: 0;\n  }\n\n  .lesson-vocabulary {\n    background: #f8fafc;\n    border-radius: 12px;\n    padding: 1.5rem;\n    margin-bottom: 2rem;\n  }\n\n  .vocabulary-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n  }\n\n  .vocabulary-header h3 {\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin: 0;\n  }\n\n  .toggle-vocabulary {\n    background: none;\n    border: none;\n    color: #3b82f6;\n    cursor: pointer;\n    font-size: 0.875rem;\n    text-decoration: underline;\n  }\n\n  .vocabulary-preview {\n    font-size: 0.95rem;\n    color: #475569;\n    line-height: 1.5;\n  }\n\n  .more-vocabulary {\n    color: #3b82f6;\n    font-size: 0.875rem;\n  }\n\n  .vocabulary-list {\n    margin-top: 1rem;\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n    gap: 1rem;\n  }\n\n  .vocabulary-item {\n    background: white;\n    border-radius: 8px;\n    padding: 1rem;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  }\n\n  .vocabulary-source {\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 0.5rem;\n    font-size: 1.1rem;\n  }\n\n  .vocabulary-target {\n    color: #3b82f6;\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    font-size: 0.95rem;\n  }\n\n  .vocabulary-part-of-speech {\n    font-size: 0.75rem;\n    color: #64748b;\n    background: #f1f5f9;\n    padding: 0.25rem 0.5rem;\n    border-radius: 4px;\n    display: inline-block;\n    margin-right: 0.5rem;\n  }\n\n  .vocabulary-difficulty {\n    font-size: 0.75rem;\n    color: #f59e0b;\n  }\n\n  .lesson-sections {\n    margin-bottom: 2rem;\n  }\n\n  .sections-navigation {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1.5rem;\n  }\n\n  .sections-navigation button {\n    padding: 0.5rem 1rem;\n    background: #f1f5f9;\n    border: 1px solid #e2e8f0;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.875rem;\n  }\n\n  .sections-navigation button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .section-indicator {\n    font-size: 0.875rem;\n    color: #64748b;\n  }\n\n  .section-content {\n    background: white;\n    border-radius: 12px;\n    padding: 2rem;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  }\n\n  .section-header {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    margin-bottom: 1.5rem;\n    border-bottom: 1px solid #e2e8f0;\n    padding-bottom: 1rem;\n  }\n\n  .section-icon {\n    font-size: 1.5rem;\n  }\n\n  .section-title {\n    font-size: 1.5rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin: 0;\n    flex: 1;\n  }\n\n  .section-type {\n    padding: 0.25rem 0.75rem;\n    background: #f1f5f9;\n    border-radius: 20px;\n    font-size: 0.75rem;\n    color: #475569;\n  }\n\n  .section-body {\n    line-height: 1.7;\n  }\n\n  .section-content-text {\n    font-size: 1rem;\n    color: #334155;\n  }\n\n  .section-content-text :global(strong) {\n    font-weight: 600;\n    color: #1e293b;\n  }\n\n  .section-content-text :global(em) {\n    font-style: italic;\n  }\n\n  .section-content-text :global(code) {\n    background: #f1f5f9;\n    padding: 0.1rem 0.3rem;\n    border-radius: 4px;\n    font-family: monospace;\n  }\n\n  .section-meta {\n    margin-top: 1rem;\n    font-size: 0.75rem;\n    color: #94a3b8;\n  }\n\n  .sections-overview {\n    margin-top: 2rem;\n  }\n\n  .sections-overview h3 {\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 1rem;\n  }\n\n  .sections-list {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n    gap: 1rem;\n  }\n\n  .section-overview-item {\n    background: #f8fafc;\n    border-radius: 8px;\n    padding: 1rem;\n    cursor: pointer;\n    transition: background 0.2s ease;\n  }\n\n  .section-overview-item:hover {\n    background: #f1f5f9;\n  }\n\n  .section-overview-item.active {\n    background: #e2e8f0;\n    border-left: 3px solid #3b82f6;\n  }\n\n  .section-overview-icon {\n    font-size: 1.25rem;\n    margin-bottom: 0.5rem;\n  }\n\n  .section-overview-title {\n    font-weight: 500;\n    color: #1e293b;\n    margin-bottom: 0.25rem;\n  }\n\n  .section-overview-type {\n    font-size: 0.75rem;\n    color: #64748b;\n  }\n\n  .no-sections-message {\n    text-align: center;\n    padding: 2rem;\n    color: #64748b;\n    font-size: 1rem;\n  }\n\n  .lesson-actions {\n    display: flex;\n    justify-content: flex-end;\n    gap: 1rem;\n    margin-top: 2rem;\n  }\n\n  @media (max-width: 768px) {\n    .generated-lesson-container {\n      padding: 1rem;\n    }\n\n    .lesson-title {\n      font-size: 1.5rem;\n    }\n\n    .sections-list {\n      grid-template-columns: 1fr;\n    }\n\n    .vocabulary-list {\n      grid-template-columns: 1fr;\n    }\n\n    .lesson-actions {\n      flex-direction: column;\n    }\n  }\n</style>","// Lesson Schema for Bulgarian-German Language Learning Application\nimport { z } from 'zod';\nimport { VocabularyCategorySchemaWithFallback, VocabularyMetadataSchema, LegacyIdSchema, PartOfSpeechSchema } from './vocabulary';\n// Create a base schema without catch for omit operations\nconst VocabularyItemBaseSchema = z.object({\n    id: LegacyIdSchema,\n    german: z.string().min(1).max(100),\n    bulgarian: z.string().min(1).max(100),\n    partOfSpeech: PartOfSpeechSchema.default('noun'),\n    difficulty: z.number().min(1).max(5).default(1).describe('1-5 scale where 1 is easiest'),\n    categories: z.array(VocabularyCategorySchemaWithFallback).min(1).default(['uncategorized']),\n    metadata: VocabularyMetadataSchema.optional(),\n    createdAt: z.union([\n        z.date(),\n        z.string().datetime().transform(str => new Date(str))\n    ]).default(new Date()).transform(val => val instanceof Date ? val : new Date(val)),\n    updatedAt: z.union([\n        z.date(),\n        z.string().datetime().transform(str => new Date(str))\n    ]).default(new Date()).transform(val => val instanceof Date ? val : new Date(val)),\n    isCommon: z.boolean().default(false),\n    isVerified: z.boolean().default(false)\n});\n// Vocabulary reference schema\nexport const VocabularyReferenceSchema = z.union([\n    VocabularyItemBaseSchema.omit({ id: true }), // Use base schema for omit()\n    LegacyIdSchema,\n    z.string().uuid()\n]);\n// Lesson difficulty levels\nexport const LessonDifficultySchema = z.enum(['A1', 'A2', 'B1', 'B2', 'C1']);\n// Lesson types\nexport const LessonTypeSchema = z.enum([\n    'vocabulary', 'grammar', 'conversation', 'reading', 'listening', 'writing', 'culture', 'mixed'\n]);\n// Learning objective schema\nexport const LearningObjectiveSchema = z.object({\n    id: z.string().uuid(),\n    description: z.string().min(5).max(200),\n    isCompleted: z.boolean().default(false),\n    createdAt: z.date().default(new Date())\n});\n// Lesson metadata\nexport const LessonMetadataSchema = z.object({\n    tags: z.array(z.string()).default([]),\n    prerequisites: z.array(LegacyIdSchema).default([]),\n    relatedLessons: z.array(LegacyIdSchema).default([]),\n    isPremium: z.boolean().default(false)\n}).default({});\n// Main Lesson Schema\nexport const LessonSchema = z.object({\n    id: LegacyIdSchema,\n    title: z.string().min(3).max(100),\n    description: z.string().min(10).max(1000),\n    difficulty: LessonDifficultySchema.default('A1'),\n    type: LessonTypeSchema.default('vocabulary'),\n    duration: z.number().min(5).max(120).default(15),\n    vocabulary: z.array(VocabularyReferenceSchema).default([]),\n    objectives: z.array(LearningObjectiveSchema).default([]),\n    content: z.string().optional(),\n    isCompleted: z.boolean().default(false),\n    completionPercentage: z.number().min(0).max(100).default(0),\n    createdAt: z.union([z.date(), z.string().datetime().transform(str => new Date(str))]).default(new Date()),\n    updatedAt: z.union([z.date(), z.string().datetime().transform(str => new Date(str))]).default(new Date()),\n    metadata: LessonMetadataSchema\n}).catch((_ctx) => {\n  return {\n        id: `fallback-${Date.now()}`,\n        title: 'Invalid Lesson',\n        description: 'This lesson failed validation',\n        difficulty: 'A1',\n        type: 'vocabulary',\n        duration: 15,\n        vocabulary: [],\n        objectives: [],\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        metadata: {}\n    };\n});\n//# sourceMappingURL=lesson.js.map","/**\n * Lesson Service for Bulgarian-German Language Learning Application\n *\n * This service provides comprehensive business logic for creating, managing, and delivering\n * curriculum-based lessons with robust vocabulary integration, error handling, and performance optimization.\n */\n\nimport { LessonSchema } from '../schemas/lesson';\nimport type { Lesson, LearningObjective, LessonDifficulty, LessonType } from '../schemas/lesson';\nimport type { VocabularyItem, VocabularyCategory, PartOfSpeech } from '../types/vocabulary';\nimport { vocabularyDb as db } from '../data/db.svelte.js';\n\n/**\n * Lesson Service Class\n */\nexport class LessonService {\n  private lessons: Lesson[] = [];\n  private vocabularyData: VocabularyItem[] = [];\n  private initialized = false;\n\n  constructor() {\n    // Initialize will be called explicitly to prevent SSR issues\n  }\n\n  /**\n   * Initialize the lesson service with vocabulary data\n   */\n  async initialize() {\n    if (this.initialized) return;\n\n    try {\n      await db.initialize();\n      const vocabData = await db.getVocabulary();\n      // Normalize unified vocabulary items to lesson service expectations\n      this.vocabularyData = vocabData.map((item) => ({\n        ...item,\n        categories: this.normalizeCategories(item.categories as VocabularyCategory[] | undefined),\n        metadata: (item.metadata ?? {}) as any,\n        isCommon: item.isCommon ?? false,\n        isVerified: item.isVerified ?? false,\n        learningPhase: (item as { learningPhase?: number }).learningPhase ?? 0,\n        createdAt: (item as { createdAt?: Date }).createdAt ?? new Date(),\n        updatedAt: (item as { updatedAt?: Date }).updatedAt ?? new Date(),\n        cefrLevel: this.normalizeCefrLevel((item as { cefrLevel?: LessonDifficulty | 'C1' }).cefrLevel)\n      }));\n      this.initialized = true;\n    } catch (_error) {\n      // Failed to initialize LessonService\n      this.vocabularyData = [];\n      this.initialized = false;\n      throw _error;\n    }\n  }\n\n  /**\n   * Check if service is initialized\n   */\n  isInitialized(): boolean {\n    return this.initialized;\n  }\n\n  /**\n   * Generate a lesson from specific vocabulary items\n   */\n  generateLessonFromVocabulary(\n    vocabularyItems: VocabularyItem[],\n    options: {\n      title?: string;\n      difficulty?: LessonDifficulty;\n      type?: LessonType;\n      description?: string;\n    } = {}\n  ): Lesson {\n    // Validate input\n    if (!vocabularyItems || vocabularyItems.length === 0) {\n      return this.createFallbackLesson('No vocabulary items provided');\n    }\n\n    const { title, difficulty, type = 'vocabulary', description } = options;\n\n    // Determine lesson title\n    const lessonTitle = title || this.generateLessonTitle(vocabularyItems, type);\n\n    // Determine difficulty if not provided\n    const lessonDifficulty = difficulty || this.determineLessonDifficulty(vocabularyItems);\n\n    // Create learning objectives\n    const objectives = this.createLearningObjectives(vocabularyItems, lessonDifficulty, type);\n\n    // Create the lesson\n    const lesson: Lesson = {\n      id: crypto.randomUUID(),\n      title: lessonTitle,\n      description: description || this.generateLessonDescription(vocabularyItems, lessonDifficulty, type),\n      difficulty: lessonDifficulty,\n      type,\n      duration: this.calculateLessonDuration(vocabularyItems.length),\n      vocabulary: vocabularyItems.map(item => this.normalizeVocabularyItem(item)),\n      objectives,\n      isCompleted: false,\n      completionPercentage: 0,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      metadata: {\n        tags: this.generateLessonTags(vocabularyItems, lessonDifficulty, type),\n        prerequisites: [],\n        relatedLessons: [],\n        isPremium: false\n      }\n    };\n\n    // Validate the lesson\n    return this.validateLesson(lesson);\n  }\n\n  /**\n   * Generate a lesson from criteria (difficulty, type, theme, etc.)\n   */\n  async generateLessonFromCriteria(\n    criteria: {\n      difficulty?: LessonDifficulty;\n      type?: LessonType;\n      categories?: VocabularyCategory[];\n      partOfSpeech?: PartOfSpeech;\n      limit?: number;\n      title?: string;\n      description?: string;\n    } = {}\n  ): Promise<Lesson> {\n    try {\n      // Ensure service is initialized\n      if (!this.initialized) {\n        await this.initialize();\n      }\n\n      // Query vocabulary based on criteria\n      const vocabularyItems = this.queryVocabulary(criteria);\n\n      // Apply limit if specified and normalize items for schema compatibility\n      const limitedItems = (criteria.limit\n        ? vocabularyItems.slice(0, criteria.limit)\n        : vocabularyItems).map(item => this.normalizeVocabularyItem(item));\n\n      // Generate lesson\n      return this.generateLessonFromVocabulary(limitedItems, {\n        title: criteria.title ?? 'Untitled Lesson',\n        difficulty: criteria.difficulty ?? 'A1',\n        type: criteria.type ?? 'vocabulary',\n        description: criteria.description ?? ''\n      });\n\n    } catch (_error) {\n      // Failed to generate lesson from criteria\n      return this.createFallbackLesson('Failed to generate lesson from criteria');\n    }\n  }\n\n  /**\n   * Query vocabulary based on criteria\n   */\n  private queryVocabulary(criteria: {\n    difficulty?: LessonDifficulty;\n    categories?: VocabularyCategory[];\n    partOfSpeech?: PartOfSpeech;\n    limit?: number;\n  }): VocabularyItem[] {\n    if (this.vocabularyData.length === 0) {\n      // No vocabulary data available\n      return [];\n    }\n\n    // Convert difficulty level to numeric range if provided\n    const difficultyRange = criteria.difficulty\n      ? this.getDifficultyRange(criteria.difficulty)\n      : null;\n\n    return this.vocabularyData.filter(item => {\n      // Filter by difficulty\n      const difficultyMatch = difficultyRange\n        ? item.difficulty >= difficultyRange.min && item.difficulty <= difficultyRange.max\n        : true;\n\n      // Filter by categories\n      const categoryMatch = criteria.categories && criteria.categories.length > 0\n        ? item.categories.some(category => criteria.categories?.includes(category))\n        : true;\n\n      // Filter by part of speech\n      const partOfSpeechMatch = criteria.partOfSpeech\n        ? item.partOfSpeech === criteria.partOfSpeech\n        : true;\n\n      return difficultyMatch && categoryMatch && partOfSpeechMatch;\n    });\n  }\n\n  /**\n   * Get numeric difficulty range for a CEFR level\n   */\n  private getDifficultyRange(difficulty: LessonDifficulty): { min: number; max: number } {\n    const ranges: Record<LessonDifficulty, { min: number; max: number }> = {\n      'A1': { min: 1, max: 1.5 },\n      'A2': { min: 1.5, max: 2.5 },\n      'B1': { min: 2.5, max: 3.5 },\n      'B2': { min: 3.5, max: 4.5 },\n      'C1': { min: 4.5, max: 5 }\n    };\n    return ranges[difficulty];\n  }\n\n  private normalizeCefrLevel(level?: LessonDifficulty | 'C1'): LessonDifficulty {\n    if (level === 'A1' || level === 'A2' || level === 'B1' || level === 'B2') {\n      return level;\n    }\n    return 'A1';\n  }\n\n  /**\n   * Generate a lesson title based on vocabulary content\n   */\n  private generateLessonTitle(vocabularyItems: VocabularyItem[], type: LessonType): string {\n    if (vocabularyItems.length === 0) return 'New Lesson';\n\n    // Extract unique categories\n    const categories = new Set<VocabularyCategory>();\n    vocabularyItems.forEach(item => {\n      this.normalizeCategories(item.categories).forEach(category => categories.add(category));\n    });\n\n    // Determine lesson type name\n    const typeNames: Record<LessonType, string> = {\n      'vocabulary': 'Vocabulary',\n      'grammar': 'Grammar',\n      'conversation': 'Conversation',\n      'reading': 'Reading',\n      'listening': 'Listening',\n      'writing': 'Writing',\n      'culture': 'Culture',\n      'mixed': 'Mixed Topics',\n      'contextual': 'Contextual'\n    };\n\n    const typeName = typeNames[type] || 'Lesson';\n\n    // If single category, use it in the title\n    if (categories.size === 1) {\n      const categoryEntry = categories.values().next();\n      if (!categoryEntry.done) {\n        return `${typeName}: ${this.getCategoryDisplayName(categoryEntry.value)}`;\n      }\n    }\n\n    // If multiple categories, use a generic title\n    return `${typeName} Lesson (${vocabularyItems.length} items)`;\n  }\n\n  /**\n   * Generate a lesson description\n   */\n  private generateLessonDescription(\n    vocabularyItems: VocabularyItem[],\n    difficulty: LessonDifficulty,\n    type: LessonType\n  ): string {\n    const typeDescriptions: Record<LessonType, string> = {\n      'vocabulary': 'vocabulary building',\n      'grammar': 'grammar concepts',\n      'conversation': 'conversation practice',\n      'reading': 'reading comprehension',\n      'listening': 'listening skills',\n      'writing': 'writing practice',\n      'culture': 'cultural insights',\n      'mixed': 'various language skills',\n      'contextual': 'contextual usage'\n    };\n\n    const partsOfSpeech = new Set<PartOfSpeech>();\n    vocabularyItems.forEach(item => partsOfSpeech.add(item.partOfSpeech));\n\n    const partOfSpeechList = Array.from(partsOfSpeech)\n      .map(pos => this.getPartOfSpeechDisplayName(pos))\n      .join(', ');\n\n    return `This ${difficulty} level lesson focuses on ${typeDescriptions[type]} with ${vocabularyItems.length} vocabulary items covering ${partOfSpeechList}.`;\n  }\n\n  /**\n   * Calculate lesson duration based on number of vocabulary items\n   */\n  private calculateLessonDuration(itemCount: number): number {\n    // Base duration: 2 minutes per item\n    const baseDuration = itemCount * 2;\n\n    // Add buffer time for lessons with many items\n    if (itemCount > 15) {\n      return Math.min(baseDuration + 10, 120); // Max 120 minutes\n    } else if (itemCount > 10) {\n      return baseDuration + 5;\n    } else {\n      return Math.max(baseDuration, 15); // Minimum 15 minutes\n    }\n  }\n\n  /**\n   * Create learning objectives for a lesson\n   */\n  private createLearningObjectives(\n    vocabularyItems: VocabularyItem[],\n    difficulty: LessonDifficulty,\n    type: LessonType\n  ): LearningObjective[] {\n    const objectives: LearningObjective[] = [];\n\n    // Base objectives\n    objectives.push({\n      id: crypto.randomUUID(),\n      description: `Learn ${vocabularyItems.length} new vocabulary items at ${difficulty} level`,\n      isCompleted: false,\n      createdAt: new Date()\n    });\n\n    // Type-specific objectives\n    const typeObjectives: Record<LessonType, string> = {\n      'vocabulary': 'Practice using new vocabulary in context',\n      'grammar': 'Understand and apply grammar concepts',\n      'conversation': 'Engage in conversation using learned vocabulary',\n      'reading': 'Read and comprehend texts using learned vocabulary',\n      'listening': 'Listen and understand spoken language at this level',\n      'writing': 'Write sentences or paragraphs using learned vocabulary',\n      'culture': 'Understand cultural context of vocabulary',\n      'mixed': 'Practice various language skills at this level',\n      'contextual': 'Use vocabulary in specific contexts'\n    };\n\n    objectives.push({\n      id: crypto.randomUUID(),\n      description: typeObjectives[type],\n      isCompleted: false,\n      createdAt: new Date()\n    });\n\n    // Difficulty-specific objectives\n    if (difficulty === 'A1' || difficulty === 'A2') {\n      objectives.push({\n        id: crypto.randomUUID(),\n        description: 'Recognize basic words and phrases in context',\n        isCompleted: false,\n        createdAt: new Date()\n      });\n    } else if (difficulty === 'B1' || difficulty === 'B2') {\n      objectives.push({\n        id: crypto.randomUUID(),\n        description: 'Use vocabulary in complete sentences and questions',\n        isCompleted: false,\n        createdAt: new Date()\n      });\n    } else {\n      objectives.push({\n        id: crypto.randomUUID(),\n        description: 'Use advanced vocabulary in complex sentences and discussions',\n        isCompleted: false,\n        createdAt: new Date()\n      });\n    }\n\n    return objectives;\n  }\n\n  /**\n   * Generate tags for a lesson\n   */\n  private generateLessonTags(\n    vocabularyItems: VocabularyItem[],\n    difficulty: LessonDifficulty,\n    type: LessonType\n  ): string[] {\n    const tags: string[] = [type, difficulty];\n\n    // Add categories as tags\n    const categories = new Set<VocabularyCategory>();\n    vocabularyItems.forEach(item => {\n      this.normalizeCategories(item.categories).forEach(category => categories.add(category));\n    });\n\n    // Add up to 3 categories as tags\n    Array.from(categories).slice(0, 3).forEach(category => {\n      tags.push(this.getCategoryDisplayName(category));\n    });\n\n    return tags;\n  }\n\n  /**\n   * Get display name for a vocabulary category\n   */\n  public getCategoryDisplayName(category: VocabularyCategory): string {\n    const displayNames: Record<VocabularyCategory, string> = {\n      'greetings': 'Greetings',\n      'numbers': 'Numbers',\n      'family': 'Family',\n      'food': 'Food',\n      'colors': 'Colors',\n      'animals': 'Animals',\n      'body-parts': 'Body Parts',\n      'clothing': 'Clothing',\n      'home': 'House & Home',\n      'nature': 'Nature',\n      'transport': 'Transportation',\n      'technology': 'Technology',\n      'time': 'Time & Date',\n      'weather': 'Weather',\n      'professions': 'Professions',\n      'places': 'Places',\n      'grammar': 'Grammar',\n      'culture': 'Culture',\n      'everyday-phrases': 'Everyday Phrases'\n    };\n\n    return displayNames[category] || category;\n  }\n\n  /**\n   * Get display name for part of speech\n   */\n  private getPartOfSpeechDisplayName(partOfSpeech: PartOfSpeech): string {\n    const displayNames: Record<PartOfSpeech, string> = {\n      'noun': 'Nouns',\n      'verb': 'Verbs',\n      'adjective': 'Adjectives',\n      'adverb': 'Adverbs',\n      'pronoun': 'Pronouns',\n      'preposition': 'Prepositions',\n      'conjunction': 'Conjunctions',\n      'interjection': 'Interjections',\n      'article': 'Articles',\n      'number': 'Numbers',\n      'phrase': 'Phrases',\n      'expression': 'Expressions'\n    };\n\n    return displayNames[partOfSpeech] || partOfSpeech;\n  }\n\n  /**\n   * Coerce category strings into the schema-backed category union\n   */\n  private normalizeCategories(categories?: VocabularyCategory[] | string[]): VocabularyCategory[] {\n    const allowed: VocabularyCategory[] = [\n      'greetings',\n      'numbers',\n      'family',\n      'food',\n      'colors',\n      'animals',\n      'body-parts',\n      'clothing',\n      'home',\n      'nature',\n      'transport',\n      'technology',\n      'time',\n      'weather',\n      'professions',\n      'places',\n      'grammar',\n      'culture',\n      'everyday-phrases'\n    ];\n\n    if (!categories || categories.length === 0) {\n      return ['culture'];\n    }\n\n    const normalized = categories\n      .map(category => (allowed.includes(category as VocabularyCategory) ? (category as VocabularyCategory) : 'culture'))\n      .filter(Boolean) as VocabularyCategory[];\n\n    return normalized.length > 0 ? normalized : ['culture'];\n  }\n\n  /**\n   * Align vocabulary items with LessonSchema requirements\n   */\n  private normalizeVocabularyItem(item: VocabularyItem): VocabularyItem {\n    return {\n      ...item,\n      categories: this.normalizeCategories(item.categories),\n      metadata: (item.metadata ?? {}) as any,\n      isCommon: item.isCommon ?? false,\n      isVerified: item.isVerified ?? false,\n      learningPhase: item.learningPhase ?? 0,\n      createdAt: item.createdAt ?? new Date(),\n      updatedAt: item.updatedAt ?? new Date(),\n      cefrLevel: item.cefrLevel ?? 'A1'\n    };\n  }\n\n  /**\n   * Determine lesson difficulty based on vocabulary items\n   */\n  private determineLessonDifficulty(vocabularyItems: VocabularyItem[]): LessonDifficulty {\n    if (vocabularyItems.length === 0) return 'A1';\n\n    const totalDifficulty = vocabularyItems.reduce((sum, item) => sum + item.difficulty, 0);\n    const avgDifficulty = totalDifficulty / vocabularyItems.length;\n\n    if (avgDifficulty <= 1.5) return 'A1';\n    if (avgDifficulty <= 2.5) return 'A2';\n    if (avgDifficulty <= 3.5) return 'B1';\n    if (avgDifficulty <= 4.5) return 'B2';\n    return 'C1';\n  }\n\n  /**\n   * Validate a lesson against the schema\n   */\n  private validateLesson(lesson: Lesson): Lesson {\n    const result = LessonSchema.safeParse(lesson);\n    if (result.success) {\n      return result.data;\n    } else {\n      // Lesson validation failed\n      return this.createFallbackLesson('Lesson validation failed');\n    }\n  }\n\n  /**\n   * Create a fallback lesson when validation or generation fails\n   */\n  private createFallbackLesson(_errorMessage: string): Lesson {\n    // Creating fallback lesson\n\n    return {\n      id: `fallback-${Date.now()}-${crypto.randomUUID()}`,\n      title: 'Lesson Unavailable',\n      description: 'This lesson could not be generated. Please try again later.',\n      difficulty: 'A1',\n      type: 'vocabulary',\n      duration: 15,\n      vocabulary: [],\n      objectives: [\n        {\n          id: crypto.randomUUID(),\n          description: 'Lesson generation failed - please try again',\n          isCompleted: false,\n          createdAt: new Date()\n        }\n      ],\n      isCompleted: false,\n      completionPercentage: 0,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      metadata: {\n        tags: ['error'],\n        prerequisites: [],\n        relatedLessons: [],\n        isPremium: false\n      }\n    };\n  }\n\n  /**\n   * Get all lessons\n   */\n  getLessons(): Lesson[] {\n    return this.lessons;\n  }\n\n  /**\n   * Get a specific lesson by ID\n   */\n  getLessonById(id: string): Lesson | undefined {\n    return this.lessons.find(lesson => lesson.id === id);\n  }\n\n  /**\n   * Add a lesson to the collection\n   */\n  addLesson(lesson: Lesson): void {\n    const validatedLesson = this.validateLesson(lesson);\n    this.lessons.push(validatedLesson);\n  }\n\n  /**\n   * Update a lesson\n   */\n  updateLesson(id: string, updates: Partial<Lesson>): Lesson | undefined {\n    const index = this.lessons.findIndex(lesson => lesson.id === id);\n    if (index === -1) return undefined;\n\n    const currentLesson = this.lessons[index];\n    const baseLesson = {\n      ...currentLesson,\n      ...updates,\n      updatedAt: new Date()\n    };\n\n    const updatedLesson = {\n      ...baseLesson,\n      id: baseLesson.id ?? `lesson_${Date.now()}`,\n      title: baseLesson.title ?? 'Untitled',\n      description: baseLesson.description ?? '',\n      difficulty: (baseLesson.difficulty ?? 'A1') as 'A1' | 'A2' | 'B1' | 'B2' | 'C1',\n      type: (baseLesson.type ?? 'vocabulary') as LessonType,\n      vocabulary: baseLesson.vocabulary ?? [],\n      duration: baseLesson.duration ?? 0,\n      objectives: baseLesson.objectives ?? [],\n      isCompleted: baseLesson.isCompleted ?? false,\n      completionPercentage: baseLesson.completionPercentage ?? 0\n    };\n\n    const validatedLesson = this.validateLesson(updatedLesson as Lesson);\n    this.lessons[index] = validatedLesson;\n    return validatedLesson;\n  }\n\n  /**\n   * Remove a lesson\n   */\n  removeLesson(id: string): boolean {\n    const initialLength = this.lessons.length;\n    this.lessons = this.lessons.filter(lesson => lesson.id !== id);\n    return this.lessons.length !== initialLength;\n  }\n\n  /**\n   * Get lessons by difficulty level\n   */\n  getLessonsByDifficulty(difficulty: LessonDifficulty): Lesson[] {\n    return this.lessons.filter(lesson => lesson.difficulty === difficulty);\n  }\n\n  /**\n   * Get lessons by type\n   */\n  getLessonsByType(type: LessonType): Lesson[] {\n    return this.lessons.filter(lesson => lesson.type === type);\n  }\n\n  /**\n   * Get lessons by tag\n   */\n  getLessonsByTag(tag: string): Lesson[] {\n    return this.lessons.filter(lesson =>\n      lesson.metadata.tags.includes(tag)\n    );\n  }\n\n  /**\n   * Get random lessons for recommendation\n   */\n  getRandomLessons(count: number = 3): Lesson[] {\n    if (this.lessons.length === 0) return [];\n\n    // Shuffle array and take first N items\n    const shuffled = [...this.lessons].sort(() => 0.5 - Math.random());\n    return shuffled.slice(0, Math.min(count, this.lessons.length));\n  }\n}\n\n// Export a singleton instance\nexport const lessonService = new LessonService();","/**\n * EnhancedLessonService - Extends the base LessonService to support dynamic lesson generation\n * while maintaining backward compatibility with existing functionality.\n *\n * This service integrates with the LessonGenerationEngine to provide dynamic lesson creation\n * based on templates, vocabulary, grammar concepts, and cultural context.\n */\nimport { lessonService } from './lesson';\nimport { lessonGenerationEngine } from './lesson-generation/lesson-generator';\nimport type { LessonGenerationParams, GeneratedLesson, EnhancedLessonCriteria } from './lesson-generation/types';\nimport { isLessonDifficulty, isLessonType } from './lesson-generation/types';\nimport type { Lesson, LearningObjective, LessonType, LessonDifficulty } from '../schemas/lesson';\nimport type { VocabularyItem, VocabularyCategory } from '../types/vocabulary';\nimport { v4 as uuidv4 } from 'uuid';\n\nclass EnhancedLessonService {\n  private initialized = false;\n\n  /**\n   * Initialize the service\n   */\n  async initialize(): Promise<void> {\n    await lessonService.initialize();\n    this.initialized = true;\n  }\n\n  /**\n   * Check if the service is initialized\n   */\n  isInitialized(): boolean {\n    return this.initialized;\n  }\n\n  /**\n   * Generate a dynamic lesson based on the provided parameters\n   * @param params Lesson generation parameters\n   * @returns Generated lesson in standard Lesson format\n   */\n  async generateDynamicLesson(params: LessonGenerationParams): Promise<Lesson> {\n    try {\n      // Validate parameters\n      const validatedParams = this.validateLessonGenerationParams(params);\n\n      // Generate the lesson using the LessonGenerationEngine\n      const generatedLesson = await lessonGenerationEngine.generateLesson(validatedParams);\n\n      // Convert the generated lesson to the standard Lesson format\n      return this.convertGeneratedLessonToLesson(generatedLesson);\n    } catch (_error) {\n      // Error handling is done by returning a fallback lesson\n      return this.createFallbackLesson(params.type || 'vocabulary', params.difficulty || 'A1');\n    }\n  }\n\n  /**\n   * Generate a thematic lesson focused on specific vocabulary categories\n   * @param categories Array of vocabulary categories\n   * @param difficulty Lesson difficulty level\n   * @param options Additional options for lesson generation\n   * @returns Generated lesson in standard Lesson format\n   */\n  async generateThematicLesson(categories: VocabularyCategory[], difficulty: string, options?: { includePractice?: boolean; includeReview?: boolean }): Promise<Lesson> {\n    const validatedDifficulty = isLessonDifficulty(difficulty) ? difficulty : 'A1';\n    const params: LessonGenerationParams = {\n      userId: 'default',\n      type: 'vocabulary',\n      difficulty: validatedDifficulty,\n      criteria: { categories },\n      metadata: {\n        includePractice: options?.includePractice ?? true,\n        includeReview: options?.includeReview ?? false\n      }\n    };\n\n    return this.generateDynamicLesson(params);\n  }\n\n  /**\n   * Generate a grammar lesson focused on a specific grammar concept\n   * @param conceptType Grammar concept type\n   * @param difficulty Lesson difficulty level\n   * @param options Additional options for lesson generation\n   * @returns Generated lesson in standard Lesson format\n   */\n  async generateGrammarLesson(conceptType: string, difficulty: string, options?: { includePractice?: boolean; includeComparison?: boolean }): Promise<Lesson> {\n    const validatedDifficulty = isLessonDifficulty(difficulty) ? difficulty : 'A1';\n    const params: LessonGenerationParams = {\n      userId: 'default',\n      type: 'grammar',\n      difficulty: validatedDifficulty,\n      criteria: { conceptType },\n      metadata: {\n        includePractice: options?.includePractice ?? true,\n        includeComparison: options?.includeComparison ?? false\n      }\n    };\n\n    return this.generateDynamicLesson(params);\n  }\n\n  /**\n   * Generate a mixed lesson combining vocabulary and grammar\n   * @param category Vocabulary category\n   * @param difficulty Lesson difficulty level\n   * @param options Additional options for lesson generation\n   * @returns Generated lesson in standard Lesson format\n   */\n  async generateMixedLesson(category: VocabularyCategory, difficulty: string, options?: { includePractice?: boolean; includeReview?: boolean }): Promise<Lesson> {\n    const validatedDifficulty = isLessonDifficulty(difficulty) ? difficulty : 'A1';\n    const params: LessonGenerationParams = {\n      userId: 'default',\n      type: 'mixed',\n      difficulty: validatedDifficulty,\n      criteria: { categories: [category] },\n      metadata: {\n        includePractice: options?.includePractice ?? true,\n        includeReview: options?.includeReview ?? false\n      }\n    };\n\n    return this.generateDynamicLesson(params);\n  }\n\n  /**\n   * Validate lesson generation parameters and provide defaults for invalid values\n   * @param params Lesson generation parameters\n   * @returns Validated parameters with defaults applied\n   */\n  private validateLessonGenerationParams(params: LessonGenerationParams): LessonGenerationParams {\n    // Default values\n    const defaults = {\n      userId: 'default',\n      type: 'vocabulary' as const,\n      difficulty: 'A1' as const,\n      criteria: {},\n      metadata: {}\n    };\n\n    // Validate and apply defaults\n    const validatedParams: LessonGenerationParams = {\n      userId: params.userId || defaults.userId,\n      type: (['vocabulary', 'grammar', 'mixed', 'culture', 'contextual'] as const).includes(params.type as any) ? params.type : defaults.type,\n      difficulty: (['A1', 'A2', 'B1', 'B2', 'C1'] as const).includes(params.difficulty as any) ? params.difficulty : defaults.difficulty,\n      criteria: params.criteria || defaults.criteria,\n      metadata: params.metadata || defaults.metadata\n    };\n\n    return validatedParams;\n  }\n\n  /**\n   * Convert a GeneratedLesson to the standard Lesson format\n   * @param generatedLesson The lesson generated by the LessonGenerationEngine\n   * @returns Lesson in standard format\n   */\n  private convertGeneratedLessonToLesson(generatedLesson: GeneratedLesson): Lesson {\n    // Converting generated lesson to standard format\n\n    // Note: Lesson schema does NOT have sections field\n    // Convert sections to content string instead\n    const sectionContent = generatedLesson.sections\n      .map(section => `## ${section.title || section.type}\\n${section.content || ''}`)\n      .join('\\n\\n');\n\n    // Convert learning objectives\n    const objectives: LearningObjective[] = generatedLesson.learningObjectives.map(objective => ({\n      id: uuidv4(),\n      description: objective,\n      isCompleted: false,\n      createdAt: new Date()\n    }));\n\n    // Calculate duration (5 minutes per section + 5 minutes buffer)\n    const duration = generatedLesson.sections.length * 5 + 5;\n\n    // Generate tags\n    const tags = this.generateLessonTags(generatedLesson);\n\n    // Create the lesson object\n    const lesson: Lesson = {\n      id: generatedLesson.id,\n      title: generatedLesson.title,\n      description: this.generateLessonDescription(generatedLesson),\n      difficulty: this.normalizeDifficulty(generatedLesson.difficulty),\n      type: this.normalizeLessonType(generatedLesson.type),\n      duration,\n      vocabulary: this.normalizeVocabulary(generatedLesson.vocabulary || []),\n      objectives,\n      content: sectionContent || this.generateLessonDescription(generatedLesson),\n      isCompleted: false,\n      completionPercentage: 0,\n      createdAt: generatedLesson.createdAt || new Date(),\n      updatedAt: generatedLesson.updatedAt || new Date(),\n      metadata: {\n        tags,\n        prerequisites: [],\n        relatedLessons: [],\n        isPremium: false,\n        ...generatedLesson.metadata\n      }\n    };\n\n    // Lesson object created successfully\n    return lesson;\n  }\n\n  /**\n   * Generate appropriate tags for the lesson\n   * @param generatedLesson The generated lesson\n   * @returns Array of tags\n   */\n  private generateLessonTags(generatedLesson: GeneratedLesson): string[] {\n    const tags: string[] = [];\n\n    // Add basic type and difficulty tags\n    tags.push(generatedLesson.type);\n    tags.push(generatedLesson.difficulty);\n\n    // Add grammar concept names if available\n    if (generatedLesson.grammarConcepts && generatedLesson.grammarConcepts.length > 0) {\n      generatedLesson.grammarConcepts.forEach(concept => {\n        if (concept.name?.german) {\n          tags.push(concept.name.german);\n        }\n      });\n    }\n\n    // Add vocabulary categories if available\n    if (generatedLesson.vocabulary && generatedLesson.vocabulary.length > 0) {\n      const categories = new Set<string>();\n      generatedLesson.vocabulary.forEach(vocab => {\n        if (vocab.categories) {\n          vocab.categories.forEach(category => {\n            // Add both display name and raw category name\n            const displayName = lessonService.getCategoryDisplayName(category);\n            categories.add(displayName);\n            categories.add(category); // Add raw category name as well\n          });\n        }\n      });\n      tags.push(...Array.from(categories));\n    }\n\n    return tags;\n  }\n\n  /**\n   * Generate a meaningful description for the lesson\n   * @param generatedLesson The generated lesson\n   * @returns Lesson description\n   */\n  private generateLessonDescription(generatedLesson: GeneratedLesson): string {\n    const difficultyMap: Record<string, string> = {\n      'A1': 'beginner',\n      'A2': 'elementary',\n      'B1': 'intermediate',\n      'B2': 'upper intermediate',\n      'C1': 'advanced'\n    };\n\n    const typeMap: Record<string, string> = {\n      'vocabulary': 'vocabulary building',\n      'grammar': 'grammar concepts',\n      'mixed': 'various language skills',\n      'contextual': 'contextual learning'\n    };\n\n    const difficultyLevel = difficultyMap[generatedLesson.difficulty] || 'beginner';\n    const focusArea = typeMap[generatedLesson.type] || 'language learning';\n\n    // Count vocabulary items\n    const vocabCount = generatedLesson.vocabulary?.length || 0;\n\n    // List grammar concepts\n    let grammarConceptsText = '';\n    if (generatedLesson.grammarConcepts && generatedLesson.grammarConcepts.length > 0) {\n      const conceptNames = generatedLesson.grammarConcepts\n        .map(concept => concept.name?.german || concept.id)\n        .join(', ');\n      grammarConceptsText = `. It covers grammar concepts including ${conceptNames}.`;\n    }\n\n    return `This ${difficultyLevel} level lesson focuses on ${focusArea} with ${vocabCount} vocabulary items${grammarConceptsText}`;\n  }\n\n  private normalizeLessonType(type: LessonType | 'contextual' | undefined): LessonType {\n    if (type === 'vocabulary' || type === 'grammar' || type === 'conversation' || type === 'reading' || type === 'listening' || type === 'writing' || type === 'culture' || type === 'mixed') {\n      return type;\n    }\n    return 'mixed';\n  }\n\n  private normalizeDifficulty(difficulty: LessonDifficulty | undefined): LessonDifficulty {\n    if (difficulty === 'A1' || difficulty === 'A2' || difficulty === 'B1' || difficulty === 'B2' || difficulty === 'C1') {\n      return difficulty;\n    }\n    return 'A1';\n  }\n\n  private normalizeVocabulary(items: VocabularyItem[]): VocabularyItem[] {\n    return items.map(item => ({\n      ...item,\n      isCommon: item.isCommon ?? false,\n      isVerified: item.isVerified ?? false,\n      learningPhase: item.learningPhase ?? 0,\n      categories: item.categories ?? [],\n      metadata: (item.metadata ?? {}) as any\n    }));\n  }\n\n  /**\n   * Create a fallback lesson when generation fails\n   * @param type Lesson type\n   * @param difficulty Lesson difficulty\n   * @returns Fallback lesson\n   */\n  private createFallbackLesson(type: string, difficulty: string): Lesson {\n    return {\n      id: `fallback-lesson-${uuidv4()}`,\n      title: 'Lesson Unavailable',\n      description: 'Dynamic lesson generation failed. Please try again or select a different lesson.',\n      difficulty: isLessonDifficulty(difficulty) ? difficulty : 'A1',\n      type: isLessonType(type) ? type : 'vocabulary',\n      duration: 10,\n      vocabulary: [],\n      objectives: [],\n      isCompleted: false,\n      completionPercentage: 0,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      metadata: {\n        tags: [type, difficulty],\n        prerequisites: [],\n        relatedLessons: [],\n        isPremium: false\n      }\n    };\n  }\n\n  // Proxy methods for backward compatibility with existing LessonService\n  getLessons() {\n    return lessonService.getLessons() || [];\n  }\n\n  getLessonById(id: string) {\n    return lessonService.getLessonById(id);\n  }\n\n  generateLessonFromVocabulary(vocabularyItems: VocabularyItem[]) {\n    return lessonService.generateLessonFromVocabulary(vocabularyItems);\n  }\n\n  async generateLessonFromCriteria(criteria: EnhancedLessonCriteria) {\n    const normalizedCriteria = {\n      ...criteria,\n      type: criteria.type ? this.normalizeLessonType(criteria.type) : undefined,\n      difficulty: criteria.difficulty ? this.normalizeDifficulty(criteria.difficulty as LessonDifficulty) : undefined,\n      categories: criteria.categories as VocabularyCategory[] | undefined\n    };\n\n    const result = await lessonService.generateLessonFromCriteria(normalizedCriteria as any);\n    return result || this.createFallbackLesson('vocabulary', 'A1');\n  }\n\n  getLessonsByDifficulty(difficulty: string) {\n    if (isLessonDifficulty(difficulty)) {\n      return lessonService.getLessonsByDifficulty(difficulty) || [];\n    }\n    return [];\n  }\n\n  getLessonsByType(type: string) {\n    if (isLessonType(type)) {\n      return lessonService.getLessonsByType(type) || [];\n    }\n    return [];\n  }\n\n  getLessonsByTag(tag: string) {\n    return lessonService.getLessonsByTag(tag) || [];\n  }\n\n  getRandomLessons(count: number) {\n    return lessonService.getRandomLessons(count) || [];\n  }\n\n  addLesson(lesson: Lesson) {\n    return lessonService.addLesson(lesson);\n  }\n\n  updateLesson(id: string, updates: Partial<Lesson>) {\n    return lessonService.updateLesson(id, updates);\n  }\n\n  removeLesson(id: string) {\n    return lessonService.removeLesson(id);\n  }\n}\n\n// Export a singleton instance\nexport const enhancedLessonService = new EnhancedLessonService();","export function isFunction(value) {\n    return typeof value === \"function\";\n}\nexport function isObject(value) {\n    return value !== null && typeof value === \"object\";\n}\nconst CLASS_VALUE_PRIMITIVE_TYPES = [\"string\", \"number\", \"bigint\", \"boolean\"];\nexport function isClassValue(value) {\n    // handle primitive types\n    if (value === null || value === undefined)\n        return true;\n    if (CLASS_VALUE_PRIMITIVE_TYPES.includes(typeof value))\n        return true;\n    // handle arrays (ClassArray)\n    if (Array.isArray(value))\n        return value.every((item) => isClassValue(item));\n    // handle objects (ClassDictionary)\n    if (typeof value === \"object\") {\n        // ensure it's a plain object and not some other object type\n        if (Object.getPrototypeOf(value) !== Object.prototype)\n            return false;\n        return true;\n    }\n    return false;\n}\n","import { isFunction, isObject } from \"../utils/is.js\";\nexport const BoxSymbol = Symbol(\"box\");\nexport const isWritableSymbol = Symbol(\"is-writable\");\nfunction boxWith(getter, setter) {\n    const derived = $derived.by(getter);\n    if (setter) {\n        return {\n            [BoxSymbol]: true,\n            [isWritableSymbol]: true,\n            get current() {\n                return derived;\n            },\n            set current(v) {\n                setter(v);\n            }\n        };\n    }\n    return {\n        [BoxSymbol]: true,\n        get current() {\n            return getter();\n        }\n    };\n}\n/**\n * @returns Whether the value is a Box\n *\n * @see {@link https://runed.dev/docs/functions/box}\n */\nfunction isBox(value) {\n    return isObject(value) && BoxSymbol in value;\n}\n/**\n * @returns Whether the value is a WritableBox\n *\n * @see {@link https://runed.dev/docs/functions/box}\n */\nfunction isWritableBox(value) {\n    return isBox(value) && isWritableSymbol in value;\n}\nfunction boxFrom(value) {\n    if (isBox(value))\n        return value;\n    if (isFunction(value))\n        return boxWith(value);\n    return simpleBox(value);\n}\n/**\n * Function that gets an object of boxes, and returns an object of reactive values\n *\n * @example\n * const count = box(0)\n * const flat = box.flatten({ count, double: box.with(() => count.current) })\n * // type of flat is { count: number, readonly double: number }\n *\n * @see {@link https://runed.dev/docs/functions/box}\n */\nfunction boxFlatten(boxes) {\n    return Object.entries(boxes).reduce((acc, [key, b]) => {\n        if (!isBox(b)) {\n            return Object.assign(acc, { [key]: b });\n        }\n        if (isWritableBox(b)) {\n            Object.defineProperty(acc, key, {\n                get() {\n                    return b.current;\n                },\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                set(v) {\n                    b.current = v;\n                }\n            });\n        }\n        else {\n            Object.defineProperty(acc, key, {\n                get() {\n                    return b.current;\n                }\n            });\n        }\n        return acc;\n    }, {});\n}\n/**\n * Function that converts a box to a readonly box.\n *\n * @example\n * const count = box(0) // WritableBox<number>\n * const countReadonly = box.readonly(count) // ReadableBox<number>\n *\n * @see {@link https://runed.dev/docs/functions/box}\n */\nfunction toReadonlyBox(b) {\n    if (!isWritableBox(b))\n        return b;\n    return {\n        [BoxSymbol]: true,\n        get current() {\n            return b.current;\n        }\n    };\n}\nfunction simpleBox(initialValue) {\n    let current = $state(initialValue);\n    return {\n        [BoxSymbol]: true,\n        [isWritableSymbol]: true,\n        get current() {\n            return current;\n        },\n        set current(v) {\n            current = v;\n        }\n    };\n}\nexport { boxWith, isBox, isWritableBox, boxFrom, boxFlatten, toReadonlyBox, simpleBox };\n","/**\n * Composes event handlers into a single function that can be called with an event.\n * If the previous handler cancels the event using `event.preventDefault()`, the handlers\n * that follow will not be called.\n */\nexport function composeHandlers(...handlers) {\n    return function (e) {\n        for (const handler of handlers) {\n            if (!handler)\n                continue;\n            if (e.defaultPrevented)\n                return;\n            if (typeof handler === \"function\") {\n                handler.call(this, e);\n            }\n            else {\n                handler.current?.call(this, e);\n            }\n        }\n    };\n}\n","// http://www.w3.org/TR/CSS21/grammar.html\n// https://github.com/visionmedia/css-parse/pull/49#issuecomment-30088027\nvar COMMENT_REGEX = /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//g;\n\nvar NEWLINE_REGEX = /\\n/g;\nvar WHITESPACE_REGEX = /^\\s*/;\n\n// declaration\nvar PROPERTY_REGEX = /^(\\*?[-#/*\\\\\\w]+(\\[[0-9a-z_-]+\\])?)\\s*/;\nvar COLON_REGEX = /^:\\s*/;\nvar VALUE_REGEX = /^((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^)]*?\\)|[^};])+)/;\nvar SEMICOLON_REGEX = /^[;\\s]*/;\n\n// https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String/Trim#Polyfill\nvar TRIM_REGEX = /^\\s+|\\s+$/g;\n\n// strings\nvar NEWLINE = '\\n';\nvar FORWARD_SLASH = '/';\nvar ASTERISK = '*';\nvar EMPTY_STRING = '';\n\n// types\nvar TYPE_COMMENT = 'comment';\nvar TYPE_DECLARATION = 'declaration';\n\n/**\n * @param {String} style\n * @param {Object} [options]\n * @return {Object[]}\n * @throws {TypeError}\n * @throws {Error}\n */\nfunction index (style, options) {\n  if (typeof style !== 'string') {\n    throw new TypeError('First argument must be a string');\n  }\n\n  if (!style) return [];\n\n  options = options || {};\n\n  /**\n   * Positional.\n   */\n  var lineno = 1;\n  var column = 1;\n\n  /**\n   * Update lineno and column based on `str`.\n   *\n   * @param {String} str\n   */\n  function updatePosition(str) {\n    var lines = str.match(NEWLINE_REGEX);\n    if (lines) lineno += lines.length;\n    var i = str.lastIndexOf(NEWLINE);\n    column = ~i ? str.length - i : column + str.length;\n  }\n\n  /**\n   * Mark position and patch `node.position`.\n   *\n   * @return {Function}\n   */\n  function position() {\n    var start = { line: lineno, column: column };\n    return function (node) {\n      node.position = new Position(start);\n      whitespace();\n      return node;\n    };\n  }\n\n  /**\n   * Store position information for a node.\n   *\n   * @constructor\n   * @property {Object} start\n   * @property {Object} end\n   * @property {undefined|String} source\n   */\n  function Position(start) {\n    this.start = start;\n    this.end = { line: lineno, column: column };\n    this.source = options.source;\n  }\n\n  /**\n   * Non-enumerable source string.\n   */\n  Position.prototype.content = style;\n\n  /**\n   * Error `msg`.\n   *\n   * @param {String} msg\n   * @throws {Error}\n   */\n  function error(msg) {\n    var err = new Error(\n      options.source + ':' + lineno + ':' + column + ': ' + msg\n    );\n    err.reason = msg;\n    err.filename = options.source;\n    err.line = lineno;\n    err.column = column;\n    err.source = style;\n\n    if (options.silent) ; else {\n      throw err;\n    }\n  }\n\n  /**\n   * Match `re` and return captures.\n   *\n   * @param {RegExp} re\n   * @return {undefined|Array}\n   */\n  function match(re) {\n    var m = re.exec(style);\n    if (!m) return;\n    var str = m[0];\n    updatePosition(str);\n    style = style.slice(str.length);\n    return m;\n  }\n\n  /**\n   * Parse whitespace.\n   */\n  function whitespace() {\n    match(WHITESPACE_REGEX);\n  }\n\n  /**\n   * Parse comments.\n   *\n   * @param {Object[]} [rules]\n   * @return {Object[]}\n   */\n  function comments(rules) {\n    var c;\n    rules = rules || [];\n    while ((c = comment())) {\n      if (c !== false) {\n        rules.push(c);\n      }\n    }\n    return rules;\n  }\n\n  /**\n   * Parse comment.\n   *\n   * @return {Object}\n   * @throws {Error}\n   */\n  function comment() {\n    var pos = position();\n    if (FORWARD_SLASH != style.charAt(0) || ASTERISK != style.charAt(1)) return;\n\n    var i = 2;\n    while (\n      EMPTY_STRING != style.charAt(i) &&\n      (ASTERISK != style.charAt(i) || FORWARD_SLASH != style.charAt(i + 1))\n    ) {\n      ++i;\n    }\n    i += 2;\n\n    if (EMPTY_STRING === style.charAt(i - 1)) {\n      return error('End of comment missing');\n    }\n\n    var str = style.slice(2, i - 2);\n    column += 2;\n    updatePosition(str);\n    style = style.slice(i);\n    column += 2;\n\n    return pos({\n      type: TYPE_COMMENT,\n      comment: str\n    });\n  }\n\n  /**\n   * Parse declaration.\n   *\n   * @return {Object}\n   * @throws {Error}\n   */\n  function declaration() {\n    var pos = position();\n\n    // prop\n    var prop = match(PROPERTY_REGEX);\n    if (!prop) return;\n    comment();\n\n    // :\n    if (!match(COLON_REGEX)) return error(\"property missing ':'\");\n\n    // val\n    var val = match(VALUE_REGEX);\n\n    var ret = pos({\n      type: TYPE_DECLARATION,\n      property: trim(prop[0].replace(COMMENT_REGEX, EMPTY_STRING)),\n      value: val\n        ? trim(val[0].replace(COMMENT_REGEX, EMPTY_STRING))\n        : EMPTY_STRING\n    });\n\n    // ;\n    match(SEMICOLON_REGEX);\n\n    return ret;\n  }\n\n  /**\n   * Parse declarations.\n   *\n   * @return {Object[]}\n   */\n  function declarations() {\n    var decls = [];\n\n    comments(decls);\n\n    // declarations\n    var decl;\n    while ((decl = declaration())) {\n      if (decl !== false) {\n        decls.push(decl);\n        comments(decls);\n      }\n    }\n\n    return decls;\n  }\n\n  whitespace();\n  return declarations();\n}\n\n/**\n * Trim `str`.\n *\n * @param {String} str\n * @return {String}\n */\nfunction trim(str) {\n  return str ? str.replace(TRIM_REGEX, EMPTY_STRING) : EMPTY_STRING;\n}\n\nexport { index as default };\n//# sourceMappingURL=index.mjs.map\n","import parse from 'inline-style-parser';\n\n/**\n * Parses inline style to object.\n *\n * @param style - Inline style.\n * @param iterator - Iterator.\n * @returns - Style object or null.\n *\n * @example Parsing inline style to object:\n *\n * ```js\n * import parse from 'style-to-object';\n * parse('line-height: 42;'); // { 'line-height': '42' }\n * ```\n */\nfunction StyleToObject(style, iterator) {\n    let styleObject = null;\n    if (!style || typeof style !== 'string') {\n        return styleObject;\n    }\n    const declarations = parse(style);\n    const hasIterator = typeof iterator === 'function';\n    declarations.forEach((declaration) => {\n        if (declaration.type !== 'declaration') {\n            return;\n        }\n        const { property, value } = declaration;\n        if (hasIterator) {\n            iterator(property, value, declaration);\n        }\n        else if (value) {\n            styleObject = styleObject || {};\n            styleObject[property] = value;\n        }\n    });\n    return styleObject;\n}\n\nexport { StyleToObject as default };\n//# sourceMappingURL=index.mjs.map\n","const NUMBER_CHAR_RE = /\\d/;\nconst STR_SPLITTERS = [\"-\", \"_\", \"/\", \".\"];\nfunction isUppercase(char = \"\") {\n    if (NUMBER_CHAR_RE.test(char))\n        return undefined;\n    return char !== char.toLowerCase();\n}\nfunction splitByCase(str) {\n    const parts = [];\n    let buff = \"\";\n    let previousUpper;\n    let previousSplitter;\n    for (const char of str) {\n        // Splitter\n        const isSplitter = STR_SPLITTERS.includes(char);\n        if (isSplitter === true) {\n            parts.push(buff);\n            buff = \"\";\n            previousUpper = undefined;\n            continue;\n        }\n        const isUpper = isUppercase(char);\n        if (previousSplitter === false) {\n            // Case rising edge\n            if (previousUpper === false && isUpper === true) {\n                parts.push(buff);\n                buff = char;\n                previousUpper = isUpper;\n                continue;\n            }\n            // Case falling edge\n            if (previousUpper === true && isUpper === false && buff.length > 1) {\n                const lastChar = buff.at(-1);\n                parts.push(buff.slice(0, Math.max(0, buff.length - 1)));\n                buff = lastChar + char;\n                previousUpper = isUpper;\n                continue;\n            }\n        }\n        // Normal char\n        buff += char;\n        previousUpper = isUpper;\n        previousSplitter = isSplitter;\n    }\n    parts.push(buff);\n    return parts;\n}\nexport function pascalCase(str) {\n    if (!str)\n        return \"\";\n    return splitByCase(str)\n        .map((p) => upperFirst(p))\n        .join(\"\");\n}\nexport function camelCase(str) {\n    return lowerFirst(pascalCase(str || \"\"));\n}\nexport function kebabCase(str) {\n    return str\n        ? splitByCase(str)\n            .map((p) => p.toLowerCase())\n            .join(\"-\")\n        : \"\";\n}\nfunction upperFirst(str) {\n    return str ? str[0].toUpperCase() + str.slice(1) : \"\";\n}\nfunction lowerFirst(str) {\n    return str ? str[0].toLowerCase() + str.slice(1) : \"\";\n}\n","import parse from \"style-to-object\";\nimport { camelCase, pascalCase } from \"./strings.js\";\nexport function cssToStyleObj(css) {\n    if (!css)\n        return {};\n    const styleObj = {};\n    function iterator(name, value) {\n        if (name.startsWith(\"-moz-\") ||\n            name.startsWith(\"-webkit-\") ||\n            name.startsWith(\"-ms-\") ||\n            name.startsWith(\"-o-\")) {\n            styleObj[pascalCase(name)] = value;\n            return;\n        }\n        if (name.startsWith(\"--\")) {\n            styleObj[name] = value;\n            return;\n        }\n        styleObj[camelCase(name)] = value;\n    }\n    parse(css, iterator);\n    return styleObj;\n}\n","/**\n * Executes an array of callback functions with the same arguments.\n * @template T The types of the arguments that the callback functions take.\n * @param callbacks array of callback functions to execute.\n * @returns A new function that executes all of the original callback functions with the same arguments.\n */\nexport function executeCallbacks(...callbacks) {\n    return (...args) => {\n        for (const callback of callbacks) {\n            if (typeof callback === \"function\") {\n                callback(...args);\n            }\n        }\n    };\n}\n","function createParser(matcher, replacer) {\n    const regex = RegExp(matcher, \"g\");\n    return (str) => {\n        // throw an error if not a string\n        if (typeof str !== \"string\") {\n            throw new TypeError(`expected an argument of type string, but got ${typeof str}`);\n        }\n        // if no match between string and matcher\n        if (!str.match(regex))\n            return str;\n        // executes the replacer function for each match\n        return str.replace(regex, replacer);\n    };\n}\nconst camelToKebab = createParser(/[A-Z]/, (match) => `-${match.toLowerCase()}`);\nexport function styleToCSS(styleObj) {\n    if (!styleObj || typeof styleObj !== \"object\" || Array.isArray(styleObj)) {\n        throw new TypeError(`expected an argument of type object, but got ${typeof styleObj}`);\n    }\n    return Object.keys(styleObj)\n        .map((property) => `${camelToKebab(property)}: ${styleObj[property]};`)\n        .join(\"\\n\");\n}\n","import { styleToCSS } from \"./style-to-css.js\";\nexport function styleToString(style = {}) {\n    return styleToCSS(style).replace(\"\\n\", \" \");\n}\n","const EVENT_LIST = [\n    \"onabort\",\n    \"onanimationcancel\",\n    \"onanimationend\",\n    \"onanimationiteration\",\n    \"onanimationstart\",\n    \"onauxclick\",\n    \"onbeforeinput\",\n    \"onbeforetoggle\",\n    \"onblur\",\n    \"oncancel\",\n    \"oncanplay\",\n    \"oncanplaythrough\",\n    \"onchange\",\n    \"onclick\",\n    \"onclose\",\n    \"oncompositionend\",\n    \"oncompositionstart\",\n    \"oncompositionupdate\",\n    \"oncontextlost\",\n    \"oncontextmenu\",\n    \"oncontextrestored\",\n    \"oncopy\",\n    \"oncuechange\",\n    \"oncut\",\n    \"ondblclick\",\n    \"ondrag\",\n    \"ondragend\",\n    \"ondragenter\",\n    \"ondragleave\",\n    \"ondragover\",\n    \"ondragstart\",\n    \"ondrop\",\n    \"ondurationchange\",\n    \"onemptied\",\n    \"onended\",\n    \"onerror\",\n    \"onfocus\",\n    \"onfocusin\",\n    \"onfocusout\",\n    \"onformdata\",\n    \"ongotpointercapture\",\n    \"oninput\",\n    \"oninvalid\",\n    \"onkeydown\",\n    \"onkeypress\",\n    \"onkeyup\",\n    \"onload\",\n    \"onloadeddata\",\n    \"onloadedmetadata\",\n    \"onloadstart\",\n    \"onlostpointercapture\",\n    \"onmousedown\",\n    \"onmouseenter\",\n    \"onmouseleave\",\n    \"onmousemove\",\n    \"onmouseout\",\n    \"onmouseover\",\n    \"onmouseup\",\n    \"onpaste\",\n    \"onpause\",\n    \"onplay\",\n    \"onplaying\",\n    \"onpointercancel\",\n    \"onpointerdown\",\n    \"onpointerenter\",\n    \"onpointerleave\",\n    \"onpointermove\",\n    \"onpointerout\",\n    \"onpointerover\",\n    \"onpointerup\",\n    \"onprogress\",\n    \"onratechange\",\n    \"onreset\",\n    \"onresize\",\n    \"onscroll\",\n    \"onscrollend\",\n    \"onsecuritypolicyviolation\",\n    \"onseeked\",\n    \"onseeking\",\n    \"onselect\",\n    \"onselectionchange\",\n    \"onselectstart\",\n    \"onslotchange\",\n    \"onstalled\",\n    \"onsubmit\",\n    \"onsuspend\",\n    \"ontimeupdate\",\n    \"ontoggle\",\n    \"ontouchcancel\",\n    \"ontouchend\",\n    \"ontouchmove\",\n    \"ontouchstart\",\n    \"ontransitioncancel\",\n    \"ontransitionend\",\n    \"ontransitionrun\",\n    \"ontransitionstart\",\n    \"onvolumechange\",\n    \"onwaiting\",\n    \"onwebkitanimationend\",\n    \"onwebkitanimationiteration\",\n    \"onwebkitanimationstart\",\n    \"onwebkittransitionend\",\n    \"onwheel\"\n];\nexport const EVENT_LIST_SET = new Set(EVENT_LIST);\n","/**\n * Modified from https://github.com/adobe/react-spectrum/blob/main/packages/%40react-aria/utils/src/mergeProps.ts (see NOTICE.txt for source)\n */\nimport { clsx } from \"clsx\";\nimport { composeHandlers } from \"./compose-handlers.js\";\nimport { cssToStyleObj } from \"./css-to-style-obj.js\";\nimport { isClassValue } from \"./is.js\";\nimport { executeCallbacks } from \"./execute-callbacks.js\";\nimport { styleToString } from \"./style.js\";\nimport { EVENT_LIST_SET } from \"./event-list.js\";\nfunction isEventHandler(key) {\n    return EVENT_LIST_SET.has(key);\n}\n/**\n * Given a list of prop objects, merges them into a single object.\n * - Automatically composes event handlers (e.g. `onclick`, `oninput`, etc.)\n * - Chains regular functions with the same name so they are called in order\n * - Merges class strings with `clsx`\n * - Merges style objects and converts them to strings\n * - Handles a bug with Svelte where setting the `hidden` attribute to `false` doesn't remove it\n * - Overrides other values with the last one\n */\nexport function mergeProps(...args) {\n    const result = { ...args[0] };\n    for (let i = 1; i < args.length; i++) {\n        const props = args[i];\n        if (!props)\n            continue;\n        // Handle string keys\n        for (const key of Object.keys(props)) {\n            const a = result[key];\n            const b = props[key];\n            const aIsFunction = typeof a === \"function\";\n            const bIsFunction = typeof b === \"function\";\n            // compose event handlers\n            if (aIsFunction && typeof bIsFunction && isEventHandler(key)) {\n                // handle merging of event handlers\n                const aHandler = a;\n                const bHandler = b;\n                result[key] = composeHandlers(aHandler, bHandler);\n            }\n            else if (aIsFunction && bIsFunction) {\n                // chain non-event handler functions\n                result[key] = executeCallbacks(a, b);\n            }\n            else if (key === \"class\") {\n                // handle merging acceptable class values from clsx\n                const aIsClassValue = isClassValue(a);\n                const bIsClassValue = isClassValue(b);\n                if (aIsClassValue && bIsClassValue) {\n                    result[key] = clsx(a, b);\n                }\n                else if (aIsClassValue) {\n                    result[key] = clsx(a);\n                }\n                else if (bIsClassValue) {\n                    result[key] = clsx(b);\n                }\n            }\n            else if (key === \"style\") {\n                const aIsObject = typeof a === \"object\";\n                const bIsObject = typeof b === \"object\";\n                const aIsString = typeof a === \"string\";\n                const bIsString = typeof b === \"string\";\n                if (aIsObject && bIsObject) {\n                    // both are style objects, merge them\n                    result[key] = { ...a, ...b };\n                }\n                else if (aIsObject && bIsString) {\n                    // a is style object, b is string, convert b to style object and merge\n                    const parsedStyle = cssToStyleObj(b);\n                    result[key] = { ...a, ...parsedStyle };\n                }\n                else if (aIsString && bIsObject) {\n                    // a is string, b is style object, convert a to style object and merge\n                    const parsedStyle = cssToStyleObj(a);\n                    result[key] = { ...parsedStyle, ...b };\n                }\n                else if (aIsString && bIsString) {\n                    // both are strings, convert both to objects and merge\n                    const parsedStyleA = cssToStyleObj(a);\n                    const parsedStyleB = cssToStyleObj(b);\n                    result[key] = { ...parsedStyleA, ...parsedStyleB };\n                }\n                else if (aIsObject) {\n                    result[key] = a;\n                }\n                else if (bIsObject) {\n                    result[key] = b;\n                }\n                else if (aIsString) {\n                    result[key] = a;\n                }\n                else if (bIsString) {\n                    result[key] = b;\n                }\n            }\n            else {\n                // override other values\n                result[key] = b !== undefined ? b : a;\n            }\n        }\n        // handle symbol keys (mostly for `Attachments`)\n        for (const key of Object.getOwnPropertySymbols(props)) {\n            const a = result[key];\n            const b = props[key];\n            // for matching symbols, we just override\n            result[key] = b !== undefined ? b : a;\n        }\n    }\n    // convert style object to string\n    if (typeof result.style === \"object\") {\n        result.style = styleToString(result.style).replaceAll(\"\\n\", \" \");\n    }\n    // handle weird svelte bug where `hidden` is not removed when set to `false`\n    if (result.hidden === false) {\n        result.hidden = undefined;\n        delete result.hidden;\n    }\n    // handle weird svelte bug where `disabled` is not removed when set to `false`\n    if (result.disabled === false) {\n        result.disabled = undefined;\n        delete result.disabled;\n    }\n    return result;\n}\n","import { BROWSER } from \"esm-env\";\nexport const defaultWindow = BROWSER && typeof window !== \"undefined\" ? window : undefined;\nexport const defaultDocument = BROWSER && typeof window !== \"undefined\" ? window.document : undefined;\nexport const defaultNavigator = BROWSER && typeof window !== \"undefined\" ? window.navigator : undefined;\nexport const defaultLocation = BROWSER && typeof window !== \"undefined\" ? window.location : undefined;\n","import { defaultWindow, } from \"../../internal/configurable-globals.js\";\nimport { getActiveElement } from \"../../internal/utils/dom.js\";\nimport { on } from \"svelte/events\";\nimport { createSubscriber } from \"svelte/reactivity\";\nexport class ActiveElement {\n    #document;\n    #subscribe;\n    constructor(options = {}) {\n        const { window = defaultWindow, document = window?.document } = options;\n        if (window === undefined)\n            return;\n        this.#document = document;\n        this.#subscribe = createSubscriber((update) => {\n            const cleanupFocusIn = on(window, \"focusin\", update);\n            const cleanupFocusOut = on(window, \"focusout\", update);\n            return () => {\n                cleanupFocusIn();\n                cleanupFocusOut();\n            };\n        });\n    }\n    get current() {\n        this.#subscribe?.();\n        if (!this.#document)\n            return null;\n        return getActiveElement(this.#document);\n    }\n}\n/**\n * An object holding a reactive value that is equal to `document.activeElement`.\n * It automatically listens for changes, keeping the reference up to date.\n *\n * If you wish to use a custom document or shadowRoot, you should use\n * [useActiveElement](https://runed.dev/docs/utilities/active-element) instead.\n *\n * @see {@link https://runed.dev/docs/utilities/active-element}\n */\nexport const activeElement = new ActiveElement();\n","import { defaultDocument } from \"../configurable-globals.js\";\n/**\n * Handles getting the active element in a document or shadow root.\n * If the active element is within a shadow root, it will traverse the shadow root\n * to find the active element.\n * If not, it will return the active element in the document.\n *\n * @param document A document or shadow root to get the active element from.\n * @returns The active element in the document or shadow root.\n */\nexport function getActiveElement(document) {\n    let activeElement = document.activeElement;\n    while (activeElement?.shadowRoot) {\n        const node = activeElement.shadowRoot.activeElement;\n        if (node === activeElement)\n            break;\n        else\n            activeElement = node;\n    }\n    return activeElement;\n}\n/**\n * Returns the owner document of a given element.\n *\n * @param node The element to get the owner document from.\n * @returns\n */\nexport function getOwnerDocument(node, fallback = defaultDocument) {\n    return node?.ownerDocument ?? fallback;\n}\n/**\n * Checks if an element is or is contained by another element.\n *\n * @param node The element to check if it or its descendants contain the target element.\n * @param target The element to check if it is contained by the node.\n * @returns\n */\nexport function isOrContainsTarget(node, target) {\n    return node === target || node.contains(target);\n}\n","import { getContext, hasContext, setContext } from \"svelte\";\nexport class Context {\n    #name;\n    #key;\n    /**\n     * @param name The name of the context.\n     * This is used for generating the context key and error messages.\n     */\n    constructor(name) {\n        this.#name = name;\n        this.#key = Symbol(name);\n    }\n    /**\n     * The key used to get and set the context.\n     *\n     * It is not recommended to use this value directly.\n     * Instead, use the methods provided by this class.\n     */\n    get key() {\n        return this.#key;\n    }\n    /**\n     * Checks whether this has been set in the context of a parent component.\n     *\n     * Must be called during component initialisation.\n     */\n    exists() {\n        return hasContext(this.#key);\n    }\n    /**\n     * Retrieves the context that belongs to the closest parent component.\n     *\n     * Must be called during component initialisation.\n     *\n     * @throws An error if the context does not exist.\n     */\n    get() {\n        const context = getContext(this.#key);\n        if (context === undefined) {\n            throw new Error(`Context \"${this.#name}\" not found`);\n        }\n        return context;\n    }\n    /**\n     * Retrieves the context that belongs to the closest parent component,\n     * or the given fallback value if the context does not exist.\n     *\n     * Must be called during component initialisation.\n     */\n    getOr(fallback) {\n        const context = getContext(this.#key);\n        if (context === undefined) {\n            return fallback;\n        }\n        return context;\n    }\n    /**\n     * Associates the given value with the current component and returns it.\n     *\n     * Must be called during component initialisation.\n     */\n    set(context) {\n        return setContext(this.#key, context);\n    }\n}\n","import { untrack } from \"svelte\";\nfunction runEffect(flush, effect) {\n    switch (flush) {\n        case \"post\":\n            $effect(effect);\n            break;\n        case \"pre\":\n            $effect.pre(effect);\n            break;\n    }\n}\nfunction runWatcher(sources, flush, effect, options = {}) {\n    const { lazy = false } = options;\n    // Run the effect immediately if `lazy` is `false`.\n    let active = !lazy;\n    // On the first run, if the dependencies are an array, pass an empty array\n    // to the previous value instead of `undefined` to allow destructuring.\n    //\n    // watch(() => [a, b], ([a, b], [prevA, prevB]) => { ... });\n    let previousValues = Array.isArray(sources)\n        ? []\n        : undefined;\n    runEffect(flush, () => {\n        const values = Array.isArray(sources) ? sources.map((source) => source()) : sources();\n        if (!active) {\n            active = true;\n            previousValues = values;\n            return;\n        }\n        const cleanup = untrack(() => effect(values, previousValues));\n        previousValues = values;\n        return cleanup;\n    });\n}\nfunction runWatcherOnce(sources, flush, effect) {\n    const cleanupRoot = $effect.root(() => {\n        let stop = false;\n        runWatcher(sources, flush, (values, previousValues) => {\n            if (stop) {\n                cleanupRoot();\n                return;\n            }\n            // Since `lazy` is `true`, `previousValues` is always defined.\n            const cleanup = effect(values, previousValues);\n            stop = true;\n            return cleanup;\n        }, \n        // Running the effect immediately just once makes no sense at all.\n        // That's just `onMount` with extra steps.\n        { lazy: true });\n    });\n    $effect(() => {\n        return cleanupRoot;\n    });\n}\nexport function watch(sources, effect, options) {\n    runWatcher(sources, \"post\", effect, options);\n}\nfunction watchPre(sources, effect, options) {\n    runWatcher(sources, \"pre\", effect, options);\n}\nwatch.pre = watchPre;\nexport function watchOnce(source, effect) {\n    runWatcherOnce(source, \"post\", effect);\n}\nfunction watchOncePre(source, effect) {\n    runWatcherOnce(source, \"pre\", effect);\n}\nwatchOnce.pre = watchOncePre;\n","export function onDestroyEffect(fn) {\n    $effect(() => {\n        return () => {\n            fn();\n        };\n    });\n}\n","import { tick } from \"svelte\";\nexport function afterTick(fn) {\n    tick().then(fn);\n}\n","import { isObject } from \"./is.js\";\nconst ELEMENT_NODE = 1;\nconst DOCUMENT_NODE = 9;\nconst DOCUMENT_FRAGMENT_NODE = 11;\nexport function isHTMLElement(node) {\n    return isObject(node) && node.nodeType === ELEMENT_NODE && typeof node.nodeName === \"string\";\n}\nexport function isDocument(node) {\n    return isObject(node) && node.nodeType === DOCUMENT_NODE;\n}\nexport function isWindow(node) {\n    return isObject(node) && node.constructor?.name === \"VisualViewport\";\n}\nexport function getNodeName(node) {\n    if (isHTMLElement(node))\n        return node.localName ?? \"\";\n    return \"#document\";\n}\nexport function isNode(node) {\n    return isObject(node) && node.nodeType !== undefined;\n}\nexport function isShadowRoot(node) {\n    return isNode(node) && node.nodeType === DOCUMENT_FRAGMENT_NODE && \"host\" in node;\n}\nexport function contains(parent, child) {\n    if (!parent || !child)\n        return false;\n    if (!isHTMLElement(parent) || !isHTMLElement(child))\n        return false;\n    const rootNode = child.getRootNode?.();\n    if (parent === child)\n        return true;\n    if (parent.contains(child))\n        return true;\n    if (rootNode && isShadowRoot(rootNode)) {\n        let next = child;\n        while (next) {\n            if (parent === next)\n                return true;\n            // @ts-expect-error - host is not typed\n            next = next.parentNode || next.host;\n        }\n    }\n    return false;\n}\nexport function getDocument(node) {\n    if (isDocument(node))\n        return node;\n    if (isWindow(node))\n        return node.document;\n    return node?.ownerDocument ?? document;\n}\nexport function getDocumentElement(node) {\n    return getDocument(node).documentElement;\n}\nexport function getWindow(node) {\n    if (isShadowRoot(node))\n        return getWindow(node.host);\n    if (isDocument(node))\n        return node.defaultView ?? window;\n    if (isHTMLElement(node))\n        return node.ownerDocument?.defaultView ?? window;\n    return window;\n}\nexport function getActiveElement(rootNode) {\n    let activeElement = rootNode.activeElement;\n    while (activeElement?.shadowRoot) {\n        const el = activeElement.shadowRoot.activeElement;\n        if (el === activeElement)\n            break;\n        else\n            activeElement = el;\n    }\n    return activeElement;\n}\nexport function getParentNode(node) {\n    if (getNodeName(node) === \"html\")\n        return node;\n    const result = \n    // @ts-expect-error - assignedSlot is not typed\n    node.assignedSlot ||\n        node.parentNode ||\n        (isShadowRoot(node) && node.host) ||\n        getDocumentElement(node);\n    return isShadowRoot(result) ? result.host : result;\n}\n","import { boxWith } from \"../box/box-extras.svelte.js\";\nimport { getActiveElement, getDocument } from \"./dom.js\";\nexport class DOMContext {\n    element;\n    root = $derived.by(() => {\n        if (!this.element.current)\n            return document;\n        const rootNode = this.element.current.getRootNode() ?? document;\n        return rootNode;\n    });\n    constructor(element) {\n        if (typeof element === \"function\") {\n            this.element = boxWith(element);\n        }\n        else {\n            this.element = element;\n        }\n    }\n    getDocument = () => {\n        return getDocument(this.root);\n    };\n    getWindow = () => {\n        return this.getDocument().defaultView ?? window;\n    };\n    getActiveElement = () => {\n        return getActiveElement(this.root);\n    };\n    isActiveElement = (node) => {\n        return node === this.getActiveElement();\n    };\n    getElementById(id) {\n        return this.root.getElementById(id);\n    }\n    querySelector = (selector) => {\n        if (!this.root)\n            return null;\n        return this.root.querySelector(selector);\n    };\n    querySelectorAll = (selector) => {\n        if (!this.root)\n            return [];\n        return this.root.querySelectorAll(selector);\n    };\n    setTimeout = (callback, delay) => {\n        return this.getWindow().setTimeout(callback, delay);\n    };\n    clearTimeout = (timeoutId) => {\n        return this.getWindow().clearTimeout(timeoutId);\n    };\n}\n","import { untrack } from \"svelte\";\nimport { isBox } from \"../box/box-extras.svelte.js\";\nimport { createAttachmentKey } from \"svelte/attachments\";\n/**\n * Creates a Svelte Attachment that attaches a DOM element to a ref.\n * The ref can be either a WritableBox or a callback function.\n *\n * @param ref - Either a WritableBox to store the element in, or a callback function that receives the element\n * @param onChange - Optional callback that fires when the ref changes\n * @returns An object with a spreadable attachment key that should be spread onto the element\n *\n * @example\n * // Using with WritableBox\n * const ref = box<HTMLDivElement | null>(null);\n * <div {...attachRef(ref)}>Content</div>\n *\n * @example\n * // Using with callback\n * <div {...attachRef((node) => myNode = node)}>Content</div>\n *\n * @example\n * // Using with onChange\n * <div {...attachRef(ref, (node) => console.log(node))}>Content</div>\n */\nexport function attachRef(ref, onChange) {\n    return {\n        [createAttachmentKey()]: (node) => {\n            if (isBox(ref)) {\n                ref.current = node;\n                untrack(() => onChange?.(node));\n                return () => {\n                    // we don't want to detach the node if it's still connected\n                    if (\"isConnected\" in node && node.isConnected)\n                        return;\n                    ref.current = null;\n                    onChange?.(null);\n                };\n            }\n            ref(node);\n            untrack(() => onChange?.(node));\n            return () => {\n                // we don't want to detach the node if it's still connected\n                if (\"isConnected\" in node && node.isConnected)\n                    return;\n                ref(null);\n                onChange?.(null);\n            };\n        }\n    };\n}\n","export function boolToStr(condition) {\n    return condition ? \"true\" : \"false\";\n}\nexport function boolToStrTrueOrUndef(condition) {\n    return condition ? \"true\" : undefined;\n}\nexport function boolToEmptyStrOrUndef(condition) {\n    return condition ? \"\" : undefined;\n}\nexport function boolToTrueOrUndef(condition) {\n    return condition ? true : undefined;\n}\nexport function getDataOpenClosed(condition) {\n    return condition ? \"open\" : \"closed\";\n}\nexport function getDataChecked(condition) {\n    return condition ? \"checked\" : \"unchecked\";\n}\nexport function getAriaChecked(checked, indeterminate) {\n    if (indeterminate) {\n        return \"mixed\";\n    }\n    return checked ? \"true\" : \"false\";\n}\nexport class BitsAttrs {\n    #variant;\n    #prefix;\n    attrs;\n    constructor(config) {\n        this.#variant = config.getVariant ? config.getVariant() : null;\n        this.#prefix = this.#variant ? `data-${this.#variant}-` : `data-${config.component}-`;\n        this.getAttr = this.getAttr.bind(this);\n        this.selector = this.selector.bind(this);\n        this.attrs = Object.fromEntries(config.parts.map((part) => [part, this.getAttr(part)]));\n    }\n    getAttr(part, variantOverride) {\n        if (variantOverride)\n            return `data-${variantOverride}-${part}`;\n        return `${this.#prefix}${part}`;\n    }\n    selector(part, variantOverride) {\n        return `[${this.getAttr(part, variantOverride)}]`;\n    }\n}\nexport function createBitsAttrs(config) {\n    const bitsAttrs = new BitsAttrs(config);\n    return {\n        ...bitsAttrs.attrs,\n        selector: bitsAttrs.selector,\n        getAttr: bitsAttrs.getAttr,\n    };\n}\n","export const ALT = \"Alt\";\nexport const ARROW_DOWN = \"ArrowDown\";\nexport const ARROW_LEFT = \"ArrowLeft\";\nexport const ARROW_RIGHT = \"ArrowRight\";\nexport const ARROW_UP = \"ArrowUp\";\nexport const BACKSPACE = \"Backspace\";\nexport const CAPS_LOCK = \"CapsLock\";\nexport const CONTROL = \"Control\";\nexport const DELETE = \"Delete\";\nexport const END = \"End\";\nexport const ENTER = \"Enter\";\nexport const ESCAPE = \"Escape\";\nexport const F1 = \"F1\";\nexport const F10 = \"F10\";\nexport const F11 = \"F11\";\nexport const F12 = \"F12\";\nexport const F2 = \"F2\";\nexport const F3 = \"F3\";\nexport const F4 = \"F4\";\nexport const F5 = \"F5\";\nexport const F6 = \"F6\";\nexport const F7 = \"F7\";\nexport const F8 = \"F8\";\nexport const F9 = \"F9\";\nexport const HOME = \"Home\";\nexport const META = \"Meta\";\nexport const PAGE_DOWN = \"PageDown\";\nexport const PAGE_UP = \"PageUp\";\nexport const SHIFT = \"Shift\";\nexport const SPACE = \" \";\nexport const TAB = \"Tab\";\nexport const CTRL = \"Control\";\nexport const ASTERISK = \"*\";\nexport const a = \"a\";\nexport const P = \"P\";\nexport const A = \"A\";\nexport const p = \"p\";\nexport const n = \"n\";\nexport const j = \"j\";\nexport const k = \"k\";\nexport const h = \"h\";\nexport const l = \"l\";\n","export const isBrowser = typeof document !== \"undefined\";\nexport const isIOS = getIsIOS();\nfunction getIsIOS() {\n    return (isBrowser &&\n        window?.navigator?.userAgent &&\n        (/iP(ad|hone|od)/.test(window.navigator.userAgent) ||\n            // The new iPad Pro Gen3 does not identify itself as iPad, but as Macintosh.\n            (window?.navigator?.maxTouchPoints > 2 &&\n                /iPad|Macintosh/.test(window?.navigator.userAgent))));\n}\nexport function isFunction(value) {\n    return typeof value === \"function\";\n}\nexport function isHTMLElement(element) {\n    return element instanceof HTMLElement;\n}\nexport function isElement(element) {\n    return element instanceof Element;\n}\nexport function isElementOrSVGElement(element) {\n    return element instanceof Element || element instanceof SVGElement;\n}\nexport function isNumberString(value) {\n    return !Number.isNaN(Number(value)) && !Number.isNaN(Number.parseFloat(value));\n}\nexport function isNull(value) {\n    return value === null;\n}\nexport function isTouch(e) {\n    return e.pointerType === \"touch\";\n}\nexport function isFocusVisible(element) {\n    return element.matches(\":focus-visible\");\n}\nexport function isNotNull(value) {\n    return value !== null;\n}\n/**\n * Determines if the provided object is a valid `HTMLInputElement` with\n * a `select` method available.\n */\nexport function isSelectableInput(element) {\n    return element instanceof HTMLInputElement && \"select\" in element;\n}\n/**\n * Given a node, determine if it is hidden by walking up the\n * DOM tree until we hit the `stopAt` node (exclusive), if provided)\n * otherwise we stop at the document root.\n */\nexport function isElementHidden(node, stopAt) {\n    if (getComputedStyle(node).visibility === \"hidden\")\n        return true;\n    while (node) {\n        // we stop at `upTo` (excluding it)\n        if (stopAt !== undefined && node === stopAt)\n            return false;\n        if (getComputedStyle(node).display === \"none\")\n            return true;\n        node = node.parentElement;\n    }\n    return false;\n}\n","import { afterTick, onDestroyEffect } from \"svelte-toolbelt\";\nexport class AnimationsComplete {\n    #opts;\n    #currentFrame = null;\n    constructor(opts) {\n        this.#opts = opts;\n        onDestroyEffect(() => this.#cleanup());\n    }\n    #cleanup() {\n        if (!this.#currentFrame)\n            return;\n        window.cancelAnimationFrame(this.#currentFrame);\n        this.#currentFrame = null;\n    }\n    run(fn) {\n        // if already running, cleanup and restart\n        this.#cleanup();\n        const node = this.#opts.ref.current;\n        if (!node)\n            return;\n        if (typeof node.getAnimations !== \"function\") {\n            this.#executeCallback(fn);\n            return;\n        }\n        this.#currentFrame = window.requestAnimationFrame(() => {\n            const animations = node.getAnimations();\n            if (animations.length === 0) {\n                this.#executeCallback(fn);\n                return;\n            }\n            Promise.allSettled(animations.map((animation) => animation.finished)).then(() => {\n                this.#executeCallback(fn);\n            });\n        });\n    }\n    #executeCallback(fn) {\n        const execute = () => {\n            fn();\n        };\n        if (this.#opts.afterTick) {\n            afterTick(execute);\n        }\n        else {\n            execute();\n        }\n    }\n}\n","import { watch } from \"runed\";\nimport { AnimationsComplete } from \"./animations-complete.js\";\nexport class PresenceManager {\n    #opts;\n    #enabled;\n    #afterAnimations;\n    #shouldRender = $state(false);\n    constructor(opts) {\n        this.#opts = opts;\n        this.#shouldRender = opts.open.current;\n        this.#enabled = opts.enabled ?? true;\n        this.#afterAnimations = new AnimationsComplete({\n            ref: this.#opts.ref,\n            afterTick: this.#opts.open,\n        });\n        watch(() => this.#opts.open.current, (isOpen) => {\n            if (isOpen)\n                this.#shouldRender = true;\n            if (!this.#enabled)\n                return;\n            this.#afterAnimations.run(() => {\n                if (isOpen === this.#opts.open.current) {\n                    if (!this.#opts.open.current) {\n                        this.#shouldRender = false;\n                    }\n                    this.#opts.onComplete?.();\n                }\n            });\n        });\n    }\n    get shouldRender() {\n        return this.#shouldRender;\n    }\n}\n","/**\n * A no operation function (does nothing)\n */\nexport function noop() { }\n","export function createId(prefixOrUid, uid) {\n    if (uid === undefined)\n        return `bits-${prefixOrUid}`;\n    return `bits-${prefixOrUid}-${uid}`;\n}\n","import { attachRef, boxWith, onDestroyEffect, } from \"svelte-toolbelt\";\nimport { Context, watch } from \"runed\";\nimport { createBitsAttrs, boolToStr, getDataOpenClosed, boolToEmptyStrOrUndef, } from \"../../internal/attrs.js\";\nimport { kbd } from \"../../internal/kbd.js\";\nimport { PresenceManager } from \"../../internal/presence-manager.svelte.js\";\nconst dialogAttrs = createBitsAttrs({\n    component: \"dialog\",\n    parts: [\"content\", \"trigger\", \"overlay\", \"title\", \"description\", \"close\", \"cancel\", \"action\"],\n});\nconst DialogRootContext = new Context(\"Dialog.Root | AlertDialog.Root\");\nexport class DialogRootState {\n    static create(opts) {\n        const parent = DialogRootContext.getOr(null);\n        return DialogRootContext.set(new DialogRootState(opts, parent));\n    }\n    opts;\n    triggerNode = $state(null);\n    contentNode = $state(null);\n    overlayNode = $state(null);\n    descriptionNode = $state(null);\n    contentId = $state(undefined);\n    titleId = $state(undefined);\n    triggerId = $state(undefined);\n    descriptionId = $state(undefined);\n    cancelNode = $state(null);\n    nestedOpenCount = $state(0);\n    depth;\n    parent;\n    contentPresence;\n    overlayPresence;\n    constructor(opts, parent) {\n        this.opts = opts;\n        this.parent = parent;\n        this.depth = parent ? parent.depth + 1 : 0;\n        this.handleOpen = this.handleOpen.bind(this);\n        this.handleClose = this.handleClose.bind(this);\n        this.contentPresence = new PresenceManager({\n            ref: boxWith(() => this.contentNode),\n            open: this.opts.open,\n            enabled: true,\n            onComplete: () => {\n                this.opts.onOpenChangeComplete.current(this.opts.open.current);\n            },\n        });\n        this.overlayPresence = new PresenceManager({\n            ref: boxWith(() => this.overlayNode),\n            open: this.opts.open,\n            enabled: true,\n        });\n        watch(() => this.opts.open.current, (isOpen) => {\n            if (!this.parent)\n                return;\n            if (isOpen) {\n                this.parent.incrementNested();\n            }\n            else {\n                this.parent.decrementNested();\n            }\n        }, { lazy: true });\n        onDestroyEffect(() => {\n            if (this.opts.open.current) {\n                this.parent?.decrementNested();\n            }\n        });\n    }\n    handleOpen() {\n        if (this.opts.open.current)\n            return;\n        this.opts.open.current = true;\n    }\n    handleClose() {\n        if (!this.opts.open.current)\n            return;\n        this.opts.open.current = false;\n    }\n    getBitsAttr = (part) => {\n        return dialogAttrs.getAttr(part, this.opts.variant.current);\n    };\n    incrementNested() {\n        this.nestedOpenCount++;\n        this.parent?.incrementNested();\n    }\n    decrementNested() {\n        if (this.nestedOpenCount === 0)\n            return;\n        this.nestedOpenCount--;\n        this.parent?.decrementNested();\n    }\n    sharedProps = $derived.by(() => ({\n        \"data-state\": getDataOpenClosed(this.opts.open.current),\n    }));\n}\nexport class DialogTriggerState {\n    static create(opts) {\n        return new DialogTriggerState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref, (v) => {\n            this.root.triggerNode = v;\n            this.root.triggerId = v?.id;\n        });\n        this.onclick = this.onclick.bind(this);\n        this.onkeydown = this.onkeydown.bind(this);\n    }\n    onclick(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.button > 0)\n            return;\n        this.root.handleOpen();\n    }\n    onkeydown(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.key === kbd.SPACE || e.key === kbd.ENTER) {\n            e.preventDefault();\n            this.root.handleOpen();\n        }\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        \"aria-haspopup\": \"dialog\",\n        \"aria-expanded\": boolToStr(this.root.opts.open.current),\n        \"aria-controls\": this.root.contentId,\n        [this.root.getBitsAttr(\"trigger\")]: \"\",\n        onkeydown: this.onkeydown,\n        onclick: this.onclick,\n        disabled: this.opts.disabled.current ? true : undefined,\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\nexport class DialogCloseState {\n    static create(opts) {\n        return new DialogCloseState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref);\n        this.onclick = this.onclick.bind(this);\n        this.onkeydown = this.onkeydown.bind(this);\n    }\n    onclick(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.button > 0)\n            return;\n        this.root.handleClose();\n    }\n    onkeydown(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.key === kbd.SPACE || e.key === kbd.ENTER) {\n            e.preventDefault();\n            this.root.handleClose();\n        }\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(this.opts.variant.current)]: \"\",\n        onclick: this.onclick,\n        onkeydown: this.onkeydown,\n        disabled: this.opts.disabled.current ? true : undefined,\n        tabindex: 0,\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\nexport class DialogActionState {\n    static create(opts) {\n        return new DialogActionState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"action\")]: \"\",\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\nexport class DialogTitleState {\n    static create(opts) {\n        return new DialogTitleState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.root.titleId = this.opts.id.current;\n        this.attachment = attachRef(this.opts.ref);\n        watch.pre(() => this.opts.id.current, (id) => {\n            this.root.titleId = id;\n        });\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: \"heading\",\n        \"aria-level\": this.opts.level.current,\n        [this.root.getBitsAttr(\"title\")]: \"\",\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\nexport class DialogDescriptionState {\n    static create(opts) {\n        return new DialogDescriptionState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.root.descriptionId = this.opts.id.current;\n        this.attachment = attachRef(this.opts.ref, (v) => {\n            this.root.descriptionNode = v;\n        });\n        watch.pre(() => this.opts.id.current, (id) => {\n            this.root.descriptionId = id;\n        });\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"description\")]: \"\",\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\nexport class DialogContentState {\n    static create(opts) {\n        return new DialogContentState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref, (v) => {\n            this.root.contentNode = v;\n            this.root.contentId = v?.id;\n        });\n    }\n    snippetProps = $derived.by(() => ({ open: this.root.opts.open.current }));\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: this.root.opts.variant.current === \"alert-dialog\" ? \"alertdialog\" : \"dialog\",\n        \"aria-modal\": \"true\",\n        \"aria-describedby\": this.root.descriptionId,\n        \"aria-labelledby\": this.root.titleId,\n        [this.root.getBitsAttr(\"content\")]: \"\",\n        style: {\n            pointerEvents: \"auto\",\n            outline: this.root.opts.variant.current === \"alert-dialog\" ? \"none\" : undefined,\n            \"--bits-dialog-depth\": this.root.depth,\n            \"--bits-dialog-nested-count\": this.root.nestedOpenCount,\n        },\n        tabindex: this.root.opts.variant.current === \"alert-dialog\" ? -1 : undefined,\n        \"data-nested-open\": boolToEmptyStrOrUndef(this.root.nestedOpenCount > 0),\n        \"data-nested\": boolToEmptyStrOrUndef(this.root.parent !== null),\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n    get shouldRender() {\n        return this.root.contentPresence.shouldRender;\n    }\n}\nexport class DialogOverlayState {\n    static create(opts) {\n        return new DialogOverlayState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.root.overlayNode = v));\n    }\n    snippetProps = $derived.by(() => ({ open: this.root.opts.open.current }));\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"overlay\")]: \"\",\n        style: {\n            pointerEvents: \"auto\",\n            \"--bits-dialog-depth\": this.root.depth,\n            \"--bits-dialog-nested-count\": this.root.nestedOpenCount,\n        },\n        \"data-nested-open\": boolToEmptyStrOrUndef(this.root.nestedOpenCount > 0),\n        \"data-nested\": boolToEmptyStrOrUndef(this.root.parent !== null),\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n    get shouldRender() {\n        return this.root.overlayPresence.shouldRender;\n    }\n}\nexport class AlertDialogCancelState {\n    static create(opts) {\n        return new AlertDialogCancelState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.root.cancelNode = v));\n        this.onclick = this.onclick.bind(this);\n        this.onkeydown = this.onkeydown.bind(this);\n    }\n    onclick(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.button > 0)\n            return;\n        this.root.handleClose();\n    }\n    onkeydown(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.key === kbd.SPACE || e.key === kbd.ENTER) {\n            e.preventDefault();\n            this.root.handleClose();\n        }\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"cancel\")]: \"\",\n        onclick: this.onclick,\n        onkeydown: this.onkeydown,\n        tabindex: 0,\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\n","<script lang=\"ts\">\n\timport { boxWith, mergeProps } from \"svelte-toolbelt\";\n\timport { DialogTitleState } from \"../dialog.svelte.js\";\n\timport type { DialogTitleProps } from \"../types.js\";\n\timport { createId } from \"../../../internal/create-id.js\";\n\n\tconst uid = $props.id();\n\n\tlet {\n\t\tid = createId(uid),\n\t\tref = $bindable(null),\n\t\tchild,\n\t\tchildren,\n\t\tlevel = 2,\n\t\t...restProps\n\t}: DialogTitleProps = $props();\n\n\tconst titleState = DialogTitleState.create({\n\t\tid: boxWith(() => id),\n\t\tlevel: boxWith(() => level),\n\t\tref: boxWith(\n\t\t\t() => ref,\n\t\t\t(v) => (ref = v)\n\t\t),\n\t});\n\n\tconst mergedProps = $derived(mergeProps(restProps, titleState.props));\n</script>\n\n{#if child}\n\t{@render child({ props: mergedProps })}\n{:else}\n\t<div {...mergedProps}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","/** @import { TemplateNode } from '#client' */\nimport { is_runes } from '../../context.js';\nimport { block } from '../../reactivity/effects.js';\nimport { hydrate_next, hydrating } from '../hydration.js';\nimport { BranchManager } from './branches.js';\n\n/**\n * @template V\n * @param {TemplateNode} node\n * @param {() => V} get_key\n * @param {(anchor: Node) => TemplateNode | void} render_fn\n * @returns {void}\n */\nexport function key(node, get_key, render_fn) {\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\tvar branches = new BranchManager(node);\n\n\tvar legacy = !is_runes();\n\n\tblock(() => {\n\t\tvar key = get_key();\n\n\t\t// key blocks in Svelte <5 had stupid semantics\n\t\tif (legacy && key !== null && typeof key === 'object') {\n\t\t\tkey = /** @type {V} */ ({});\n\t\t}\n\n\t\tbranches.ensure(key, render_fn);\n\t});\n}\n","<script lang=\"ts\">\n\timport type { Snippet } from \"svelte\";\n\n\tconst { children }: { children?: Snippet } = $props();\n</script>\n\n{#key children}\n\t{@render children?.()}\n{/key}\n","import { Context } from \"runed\";\nimport { boxWith } from \"svelte-toolbelt\";\nexport const BitsConfigContext = new Context(\"BitsConfig\");\n/**\n * Gets the current Bits UI configuration state from the context.\n *\n * Returns a default configuration (where all values are `undefined`) if no configuration is found.\n */\nexport function getBitsConfig() {\n    const fallback = new BitsConfigState(null, {});\n    return BitsConfigContext.getOr(fallback).opts;\n}\n/**\n * Creates and sets a new Bits UI configuration state that inherits from parent configs.\n *\n * @param opts - Configuration options for this level\n * @returns The configuration state instance\n *\n * @example\n * ```typescript\n * // In a component that wants to set a default portal target\n * const config = useBitsConfig({ defaultPortalTo: box(\"#some-element\") });\n *\n * // Child components will inherit this config and can override specific values\n * const childConfig = useBitsConfig({ someOtherProp: box(\"value\") });\n * // childConfig still has defaultPortalTo=\"#some-element\" from parent\n * ```\n */\nexport function useBitsConfig(opts) {\n    return BitsConfigContext.set(new BitsConfigState(BitsConfigContext.getOr(null), opts));\n}\n/**\n * Configuration state that inherits from parent configurations.\n *\n * @example\n * Config resolution:\n * ```\n * Level 1: { defaultPortalTo: \"#some-element\", theme: \"dark\" }\n * Level 2: { spacing: \"large\" } // inherits defaultPortalTo=\"#some-element\", theme=\"dark\"\n * Level 3: { theme: \"light\" }   // inherits defaultPortalTo=\"#some-element\", spacing=\"large\", overrides theme=\"light\"\n * ```\n */\nexport class BitsConfigState {\n    opts;\n    constructor(parent, opts) {\n        const resolveConfigOption = createConfigResolver(parent, opts);\n        this.opts = {\n            defaultPortalTo: resolveConfigOption((config) => config.defaultPortalTo),\n            defaultLocale: resolveConfigOption((config) => config.defaultLocale),\n        };\n    }\n}\n/**\n * Returns a config resolver that resolves a given config option's value.\n *\n * The resolver creates reactive boxes that resolve config option values using this priority:\n * 1. Current level's value (if defined)\n * 2. Parent level's value (if defined and current is undefined)\n * 3. `undefined` (if no value is found in either parent or child)\n *\n * @param parent - Parent configuration state (null if this is root level)\n * @param currentOpts - Current level's configuration options\n *\n * @example\n * ```typescript\n * // Given this hierarchy:\n * // Root: { defaultPortalTo: \"#some-element\" }\n * // Child: { someOtherProp: \"value\" } // no defaultPortalTo specified\n *\n * const resolveConfigOption = createConfigResolver(parent, opts);\n * const portalTo = resolveConfigOption(config => config.defaultPortalTo);\n *\n * // portalTo.current === \"#some-element\" (inherited from parent)\n * // even when child didn't specify `defaultPortalTo`\n * ```\n */\nfunction createConfigResolver(parent, currentOpts) {\n    return (getter) => {\n        const configOption = boxWith(() => {\n            // try current opts first\n            const value = getter(currentOpts)?.current;\n            if (value !== undefined)\n                return value;\n            // if no parent, return undefined\n            if (parent === null)\n                return undefined;\n            // get value from parent (which already has its own chain resolved)\n            return getter(parent.opts)?.current;\n        });\n        return configOption;\n    };\n}\n","import { boxWith } from \"svelte-toolbelt\";\nimport { getBitsConfig } from \"./bits-config.js\";\n/**\n * Creates a generic prop resolver that follows a standard priority chain:\n * 1. The getter's prop value (if defined)\n * 2. The config default value (if no getter prop value is defined)\n * 3. The fallback value (if no config value found)\n */\nfunction createPropResolver(configOption, fallback) {\n    return (getProp) => {\n        const config = getBitsConfig();\n        return boxWith(() => {\n            // 1. return the prop's value, if provided\n            const propValue = getProp();\n            if (propValue !== undefined)\n                return propValue;\n            // 2. return the resolved config option value, if available\n            const option = configOption(config).current;\n            if (option !== undefined)\n                return option;\n            // 3. return the fallback if no other value is found\n            return fallback;\n        });\n    };\n}\n/**\n * Resolves a locale value using the prop, the config default, or a fallback.\n *\n * Default value: `\"en\"`\n */\nexport const resolveLocaleProp = createPropResolver((config) => config.defaultLocale, \"en\");\n/**\n * Resolves a portal's `to` value using the prop, the config default, or a fallback.\n *\n * Default value: `\"body\"`\n */\nexport const resolvePortalToProp = createPropResolver((config) => config.defaultPortalTo, \"body\");\n","<script lang=\"ts\">\n\timport { getAllContexts, mount, unmount } from \"svelte\";\n\timport { DEV } from \"esm-env\";\n\timport { watch } from \"runed\";\n\timport PortalConsumer from \"./portal-consumer.svelte\";\n\timport type { PortalProps } from \"./types.js\";\n\timport { isBrowser } from \"../../../internal/is.js\";\n\timport { resolvePortalToProp } from \"../config/prop-resolvers.js\";\n\n\tlet { to: toProp, children, disabled }: PortalProps = $props();\n\n\tconst to = resolvePortalToProp(() => toProp);\n\tconst context = getAllContexts();\n\n\tlet target = $derived(getTarget());\n\n\tfunction getTarget() {\n\t\tif (!isBrowser || disabled) return null;\n\n\t\tlet localTarget: Element | null = null;\n\n\t\tif (typeof to.current === \"string\") {\n\t\t\tconst target = document.querySelector(to.current);\n\t\t\tif (DEV && target === null) {\n\t\t\t\tthrow new Error(`Target element \"${to.current}\" not found.`);\n\t\t\t}\n\t\t\tlocalTarget = target;\n\t\t} else {\n\t\t\tlocalTarget = to.current;\n\t\t}\n\n\t\tif (DEV && !(localTarget instanceof Element)) {\n\t\t\tconst type = localTarget === null ? \"null\" : typeof localTarget;\n\t\t\tthrow new TypeError(\n\t\t\t\t`Unknown portal target type: ${type}. Allowed types: string (query selector) or Element.`\n\t\t\t);\n\t\t}\n\n\t\treturn localTarget;\n\t}\n\n\tlet instance: ReturnType<typeof mount> | null;\n\n\tfunction unmountInstance() {\n\t\tif (instance) {\n\t\t\tunmount(instance);\n\t\t\tinstance = null;\n\t\t}\n\t}\n\n\twatch([() => target, () => disabled], ([target, disabled]) => {\n\t\tif (!target || disabled) {\n\t\t\tunmountInstance();\n\t\t\treturn;\n\t\t}\n\t\tinstance = mount(PortalConsumer, {\n\t\t\ttarget: target,\n\t\t\tprops: { children },\n\t\t\tcontext,\n\t\t});\n\n\t\treturn () => {\n\t\t\tunmountInstance();\n\t\t};\n\t});\n</script>\n\n{#if disabled}\n\t{@render children?.()}\n{/if}\n","// oxlint-disable-next-line no-explicit-any\nexport function debounce(fn, wait = 500) {\n    let timeout = null;\n    const debounced = (...args) => {\n        if (timeout !== null) {\n            clearTimeout(timeout);\n        }\n        timeout = setTimeout(() => {\n            fn(...args);\n        }, wait);\n    };\n    debounced.destroy = () => {\n        if (timeout !== null) {\n            clearTimeout(timeout);\n            timeout = null;\n        }\n    };\n    return debounced;\n}\n","export function isOrContainsTarget(node, target) {\n    return node === target || node.contains(target);\n}\nexport function getOwnerDocument(el) {\n    return el?.ownerDocument ?? document;\n}\n","/*!\n* tabbable 6.3.0\n* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE\n*/\n// NOTE: separate `:not()` selectors has broader browser support than the newer\n//  `:not([inert], [inert] *)` (Feb 2023)\n// CAREFUL: JSDom does not support `:not([inert] *)` as a selector; using it causes\n//  the entire query to fail, resulting in no nodes found, which will break a lot\n//  of things... so we have to rely on JS to identify nodes inside an inert container\nvar candidateSelectors = ['input:not([inert])', 'select:not([inert])', 'textarea:not([inert])', 'a[href]:not([inert])', 'button:not([inert])', '[tabindex]:not(slot):not([inert])', 'audio[controls]:not([inert])', 'video[controls]:not([inert])', '[contenteditable]:not([contenteditable=\"false\"]):not([inert])', 'details>summary:first-of-type:not([inert])', 'details:not([inert])'];\nvar candidateSelector = /* #__PURE__ */candidateSelectors.join(',');\nvar NoElement = typeof Element === 'undefined';\nvar matches = NoElement ? function () {} : Element.prototype.matches || Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\nvar getRootNode = !NoElement && Element.prototype.getRootNode ? function (element) {\n  var _element$getRootNode;\n  return element === null || element === void 0 ? void 0 : (_element$getRootNode = element.getRootNode) === null || _element$getRootNode === void 0 ? void 0 : _element$getRootNode.call(element);\n} : function (element) {\n  return element === null || element === void 0 ? void 0 : element.ownerDocument;\n};\n\n/**\n * Determines if a node is inert or in an inert ancestor.\n * @param {Element} [node]\n * @param {boolean} [lookUp] If true and `node` is not inert, looks up at ancestors to\n *  see if any of them are inert. If false, only `node` itself is considered.\n * @returns {boolean} True if inert itself or by way of being in an inert ancestor.\n *  False if `node` is falsy.\n */\nvar _isInert = function isInert(node, lookUp) {\n  var _node$getAttribute;\n  if (lookUp === void 0) {\n    lookUp = true;\n  }\n  // CAREFUL: JSDom does not support inert at all, so we can't use the `HTMLElement.inert`\n  //  JS API property; we have to check the attribute, which can either be empty or 'true';\n  //  if it's `null` (not specified) or 'false', it's an active element\n  var inertAtt = node === null || node === void 0 ? void 0 : (_node$getAttribute = node.getAttribute) === null || _node$getAttribute === void 0 ? void 0 : _node$getAttribute.call(node, 'inert');\n  var inert = inertAtt === '' || inertAtt === 'true';\n\n  // NOTE: this could also be handled with `node.matches('[inert], :is([inert] *)')`\n  //  if it weren't for `matches()` not being a function on shadow roots; the following\n  //  code works for any kind of node\n  // CAREFUL: JSDom does not appear to support certain selectors like `:not([inert] *)`\n  //  so it likely would not support `:is([inert] *)` either...\n  var result = inert || lookUp && node && _isInert(node.parentNode); // recursive\n\n  return result;\n};\n\n/**\n * Determines if a node's content is editable.\n * @param {Element} [node]\n * @returns True if it's content-editable; false if it's not or `node` is falsy.\n */\nvar isContentEditable = function isContentEditable(node) {\n  var _node$getAttribute2;\n  // CAREFUL: JSDom does not support the `HTMLElement.isContentEditable` API so we have\n  //  to use the attribute directly to check for this, which can either be empty or 'true';\n  //  if it's `null` (not specified) or 'false', it's a non-editable element\n  var attValue = node === null || node === void 0 ? void 0 : (_node$getAttribute2 = node.getAttribute) === null || _node$getAttribute2 === void 0 ? void 0 : _node$getAttribute2.call(node, 'contenteditable');\n  return attValue === '' || attValue === 'true';\n};\n\n/**\n * @param {Element} el container to check in\n * @param {boolean} includeContainer add container to check\n * @param {(node: Element) => boolean} filter filter candidates\n * @returns {Element[]}\n */\nvar getCandidates = function getCandidates(el, includeContainer, filter) {\n  // even if `includeContainer=false`, we still have to check it for inertness because\n  //  if it's inert, all its children are inert\n  if (_isInert(el)) {\n    return [];\n  }\n  var candidates = Array.prototype.slice.apply(el.querySelectorAll(candidateSelector));\n  if (includeContainer && matches.call(el, candidateSelector)) {\n    candidates.unshift(el);\n  }\n  candidates = candidates.filter(filter);\n  return candidates;\n};\n\n/**\n * @callback GetShadowRoot\n * @param {Element} element to check for shadow root\n * @returns {ShadowRoot|boolean} ShadowRoot if available or boolean indicating if a shadowRoot is attached but not available.\n */\n\n/**\n * @callback ShadowRootFilter\n * @param {Element} shadowHostNode the element which contains shadow content\n * @returns {boolean} true if a shadow root could potentially contain valid candidates.\n */\n\n/**\n * @typedef {Object} CandidateScope\n * @property {Element} scopeParent contains inner candidates\n * @property {Element[]} candidates list of candidates found in the scope parent\n */\n\n/**\n * @typedef {Object} IterativeOptions\n * @property {GetShadowRoot|boolean} getShadowRoot true if shadow support is enabled; falsy if not;\n *  if a function, implies shadow support is enabled and either returns the shadow root of an element\n *  or a boolean stating if it has an undisclosed shadow root\n * @property {(node: Element) => boolean} filter filter candidates\n * @property {boolean} flatten if true then result will flatten any CandidateScope into the returned list\n * @property {ShadowRootFilter} shadowRootFilter filter shadow roots;\n */\n\n/**\n * @param {Element[]} elements list of element containers to match candidates from\n * @param {boolean} includeContainer add container list to check\n * @param {IterativeOptions} options\n * @returns {Array.<Element|CandidateScope>}\n */\nvar _getCandidatesIteratively = function getCandidatesIteratively(elements, includeContainer, options) {\n  var candidates = [];\n  var elementsToCheck = Array.from(elements);\n  while (elementsToCheck.length) {\n    var element = elementsToCheck.shift();\n    if (_isInert(element, false)) {\n      // no need to look up since we're drilling down\n      // anything inside this container will also be inert\n      continue;\n    }\n    if (element.tagName === 'SLOT') {\n      // add shadow dom slot scope (slot itself cannot be focusable)\n      var assigned = element.assignedElements();\n      var content = assigned.length ? assigned : element.children;\n      var nestedCandidates = _getCandidatesIteratively(content, true, options);\n      if (options.flatten) {\n        candidates.push.apply(candidates, nestedCandidates);\n      } else {\n        candidates.push({\n          scopeParent: element,\n          candidates: nestedCandidates\n        });\n      }\n    } else {\n      // check candidate element\n      var validCandidate = matches.call(element, candidateSelector);\n      if (validCandidate && options.filter(element) && (includeContainer || !elements.includes(element))) {\n        candidates.push(element);\n      }\n\n      // iterate over shadow content if possible\n      var shadowRoot = element.shadowRoot ||\n      // check for an undisclosed shadow\n      typeof options.getShadowRoot === 'function' && options.getShadowRoot(element);\n\n      // no inert look up because we're already drilling down and checking for inertness\n      //  on the way down, so all containers to this root node should have already been\n      //  vetted as non-inert\n      var validShadowRoot = !_isInert(shadowRoot, false) && (!options.shadowRootFilter || options.shadowRootFilter(element));\n      if (shadowRoot && validShadowRoot) {\n        // add shadow dom scope IIF a shadow root node was given; otherwise, an undisclosed\n        //  shadow exists, so look at light dom children as fallback BUT create a scope for any\n        //  child candidates found because they're likely slotted elements (elements that are\n        //  children of the web component element (which has the shadow), in the light dom, but\n        //  slotted somewhere _inside_ the undisclosed shadow) -- the scope is created below,\n        //  _after_ we return from this recursive call\n        var _nestedCandidates = _getCandidatesIteratively(shadowRoot === true ? element.children : shadowRoot.children, true, options);\n        if (options.flatten) {\n          candidates.push.apply(candidates, _nestedCandidates);\n        } else {\n          candidates.push({\n            scopeParent: element,\n            candidates: _nestedCandidates\n          });\n        }\n      } else {\n        // there's not shadow so just dig into the element's (light dom) children\n        //  __without__ giving the element special scope treatment\n        elementsToCheck.unshift.apply(elementsToCheck, element.children);\n      }\n    }\n  }\n  return candidates;\n};\n\n/**\n * @private\n * Determines if the node has an explicitly specified `tabindex` attribute.\n * @param {HTMLElement} node\n * @returns {boolean} True if so; false if not.\n */\nvar hasTabIndex = function hasTabIndex(node) {\n  return !isNaN(parseInt(node.getAttribute('tabindex'), 10));\n};\n\n/**\n * Determine the tab index of a given node.\n * @param {HTMLElement} node\n * @returns {number} Tab order (negative, 0, or positive number).\n * @throws {Error} If `node` is falsy.\n */\nvar getTabIndex = function getTabIndex(node) {\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (node.tabIndex < 0) {\n    // in Chrome, <details/>, <audio controls/> and <video controls/> elements get a default\n    // `tabIndex` of -1 when the 'tabindex' attribute isn't specified in the DOM,\n    // yet they are still part of the regular tab order; in FF, they get a default\n    // `tabIndex` of 0; since Chrome still puts those elements in the regular tab\n    // order, consider their tab index to be 0.\n    // Also browsers do not return `tabIndex` correctly for contentEditable nodes;\n    // so if they don't have a tabindex attribute specifically set, assume it's 0.\n    if ((/^(AUDIO|VIDEO|DETAILS)$/.test(node.tagName) || isContentEditable(node)) && !hasTabIndex(node)) {\n      return 0;\n    }\n  }\n  return node.tabIndex;\n};\n\n/**\n * Determine the tab index of a given node __for sort order purposes__.\n * @param {HTMLElement} node\n * @param {boolean} [isScope] True for a custom element with shadow root or slot that, by default,\n *  has tabIndex -1, but needs to be sorted by document order in order for its content to be\n *  inserted into the correct sort position.\n * @returns {number} Tab order (negative, 0, or positive number).\n */\nvar getSortOrderTabIndex = function getSortOrderTabIndex(node, isScope) {\n  var tabIndex = getTabIndex(node);\n  if (tabIndex < 0 && isScope && !hasTabIndex(node)) {\n    return 0;\n  }\n  return tabIndex;\n};\nvar sortOrderedTabbables = function sortOrderedTabbables(a, b) {\n  return a.tabIndex === b.tabIndex ? a.documentOrder - b.documentOrder : a.tabIndex - b.tabIndex;\n};\nvar isInput = function isInput(node) {\n  return node.tagName === 'INPUT';\n};\nvar isHiddenInput = function isHiddenInput(node) {\n  return isInput(node) && node.type === 'hidden';\n};\nvar isDetailsWithSummary = function isDetailsWithSummary(node) {\n  var r = node.tagName === 'DETAILS' && Array.prototype.slice.apply(node.children).some(function (child) {\n    return child.tagName === 'SUMMARY';\n  });\n  return r;\n};\nvar getCheckedRadio = function getCheckedRadio(nodes, form) {\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i].checked && nodes[i].form === form) {\n      return nodes[i];\n    }\n  }\n};\nvar isTabbableRadio = function isTabbableRadio(node) {\n  if (!node.name) {\n    return true;\n  }\n  var radioScope = node.form || getRootNode(node);\n  var queryRadios = function queryRadios(name) {\n    return radioScope.querySelectorAll('input[type=\"radio\"][name=\"' + name + '\"]');\n  };\n  var radioSet;\n  if (typeof window !== 'undefined' && typeof window.CSS !== 'undefined' && typeof window.CSS.escape === 'function') {\n    radioSet = queryRadios(window.CSS.escape(node.name));\n  } else {\n    try {\n      radioSet = queryRadios(node.name);\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error('Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s', err.message);\n      return false;\n    }\n  }\n  var checked = getCheckedRadio(radioSet, node.form);\n  return !checked || checked === node;\n};\nvar isRadio = function isRadio(node) {\n  return isInput(node) && node.type === 'radio';\n};\nvar isNonTabbableRadio = function isNonTabbableRadio(node) {\n  return isRadio(node) && !isTabbableRadio(node);\n};\n\n// determines if a node is ultimately attached to the window's document\nvar isNodeAttached = function isNodeAttached(node) {\n  var _nodeRoot;\n  // The root node is the shadow root if the node is in a shadow DOM; some document otherwise\n  //  (but NOT _the_ document; see second 'If' comment below for more).\n  // If rootNode is shadow root, it'll have a host, which is the element to which the shadow\n  //  is attached, and the one we need to check if it's in the document or not (because the\n  //  shadow, and all nodes it contains, is never considered in the document since shadows\n  //  behave like self-contained DOMs; but if the shadow's HOST, which is part of the document,\n  //  is hidden, or is not in the document itself but is detached, it will affect the shadow's\n  //  visibility, including all the nodes it contains). The host could be any normal node,\n  //  or a custom element (i.e. web component). Either way, that's the one that is considered\n  //  part of the document, not the shadow root, nor any of its children (i.e. the node being\n  //  tested).\n  // To further complicate things, we have to look all the way up until we find a shadow HOST\n  //  that is attached (or find none) because the node might be in nested shadows...\n  // If rootNode is not a shadow root, it won't have a host, and so rootNode should be the\n  //  document (per the docs) and while it's a Document-type object, that document does not\n  //  appear to be the same as the node's `ownerDocument` for some reason, so it's safer\n  //  to ignore the rootNode at this point, and use `node.ownerDocument`. Otherwise,\n  //  using `rootNode.contains(node)` will _always_ be true we'll get false-positives when\n  //  node is actually detached.\n  // NOTE: If `nodeRootHost` or `node` happens to be the `document` itself (which is possible\n  //  if a tabbable/focusable node was quickly added to the DOM, focused, and then removed\n  //  from the DOM as in https://github.com/focus-trap/focus-trap-react/issues/905), then\n  //  `ownerDocument` will be `null`, hence the optional chaining on it.\n  var nodeRoot = node && getRootNode(node);\n  var nodeRootHost = (_nodeRoot = nodeRoot) === null || _nodeRoot === void 0 ? void 0 : _nodeRoot.host;\n\n  // in some cases, a detached node will return itself as the root instead of a document or\n  //  shadow root object, in which case, we shouldn't try to look further up the host chain\n  var attached = false;\n  if (nodeRoot && nodeRoot !== node) {\n    var _nodeRootHost, _nodeRootHost$ownerDo, _node$ownerDocument;\n    attached = !!((_nodeRootHost = nodeRootHost) !== null && _nodeRootHost !== void 0 && (_nodeRootHost$ownerDo = _nodeRootHost.ownerDocument) !== null && _nodeRootHost$ownerDo !== void 0 && _nodeRootHost$ownerDo.contains(nodeRootHost) || node !== null && node !== void 0 && (_node$ownerDocument = node.ownerDocument) !== null && _node$ownerDocument !== void 0 && _node$ownerDocument.contains(node));\n    while (!attached && nodeRootHost) {\n      var _nodeRoot2, _nodeRootHost2, _nodeRootHost2$ownerD;\n      // since it's not attached and we have a root host, the node MUST be in a nested shadow DOM,\n      //  which means we need to get the host's host and check if that parent host is contained\n      //  in (i.e. attached to) the document\n      nodeRoot = getRootNode(nodeRootHost);\n      nodeRootHost = (_nodeRoot2 = nodeRoot) === null || _nodeRoot2 === void 0 ? void 0 : _nodeRoot2.host;\n      attached = !!((_nodeRootHost2 = nodeRootHost) !== null && _nodeRootHost2 !== void 0 && (_nodeRootHost2$ownerD = _nodeRootHost2.ownerDocument) !== null && _nodeRootHost2$ownerD !== void 0 && _nodeRootHost2$ownerD.contains(nodeRootHost));\n    }\n  }\n  return attached;\n};\nvar isZeroArea = function isZeroArea(node) {\n  var _node$getBoundingClie = node.getBoundingClientRect(),\n    width = _node$getBoundingClie.width,\n    height = _node$getBoundingClie.height;\n  return width === 0 && height === 0;\n};\nvar isHidden = function isHidden(node, _ref) {\n  var displayCheck = _ref.displayCheck,\n    getShadowRoot = _ref.getShadowRoot;\n  if (displayCheck === 'full-native') {\n    if ('checkVisibility' in node) {\n      // Chrome >= 105, Edge >= 105, Firefox >= 106, Safari >= 17.4\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Element/checkVisibility#browser_compatibility\n      var visible = node.checkVisibility({\n        // Checking opacity might be desirable for some use cases, but natively,\n        // opacity zero elements _are_ focusable and tabbable.\n        checkOpacity: false,\n        opacityProperty: false,\n        contentVisibilityAuto: true,\n        visibilityProperty: true,\n        // This is an alias for `visibilityProperty`. Contemporary browsers\n        // support both. However, this alias has wider browser support (Chrome\n        // >= 105 and Firefox >= 106, vs. Chrome >= 121 and Firefox >= 122), so\n        // we include it anyway.\n        checkVisibilityCSS: true\n      });\n      return !visible;\n    }\n    // Fall through to manual visibility checks\n  }\n\n  // NOTE: visibility will be `undefined` if node is detached from the document\n  //  (see notes about this further down), which means we will consider it visible\n  //  (this is legacy behavior from a very long way back)\n  // NOTE: we check this regardless of `displayCheck=\"none\"` because this is a\n  //  _visibility_ check, not a _display_ check\n  if (getComputedStyle(node).visibility === 'hidden') {\n    return true;\n  }\n  var isDirectSummary = matches.call(node, 'details>summary:first-of-type');\n  var nodeUnderDetails = isDirectSummary ? node.parentElement : node;\n  if (matches.call(nodeUnderDetails, 'details:not([open]) *')) {\n    return true;\n  }\n  if (!displayCheck || displayCheck === 'full' ||\n  // full-native can run this branch when it falls through in case\n  // Element#checkVisibility is unsupported\n  displayCheck === 'full-native' || displayCheck === 'legacy-full') {\n    if (typeof getShadowRoot === 'function') {\n      // figure out if we should consider the node to be in an undisclosed shadow and use the\n      //  'non-zero-area' fallback\n      var originalNode = node;\n      while (node) {\n        var parentElement = node.parentElement;\n        var rootNode = getRootNode(node);\n        if (parentElement && !parentElement.shadowRoot && getShadowRoot(parentElement) === true // check if there's an undisclosed shadow\n        ) {\n          // node has an undisclosed shadow which means we can only treat it as a black box, so we\n          //  fall back to a non-zero-area test\n          return isZeroArea(node);\n        } else if (node.assignedSlot) {\n          // iterate up slot\n          node = node.assignedSlot;\n        } else if (!parentElement && rootNode !== node.ownerDocument) {\n          // cross shadow boundary\n          node = rootNode.host;\n        } else {\n          // iterate up normal dom\n          node = parentElement;\n        }\n      }\n      node = originalNode;\n    }\n    // else, `getShadowRoot` might be true, but all that does is enable shadow DOM support\n    //  (i.e. it does not also presume that all nodes might have undisclosed shadows); or\n    //  it might be a falsy value, which means shadow DOM support is disabled\n\n    // Since we didn't find it sitting in an undisclosed shadow (or shadows are disabled)\n    //  now we can just test to see if it would normally be visible or not, provided it's\n    //  attached to the main document.\n    // NOTE: We must consider case where node is inside a shadow DOM and given directly to\n    //  `isTabbable()` or `isFocusable()` -- regardless of `getShadowRoot` option setting.\n\n    if (isNodeAttached(node)) {\n      // this works wherever the node is: if there's at least one client rect, it's\n      //  somehow displayed; it also covers the CSS 'display: contents' case where the\n      //  node itself is hidden in place of its contents; and there's no need to search\n      //  up the hierarchy either\n      return !node.getClientRects().length;\n    }\n\n    // Else, the node isn't attached to the document, which means the `getClientRects()`\n    //  API will __always__ return zero rects (this can happen, for example, if React\n    //  is used to render nodes onto a detached tree, as confirmed in this thread:\n    //  https://github.com/facebook/react/issues/9117#issuecomment-284228870)\n    //\n    // It also means that even window.getComputedStyle(node).display will return `undefined`\n    //  because styles are only computed for nodes that are in the document.\n    //\n    // NOTE: THIS HAS BEEN THE CASE FOR YEARS. It is not new, nor is it caused by tabbable\n    //  somehow. Though it was never stated officially, anyone who has ever used tabbable\n    //  APIs on nodes in detached containers has actually implicitly used tabbable in what\n    //  was later (as of v5.2.0 on Apr 9, 2021) called `displayCheck=\"none\"` mode -- essentially\n    //  considering __everything__ to be visible because of the innability to determine styles.\n    //\n    // v6.0.0: As of this major release, the default 'full' option __no longer treats detached\n    //  nodes as visible with the 'none' fallback.__\n    if (displayCheck !== 'legacy-full') {\n      return true; // hidden\n    }\n    // else, fallback to 'none' mode and consider the node visible\n  } else if (displayCheck === 'non-zero-area') {\n    // NOTE: Even though this tests that the node's client rect is non-zero to determine\n    //  whether it's displayed, and that a detached node will __always__ have a zero-area\n    //  client rect, we don't special-case for whether the node is attached or not. In\n    //  this mode, we do want to consider nodes that have a zero area to be hidden at all\n    //  times, and that includes attached or not.\n    return isZeroArea(node);\n  }\n\n  // visible, as far as we can tell, or per current `displayCheck=none` mode, we assume\n  //  it's visible\n  return false;\n};\n\n// form fields (nested) inside a disabled fieldset are not focusable/tabbable\n//  unless they are in the _first_ <legend> element of the top-most disabled\n//  fieldset\nvar isDisabledFromFieldset = function isDisabledFromFieldset(node) {\n  if (/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(node.tagName)) {\n    var parentNode = node.parentElement;\n    // check if `node` is contained in a disabled <fieldset>\n    while (parentNode) {\n      if (parentNode.tagName === 'FIELDSET' && parentNode.disabled) {\n        // look for the first <legend> among the children of the disabled <fieldset>\n        for (var i = 0; i < parentNode.children.length; i++) {\n          var child = parentNode.children.item(i);\n          // when the first <legend> (in document order) is found\n          if (child.tagName === 'LEGEND') {\n            // if its parent <fieldset> is not nested in another disabled <fieldset>,\n            // return whether `node` is a descendant of its first <legend>\n            return matches.call(parentNode, 'fieldset[disabled] *') ? true : !child.contains(node);\n          }\n        }\n        // the disabled <fieldset> containing `node` has no <legend>\n        return true;\n      }\n      parentNode = parentNode.parentElement;\n    }\n  }\n\n  // else, node's tabbable/focusable state should not be affected by a fieldset's\n  //  enabled/disabled state\n  return false;\n};\nvar isNodeMatchingSelectorFocusable = function isNodeMatchingSelectorFocusable(options, node) {\n  if (node.disabled ||\n  // we must do an inert look up to filter out any elements inside an inert ancestor\n  //  because we're limited in the type of selectors we can use in JSDom (see related\n  //  note related to `candidateSelectors`)\n  _isInert(node) || isHiddenInput(node) || isHidden(node, options) ||\n  // For a details element with a summary, the summary element gets the focus\n  isDetailsWithSummary(node) || isDisabledFromFieldset(node)) {\n    return false;\n  }\n  return true;\n};\nvar isNodeMatchingSelectorTabbable = function isNodeMatchingSelectorTabbable(options, node) {\n  if (isNonTabbableRadio(node) || getTabIndex(node) < 0 || !isNodeMatchingSelectorFocusable(options, node)) {\n    return false;\n  }\n  return true;\n};\nvar isShadowRootTabbable = function isShadowRootTabbable(shadowHostNode) {\n  var tabIndex = parseInt(shadowHostNode.getAttribute('tabindex'), 10);\n  if (isNaN(tabIndex) || tabIndex >= 0) {\n    return true;\n  }\n  // If a custom element has an explicit negative tabindex,\n  // browsers will not allow tab targeting said element's children.\n  return false;\n};\n\n/**\n * @param {Array.<Element|CandidateScope>} candidates\n * @returns Element[]\n */\nvar _sortByOrder = function sortByOrder(candidates) {\n  var regularTabbables = [];\n  var orderedTabbables = [];\n  candidates.forEach(function (item, i) {\n    var isScope = !!item.scopeParent;\n    var element = isScope ? item.scopeParent : item;\n    var candidateTabindex = getSortOrderTabIndex(element, isScope);\n    var elements = isScope ? _sortByOrder(item.candidates) : element;\n    if (candidateTabindex === 0) {\n      isScope ? regularTabbables.push.apply(regularTabbables, elements) : regularTabbables.push(element);\n    } else {\n      orderedTabbables.push({\n        documentOrder: i,\n        tabIndex: candidateTabindex,\n        item: item,\n        isScope: isScope,\n        content: elements\n      });\n    }\n  });\n  return orderedTabbables.sort(sortOrderedTabbables).reduce(function (acc, sortable) {\n    sortable.isScope ? acc.push.apply(acc, sortable.content) : acc.push(sortable.content);\n    return acc;\n  }, []).concat(regularTabbables);\n};\nvar tabbable = function tabbable(container, options) {\n  options = options || {};\n  var candidates;\n  if (options.getShadowRoot) {\n    candidates = _getCandidatesIteratively([container], options.includeContainer, {\n      filter: isNodeMatchingSelectorTabbable.bind(null, options),\n      flatten: false,\n      getShadowRoot: options.getShadowRoot,\n      shadowRootFilter: isShadowRootTabbable\n    });\n  } else {\n    candidates = getCandidates(container, options.includeContainer, isNodeMatchingSelectorTabbable.bind(null, options));\n  }\n  return _sortByOrder(candidates);\n};\nvar focusable = function focusable(container, options) {\n  options = options || {};\n  var candidates;\n  if (options.getShadowRoot) {\n    candidates = _getCandidatesIteratively([container], options.includeContainer, {\n      filter: isNodeMatchingSelectorFocusable.bind(null, options),\n      flatten: true,\n      getShadowRoot: options.getShadowRoot\n    });\n  } else {\n    candidates = getCandidates(container, options.includeContainer, isNodeMatchingSelectorFocusable.bind(null, options));\n  }\n  return candidates;\n};\nvar isTabbable = function isTabbable(node, options) {\n  options = options || {};\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (matches.call(node, candidateSelector) === false) {\n    return false;\n  }\n  return isNodeMatchingSelectorTabbable(options, node);\n};\nvar focusableCandidateSelector = /* #__PURE__ */candidateSelectors.concat('iframe').join(',');\nvar isFocusable = function isFocusable(node, options) {\n  options = options || {};\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (matches.call(node, focusableCandidateSelector) === false) {\n    return false;\n  }\n  return isNodeMatchingSelectorFocusable(options, node);\n};\n\nexport { focusable, getTabIndex, isFocusable, isTabbable, tabbable };\n//# sourceMappingURL=index.esm.js.map\n","import { afterTick, mergeProps, onDestroyEffect, attachRef, DOMContext, getWindow, simpleBox, boxWith, } from \"svelte-toolbelt\";\nimport { Context, watch } from \"runed\";\nimport { FIRST_LAST_KEYS, LAST_KEYS, SELECTION_KEYS, SUB_OPEN_KEYS, getCheckedState, isMouseEvent, } from \"./utils.js\";\nimport { focusFirst } from \"../../internal/focus.js\";\nimport { CustomEventDispatcher } from \"../../internal/events.js\";\nimport { isElement, isElementOrSVGElement, isHTMLElement } from \"../../internal/is.js\";\nimport { kbd } from \"../../internal/kbd.js\";\nimport { createBitsAttrs, getAriaChecked, boolToStr, getDataOpenClosed, boolToEmptyStrOrUndef, } from \"../../internal/attrs.js\";\nimport { IsUsingKeyboard } from \"../../index.js\";\nimport { getTabbableFrom } from \"../../internal/tabbable.js\";\nimport { isTabbable } from \"tabbable\";\nimport { DOMTypeahead } from \"../../internal/dom-typeahead.svelte.js\";\nimport { RovingFocusGroup } from \"../../internal/roving-focus-group.js\";\nimport { GraceArea } from \"../../internal/grace-area.svelte.js\";\nimport { PresenceManager } from \"../../internal/presence-manager.svelte.js\";\nexport const CONTEXT_MENU_TRIGGER_ATTR = \"data-context-menu-trigger\";\nexport const CONTEXT_MENU_CONTENT_ATTR = \"data-context-menu-content\";\nconst MenuRootContext = new Context(\"Menu.Root\");\nconst MenuMenuContext = new Context(\"Menu.Root | Menu.Sub\");\nconst MenuContentContext = new Context(\"Menu.Content\");\nconst MenuGroupContext = new Context(\"Menu.Group | Menu.RadioGroup\");\nconst MenuRadioGroupContext = new Context(\"Menu.RadioGroup\");\nexport const MenuCheckboxGroupContext = new Context(\"Menu.CheckboxGroup\");\nexport const MenuOpenEvent = new CustomEventDispatcher(\"bitsmenuopen\", {\n    bubbles: false,\n    cancelable: true,\n});\nexport const menuAttrs = createBitsAttrs({\n    component: \"menu\",\n    parts: [\n        \"trigger\",\n        \"content\",\n        \"sub-trigger\",\n        \"item\",\n        \"group\",\n        \"group-heading\",\n        \"checkbox-group\",\n        \"checkbox-item\",\n        \"radio-group\",\n        \"radio-item\",\n        \"separator\",\n        \"sub-content\",\n        \"arrow\",\n    ],\n});\nexport class MenuRootState {\n    static create(opts) {\n        const root = new MenuRootState(opts);\n        return MenuRootContext.set(root);\n    }\n    opts;\n    isUsingKeyboard = new IsUsingKeyboard();\n    ignoreCloseAutoFocus = $state(false);\n    isPointerInTransit = $state(false);\n    constructor(opts) {\n        this.opts = opts;\n    }\n    getBitsAttr = (part) => {\n        return menuAttrs.getAttr(part, this.opts.variant.current);\n    };\n}\nexport class MenuMenuState {\n    static create(opts, root) {\n        return MenuMenuContext.set(new MenuMenuState(opts, root, null));\n    }\n    opts;\n    root;\n    parentMenu;\n    contentId = boxWith(() => \"\");\n    contentNode = $state(null);\n    contentPresence;\n    triggerNode = $state(null);\n    constructor(opts, root, parentMenu) {\n        this.opts = opts;\n        this.root = root;\n        this.parentMenu = parentMenu;\n        this.contentPresence = new PresenceManager({\n            ref: boxWith(() => this.contentNode),\n            open: this.opts.open,\n            onComplete: () => {\n                this.opts.onOpenChangeComplete.current(this.opts.open.current);\n            },\n        });\n        if (parentMenu) {\n            watch(() => parentMenu.opts.open.current, () => {\n                if (parentMenu.opts.open.current)\n                    return;\n                this.opts.open.current = false;\n            });\n        }\n    }\n    toggleOpen() {\n        this.opts.open.current = !this.opts.open.current;\n    }\n    onOpen() {\n        this.opts.open.current = true;\n    }\n    onClose() {\n        this.opts.open.current = false;\n    }\n}\nexport class MenuContentState {\n    static create(opts) {\n        return MenuContentContext.set(new MenuContentState(opts, MenuMenuContext.get()));\n    }\n    opts;\n    parentMenu;\n    rovingFocusGroup;\n    domContext;\n    attachment;\n    search = $state(\"\");\n    #timer = 0;\n    #handleTypeaheadSearch;\n    mounted = $state(false);\n    #isSub;\n    constructor(opts, parentMenu) {\n        this.opts = opts;\n        this.parentMenu = parentMenu;\n        this.domContext = new DOMContext(opts.ref);\n        this.attachment = attachRef(this.opts.ref, (v) => {\n            if (this.parentMenu.contentNode !== v) {\n                this.parentMenu.contentNode = v;\n            }\n        });\n        parentMenu.contentId = opts.id;\n        this.#isSub = opts.isSub ?? false;\n        this.onkeydown = this.onkeydown.bind(this);\n        this.onblur = this.onblur.bind(this);\n        this.onfocus = this.onfocus.bind(this);\n        this.handleInteractOutside = this.handleInteractOutside.bind(this);\n        new GraceArea({\n            contentNode: () => this.parentMenu.contentNode,\n            triggerNode: () => this.parentMenu.triggerNode,\n            enabled: () => this.parentMenu.opts.open.current &&\n                Boolean(this.parentMenu.triggerNode?.hasAttribute(this.parentMenu.root.getBitsAttr(\"sub-trigger\"))),\n            onPointerExit: () => {\n                this.parentMenu.opts.open.current = false;\n            },\n            setIsPointerInTransit: (value) => {\n                this.parentMenu.root.isPointerInTransit = value;\n            },\n        });\n        this.#handleTypeaheadSearch = new DOMTypeahead({\n            getActiveElement: () => this.domContext.getActiveElement(),\n            getWindow: () => this.domContext.getWindow(),\n        }).handleTypeaheadSearch;\n        this.rovingFocusGroup = new RovingFocusGroup({\n            rootNode: boxWith(() => this.parentMenu.contentNode),\n            candidateAttr: this.parentMenu.root.getBitsAttr(\"item\"),\n            loop: this.opts.loop,\n            orientation: boxWith(() => \"vertical\"),\n        });\n        watch(() => this.parentMenu.contentNode, (contentNode) => {\n            if (!contentNode)\n                return;\n            const handler = () => {\n                afterTick(() => {\n                    if (!this.parentMenu.root.isUsingKeyboard.current)\n                        return;\n                    this.rovingFocusGroup.focusFirstCandidate();\n                });\n            };\n            return MenuOpenEvent.listen(contentNode, handler);\n        });\n        $effect(() => {\n            if (!this.parentMenu.opts.open.current) {\n                this.domContext.getWindow().clearTimeout(this.#timer);\n            }\n        });\n    }\n    #getCandidateNodes() {\n        const node = this.parentMenu.contentNode;\n        if (!node)\n            return [];\n        const candidates = Array.from(node.querySelectorAll(`[${this.parentMenu.root.getBitsAttr(\"item\")}]:not([data-disabled])`));\n        return candidates;\n    }\n    #isPointerMovingToSubmenu() {\n        return this.parentMenu.root.isPointerInTransit;\n    }\n    onCloseAutoFocus = (e) => {\n        this.opts.onCloseAutoFocus.current?.(e);\n        if (e.defaultPrevented || this.#isSub)\n            return;\n        if (this.parentMenu.triggerNode && isTabbable(this.parentMenu.triggerNode)) {\n            e.preventDefault();\n            this.parentMenu.triggerNode.focus();\n        }\n    };\n    handleTabKeyDown(e) {\n        /**\n         * We locate the root `menu`'s trigger by going up the tree until\n         * we find a menu that has no parent. This will allow us to focus the next\n         * tabbable element before/after the root trigger.\n         */\n        let rootMenu = this.parentMenu;\n        while (rootMenu.parentMenu !== null) {\n            rootMenu = rootMenu.parentMenu;\n        }\n        // if for some unforeseen reason the root menu has no trigger, we bail\n        if (!rootMenu.triggerNode)\n            return;\n        // cancel default tab behavior\n        e.preventDefault();\n        // find the next/previous tabbable\n        const nodeToFocus = getTabbableFrom(rootMenu.triggerNode, e.shiftKey ? \"prev\" : \"next\");\n        if (nodeToFocus) {\n            /**\n             * We set a flag to ignore the `onCloseAutoFocus` event handler\n             * as well as the fallbacks inside the focus scope to prevent\n             * race conditions causing focus to fall back to the body even\n             * though we're trying to focus the next tabbable element.\n             */\n            this.parentMenu.root.ignoreCloseAutoFocus = true;\n            rootMenu.onClose();\n            afterTick(() => {\n                nodeToFocus.focus();\n                afterTick(() => {\n                    this.parentMenu.root.ignoreCloseAutoFocus = false;\n                });\n            });\n        }\n        else {\n            this.domContext.getDocument().body.focus();\n        }\n    }\n    onkeydown(e) {\n        if (e.defaultPrevented)\n            return;\n        if (e.key === kbd.TAB) {\n            this.handleTabKeyDown(e);\n            return;\n        }\n        const target = e.target;\n        const currentTarget = e.currentTarget;\n        if (!isHTMLElement(target) || !isHTMLElement(currentTarget))\n            return;\n        const isKeydownInside = target.closest(`[${this.parentMenu.root.getBitsAttr(\"content\")}]`)?.id ===\n            this.parentMenu.contentId.current;\n        const isModifierKey = e.ctrlKey || e.altKey || e.metaKey;\n        const isCharacterKey = e.key.length === 1;\n        const kbdFocusedEl = this.rovingFocusGroup.handleKeydown(target, e);\n        if (kbdFocusedEl)\n            return;\n        // prevent space from being considered with typeahead\n        if (e.code === \"Space\")\n            return;\n        const candidateNodes = this.#getCandidateNodes();\n        if (isKeydownInside) {\n            if (!isModifierKey && isCharacterKey) {\n                this.#handleTypeaheadSearch(e.key, candidateNodes);\n            }\n        }\n        // focus first/last based on key pressed\n        if (e.target?.id !== this.parentMenu.contentId.current)\n            return;\n        if (!FIRST_LAST_KEYS.includes(e.key))\n            return;\n        e.preventDefault();\n        if (LAST_KEYS.includes(e.key)) {\n            candidateNodes.reverse();\n        }\n        focusFirst(candidateNodes, { select: false }, () => this.domContext.getActiveElement());\n    }\n    onblur(e) {\n        if (!isElement(e.currentTarget))\n            return;\n        if (!isElement(e.target))\n            return;\n        // clear search buffer when leaving the menu\n        if (!e.currentTarget.contains?.(e.target)) {\n            this.domContext.getWindow().clearTimeout(this.#timer);\n            this.search = \"\";\n        }\n    }\n    onfocus(_) {\n        if (!this.parentMenu.root.isUsingKeyboard.current)\n            return;\n        afterTick(() => this.rovingFocusGroup.focusFirstCandidate());\n    }\n    onItemEnter() {\n        return this.#isPointerMovingToSubmenu();\n    }\n    onItemLeave(e) {\n        if (e.currentTarget.hasAttribute(this.parentMenu.root.getBitsAttr(\"sub-trigger\")))\n            return;\n        if (this.#isPointerMovingToSubmenu() || this.parentMenu.root.isUsingKeyboard.current)\n            return;\n        const contentNode = this.parentMenu.contentNode;\n        contentNode?.focus();\n        this.rovingFocusGroup.setCurrentTabStopId(\"\");\n    }\n    onTriggerLeave() {\n        if (this.#isPointerMovingToSubmenu())\n            return true;\n        return false;\n    }\n    handleInteractOutside(e) {\n        if (!isElementOrSVGElement(e.target))\n            return;\n        const triggerId = this.parentMenu.triggerNode?.id;\n        if (e.target.id === triggerId) {\n            e.preventDefault();\n            return;\n        }\n        if (e.target.closest(`#${triggerId}`)) {\n            e.preventDefault();\n        }\n    }\n    get shouldRender() {\n        return this.parentMenu.contentPresence.shouldRender;\n    }\n    snippetProps = $derived.by(() => ({ open: this.parentMenu.opts.open.current }));\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: \"menu\",\n        \"aria-orientation\": \"vertical\",\n        [this.parentMenu.root.getBitsAttr(\"content\")]: \"\",\n        \"data-state\": getDataOpenClosed(this.parentMenu.opts.open.current),\n        onkeydown: this.onkeydown,\n        onblur: this.onblur,\n        onfocus: this.onfocus,\n        dir: this.parentMenu.root.opts.dir.current,\n        style: {\n            pointerEvents: \"auto\",\n        },\n        ...this.attachment,\n    }));\n    popperProps = {\n        onCloseAutoFocus: (e) => this.onCloseAutoFocus(e),\n    };\n}\nclass MenuItemSharedState {\n    opts;\n    content;\n    attachment;\n    #isFocused = $state(false);\n    constructor(opts, content) {\n        this.opts = opts;\n        this.content = content;\n        this.attachment = attachRef(this.opts.ref);\n        this.onpointermove = this.onpointermove.bind(this);\n        this.onpointerleave = this.onpointerleave.bind(this);\n        this.onfocus = this.onfocus.bind(this);\n        this.onblur = this.onblur.bind(this);\n    }\n    onpointermove(e) {\n        if (e.defaultPrevented)\n            return;\n        if (!isMouseEvent(e))\n            return;\n        if (this.opts.disabled.current) {\n            this.content.onItemLeave(e);\n        }\n        else {\n            const defaultPrevented = this.content.onItemEnter();\n            if (defaultPrevented)\n                return;\n            const item = e.currentTarget;\n            if (!isHTMLElement(item))\n                return;\n            item.focus();\n        }\n    }\n    onpointerleave(e) {\n        if (e.defaultPrevented)\n            return;\n        if (!isMouseEvent(e))\n            return;\n        this.content.onItemLeave(e);\n    }\n    onfocus(e) {\n        afterTick(() => {\n            if (e.defaultPrevented || this.opts.disabled.current)\n                return;\n            this.#isFocused = true;\n        });\n    }\n    onblur(e) {\n        afterTick(() => {\n            if (e.defaultPrevented)\n                return;\n            this.#isFocused = false;\n        });\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        tabindex: -1,\n        role: \"menuitem\",\n        \"aria-disabled\": boolToStr(this.opts.disabled.current),\n        \"data-disabled\": boolToEmptyStrOrUndef(this.opts.disabled.current),\n        \"data-highlighted\": this.#isFocused ? \"\" : undefined,\n        [this.content.parentMenu.root.getBitsAttr(\"item\")]: \"\",\n        //\n        onpointermove: this.onpointermove,\n        onpointerleave: this.onpointerleave,\n        onfocus: this.onfocus,\n        onblur: this.onblur,\n        ...this.attachment,\n    }));\n}\nexport class MenuItemState {\n    static create(opts) {\n        const item = new MenuItemSharedState(opts, MenuContentContext.get());\n        return new MenuItemState(opts, item);\n    }\n    opts;\n    item;\n    root;\n    #isPointerDown = false;\n    constructor(opts, item) {\n        this.opts = opts;\n        this.item = item;\n        this.root = item.content.parentMenu.root;\n        this.onkeydown = this.onkeydown.bind(this);\n        this.onclick = this.onclick.bind(this);\n        this.onpointerdown = this.onpointerdown.bind(this);\n        this.onpointerup = this.onpointerup.bind(this);\n    }\n    #handleSelect() {\n        if (this.item.opts.disabled.current)\n            return;\n        const selectEvent = new CustomEvent(\"menuitemselect\", { bubbles: true, cancelable: true });\n        this.opts.onSelect.current(selectEvent);\n        if (selectEvent.defaultPrevented) {\n            this.item.content.parentMenu.root.isUsingKeyboard.current = false;\n            return;\n        }\n        if (this.opts.closeOnSelect.current) {\n            this.item.content.parentMenu.root.opts.onClose();\n        }\n    }\n    onkeydown(e) {\n        const isTypingAhead = this.item.content.search !== \"\";\n        if (this.item.opts.disabled.current || (isTypingAhead && e.key === kbd.SPACE))\n            return;\n        if (SELECTION_KEYS.includes(e.key)) {\n            if (!isHTMLElement(e.currentTarget))\n                return;\n            e.currentTarget.click();\n            /**\n             * We prevent default browser behavior for selection keys as they should trigger\n             * a selection only:\n             * - prevents space from scrolling the page.\n             * - if keydown causes focus to move, prevents keydown from firing on the new target.\n             */\n            e.preventDefault();\n        }\n    }\n    onclick(_) {\n        if (this.item.opts.disabled.current)\n            return;\n        this.#handleSelect();\n    }\n    onpointerup(e) {\n        if (e.defaultPrevented)\n            return;\n        if (!this.#isPointerDown) {\n            if (!isHTMLElement(e.currentTarget))\n                return;\n            e.currentTarget?.click();\n        }\n    }\n    onpointerdown(_) {\n        this.#isPointerDown = true;\n    }\n    props = $derived.by(() => mergeProps(this.item.props, {\n        onclick: this.onclick,\n        onpointerdown: this.onpointerdown,\n        onpointerup: this.onpointerup,\n        onkeydown: this.onkeydown,\n    }));\n}\nexport class MenuSubTriggerState {\n    static create(opts) {\n        const content = MenuContentContext.get();\n        const item = new MenuItemSharedState(opts, content);\n        const submenu = MenuMenuContext.get();\n        return new MenuSubTriggerState(opts, item, content, submenu);\n    }\n    opts;\n    item;\n    content;\n    submenu;\n    attachment;\n    #openTimer = null;\n    constructor(opts, item, content, submenu) {\n        this.opts = opts;\n        this.item = item;\n        this.content = content;\n        this.submenu = submenu;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.submenu.triggerNode = v));\n        this.onpointerleave = this.onpointerleave.bind(this);\n        this.onpointermove = this.onpointermove.bind(this);\n        this.onkeydown = this.onkeydown.bind(this);\n        this.onclick = this.onclick.bind(this);\n        onDestroyEffect(() => {\n            this.#clearOpenTimer();\n        });\n    }\n    #clearOpenTimer() {\n        if (this.#openTimer === null)\n            return;\n        this.content.domContext.getWindow().clearTimeout(this.#openTimer);\n        this.#openTimer = null;\n    }\n    onpointermove(e) {\n        if (!isMouseEvent(e))\n            return;\n        if (!this.item.opts.disabled.current &&\n            !this.submenu.opts.open.current &&\n            !this.#openTimer &&\n            !this.content.parentMenu.root.isPointerInTransit) {\n            this.#openTimer = this.content.domContext.setTimeout(() => {\n                this.submenu.onOpen();\n                this.#clearOpenTimer();\n            }, this.opts.openDelay.current);\n        }\n    }\n    onpointerleave(e) {\n        if (!isMouseEvent(e))\n            return;\n        this.#clearOpenTimer();\n    }\n    onkeydown(e) {\n        const isTypingAhead = this.content.search !== \"\";\n        if (this.item.opts.disabled.current || (isTypingAhead && e.key === kbd.SPACE))\n            return;\n        if (SUB_OPEN_KEYS[this.submenu.root.opts.dir.current].includes(e.key)) {\n            e.currentTarget.click();\n            e.preventDefault();\n        }\n    }\n    onclick(e) {\n        if (this.item.opts.disabled.current)\n            return;\n        /**\n         * We manually focus because iOS Safari doesn't always focus on click (e.g. buttons)\n         * and we rely heavily on `onFocusOutside` for submenus to close when switching\n         * between separate submenus.\n         */\n        if (!isHTMLElement(e.currentTarget))\n            return;\n        e.currentTarget.focus();\n        const selectEvent = new CustomEvent(\"menusubtriggerselect\", {\n            bubbles: true,\n            cancelable: true,\n        });\n        this.opts.onSelect.current(selectEvent);\n        if (!this.submenu.opts.open.current) {\n            this.submenu.onOpen();\n            afterTick(() => {\n                const contentNode = this.submenu.contentNode;\n                if (!contentNode)\n                    return;\n                MenuOpenEvent.dispatch(contentNode);\n            });\n        }\n    }\n    props = $derived.by(() => mergeProps({\n        \"aria-haspopup\": \"menu\",\n        \"aria-expanded\": boolToStr(this.submenu.opts.open.current),\n        \"data-state\": getDataOpenClosed(this.submenu.opts.open.current),\n        \"aria-controls\": this.submenu.opts.open.current\n            ? this.submenu.contentId.current\n            : undefined,\n        [this.submenu.root.getBitsAttr(\"sub-trigger\")]: \"\",\n        onclick: this.onclick,\n        onpointermove: this.onpointermove,\n        onpointerleave: this.onpointerleave,\n        onkeydown: this.onkeydown,\n        ...this.attachment,\n    }, this.item.props));\n}\nexport class MenuCheckboxItemState {\n    static create(opts, checkboxGroup) {\n        const item = new MenuItemState(opts, new MenuItemSharedState(opts, MenuContentContext.get()));\n        return new MenuCheckboxItemState(opts, item, checkboxGroup);\n    }\n    opts;\n    item;\n    group;\n    constructor(opts, item, group = null) {\n        this.opts = opts;\n        this.item = item;\n        this.group = group;\n        // Watch for value changes in the group if we're part of one\n        if (this.group) {\n            watch(() => this.group.opts.value.current, (groupValues) => {\n                this.opts.checked.current = groupValues.includes(this.opts.value.current);\n            });\n            // Watch for checked state changes and sync with group\n            watch(() => this.opts.checked.current, (checked) => {\n                if (checked) {\n                    this.group.addValue(this.opts.value.current);\n                }\n                else {\n                    this.group.removeValue(this.opts.value.current);\n                }\n            });\n        }\n    }\n    toggleChecked() {\n        if (this.opts.indeterminate.current) {\n            this.opts.indeterminate.current = false;\n            this.opts.checked.current = true;\n        }\n        else {\n            this.opts.checked.current = !this.opts.checked.current;\n        }\n    }\n    snippetProps = $derived.by(() => ({\n        checked: this.opts.checked.current,\n        indeterminate: this.opts.indeterminate.current,\n    }));\n    props = $derived.by(() => ({\n        ...this.item.props,\n        role: \"menuitemcheckbox\",\n        \"aria-checked\": getAriaChecked(this.opts.checked.current, this.opts.indeterminate.current),\n        \"data-state\": getCheckedState(this.opts.checked.current),\n        [this.item.root.getBitsAttr(\"checkbox-item\")]: \"\",\n    }));\n}\nexport class MenuGroupState {\n    static create(opts) {\n        return MenuGroupContext.set(new MenuGroupState(opts, MenuRootContext.get()));\n    }\n    opts;\n    root;\n    attachment;\n    groupHeadingId = $state(undefined);\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: \"group\",\n        \"aria-labelledby\": this.groupHeadingId,\n        [this.root.getBitsAttr(\"group\")]: \"\",\n        ...this.attachment,\n    }));\n}\nexport class MenuGroupHeadingState {\n    static create(opts) {\n        // Try to get checkbox group first, then radio group, then regular group\n        const checkboxGroup = MenuCheckboxGroupContext.getOr(null);\n        if (checkboxGroup)\n            return new MenuGroupHeadingState(opts, checkboxGroup);\n        const radioGroup = MenuRadioGroupContext.getOr(null);\n        if (radioGroup)\n            return new MenuGroupHeadingState(opts, radioGroup);\n        return new MenuGroupHeadingState(opts, MenuGroupContext.get());\n    }\n    opts;\n    group;\n    attachment;\n    constructor(opts, group) {\n        this.opts = opts;\n        this.group = group;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.group.groupHeadingId = v?.id));\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: \"group\",\n        [this.group.root.getBitsAttr(\"group-heading\")]: \"\",\n        ...this.attachment,\n    }));\n}\nexport class MenuSeparatorState {\n    static create(opts) {\n        return new MenuSeparatorState(opts, MenuRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: \"group\",\n        [this.root.getBitsAttr(\"separator\")]: \"\",\n        ...this.attachment,\n    }));\n}\nexport class MenuArrowState {\n    static create() {\n        return new MenuArrowState(MenuRootContext.get());\n    }\n    root;\n    constructor(root) {\n        this.root = root;\n    }\n    props = $derived.by(() => ({\n        [this.root.getBitsAttr(\"arrow\")]: \"\",\n    }));\n}\nexport class MenuRadioGroupState {\n    static create(opts) {\n        return MenuGroupContext.set(MenuRadioGroupContext.set(new MenuRadioGroupState(opts, MenuContentContext.get())));\n    }\n    opts;\n    content;\n    attachment;\n    groupHeadingId = $state(null);\n    root;\n    constructor(opts, content) {\n        this.opts = opts;\n        this.content = content;\n        this.root = content.parentMenu.root;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    setValue(v) {\n        this.opts.value.current = v;\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"radio-group\")]: \"\",\n        role: \"group\",\n        \"aria-labelledby\": this.groupHeadingId,\n        ...this.attachment,\n    }));\n}\nexport class MenuRadioItemState {\n    static create(opts) {\n        const radioGroup = MenuRadioGroupContext.get();\n        const sharedItem = new MenuItemSharedState(opts, radioGroup.content);\n        const item = new MenuItemState(opts, sharedItem);\n        return new MenuRadioItemState(opts, item, radioGroup);\n    }\n    opts;\n    item;\n    group;\n    attachment;\n    isChecked = $derived.by(() => this.group.opts.value.current === this.opts.value.current);\n    constructor(opts, item, group) {\n        this.opts = opts;\n        this.item = item;\n        this.group = group;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    selectValue() {\n        this.group.setValue(this.opts.value.current);\n    }\n    props = $derived.by(() => ({\n        [this.group.root.getBitsAttr(\"radio-item\")]: \"\",\n        ...this.item.props,\n        role: \"menuitemradio\",\n        \"aria-checked\": getAriaChecked(this.isChecked, false),\n        \"data-state\": getCheckedState(this.isChecked),\n        ...this.attachment,\n    }));\n}\nexport class DropdownMenuTriggerState {\n    static create(opts) {\n        return new DropdownMenuTriggerState(opts, MenuMenuContext.get());\n    }\n    opts;\n    parentMenu;\n    attachment;\n    constructor(opts, parentMenu) {\n        this.opts = opts;\n        this.parentMenu = parentMenu;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.parentMenu.triggerNode = v));\n    }\n    onclick = (e) => {\n        /**\n         * MacOS VoiceOver sends a click in Safari/Firefox bypassing the keydown event\n         * when V0+Space is pressed. Since we already handle the keydown event and the\n         * pointerdown events separately, we ignore it if the detail is not 0.\n         */\n        if (this.opts.disabled.current || e.detail !== 0)\n            return;\n        this.parentMenu.toggleOpen();\n        e.preventDefault();\n    };\n    onpointerdown = (e) => {\n        if (this.opts.disabled.current)\n            return;\n        if (e.pointerType === \"touch\")\n            return e.preventDefault();\n        if (e.button === 0 && e.ctrlKey === false) {\n            this.parentMenu.toggleOpen();\n            // prevent trigger focusing when opening to allow\n            // the content to be given focus without competition\n            if (!this.parentMenu.opts.open.current)\n                e.preventDefault();\n        }\n    };\n    onpointerup = (e) => {\n        if (this.opts.disabled.current)\n            return;\n        if (e.pointerType === \"touch\") {\n            e.preventDefault();\n            this.parentMenu.toggleOpen();\n        }\n    };\n    onkeydown = (e) => {\n        if (this.opts.disabled.current)\n            return;\n        if (e.key === kbd.SPACE || e.key === kbd.ENTER) {\n            this.parentMenu.toggleOpen();\n            e.preventDefault();\n            return;\n        }\n        if (e.key === kbd.ARROW_DOWN) {\n            this.parentMenu.onOpen();\n            e.preventDefault();\n        }\n    };\n    #ariaControls = $derived.by(() => {\n        if (this.parentMenu.opts.open.current && this.parentMenu.contentId.current)\n            return this.parentMenu.contentId.current;\n        return undefined;\n    });\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        disabled: this.opts.disabled.current,\n        \"aria-haspopup\": \"menu\",\n        \"aria-expanded\": boolToStr(this.parentMenu.opts.open.current),\n        \"aria-controls\": this.#ariaControls,\n        \"data-disabled\": boolToEmptyStrOrUndef(this.opts.disabled.current),\n        \"data-state\": getDataOpenClosed(this.parentMenu.opts.open.current),\n        [this.parentMenu.root.getBitsAttr(\"trigger\")]: \"\",\n        //\n        onclick: this.onclick,\n        onpointerdown: this.onpointerdown,\n        onpointerup: this.onpointerup,\n        onkeydown: this.onkeydown,\n        ...this.attachment,\n    }));\n}\nexport class ContextMenuTriggerState {\n    static create(opts) {\n        return new ContextMenuTriggerState(opts, MenuMenuContext.get());\n    }\n    opts;\n    parentMenu;\n    attachment;\n    #point = $state({ x: 0, y: 0 });\n    virtualElement = simpleBox({\n        getBoundingClientRect: () => DOMRect.fromRect({ width: 0, height: 0, ...this.#point }),\n    });\n    #longPressTimer = null;\n    constructor(opts, parentMenu) {\n        this.opts = opts;\n        this.parentMenu = parentMenu;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.parentMenu.triggerNode = v));\n        this.oncontextmenu = this.oncontextmenu.bind(this);\n        this.onpointerdown = this.onpointerdown.bind(this);\n        this.onpointermove = this.onpointermove.bind(this);\n        this.onpointercancel = this.onpointercancel.bind(this);\n        this.onpointerup = this.onpointerup.bind(this);\n        watch(() => this.#point, (point) => {\n            this.virtualElement.current = {\n                getBoundingClientRect: () => DOMRect.fromRect({ width: 0, height: 0, ...point }),\n            };\n        });\n        watch(() => this.opts.disabled.current, (isDisabled) => {\n            if (isDisabled) {\n                this.#clearLongPressTimer();\n            }\n        });\n        onDestroyEffect(() => this.#clearLongPressTimer());\n    }\n    #clearLongPressTimer() {\n        if (this.#longPressTimer === null)\n            return;\n        getWindow(this.opts.ref.current).clearTimeout(this.#longPressTimer);\n    }\n    #handleOpen(e) {\n        this.#point = { x: e.clientX, y: e.clientY };\n        this.parentMenu.onOpen();\n    }\n    oncontextmenu(e) {\n        if (e.defaultPrevented || this.opts.disabled.current)\n            return;\n        this.#clearLongPressTimer();\n        this.#handleOpen(e);\n        e.preventDefault();\n        this.parentMenu.contentNode?.focus();\n    }\n    onpointerdown(e) {\n        if (this.opts.disabled.current || isMouseEvent(e))\n            return;\n        this.#clearLongPressTimer();\n        this.#longPressTimer = getWindow(this.opts.ref.current).setTimeout(() => this.#handleOpen(e), 700);\n    }\n    onpointermove(e) {\n        if (this.opts.disabled.current || isMouseEvent(e))\n            return;\n        this.#clearLongPressTimer();\n    }\n    onpointercancel(e) {\n        if (this.opts.disabled.current || isMouseEvent(e))\n            return;\n        this.#clearLongPressTimer();\n    }\n    onpointerup(e) {\n        if (this.opts.disabled.current || isMouseEvent(e))\n            return;\n        this.#clearLongPressTimer();\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        disabled: this.opts.disabled.current,\n        \"data-disabled\": boolToEmptyStrOrUndef(this.opts.disabled.current),\n        \"data-state\": getDataOpenClosed(this.parentMenu.opts.open.current),\n        [CONTEXT_MENU_TRIGGER_ATTR]: \"\",\n        tabindex: -1,\n        //\n        onpointerdown: this.onpointerdown,\n        onpointermove: this.onpointermove,\n        onpointercancel: this.onpointercancel,\n        onpointerup: this.onpointerup,\n        oncontextmenu: this.oncontextmenu,\n        ...this.attachment,\n    }));\n}\nexport class MenuCheckboxGroupState {\n    static create(opts) {\n        return MenuCheckboxGroupContext.set(new MenuCheckboxGroupState(opts, MenuContentContext.get()));\n    }\n    opts;\n    content;\n    root;\n    attachment;\n    groupHeadingId = $state(null);\n    constructor(opts, content) {\n        this.opts = opts;\n        this.content = content;\n        this.root = content.parentMenu.root;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    addValue(checkboxValue) {\n        if (!checkboxValue)\n            return;\n        if (!this.opts.value.current.includes(checkboxValue)) {\n            const newValue = [...$state.snapshot(this.opts.value.current), checkboxValue];\n            this.opts.value.current = newValue;\n            this.opts.onValueChange.current(newValue);\n        }\n    }\n    removeValue(checkboxValue) {\n        if (!checkboxValue)\n            return;\n        const index = this.opts.value.current.indexOf(checkboxValue);\n        if (index === -1)\n            return;\n        const newValue = this.opts.value.current.filter((v) => v !== checkboxValue);\n        this.opts.value.current = newValue;\n        this.opts.onValueChange.current(newValue);\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"checkbox-group\")]: \"\",\n        role: \"group\",\n        \"aria-labelledby\": this.groupHeadingId,\n        ...this.attachment,\n    }));\n}\nexport class MenuSubmenuState {\n    static create(opts) {\n        const menu = MenuMenuContext.get();\n        return MenuMenuContext.set(new MenuMenuState(opts, menu.root, menu));\n    }\n}\n","import { afterSleep, afterTick, executeCallbacks, onDestroyEffect, } from \"svelte-toolbelt\";\nimport { watch } from \"runed\";\nimport { on } from \"svelte/events\";\nimport {} from \"../../../internal/events.js\";\nimport { debounce } from \"../../../internal/debounce.js\";\nimport { noop } from \"../../../internal/noop.js\";\nimport { getOwnerDocument, isOrContainsTarget } from \"../../../internal/elements.js\";\nimport { isElementOrSVGElement } from \"../../../internal/is.js\";\nimport { isClickTrulyOutside } from \"../../../internal/dom.js\";\nimport { CONTEXT_MENU_CONTENT_ATTR, CONTEXT_MENU_TRIGGER_ATTR, } from \"../../menu/menu.svelte.js\";\nglobalThis.bitsDismissableLayers ??= new Map();\nexport class DismissibleLayerState {\n    static create(opts) {\n        return new DismissibleLayerState(opts);\n    }\n    opts;\n    #interactOutsideProp;\n    #behaviorType;\n    #interceptedEvents = {\n        pointerdown: false,\n    };\n    #isResponsibleLayer = false;\n    #isFocusInsideDOMTree = false;\n    #documentObj = undefined;\n    #onFocusOutside;\n    #unsubClickListener = noop;\n    constructor(opts) {\n        this.opts = opts;\n        this.#behaviorType = opts.interactOutsideBehavior;\n        this.#interactOutsideProp = opts.onInteractOutside;\n        this.#onFocusOutside = opts.onFocusOutside;\n        $effect(() => {\n            this.#documentObj = getOwnerDocument(this.opts.ref.current);\n        });\n        let unsubEvents = noop;\n        const cleanup = () => {\n            this.#resetState();\n            globalThis.bitsDismissableLayers.delete(this);\n            this.#handleInteractOutside.destroy();\n            unsubEvents();\n        };\n        watch([() => this.opts.enabled.current, () => this.opts.ref.current], () => {\n            if (!this.opts.enabled.current || !this.opts.ref.current)\n                return;\n            afterSleep(1, () => {\n                if (!this.opts.ref.current)\n                    return;\n                globalThis.bitsDismissableLayers.set(this, this.#behaviorType);\n                unsubEvents();\n                unsubEvents = this.#addEventListeners();\n            });\n            return cleanup;\n        });\n        onDestroyEffect(() => {\n            this.#resetState.destroy();\n            globalThis.bitsDismissableLayers.delete(this);\n            this.#handleInteractOutside.destroy();\n            this.#unsubClickListener();\n            unsubEvents();\n        });\n    }\n    #handleFocus = (event) => {\n        if (event.defaultPrevented)\n            return;\n        if (!this.opts.ref.current)\n            return;\n        afterTick(() => {\n            if (!this.opts.ref.current || this.#isTargetWithinLayer(event.target))\n                return;\n            if (event.target && !this.#isFocusInsideDOMTree) {\n                this.#onFocusOutside.current?.(event);\n            }\n        });\n    };\n    #addEventListeners() {\n        return executeCallbacks(\n        /**\n         * CAPTURE INTERACTION START\n         * mark interaction-start event as intercepted.\n         * mark responsible layer during interaction start\n         * to avoid checking if is responsible layer during interaction end\n         * when a new floating element may have been opened.\n         */\n        on(this.#documentObj, \"pointerdown\", executeCallbacks(this.#markInterceptedEvent, this.#markResponsibleLayer), { capture: true }), \n        /**\n         * BUBBLE INTERACTION START\n         * Mark interaction-start event as non-intercepted. Debounce `onInteractOutsideStart`\n         * to avoid prematurely checking if other events were intercepted.\n         */\n        on(this.#documentObj, \"pointerdown\", executeCallbacks(this.#markNonInterceptedEvent, this.#handleInteractOutside)), \n        /**\n         * HANDLE FOCUS OUTSIDE\n         */\n        on(this.#documentObj, \"focusin\", this.#handleFocus));\n    }\n    #handleDismiss = (e) => {\n        let event = e;\n        if (event.defaultPrevented) {\n            event = createWrappedEvent(e);\n        }\n        this.#interactOutsideProp.current(e);\n    };\n    #handleInteractOutside = debounce((e) => {\n        if (!this.opts.ref.current) {\n            this.#unsubClickListener();\n            return;\n        }\n        const isEventValid = this.opts.isValidEvent.current(e, this.opts.ref.current) ||\n            isValidEvent(e, this.opts.ref.current);\n        if (!this.#isResponsibleLayer || this.#isAnyEventIntercepted() || !isEventValid) {\n            this.#unsubClickListener();\n            return;\n        }\n        let event = e;\n        if (event.defaultPrevented) {\n            event = createWrappedEvent(event);\n        }\n        if (this.#behaviorType.current !== \"close\" &&\n            this.#behaviorType.current !== \"defer-otherwise-close\") {\n            this.#unsubClickListener();\n            return;\n        }\n        if (e.pointerType === \"touch\") {\n            this.#unsubClickListener();\n            this.#unsubClickListener = on(this.#documentObj, \"click\", this.#handleDismiss, {\n                once: true,\n            });\n        }\n        else {\n            this.#interactOutsideProp.current(event);\n        }\n    }, 10);\n    #markInterceptedEvent = (e) => {\n        this.#interceptedEvents[e.type] = true;\n    };\n    #markNonInterceptedEvent = (e) => {\n        this.#interceptedEvents[e.type] = false;\n    };\n    #markResponsibleLayer = () => {\n        if (!this.opts.ref.current)\n            return;\n        this.#isResponsibleLayer = isResponsibleLayer(this.opts.ref.current);\n    };\n    #isTargetWithinLayer = (target) => {\n        if (!this.opts.ref.current)\n            return false;\n        return isOrContainsTarget(this.opts.ref.current, target);\n    };\n    #resetState = debounce(() => {\n        for (const eventType in this.#interceptedEvents) {\n            this.#interceptedEvents[eventType] = false;\n        }\n        this.#isResponsibleLayer = false;\n    }, 20);\n    #isAnyEventIntercepted() {\n        const i = Object.values(this.#interceptedEvents).some(Boolean);\n        return i;\n    }\n    #onfocuscapture = () => {\n        this.#isFocusInsideDOMTree = true;\n    };\n    #onblurcapture = () => {\n        this.#isFocusInsideDOMTree = false;\n    };\n    props = {\n        onfocuscapture: this.#onfocuscapture,\n        onblurcapture: this.#onblurcapture,\n    };\n}\nexport function getTopMostDismissableLayer(layersArr = [\n    ...globalThis.bitsDismissableLayers,\n]) {\n    return layersArr.findLast(([_, { current: behaviorType }]) => behaviorType === \"close\" || behaviorType === \"ignore\");\n}\nfunction isResponsibleLayer(node) {\n    const layersArr = [...globalThis.bitsDismissableLayers];\n    /**\n     * We first check if we can find a top layer with `close` or `ignore`.\n     * If that top layer was found and matches the provided node, then the node is\n     * responsible for the outside interaction. Otherwise, we know that all layers defer so\n     * the first layer is the responsible one.\n     */\n    const topMostLayer = getTopMostDismissableLayer(layersArr);\n    if (topMostLayer)\n        return topMostLayer[0].opts.ref.current === node;\n    const [firstLayerNode] = layersArr[0];\n    return firstLayerNode.opts.ref.current === node;\n}\nfunction isValidEvent(e, node) {\n    const target = e.target;\n    if (!isElementOrSVGElement(target))\n        return false;\n    const targetIsContextMenuTrigger = Boolean(target.closest(`[${CONTEXT_MENU_TRIGGER_ATTR}]`));\n    if (\"button\" in e && e.button > 0 && !targetIsContextMenuTrigger)\n        return false;\n    if (\"button\" in e && e.button === 0 && targetIsContextMenuTrigger)\n        return true;\n    const nodeIsContextMenu = Boolean(node.closest(`[${CONTEXT_MENU_CONTENT_ATTR}]`));\n    if (targetIsContextMenuTrigger && nodeIsContextMenu)\n        return false;\n    const ownerDocument = getOwnerDocument(target);\n    const isValid = ownerDocument.documentElement.contains(target) &&\n        !isOrContainsTarget(node, target) &&\n        isClickTrulyOutside(e, node);\n    return isValid;\n}\nfunction createWrappedEvent(e) {\n    const capturedCurrentTarget = e.currentTarget;\n    const capturedTarget = e.target;\n    let newEvent;\n    if (e instanceof PointerEvent) {\n        newEvent = new PointerEvent(e.type, e);\n    }\n    else {\n        newEvent = new PointerEvent(\"pointerdown\", e);\n    }\n    // track the prevented state separately\n    let isPrevented = false;\n    // Create a proxy to intercept property access and method calls\n    const wrappedEvent = new Proxy(newEvent, {\n        get: (target, prop) => {\n            if (prop === \"currentTarget\") {\n                return capturedCurrentTarget;\n            }\n            if (prop === \"target\") {\n                return capturedTarget;\n            }\n            if (prop === \"preventDefault\") {\n                return () => {\n                    isPrevented = true;\n                    if (typeof target.preventDefault === \"function\") {\n                        target.preventDefault();\n                    }\n                };\n            }\n            if (prop === \"defaultPrevented\") {\n                return isPrevented;\n            }\n            if (prop in target) {\n                // oxlint-disable-next-line no-explicit-any\n                return target[prop];\n            }\n            // oxlint-disable-next-line no-explicit-any\n            return e[prop];\n        },\n    });\n    return wrappedEvent;\n}\n","export function getFirstNonCommentChild(element) {\n    if (!element)\n        return null;\n    for (const child of element.childNodes) {\n        if (child.nodeType !== Node.COMMENT_NODE) {\n            return child;\n        }\n    }\n    return null;\n}\n/**\n * Determines if the click event truly occurred outside the content node.\n * This was added to handle password managers and other elements that may be injected\n * into the DOM but visually appear inside the content.\n */\nexport function isClickTrulyOutside(event, contentNode) {\n    const { clientX, clientY } = event;\n    const rect = contentNode.getBoundingClientRect();\n    return (clientX < rect.left || clientX > rect.right || clientY < rect.top || clientY > rect.bottom);\n}\n","/**\n * A utility function that executes a callback after a specified number of milliseconds.\n */\nexport function afterSleep(ms, cb) {\n    return setTimeout(cb, ms);\n}\n","import { DOMContext } from \"svelte-toolbelt\";\nimport { watch } from \"runed\";\nimport { on } from \"svelte/events\";\nimport { kbd } from \"../../../internal/kbd.js\";\nimport { noop } from \"../../../internal/noop.js\";\nglobalThis.bitsEscapeLayers ??= new Map();\nexport class EscapeLayerState {\n    static create(opts) {\n        return new EscapeLayerState(opts);\n    }\n    opts;\n    domContext;\n    constructor(opts) {\n        this.opts = opts;\n        this.domContext = new DOMContext(this.opts.ref);\n        let unsubEvents = noop;\n        watch(() => opts.enabled.current, (enabled) => {\n            if (enabled) {\n                globalThis.bitsEscapeLayers.set(this, opts.escapeKeydownBehavior);\n                unsubEvents = this.#addEventListener();\n            }\n            return () => {\n                unsubEvents();\n                globalThis.bitsEscapeLayers.delete(this);\n            };\n        });\n    }\n    #addEventListener = () => {\n        return on(this.domContext.getDocument(), \"keydown\", this.#onkeydown, { passive: false });\n    };\n    #onkeydown = (e) => {\n        if (e.key !== kbd.ESCAPE || !isResponsibleEscapeLayer(this))\n            return;\n        const clonedEvent = new KeyboardEvent(e.type, e);\n        e.preventDefault();\n        const behaviorType = this.opts.escapeKeydownBehavior.current;\n        if (behaviorType !== \"close\" && behaviorType !== \"defer-otherwise-close\")\n            return;\n        this.opts.onEscapeKeydown.current(clonedEvent);\n    };\n}\nfunction isResponsibleEscapeLayer(instance) {\n    const layersArr = [...globalThis.bitsEscapeLayers];\n    /**\n     * We first check if we can find a top layer with `close` or `ignore`.\n     * If that top layer was found and matches the provided node, then the node is\n     * responsible for the escape. Otherwise, we know that all layers defer so\n     * the first layer is the responsible one.\n     */\n    const topMostLayer = layersArr.findLast(([_, { current: behaviorType }]) => behaviorType === \"close\" || behaviorType === \"ignore\");\n    if (topMostLayer)\n        return topMostLayer[0] === instance;\n    const [firstLayerNode] = layersArr[0];\n    return firstLayerNode === instance;\n}\n","import { simpleBox } from \"svelte-toolbelt\";\nimport { FocusScope } from \"./focus-scope.svelte.js\";\nexport class FocusScopeManager {\n    static instance;\n    #scopeStack = simpleBox([]);\n    #focusHistory = new WeakMap();\n    #preFocusHistory = new WeakMap();\n    static getInstance() {\n        if (!this.instance) {\n            this.instance = new FocusScopeManager();\n        }\n        return this.instance;\n    }\n    register(scope) {\n        const current = this.getActive();\n        if (current && current !== scope) {\n            current.pause();\n        }\n        // capture the currently focused element before this scope becomes active\n        const activeElement = document.activeElement;\n        if (activeElement && activeElement !== document.body) {\n            this.#preFocusHistory.set(scope, activeElement);\n        }\n        this.#scopeStack.current = this.#scopeStack.current.filter((s) => s !== scope);\n        this.#scopeStack.current.unshift(scope);\n    }\n    unregister(scope) {\n        this.#scopeStack.current = this.#scopeStack.current.filter((s) => s !== scope);\n        const next = this.getActive();\n        if (next) {\n            next.resume();\n        }\n    }\n    getActive() {\n        return this.#scopeStack.current[0];\n    }\n    setFocusMemory(scope, element) {\n        this.#focusHistory.set(scope, element);\n    }\n    getFocusMemory(scope) {\n        return this.#focusHistory.get(scope);\n    }\n    isActiveScope(scope) {\n        return this.getActive() === scope;\n    }\n    setPreFocusMemory(scope, element) {\n        this.#preFocusHistory.set(scope, element);\n    }\n    getPreFocusMemory(scope) {\n        return this.#preFocusHistory.get(scope);\n    }\n    clearPreFocusMemory(scope) {\n        this.#preFocusHistory.delete(scope);\n    }\n}\n","import { onDestroyEffect } from \"svelte-toolbelt\";\nimport { FocusScopeManager } from \"./focus-scope-manager.js\";\nimport { focusable, isFocusable, tabbable } from \"tabbable\";\nimport { on } from \"svelte/events\";\nimport { watch } from \"runed\";\nexport class FocusScope {\n    #paused = false;\n    #container = null;\n    #manager = FocusScopeManager.getInstance();\n    #cleanupFns = [];\n    #opts;\n    constructor(opts) {\n        this.#opts = opts;\n    }\n    get paused() {\n        return this.#paused;\n    }\n    pause() {\n        this.#paused = true;\n    }\n    resume() {\n        this.#paused = false;\n    }\n    #cleanup() {\n        for (const fn of this.#cleanupFns) {\n            fn();\n        }\n        this.#cleanupFns = [];\n    }\n    mount(container) {\n        if (this.#container) {\n            this.unmount();\n        }\n        this.#container = container;\n        this.#manager.register(this);\n        this.#setupEventListeners();\n        this.#handleOpenAutoFocus();\n    }\n    unmount() {\n        if (!this.#container)\n            return;\n        this.#cleanup();\n        // handle close auto-focus\n        this.#handleCloseAutoFocus();\n        this.#manager.unregister(this);\n        this.#manager.clearPreFocusMemory(this);\n        this.#container = null;\n    }\n    #handleOpenAutoFocus() {\n        if (!this.#container)\n            return;\n        const event = new CustomEvent(\"focusScope.onOpenAutoFocus\", {\n            bubbles: false,\n            cancelable: true,\n        });\n        this.#opts.onOpenAutoFocus.current(event);\n        if (!event.defaultPrevented) {\n            requestAnimationFrame(() => {\n                if (!this.#container)\n                    return;\n                const firstTabbable = this.#getFirstTabbable();\n                if (firstTabbable) {\n                    firstTabbable.focus();\n                    this.#manager.setFocusMemory(this, firstTabbable);\n                }\n                else {\n                    this.#container.focus();\n                }\n            });\n        }\n    }\n    #handleCloseAutoFocus() {\n        const event = new CustomEvent(\"focusScope.onCloseAutoFocus\", {\n            bubbles: false,\n            cancelable: true,\n        });\n        this.#opts.onCloseAutoFocus.current?.(event);\n        if (!event.defaultPrevented) {\n            // return focus to the element that was focused before this scope opened\n            const preFocusedElement = this.#manager.getPreFocusMemory(this);\n            if (preFocusedElement && document.contains(preFocusedElement)) {\n                // ensure the element is still focusable and in the document\n                try {\n                    preFocusedElement.focus();\n                }\n                catch {\n                    // fallback if focus fails\n                    document.body.focus();\n                }\n            }\n        }\n    }\n    #setupEventListeners() {\n        if (!this.#container || !this.#opts.trap.current)\n            return;\n        const container = this.#container;\n        const doc = container.ownerDocument;\n        const handleFocus = (e) => {\n            if (this.#paused || !this.#manager.isActiveScope(this))\n                return;\n            const target = e.target;\n            if (!target)\n                return;\n            const isInside = container.contains(target);\n            if (isInside) {\n                // store last focused element\n                this.#manager.setFocusMemory(this, target);\n            }\n            else {\n                // focus escaped - bring it back\n                const lastFocused = this.#manager.getFocusMemory(this);\n                if (lastFocused && container.contains(lastFocused) && isFocusable(lastFocused)) {\n                    e.preventDefault();\n                    lastFocused.focus();\n                }\n                else {\n                    // fallback to first tabbable or first focusable or container\n                    const firstTabbable = this.#getFirstTabbable();\n                    const firstFocusable = this.#getAllFocusables()[0];\n                    (firstTabbable || firstFocusable || container).focus();\n                }\n            }\n        };\n        const handleKeydown = (e) => {\n            if (!this.#opts.loop || this.#paused || e.key !== \"Tab\")\n                return;\n            if (!this.#manager.isActiveScope(this))\n                return;\n            const tabbables = this.#getTabbables();\n            if (tabbables.length < 2)\n                return;\n            const first = tabbables[0];\n            const last = tabbables[tabbables.length - 1];\n            if (!e.shiftKey && doc.activeElement === last) {\n                e.preventDefault();\n                first.focus();\n            }\n            else if (e.shiftKey && doc.activeElement === first) {\n                e.preventDefault();\n                last.focus();\n            }\n        };\n        this.#cleanupFns.push(on(doc, \"focusin\", handleFocus, { capture: true }), on(container, \"keydown\", handleKeydown));\n        const observer = new MutationObserver(() => {\n            const lastFocused = this.#manager.getFocusMemory(this);\n            if (lastFocused && !container.contains(lastFocused)) {\n                // last focused element was removed\n                const firstTabbable = this.#getFirstTabbable();\n                const firstFocusable = this.#getAllFocusables()[0];\n                const elementToFocus = firstTabbable || firstFocusable;\n                if (elementToFocus) {\n                    elementToFocus.focus();\n                    this.#manager.setFocusMemory(this, elementToFocus);\n                }\n                else {\n                    // no focusable elements left, focus container\n                    container.focus();\n                }\n            }\n        });\n        observer.observe(container, {\n            childList: true,\n            subtree: true,\n        });\n        this.#cleanupFns.push(() => observer.disconnect());\n    }\n    #getTabbables() {\n        if (!this.#container)\n            return [];\n        return tabbable(this.#container, {\n            includeContainer: false,\n            getShadowRoot: true,\n        });\n    }\n    #getFirstTabbable() {\n        const tabbables = this.#getTabbables();\n        return tabbables[0] || null;\n    }\n    #getAllFocusables() {\n        if (!this.#container)\n            return [];\n        return focusable(this.#container, {\n            includeContainer: false,\n            getShadowRoot: true,\n        });\n    }\n    static use(opts) {\n        let scope = null;\n        watch([() => opts.ref.current, () => opts.enabled.current], ([ref, enabled]) => {\n            if (ref && enabled) {\n                if (!scope) {\n                    scope = new FocusScope(opts);\n                }\n                scope.mount(ref);\n            }\n            else if (scope) {\n                scope.unmount();\n                scope = null;\n            }\n        });\n        onDestroyEffect(() => {\n            scope?.unmount();\n        });\n        return {\n            get props() {\n                return {\n                    tabindex: -1,\n                };\n            },\n        };\n    }\n}\n","import { DOMContext, composeHandlers, contains, executeCallbacks, } from \"svelte-toolbelt\";\nimport { watch } from \"runed\";\nimport { on } from \"svelte/events\";\nimport { noop } from \"../../../internal/noop.js\";\nimport { isHTMLElement } from \"../../../internal/is.js\";\nglobalThis.bitsTextSelectionLayers ??= new Map();\nexport class TextSelectionLayerState {\n    static create(opts) {\n        return new TextSelectionLayerState(opts);\n    }\n    opts;\n    domContext;\n    #unsubSelectionLock = noop;\n    constructor(opts) {\n        this.opts = opts;\n        this.domContext = new DOMContext(opts.ref);\n        let unsubEvents = noop;\n        watch(() => this.opts.enabled.current, (isEnabled) => {\n            if (isEnabled) {\n                globalThis.bitsTextSelectionLayers.set(this, this.opts.enabled);\n                unsubEvents();\n                unsubEvents = this.#addEventListeners();\n            }\n            return () => {\n                unsubEvents();\n                this.#resetSelectionLock();\n                globalThis.bitsTextSelectionLayers.delete(this);\n            };\n        });\n    }\n    #addEventListeners() {\n        return executeCallbacks(on(this.domContext.getDocument(), \"pointerdown\", this.#pointerdown), on(this.domContext.getDocument(), \"pointerup\", composeHandlers(this.#resetSelectionLock, this.opts.onPointerUp.current)));\n    }\n    #pointerdown = (e) => {\n        const node = this.opts.ref.current;\n        const target = e.target;\n        if (!isHTMLElement(node) || !isHTMLElement(target) || !this.opts.enabled.current)\n            return;\n        /**\n         * We only lock user-selection overflow if layer is the top most layer and\n         * pointerdown occurred inside the node. You are still allowed to select text\n         * outside the node provided pointerdown occurs outside the node.\n         */\n        if (!isHighestLayer(this) || !contains(node, target))\n            return;\n        this.opts.onPointerDown.current(e);\n        if (e.defaultPrevented)\n            return;\n        this.#unsubSelectionLock = preventTextSelectionOverflow(node, this.domContext.getDocument().body);\n    };\n    #resetSelectionLock = () => {\n        this.#unsubSelectionLock();\n        this.#unsubSelectionLock = noop;\n    };\n}\nconst getUserSelect = (node) => node.style.userSelect || node.style.webkitUserSelect;\nfunction preventTextSelectionOverflow(node, body) {\n    const originalBodyUserSelect = getUserSelect(body);\n    const originalNodeUserSelect = getUserSelect(node);\n    setUserSelect(body, \"none\");\n    setUserSelect(node, \"text\");\n    return () => {\n        setUserSelect(body, originalBodyUserSelect);\n        setUserSelect(node, originalNodeUserSelect);\n    };\n}\nfunction setUserSelect(node, value) {\n    node.style.userSelect = value;\n    node.style.webkitUserSelect = value;\n}\nfunction isHighestLayer(instance) {\n    const layersArr = [...globalThis.bitsTextSelectionLayers];\n    if (!layersArr.length)\n        return false;\n    const highestLayer = layersArr.at(-1);\n    if (!highestLayer)\n        return false;\n    return highestLayer[0] === instance;\n}\n","globalThis.bitsIdCounter ??= { current: 0 };\n/**\n * Generates a unique ID based on a global counter.\n */\nexport function useId(prefix = \"bits\") {\n    globalThis.bitsIdCounter.current++;\n    return `${prefix}-${globalThis.bitsIdCounter.current}`;\n}\n","export class SharedState {\n    #factory;\n    #subscribers = 0;\n    #state = $state();\n    #scope;\n    constructor(factory) {\n        this.#factory = factory;\n    }\n    #dispose() {\n        this.#subscribers -= 1;\n        if (this.#scope && this.#subscribers <= 0) {\n            this.#scope();\n            this.#state = undefined;\n            this.#scope = undefined;\n        }\n    }\n    get(...args) {\n        this.#subscribers += 1;\n        if (this.#state === undefined) {\n            this.#scope = $effect.root(() => {\n                this.#state = this.#factory(...args);\n            });\n        }\n        $effect(() => {\n            return () => {\n                this.#dispose();\n            };\n        });\n        return this.#state;\n    }\n}\n","import { SvelteMap } from \"svelte/reactivity\";\nimport { afterTick, boxWith, onDestroyEffect, } from \"svelte-toolbelt\";\nimport { isIOS } from \"./is.js\";\nimport { useId } from \"./use-id.js\";\nimport { watch } from \"runed\";\nimport { SharedState } from \"./shared-state.svelte.js\";\nimport { BROWSER } from \"esm-env\";\nimport { on } from \"svelte/events\";\n/** A map of lock ids to their `locked` state. */\nconst lockMap = new SvelteMap();\nlet initialBodyStyle = $state(null);\nlet stopTouchMoveListener = null;\nlet cleanupTimeoutId = null;\nlet isInCleanupTransition = false;\nconst anyLocked = boxWith(() => {\n    for (const value of lockMap.values()) {\n        if (value)\n            return true;\n    }\n    return false;\n});\n/**\n * We track the time we scheduled the cleanup to prevent race conditions\n * when multiple locks are created/destroyed in the same tick, ensuring\n * only the last one to schedule the cleanup will run.\n *\n * reference: https://github.com/huntabyte/bits-ui/issues/1639\n */\nlet cleanupScheduledAt = null;\nconst bodyLockStackCount = new SharedState(() => {\n    function resetBodyStyle() {\n        if (!BROWSER)\n            return;\n        document.body.setAttribute(\"style\", initialBodyStyle ?? \"\");\n        document.body.style.removeProperty(\"--scrollbar-width\");\n        isIOS && stopTouchMoveListener?.();\n        // reset initialBodyStyle so next locker captures the correct styles\n        initialBodyStyle = null;\n    }\n    function cancelPendingCleanup() {\n        if (cleanupTimeoutId === null)\n            return;\n        window.clearTimeout(cleanupTimeoutId);\n        cleanupTimeoutId = null;\n    }\n    function scheduleCleanupIfNoNewLocks(delay, callback) {\n        cancelPendingCleanup();\n        isInCleanupTransition = true;\n        cleanupScheduledAt = Date.now();\n        const currentCleanupId = cleanupScheduledAt;\n        /**\n         * We schedule the cleanup to run after a delay to allow new locks to register\n         * that might have been added in the same tick as the current cleanup.\n         *\n         * If a new lock is added in the same tick, the cleanup will be cancelled and\n         * a new cleanup will be scheduled.\n         *\n         * This is to prevent the cleanup from running too early and resetting the body\n         * style before the new lock has had a chance to apply its styles.\n         */\n        const cleanupFn = () => {\n            cleanupTimeoutId = null;\n            // check if this cleanup is still valid (no newer cleanups scheduled)\n            if (cleanupScheduledAt !== currentCleanupId)\n                return;\n            // ensure no new locks were added during the delay\n            if (!isAnyLocked(lockMap)) {\n                isInCleanupTransition = false;\n                callback();\n            }\n            else {\n                isInCleanupTransition = false;\n            }\n        };\n        const actualDelay = delay === null ? 24 : delay;\n        cleanupTimeoutId = window.setTimeout(cleanupFn, actualDelay);\n    }\n    function ensureInitialStyleCaptured() {\n        // only capture initial style once, when no locks exist and no cleanup is in progress\n        if (initialBodyStyle === null && lockMap.size === 0 && !isInCleanupTransition) {\n            initialBodyStyle = document.body.getAttribute(\"style\");\n        }\n    }\n    watch(() => anyLocked.current, () => {\n        if (!anyLocked.current)\n            return;\n        // ensure we've captured the initial style before applying any lock styles\n        ensureInitialStyleCaptured();\n        // if we're applying lock styles, we're no longer in a cleanup transition\n        isInCleanupTransition = false;\n        const bodyStyle = getComputedStyle(document.body);\n        // TODO: account for RTL direction, etc.\n        const verticalScrollbarWidth = window.innerWidth - document.documentElement.clientWidth;\n        const paddingRight = Number.parseInt(bodyStyle.paddingRight ?? \"0\", 10);\n        const config = {\n            padding: paddingRight + verticalScrollbarWidth,\n            margin: Number.parseInt(bodyStyle.marginRight ?? \"0\", 10),\n        };\n        if (verticalScrollbarWidth > 0) {\n            document.body.style.paddingRight = `${config.padding}px`;\n            document.body.style.marginRight = `${config.margin}px`;\n            document.body.style.setProperty(\"--scrollbar-width\", `${verticalScrollbarWidth}px`);\n            document.body.style.overflow = \"hidden\";\n        }\n        if (isIOS) {\n            // IOS devices are special and require a touchmove listener to prevent scrolling\n            stopTouchMoveListener = on(document, \"touchmove\", (e) => {\n                if (e.target !== document.documentElement)\n                    return;\n                if (e.touches.length > 1)\n                    return;\n                e.preventDefault();\n            }, { passive: false });\n        }\n        /**\n         * We ensure pointer-events: none is applied _after_ DOM updates, so that any focus/\n         * interaction changes from opening overlays/menus complete _before_ we block pointer\n         * events.\n         *\n         * this avoids race conditions where pointer-events could be set too early and break\n         * focus/interaction.\n         */\n        afterTick(() => {\n            document.body.style.pointerEvents = \"none\";\n            document.body.style.overflow = \"hidden\";\n        });\n    });\n    onDestroyEffect(() => {\n        return () => {\n            stopTouchMoveListener?.();\n        };\n    });\n    return {\n        get lockMap() {\n            return lockMap;\n        },\n        resetBodyStyle,\n        scheduleCleanupIfNoNewLocks,\n        cancelPendingCleanup,\n        ensureInitialStyleCaptured,\n    };\n});\nexport class BodyScrollLock {\n    #id = useId();\n    #initialState;\n    #restoreScrollDelay = () => null;\n    #countState;\n    locked;\n    constructor(initialState, restoreScrollDelay = () => null) {\n        this.#initialState = initialState;\n        this.#restoreScrollDelay = restoreScrollDelay;\n        this.#countState = bodyLockStackCount.get();\n        if (!this.#countState)\n            return;\n        /**\n         * Since a new lock is being created, we cancel any pending cleanup to\n         * prevent the cleanup from running too early and resetting the body style\n         * before the new lock has had a chance to apply its styles.\n         *\n         * reference: https://github.com/huntabyte/bits-ui/issues/1639\n         */\n        this.#countState.cancelPendingCleanup();\n        // capture initial style before this lock is registered\n        this.#countState.ensureInitialStyleCaptured();\n        this.#countState.lockMap.set(this.#id, this.#initialState ?? false);\n        this.locked = boxWith(() => this.#countState.lockMap.get(this.#id) ?? false, (v) => this.#countState.lockMap.set(this.#id, v));\n        onDestroyEffect(() => {\n            this.#countState.lockMap.delete(this.#id);\n            // if not the last lock, we don't need to do anything\n            if (isAnyLocked(this.#countState.lockMap))\n                return;\n            const restoreScrollDelay = this.#restoreScrollDelay();\n            /**\n             * We schedule the cleanup to run after a delay to handle same-tick\n             * destroy/create scenarios.\n             *\n             * reference: https://github.com/huntabyte/bits-ui/issues/1639\n             */\n            this.#countState.scheduleCleanupIfNoNewLocks(restoreScrollDelay, () => {\n                this.#countState.resetBodyStyle();\n            });\n        });\n    }\n}\nfunction isAnyLocked(map) {\n    for (const [_, value] of map) {\n        if (value)\n            return true;\n    }\n    return false;\n}\n","<script lang=\"ts\">\n\timport type { ScrollLockProps } from \"./index.js\";\n\timport { BodyScrollLock } from \"../../../internal/body-scroll-lock.svelte.js\";\n\n\tlet { preventScroll = true, restoreScrollDelay = null }: ScrollLockProps = $props();\n\n\tif (preventScroll) {\n\t\tnew BodyScrollLock(preventScroll, () => restoreScrollDelay);\n\t}\n</script>\n","<script lang=\"ts\">\n\timport { boxWith, mergeProps } from \"svelte-toolbelt\";\n\timport { DialogOverlayState } from \"../dialog.svelte.js\";\n\timport type { DialogOverlayProps } from \"../types.js\";\n\timport { createId } from \"../../../internal/create-id.js\";\n\n\tconst uid = $props.id();\n\n\tlet {\n\t\tid = createId(uid),\n\t\tforceMount = false,\n\t\tchild,\n\t\tchildren,\n\t\tref = $bindable(null),\n\t\t...restProps\n\t}: DialogOverlayProps = $props();\n\n\tconst overlayState = DialogOverlayState.create({\n\t\tid: boxWith(() => id),\n\t\tref: boxWith(\n\t\t\t() => ref,\n\t\t\t(v) => (ref = v)\n\t\t),\n\t});\n\n\tconst mergedProps = $derived(mergeProps(restProps, overlayState.props));\n</script>\n\n{#if overlayState.shouldRender || forceMount}\n\t{#if child}\n\t\t{@render child({ props: mergeProps(mergedProps), ...overlayState.snippetProps })}\n\t{:else}\n\t\t<div {...mergeProps(mergedProps)}>\n\t\t\t{@render children?.(overlayState.snippetProps)}\n\t\t</div>\n\t{/if}\n{/if}\n","<script lang=\"ts\">\n\timport { boxWith, mergeProps } from \"svelte-toolbelt\";\n\timport { DialogDescriptionState } from \"../dialog.svelte.js\";\n\timport type { DialogDescriptionProps } from \"../types.js\";\n\timport { createId } from \"../../../internal/create-id.js\";\n\n\tconst uid = $props.id();\n\n\tlet {\n\t\tid = createId(uid),\n\t\tchildren,\n\t\tchild,\n\t\tref = $bindable(null),\n\t\t...restProps\n\t}: DialogDescriptionProps = $props();\n\n\tconst descriptionState = DialogDescriptionState.create({\n\t\tid: boxWith(() => id),\n\t\tref: boxWith(\n\t\t\t() => ref,\n\t\t\t(v) => (ref = v)\n\t\t),\n\t});\n\n\tconst mergedProps = $derived(mergeProps(restProps, descriptionState.props));\n</script>\n\n{#if child}\n\t{@render child({ props: mergedProps })}\n{:else}\n\t<div {...mergedProps}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport { boxWith } from \"svelte-toolbelt\";\n\timport { DialogRootState } from \"../dialog.svelte.js\";\n\timport type { DialogRootProps } from \"../types.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\n\tlet {\n\t\topen = $bindable(false),\n\t\tonOpenChange = noop,\n\t\tonOpenChangeComplete = noop,\n\t\tchildren,\n\t}: DialogRootProps = $props();\n\n\tDialogRootState.create({\n\t\tvariant: boxWith(() => \"dialog\"),\n\t\topen: boxWith(\n\t\t\t() => open,\n\t\t\t(v) => {\n\t\t\t\topen = v;\n\t\t\t\tonOpenChange(v);\n\t\t\t}\n\t\t),\n\t\tonOpenChangeComplete: boxWith(() => onOpenChangeComplete),\n\t});\n</script>\n\n{@render children?.()}\n","<script lang=\"ts\">\n\timport { boxWith, mergeProps } from \"svelte-toolbelt\";\n\timport { DialogCloseState } from \"../dialog.svelte.js\";\n\timport type { DialogCloseProps } from \"../types.js\";\n\timport { createId } from \"../../../internal/create-id.js\";\n\n\tconst uid = $props.id();\n\n\tlet {\n\t\tchildren,\n\t\tchild,\n\t\tid = createId(uid),\n\t\tref = $bindable(null),\n\t\tdisabled = false,\n\t\t...restProps\n\t}: DialogCloseProps = $props();\n\n\tconst closeState = DialogCloseState.create({\n\t\tvariant: boxWith(() => \"close\"),\n\t\tid: boxWith(() => id),\n\t\tref: boxWith(\n\t\t\t() => ref,\n\t\t\t(v) => (ref = v)\n\t\t),\n\t\tdisabled: boxWith(() => Boolean(disabled)),\n\t});\n\n\tconst mergedProps = $derived(mergeProps(restProps, closeState.props));\n</script>\n\n{#if child}\n\t{@render child({ props: mergedProps })}\n{:else}\n\t<button {...mergedProps}>\n\t\t{@render children?.()}\n\t</button>\n{/if}\n","<script lang=\"ts\">\n\timport { boxWith, mergeProps } from \"svelte-toolbelt\";\n\timport { DialogContentState } from \"../dialog.svelte.js\";\n\timport type { DialogContentProps } from \"../types.js\";\n\timport DismissibleLayer from \"../../utilities/dismissible-layer/dismissible-layer.svelte\";\n\timport EscapeLayer from \"../../utilities/escape-layer/escape-layer.svelte\";\n\timport FocusScope from \"../../utilities/focus-scope/focus-scope.svelte\";\n\timport TextSelectionLayer from \"../../utilities/text-selection-layer/text-selection-layer.svelte\";\n\timport { createId } from \"../../../internal/create-id.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\timport ScrollLock from \"../../utilities/scroll-lock/scroll-lock.svelte\";\n\tconst uid = $props.id();\n\n\tlet {\n\t\tid = createId(uid),\n\t\tchildren,\n\t\tchild,\n\t\tref = $bindable(null),\n\t\tforceMount = false,\n\t\tonCloseAutoFocus = noop,\n\t\tonOpenAutoFocus = noop,\n\t\tonEscapeKeydown = noop,\n\t\tonInteractOutside = noop,\n\t\ttrapFocus = true,\n\t\tpreventScroll = true,\n\t\trestoreScrollDelay = null,\n\t\t...restProps\n\t}: DialogContentProps = $props();\n\n\tconst contentState = DialogContentState.create({\n\t\tid: boxWith(() => id),\n\t\tref: boxWith(\n\t\t\t() => ref,\n\t\t\t(v) => (ref = v)\n\t\t),\n\t});\n\n\tconst mergedProps = $derived(mergeProps(restProps, contentState.props));\n</script>\n\n{#if contentState.shouldRender || forceMount}\n\t<FocusScope\n\t\tref={contentState.opts.ref}\n\t\tloop\n\t\t{trapFocus}\n\t\tenabled={contentState.root.opts.open.current}\n\t\t{onOpenAutoFocus}\n\t\t{onCloseAutoFocus}\n\t>\n\t\t{#snippet focusScope({ props: focusScopeProps })}\n\t\t\t<EscapeLayer\n\t\t\t\t{...mergedProps}\n\t\t\t\tenabled={contentState.root.opts.open.current}\n\t\t\t\tref={contentState.opts.ref}\n\t\t\t\tonEscapeKeydown={(e) => {\n\t\t\t\t\tonEscapeKeydown(e);\n\t\t\t\t\tif (e.defaultPrevented) return;\n\t\t\t\t\tcontentState.root.handleClose();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<DismissibleLayer\n\t\t\t\t\t{...mergedProps}\n\t\t\t\t\tref={contentState.opts.ref}\n\t\t\t\t\tenabled={contentState.root.opts.open.current}\n\t\t\t\t\tonInteractOutside={(e) => {\n\t\t\t\t\t\tonInteractOutside(e);\n\t\t\t\t\t\tif (e.defaultPrevented) return;\n\t\t\t\t\t\tcontentState.root.handleClose();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<TextSelectionLayer\n\t\t\t\t\t\t{...mergedProps}\n\t\t\t\t\t\tref={contentState.opts.ref}\n\t\t\t\t\t\tenabled={contentState.root.opts.open.current}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if child}\n\t\t\t\t\t\t\t{#if contentState.root.opts.open.current}\n\t\t\t\t\t\t\t\t<ScrollLock {preventScroll} {restoreScrollDelay} />\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t{@render child({\n\t\t\t\t\t\t\t\tprops: mergeProps(mergedProps, focusScopeProps),\n\t\t\t\t\t\t\t\t...contentState.snippetProps,\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<ScrollLock {preventScroll} />\n\t\t\t\t\t\t\t<div {...mergeProps(mergedProps, focusScopeProps)}>\n\t\t\t\t\t\t\t\t{@render children?.()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</TextSelectionLayer>\n\t\t\t\t</DismissibleLayer>\n\t\t\t</EscapeLayer>\n\t\t{/snippet}\n\t</FocusScope>\n{/if}\n","<script lang=\"ts\">\n\timport { boxWith } from \"svelte-toolbelt\";\n\timport type { EscapeLayerImplProps } from \"./types.js\";\n\timport { EscapeLayerState } from \"./use-escape-layer.svelte.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\n\tlet {\n\t\tescapeKeydownBehavior = \"close\",\n\t\tonEscapeKeydown = noop,\n\t\tchildren,\n\t\tenabled,\n\t\tref,\n\t}: EscapeLayerImplProps = $props();\n\n\tEscapeLayerState.create({\n\t\tescapeKeydownBehavior: boxWith(() => escapeKeydownBehavior),\n\t\tonEscapeKeydown: boxWith(() => onEscapeKeydown),\n\t\tenabled: boxWith(() => enabled),\n\t\tref,\n\t});\n</script>\n\n{@render children?.()}\n","<script lang=\"ts\">\n\timport { boxWith } from \"svelte-toolbelt\";\n\timport type { DismissibleLayerImplProps } from \"./types.js\";\n\timport { DismissibleLayerState } from \"./use-dismissable-layer.svelte.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\n\tlet {\n\t\tinteractOutsideBehavior = \"close\",\n\t\tonInteractOutside = noop,\n\t\tonFocusOutside = noop,\n\t\tid,\n\t\tchildren,\n\t\tenabled,\n\t\tisValidEvent = () => false,\n\t\tref,\n\t}: DismissibleLayerImplProps = $props();\n\n\tconst dismissibleLayerState = DismissibleLayerState.create({\n\t\tid: boxWith(() => id),\n\t\tinteractOutsideBehavior: boxWith(() => interactOutsideBehavior),\n\t\tonInteractOutside: boxWith(() => onInteractOutside),\n\t\tenabled: boxWith(() => enabled),\n\t\tonFocusOutside: boxWith(() => onFocusOutside),\n\t\tisValidEvent: boxWith(() => isValidEvent),\n\t\tref,\n\t});\n</script>\n\n{@render children?.({ props: dismissibleLayerState.props })}\n","<script lang=\"ts\">\n\timport { boxWith } from \"svelte-toolbelt\";\n\timport type { TextSelectionLayerImplProps } from \"./types.js\";\n\timport { TextSelectionLayerState } from \"./use-text-selection-layer.svelte.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\n\tlet {\n\t\tpreventOverflowTextSelection = true,\n\t\tonPointerDown = noop,\n\t\tonPointerUp = noop,\n\t\tid,\n\t\tchildren,\n\t\tenabled,\n\t\tref,\n\t}: TextSelectionLayerImplProps = $props();\n\n\tTextSelectionLayerState.create({\n\t\tid: boxWith(() => id),\n\t\tonPointerDown: boxWith(() => onPointerDown),\n\t\tonPointerUp: boxWith(() => onPointerUp),\n\t\tenabled: boxWith(() => enabled && preventOverflowTextSelection),\n\t\tref,\n\t});\n</script>\n\n{@render children?.()}\n","<script lang=\"ts\">\n\timport { boxWith } from \"svelte-toolbelt\";\n\timport type { FocusScopeImplProps } from \"./types.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\timport { FocusScope } from \"./focus-scope.svelte.js\";\n\n\tlet {\n\t\tenabled = false,\n\t\ttrapFocus = false,\n\t\tloop = false,\n\t\tonCloseAutoFocus = noop,\n\t\tonOpenAutoFocus = noop,\n\t\tfocusScope,\n\t\tref,\n\t}: FocusScopeImplProps = $props();\n\n\tconst focusScopeState = FocusScope.use({\n\t\tenabled: boxWith(() => enabled),\n\t\ttrap: boxWith(() => trapFocus),\n\t\tloop: loop,\n\t\tonCloseAutoFocus: boxWith(() => onCloseAutoFocus),\n\t\tonOpenAutoFocus: boxWith(() => onOpenAutoFocus),\n\t\tref,\n\t});\n</script>\n\n{@render focusScope?.({ props: focusScopeState.props })}\n","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils\";\n\timport X from \"$lib/components/ui/icons/X.svelte\";\n\timport DialogPortal from \"./dialog-portal.svelte\";\n\timport DialogOverlay from \"./dialog-overlay.svelte\";\n\ttype $$Props = DialogPrimitive.ContentProps;\n\n\tlet {\n\t\tchildren,\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPortal>\n\t<DialogOverlay />\n\t<DialogPrimitive.Content\n\t\tclass={cn(\n\t\t\t'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',\n\t\t\tclassName\n\t\t)}\n\t\t{...rest}\n\t>\n\t\t\t{#if children}\n\t\t\t\t{@render children()}\n\t\t\t{/if}\n\t\t<DialogPrimitive.Close\n\t\t  class=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\"\n\t\t>\n\t\t\t<X class=\"h-4 w-4\" />\n\t\t\t<span class=\"sr-only\">Close</span>\n\t\t</DialogPrimitive.Close>\n\t</DialogPrimitive.Content>\n</DialogPortal>","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\ttype $$Props = DialogPrimitive.PortalProps & { children?: any };\n\n\tlet {\n\t\tchildren,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPrimitive.Portal\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</DialogPrimitive.Portal>","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils\";\n\n\ttype $$Props = DialogPrimitive.OverlayProps;\n\n\tlet {\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPrimitive.Overlay\n\tclass={cn(\n\t\t'fixed inset-0 z-50 bg-background/80 backdrop-blur-sm',\n\t\t'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',\n\t\tclassName\n\t)}\n\t{...rest}\n/>","<script lang=\"ts\">\n  // Define props using Svelte 5 Runes syntax\n  let {\n    size = 24,\n    color = 'currentColor',\n    strokeWidth = 2,\n    class: className = '',\n    ...rest\n  } = $props();\n\n  // Icon node data for X icon\n  const iconNode: [string, Record<string, string>][] = [\n    [\"line\", { x1: \"18\", y1: \"6\", x2: \"6\", y2: \"18\" }],\n    [\"line\", { x1: \"6\", y1: \"6\", x2: \"18\", y2: \"18\" }]\n  ];\n</script>\n\n<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  width={size}\n  height={size}\n  viewBox=\"0 0 24 24\"\n  fill=\"none\"\n  stroke={color}\n  stroke-width={strokeWidth}\n  stroke-linecap=\"round\"\n  stroke-linejoin=\"round\"\n  class={`lucide-icon lucide-x ${className}`}\n  {...rest}\n>\n  {#each iconNode as [tag, attrs]}\n    <svelte:element this={tag} {...attrs} />\n  {/each}\n</svg>","<script lang=\"ts\">\n  /**\n   * LessonGenerator Component\n   *\n   * Provides a comprehensive interface for generating dynamic lessons with advanced parameters.\n   * Supports all lesson types (vocabulary, grammar, mixed) with detailed customization options.\n   */\n\n  import { enhancedLessonService } from '$lib/services/enhanced-lesson';\n  import { t } from '$lib/services/localization';\n  import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '$lib/components/ui/dialog';\n  import { Button } from '$lib/components/ui/button';\n  import type { LessonType, LessonDifficulty } from '$lib/schemas/lesson';\n  import type { VocabularyCategory, PartOfSpeech } from '$lib/schemas/vocabulary';\n\n  // Simple error handler\n  function handleError(error: unknown, context: string) {\n    console.error(`[${context}]`, error);\n  }\n\n  // Props\n  let { isOpen = false, onClose = () => {}, onLessonGenerated = () => {} } = $props();\n\n  // State\n  let isGenerating = $state(false);\n  let error = $state<string | null>(null);\n  let successMessage = $state<string | null>(null);\n  let hasError = $state(false);\n\n  // Lesson generation parameters\n  let lessonParams = $state<{\n    title: string;\n    description: string;\n    type: LessonType | '';\n    difficulty: LessonDifficulty | '';\n    category: VocabularyCategory | '';\n    partOfSpeech: PartOfSpeech | '';\n    conceptType: string;\n    limit: number;\n    includePractice: boolean;\n    includeComparison: boolean;\n    includeReview: boolean;\n  }>({\n    title: '',\n    description: '',\n    type: '',\n    difficulty: '',\n    category: '',\n    partOfSpeech: '',\n    conceptType: '',\n    limit: 10,\n    includePractice: true,\n    includeComparison: false,\n    includeReview: false\n  });\n\n  // Computed\n  let isVocabularyLesson = $derived(lessonParams.type === 'vocabulary');\n  let isGrammarLesson = $derived(lessonParams.type === 'grammar');\n  let isMixedLesson = $derived(lessonParams.type === 'mixed');\n  let generateLabel = $derived(t('lesson.generator.generate_lesson') || 'Generate Lesson');\n  let generatingLabel = $derived(t('lesson.generator.generating') || 'Generating...');\n\n  // Methods\n  function resetForm() {\n    lessonParams = {\n      title: '',\n      description: '',\n      type: '',\n      difficulty: '',\n      category: '',\n      partOfSpeech: '',\n      conceptType: '',\n      limit: 10,\n      includePractice: true,\n      includeComparison: false,\n      includeReview: false\n    };\n    error = null;\n    successMessage = null;\n  }\n\n  function closeModal() {\n    resetForm();\n    onClose();\n  }\n\n  /**\n   * Generate a lesson with proper error handling and validation\n   * @throws Error if lesson generation fails\n   */\n  async function generateLesson() {\n    try {\n      isGenerating = true;\n      error = null;\n      successMessage = null;\n      hasError = false;\n\n      // Validate required fields with proper type checking\n      if (!lessonParams.type || typeof lessonParams.type !== 'string') {\n        throw new Error(t('lesson.generator.errors.select_valid_lesson_type'));\n      }\n\n      if (!lessonParams.difficulty || typeof lessonParams.difficulty !== 'string') {\n        throw new Error(t('lesson.generator.errors.select_valid_difficulty'));\n      }\n\n      // Generate appropriate lesson based on type\n      let generatedLesson;\n\n      if (isVocabularyLesson) {\n        // Generate vocabulary lesson\n        const categories = lessonParams.category ? [lessonParams.category] : undefined;\n        generatedLesson = await enhancedLessonService.generateThematicLesson(\n          categories || [],\n          lessonParams.difficulty,\n          {\n            includePractice: lessonParams.includePractice,\n            includeReview: lessonParams.includeReview\n          }\n        );\n      }\n      else if (isGrammarLesson) {\n        // Generate grammar lesson\n        generatedLesson = await enhancedLessonService.generateGrammarLesson(\n          lessonParams.conceptType || 'basic',\n          lessonParams.difficulty,\n          {\n            includePractice: lessonParams.includePractice,\n            includeComparison: lessonParams.includeComparison\n          }\n        );\n      }\n      else if (isMixedLesson) {\n        // Generate mixed lesson\n        const category = lessonParams.category || 'everyday-phrases';\n        generatedLesson = await enhancedLessonService.generateMixedLesson(\n          category,\n          lessonParams.difficulty,\n          {\n            includePractice: lessonParams.includePractice,\n            includeReview: lessonParams.includeReview\n          }\n        );\n      }\n      else {\n        // Fallback to dynamic lesson\n        const params = {\n          type: lessonParams.type,\n          difficulty: lessonParams.difficulty,\n          criteria: {\n            categories: lessonParams.category && (lessonParams.category as string) !== 'uncategorized' ? [lessonParams.category as VocabularyCategory] : [],\n            ...(lessonParams.partOfSpeech ? { partOfSpeech: lessonParams.partOfSpeech as PartOfSpeech } : {}),\n            conceptType: lessonParams.conceptType,\n            limit: lessonParams.limit\n          },\n          userId: 'local-user',\n          metadata: {\n            includePractice: lessonParams.includePractice,\n            includeComparison: lessonParams.includeComparison,\n            includeReview: lessonParams.includeReview\n          }\n        };\n\n        generatedLesson = await enhancedLessonService.generateDynamicLesson(params);\n      }\n\n      // Apply custom title and description if provided\n      if (lessonParams.title) {\n        generatedLesson.title = lessonParams.title;\n      }\n\n      if (lessonParams.description) {\n        generatedLesson.description = lessonParams.description;\n      }\n\n      // Notify parent component\n      onLessonGenerated(generatedLesson);\n\n      // Show success message\n      successMessage = t('lesson.generator.success_message');\n\n      // Close modal after 2 seconds\n      setTimeout(() => {\n        closeModal();\n      }, 2000);\n\n    } catch (err) {\n      handleError(err, 'Failed to generate lesson');\n      error = err instanceof Error ? err.message : t('lesson.generator.errors.generation_failed');\n      hasError = true;\n\n      // Re-throw to allow parent components to handle the error\n      throw err;\n    } finally {\n      isGenerating = false;\n    }\n  }\n\n  function getLessonTypeName(type: string) {\n    const typeNames: Record<string, string> = {\n      'vocabulary': t('lesson.types.vocabulary'),\n      'grammar': t('lesson.types.grammar'),\n      'mixed': t('lesson.types.mixed'),\n      'conversation': t('lesson.types.conversation'),\n      'reading': t('lesson.types.reading'),\n      'listening': t('lesson.types.listening'),\n      'writing': t('lesson.types.writing'),\n      'culture': t('lesson.types.culture'),\n      'contextual': t('lesson.types.contextual')\n    };\n    return typeNames[type] || type;\n  }\n\n  function getCategoryDisplayName(category: string) {\n    const displayNames: Record<string, string> = {\n      'greetings': t('vocabulary.categories.greetings'),\n      'numbers': t('vocabulary.categories.numbers'),\n      'family': t('vocabulary.categories.family'),\n      'food': t('vocabulary.categories.food'),\n      'colors': t('vocabulary.categories.colors'),\n      'animals': t('vocabulary.categories.animals'),\n      'body': t('vocabulary.categories.body_parts'),\n      'clothing': t('vocabulary.categories.clothing'),\n      'house': t('vocabulary.categories.house_home'),\n      'nature': t('vocabulary.categories.nature'),\n      'transport': t('vocabulary.categories.transportation'),\n      'technology': t('vocabulary.categories.technology'),\n      'time': t('vocabulary.categories.time_date'),\n      'weather': t('vocabulary.categories.weather'),\n      'professions': t('vocabulary.categories.professions'),\n      'places': t('vocabulary.categories.places'),\n      'grammar': t('vocabulary.categories.grammar'),\n      'culture': t('vocabulary.categories.culture'),\n      'common_phrases': t('vocabulary.categories.common_phrases'),\n      'uncategorized': t('vocabulary.categories.uncategorized')\n    };\n\n    return displayNames[category] || category;\n  }\n\n  function getPartOfSpeechDisplayName(partOfSpeech: string) {\n    const displayNames: Record<string, string> = {\n      'noun': t('vocabulary.parts_of_speech.nouns'),\n      'verb': t('vocabulary.parts_of_speech.verbs'),\n      'adjective': t('vocabulary.parts_of_speech.adjectives'),\n      'adverb': t('vocabulary.parts_of_speech.adverbs'),\n      'pronoun': t('vocabulary.parts_of_speech.pronouns'),\n      'preposition': t('vocabulary.parts_of_speech.prepositions'),\n      'conjunction': t('vocabulary.parts_of_speech.conjunctions'),\n      'interjection': t('vocabulary.parts_of_speech.interjections'),\n      'article': t('vocabulary.parts_of_speech.articles'),\n      'number': t('vocabulary.parts_of_speech.numbers'),\n      'phrase': t('vocabulary.parts_of_speech.phrases')\n    };\n\n    return displayNames[partOfSpeech] || partOfSpeech;\n  }\n\n  function getDifficultyLevels(): LessonDifficulty[] {\n    return ['A1', 'A2', 'B1', 'B2', 'C1'];\n  }\n\n  function getVocabularyCategories(): VocabularyCategory[] {\n    return [\n      'greetings', 'numbers', 'family', 'food', 'colors', 'animals', 'body-parts',\n      'clothing', 'home', 'nature', 'transport', 'technology', 'time', 'weather',\n      'professions', 'places', 'grammar', 'culture', 'everyday-phrases'\n    ];\n  }\n\n  function getPartsOfSpeech(): PartOfSpeech[] {\n    return ['noun', 'verb', 'adjective', 'adverb', 'pronoun', 'preposition', 'conjunction', 'phrase'];\n  }\n\n  function getLessonTypes(): LessonType[] {\n    return ['vocabulary', 'grammar', 'mixed', 'conversation', 'culture'];\n  }\n</script>\n\n<Dialog open={isOpen} onOpenChange={(open) => {\n  try {\n    if (!open) closeModal();\n  } catch (err) {\n    handleError(err, 'Failed to close lesson generator modal');\n    hasError = true;\n  }\n}}>\n  <DialogContent class=\"lesson-generator-modal\">\n    <DialogHeader>\n      <DialogTitle>{t('lesson.generator.title')}</DialogTitle>\n      <DialogDescription>\n        {t('lesson.generator.description')}\n      </DialogDescription>\n    </DialogHeader>\n\n    <div class=\"lesson-generator-form\">\n      {#if hasError}\n        <div class=\"error-message\">\n          ‚ö†Ô∏è {error}\n          <button\n            class=\"retry-button\"\n            onclick={() => {\n              try {\n                error = null;\n                hasError = false;\n              } catch (err) {\n                handleError(err, 'Failed to clear error state');\n              }\n            }}\n          >\n            {t('common.try_again')}\n          </button>\n        </div>\n      {/if}\n\n      {#if successMessage}\n        <div class=\"success-message\">\n          ‚úÖ {successMessage}\n        </div>\n      {/if}\n\n      <div class=\"form-section\">\n        <h3>{t('lesson.generator.basic_information')}</h3>\n\n        <div class=\"form-group\">\n          <label for=\"lesson-title\">{t('lesson.generator.lesson_title')}</label>\n          <input\n            id=\"lesson-title\"\n            type=\"text\"\n            bind:value={lessonParams.title}\n            placeholder={t('lesson.generator.lesson_title_placeholder')}\n          />\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"lesson-description\">{t('lesson.generator.description')}</label>\n          <textarea\n            id=\"lesson-description\"\n            bind:value={lessonParams.description}\n            placeholder={t('lesson.generator.description_placeholder')}\n            rows=\"3\"\n          ></textarea>\n        </div>\n      </div>\n\n      <div class=\"form-section\">\n        <h3>{t('lesson.generator.lesson_parameters')}</h3>\n\n        <div class=\"form-row\">\n          <div class=\"form-group\">\n            <label for=\"lesson-type\">{t('lesson.generator.lesson_type_required')}</label>\n            <select id=\"lesson-type\" bind:value={lessonParams.type}>\n              <option value=\"\">{t('lesson.generator.select_lesson_type')}</option>\n              {#each getLessonTypes() as type}\n                <option value={type}>{getLessonTypeName(type)}</option>\n              {/each}\n            </select>\n          </div>\n\n          <div class=\"form-group\">\n            <label for=\"lesson-difficulty\">{t('lesson.generator.difficulty_level_required')}</label>\n            <select id=\"lesson-difficulty\" bind:value={lessonParams.difficulty}>\n              <option value=\"\">{t('lesson.generator.select_difficulty')}</option>\n              {#each getDifficultyLevels() as level}\n                <option value={level}>{level}</option>\n              {/each}\n            </select>\n          </div>\n        </div>\n\n        {#if isVocabularyLesson || isMixedLesson}\n          <div class=\"form-row\">\n            <div class=\"form-group\">\n              <label for=\"lesson-category\">{t('lesson.generator.category')}</label>\n              <select id=\"lesson-category\" bind:value={lessonParams.category}>\n                <option value=\"\">{t('lesson.generator.any_category')}</option>\n                {#each getVocabularyCategories() as category}\n                  <option value={category}>{getCategoryDisplayName(category)}</option>\n                {/each}\n              </select>\n            </div>\n\n            <div class=\"form-group\">\n              <label for=\"lesson-part-of-speech\">{t('lesson.generator.part_of_speech')}</label>\n              <select id=\"lesson-part-of-speech\" bind:value={lessonParams.partOfSpeech}>\n                <option value=\"\">{t('lesson.generator.any_part_of_speech')}</option>\n                {#each getPartsOfSpeech() as partOfSpeech}\n                  <option value={partOfSpeech}>{getPartOfSpeechDisplayName(partOfSpeech)}</option>\n                {/each}\n              </select>\n            </div>\n          </div>\n        {/if}\n\n        {#if isGrammarLesson}\n          <div class=\"form-group\">\n            <label for=\"lesson-concept-type\">{t('lesson.generator.grammar_concept')}</label>\n            <input\n              id=\"lesson-concept-type\"\n              type=\"text\"\n              bind:value={lessonParams.conceptType}\n              placeholder={t('lesson.generator.grammar_concept_placeholder')}\n            />\n          </div>\n        {/if}\n\n        <div class=\"form-group\">\n          <label for=\"lesson-limit\">{t('lesson.generator.number_of_items')}</label>\n          <select id=\"lesson-limit\" bind:value={lessonParams.limit}>\n            <option value=\"5\">5 {t('lesson.generator.items')}</option>\n            <option value=\"8\">8 {t('lesson.generator.items')}</option>\n            <option value=\"10\" selected>10 {t('lesson.generator.items')}</option>\n            <option value=\"15\">15 {t('lesson.generator.items')}</option>\n            <option value=\"20\">20 {t('lesson.generator.items')}</option>\n          </select>\n        </div>\n      </div>\n\n      <div class=\"form-section\">\n        <h3>{t('lesson.generator.options')}</h3>\n\n        <div class=\"form-row\">\n          <div class=\"form-group checkbox-group\">\n            <label>\n              <input type=\"checkbox\" bind:checked={lessonParams.includePractice} />\n              {t('lesson.generator.include_practice_exercises')}\n            </label>\n          </div>\n\n          {#if isGrammarLesson}\n            <div class=\"form-group checkbox-group\">\n              <label>\n                <input type=\"checkbox\" bind:checked={lessonParams.includeComparison} />\n                {t('lesson.generator.include_language_comparison')}\n              </label>\n            </div>\n          {/if}\n\n          {#if isVocabularyLesson || isMixedLesson}\n            <div class=\"form-group checkbox-group\">\n              <label>\n                <input type=\"checkbox\" bind:checked={lessonParams.includeReview} />\n                {t('lesson.generator.include_review_section')}\n              </label>\n            </div>\n          {/if}\n        </div>\n      </div>\n    </div>\n\n    <DialogFooter>\n      <Button\n        variant=\"secondary\"\n        size=\"default\"\n        class=\"\"\n        onclick={() => {\n          try {\n            closeModal();\n          } catch (err) {\n            handleError(err, 'Failed to close modal');\n            hasError = true;\n          }\n        }}\n        disabled={isGenerating}\n      >\n        {t('common.cancel')}\n      </Button>\n      <Button\n        variant=\"default\"\n        size=\"default\"\n        class=\"\"\n        onclick={() => {\n          try {\n            generateLesson();\n          } catch (err) {\n            // Error is already handled in the generateLesson function\n          }\n        }}\n        disabled={isGenerating}\n      >\n            {isGenerating ? generatingLabel : generateLabel}\n      </Button>\n    </DialogFooter>\n  </DialogContent>\n</Dialog>\n\n<style>\n\n  .lesson-generator-form {\n    padding: 1rem 0;\n  }\n\n  .form-section {\n    margin-bottom: 1.5rem;\n    padding-bottom: 1.5rem;\n    border-bottom: 1px solid #e2e8f0;\n  }\n\n  .form-section:last-child {\n    border-bottom: none;\n    margin-bottom: 0;\n  }\n\n  .form-section h3 {\n    font-size: 1rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 1rem;\n  }\n\n  .form-group {\n    margin-bottom: 1rem;\n  }\n\n  .form-group label {\n    display: block;\n    margin-bottom: 0.5rem;\n    font-size: 0.875rem;\n    font-weight: 500;\n    color: #475569;\n  }\n\n  .form-row {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 1rem;\n  }\n\n  input, textarea, select {\n    width: 100%;\n    padding: 0.5rem 1rem;\n    border-radius: 8px;\n    border: 1px solid #e2e8f0;\n    background: white;\n    font-size: 0.875rem;\n  }\n\n  textarea {\n    resize: vertical;\n    min-height: 80px;\n  }\n\n  .checkbox-group {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n  }\n\n  .checkbox-group input {\n    width: auto;\n  }\n\n  .error-message {\n    padding: 0.75rem 1rem;\n    background: #fef2f2;\n    border-radius: 8px;\n    color: #ef4444;\n    margin-bottom: 1rem;\n    font-size: 0.875rem;\n  }\n\n  .success-message {\n    padding: 0.75rem 1rem;\n    background: #f0fdf4;\n    border-radius: 8px;\n    color: #10b981;\n    margin-bottom: 1rem;\n    font-size: 0.875rem;\n  }\n\n  @media (max-width: 768px) {\n    .form-row {\n      grid-template-columns: 1fr;\n    }\n\n  }\n</style>","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\n\ttype $$Props = DialogPrimitive.RootProps & { children?: any };\n\n\tlet {\n\t\tchildren,\n\t\topen = $bindable(false),\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPrimitive.Root\n\tbind:open\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</DialogPrimitive.Root>\n","<script lang=\"ts\">\n\timport { cn } from \"$lib/utils\";\n\timport type { HTMLAttributes } from \"svelte/elements\";\n\timport type { Snippet } from \"svelte\";\n\n\ttype $$Props = HTMLAttributes<HTMLDivElement> & {\n\tchildren?: Snippet;\n};\n\n\tlet {\n\t\tchildren,\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<div\n\tclass={cn('flex flex-col space-y-1.5 text-center sm:text-left', className)}\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</div>","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils\";\n\n\ttype $$Props = DialogPrimitive.TitleProps;\n\n\tlet {\n\t\tchildren,\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPrimitive.Title\n\tclass={cn('text-lg font-semibold leading-none tracking-tight', className)}\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</DialogPrimitive.Title>","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils\";\n\n\ttype $$Props = DialogPrimitive.DescriptionProps;\n\n\tlet {\n\t\tchildren,\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPrimitive.Description\n\tclass={cn('text-sm text-muted-foreground', className)}\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</DialogPrimitive.Description>","<script lang=\"ts\">\n\timport { cn } from \"$lib/utils\";\n\timport type { HTMLAttributes } from \"svelte/elements\";\n\timport type { Snippet } from \"svelte\";\n\n\ttype $$Props = HTMLAttributes<HTMLDivElement> & {\n\tchildren?: Snippet;\n};\n\n\tlet {\n\t\tchildren,\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<div\n\tclass={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)}\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</div>","<script lang=\"ts\">\n  /**\n   * Lessons Page\n   *\n   * Displays available lessons and allows users to browse and start learning.\n   * Uses the enhanced LessonService for comprehensive lesson generation and management.\n   */\n\n  import LessonCard from '$lib/components/LessonCard.svelte';\n  import GeneratedLesson from '$lib/components/GeneratedLesson.svelte';\n  import LessonGenerator from '$lib/components/LessonGenerator.svelte';\n  import { enhancedLessonService } from '$lib/services/enhanced-lesson';\n  import { lessonService } from '$lib/services/lesson';\n  import { vocabularyDb as db } from '$lib/data/db.svelte';\n  import { appState } from '$lib/state/app-state';\n  import type { VocabularyCategory, PartOfSpeech } from '$lib/schemas/vocabulary';\n  import type { VocabularyItem } from '$lib/types/vocabulary';\n  import type { Lesson, LessonDifficulty } from '$lib/schemas/lesson';\n\n  // State\n  let lessons = $state<Lesson[]>([]);\n  let isLoading = $state(true);\n  let error = $state<string | null>(null);\n  let selectedDifficulty = $state<LessonDifficulty | 'all'>('all');\n  let selectedType = $state<string>('all');\n  let showLessonGenerationModal = $state(false);\n  let showGeneratedLesson = $state<Lesson | null>(null);\n\n  const typeLabels = {\n    de: {\n      vocabulary: 'Vokabular',\n      grammar: 'Grammatik',\n      conversation: 'Konversation',\n      reading: 'Lesen',\n      listening: 'H√∂ren',\n      writing: 'Schreiben',\n      culture: 'Kultur',\n      mixed: 'Gemischt'\n    },\n    bg: {\n      vocabulary: '–†–µ—á–Ω–∏–∫',\n      grammar: '–ì—Ä–∞–º–∞—Ç–∏–∫–∞',\n      conversation: '–†–∞–∑–≥–æ–≤–æ—Ä',\n      reading: '–ß–µ—Ç–µ–Ω–µ',\n      listening: '–°–ª—É—à–∞–Ω–µ',\n      writing: '–ü–∏—Å–∞–Ω–µ',\n      culture: '–ö—É–ª—Ç—É—Ä–∞',\n      mixed: '–°–º–µ—Å–µ–Ω–æ'\n    }\n  } as const;\n\n  const categoryLabels = {\n    de: {\n      greetings: 'Begr√º√üungen',\n      numbers: 'Zahlen',\n      family: 'Familie',\n      food: 'Essen',\n      colors: 'Farben',\n      animals: 'Tiere',\n      'body-parts': 'K√∂rperteile',\n      clothing: 'Kleidung',\n      home: 'Zuhause',\n      nature: 'Natur',\n      transport: 'Verkehr',\n      technology: 'Technologie',\n      time: 'Zeit',\n      weather: 'Wetter',\n      professions: 'Berufe',\n      places: 'Orte',\n      grammar: 'Grammatik',\n      culture: 'Kultur',\n      'everyday-phrases': 'Alltagsphrasen'\n    },\n    bg: {\n      greetings: '–ü–æ–∑–¥—Ä–∞–≤–∏',\n      numbers: '–ß–∏—Å–ª–∞',\n      family: '–°–µ–º–µ–π—Å—Ç–≤–æ',\n      food: '–•—Ä–∞–Ω–∞',\n      colors: '–¶–≤–µ—Ç–æ–≤–µ',\n      animals: '–ñ–∏–≤–æ—Ç–Ω–∏',\n      'body-parts': '–ß–∞—Å—Ç–∏ –Ω–∞ —Ç—è–ª–æ—Ç–æ',\n      clothing: '–û–±–ª–µ–∫–ª–æ',\n      home: '–î–æ–º',\n      nature: '–ü—Ä–∏—Ä–æ–¥–∞',\n      transport: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç',\n      technology: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏',\n      time: '–í—Ä–µ–º–µ',\n      weather: '–í—Ä–µ–º–µ—Ç–æ',\n      professions: '–ü—Ä–æ—Ñ–µ—Å–∏–∏',\n      places: '–ú–µ—Å—Ç–∞',\n      grammar: '–ì—Ä–∞–º–∞—Ç–∏–∫–∞',\n      culture: '–ö—É–ª—Ç—É—Ä–∞',\n      'everyday-phrases': '–ß–µ—Å—Ç–æ —Å—Ä–µ—â–∞–Ω–∏ –∏–∑—Ä–∞–∑–∏'\n    }\n  } as const;\n\n  const partOfSpeechLabels = {\n    de: {\n      noun: 'Nomen',\n      verb: 'Verben',\n      adjective: 'Adjektive',\n      adverb: 'Adverbien',\n      pronoun: 'Pronomen',\n      preposition: 'Pr√§positionen',\n      conjunction: 'Konjunktionen',\n      interjection: 'Interjektionen',\n      article: 'Artikel',\n      number: 'Zahlw√∂rter',\n      phrase: 'Redewendungen'\n    },\n    bg: {\n      noun: '–°—ä—â–µ—Å—Ç–≤–∏—Ç–µ–ª–Ω–∏',\n      verb: '–ì–ª–∞–≥–æ–ª–∏',\n      adjective: '–ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª–Ω–∏',\n      adverb: '–ù–∞—Ä–µ—á–∏—è',\n      pronoun: '–ú–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è',\n      preposition: '–ü—Ä–µ–¥–ª–æ–∑–∏',\n      conjunction: '–°—ä—é–∑–∏',\n      interjection: '–ú–µ–∂–¥—É–º–µ—Ç–∏—è',\n      article: '–ß–ª–µ–Ω–æ–≤–µ',\n      number: '–ß–∏—Å–ª–∏—Ç–µ–ª–Ω–∏',\n      phrase: '–ò–∑—Ä–∞–∑–∏'\n    }\n  } as const;\n\n  const ui = $derived(appState.languageMode === 'DE_BG'\n    ? {\n        title: 'Lektionen',\n        subtitle: 'Strukturierte Lernerlebnisse f√ºr Bulgarisch und Deutsch',\n        createDynamicLesson: '‚ú® Dynamische Lektion erstellen',\n        createLesson: '‚ú® Lektion erstellen',\n        createFirstLesson: 'Erstelle deine erste Lektion',\n        loading: 'Lektionen werden geladen...',\n        error: 'Fehler beim Laden. Bitte erneut versuchen.',\n        retry: 'Erneut versuchen',\n        emptyTitle: 'Keine Lektionen verf√ºgbar',\n        emptyDescription: 'Erstelle deine erste individuelle Lektion!',\n        difficultyLabel: 'Niveau',\n        typeLabel: 'Typ',\n        allLevels: 'Alle Niveaus',\n        allTypes: 'Alle Typen',\n        backToLessons: '‚Üê Zur√ºck zu allen Lektionen',\n        showingLessons: (shown: number, total: number) => `Zeige ${shown} von ${total} Lektionen`,\n        resetFilters: 'Filter zur√ºcksetzen',\n        mixedEveryday: 'Gemischt: Allt√§gliche Gespr√§che',\n        basicVocabulary: 'Grundwortschatz',\n        categoryPrefix: 'Kategorie',\n        grammarPrefix: 'Grammatik'\n      }\n    : {\n        title: '–£—Ä–æ—Ü–∏',\n        subtitle: '–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω–∏ —É—Ä–æ—Ü–∏ –ø–æ –±—ä–ª–≥–∞—Ä—Å–∫–∏ –∏ –Ω–µ–º—Å–∫–∏',\n        createDynamicLesson: '‚ú® –°—ä–∑–¥–∞–π –¥–∏–Ω–∞–º–∏—á–µ–Ω —É—Ä–æ–∫',\n        createLesson: '‚ú® –°—ä–∑–¥–∞–π —É—Ä–æ–∫',\n        createFirstLesson: '–°—ä–∑–¥–∞–π –ø—ä—Ä–≤–∏—è —Å–∏ —É—Ä–æ–∫',\n        loading: '–ó–∞—Ä–µ–∂–¥–∞–º–µ —É—Ä–æ—Ü–∏—Ç–µ...',\n        error: '–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ. –û–ø–∏—Ç–∞–π—Ç–µ –ø–∞–∫.',\n        retry: '–û–ø–∏—Ç–∞–π –æ—Ç–Ω–æ–≤–æ',\n        emptyTitle: '–ù—è–º–∞ –Ω–∞–ª–∏—á–Ω–∏ —É—Ä–æ—Ü–∏',\n        emptyDescription: '–°—ä–∑–¥–∞–π –ø—ä—Ä–≤–∏—è —Å–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω —É—Ä–æ–∫!',\n        difficultyLabel: '–ù–∏–≤–æ',\n        typeLabel: '–¢–∏–ø',\n        allLevels: '–í—Å–∏—á–∫–∏ –Ω–∏–≤–∞',\n        allTypes: '–í—Å–∏—á–∫–∏ —Ç–∏–ø–æ–≤–µ',\n        backToLessons: '‚Üê –ù–∞–∑–∞–¥ –∫—ä–º –≤—Å–∏—á–∫–∏ —É—Ä–æ—Ü–∏',\n        showingLessons: (shown: number, total: number) => `–ü–æ–∫–∞–∑–∞–Ω–∏ ${shown} –æ—Ç –æ–±—â–æ ${total} —É—Ä–æ–∫–∞`,\n        resetFilters: '–ù—É–ª–∏—Ä–∞–π —Ñ–∏–ª—Ç—Ä–∏—Ç–µ',\n        mixedEveryday: '–°–º–µ—Å–µ–Ω–æ: –ï–∂–µ–¥–Ω–µ–≤–Ω–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–∏',\n        basicVocabulary: '–û—Å–Ω–æ–≤–Ω–∞ –ª–µ–∫—Å–∏–∫–∞',\n        categoryPrefix: '–ö–∞—Ç–µ–≥–æ—Ä–∏—è',\n        grammarPrefix: '–ì—Ä–∞–º–∞—Ç–∏–∫–∞'\n      });\n\n  // Computed\n  let filteredLessons = $derived(\n    lessons.filter(lesson => {\n      const difficultyMatch = selectedDifficulty === 'all' || lesson.difficulty === selectedDifficulty;\n      const typeMatch = selectedType === 'all' || lesson.type === selectedType;\n      return difficultyMatch && typeMatch;\n    })\n  );\n\n  // Initialize lessons\n  $effect(() => {\n    loadLessons();\n  });\n\n  /**\n   * Load lessons from service\n   */\n  async function loadLessons() {\n    try {\n      isLoading = true;\n      error = null;\n\n      // Initialize enhanced lesson service\n      await enhancedLessonService.initialize();\n\n      // Generate comprehensive lessons using the enhanced service\n      const generatedLessons = await generateComprehensiveLessons();\n\n      lessons = generatedLessons;\n\n    } catch (err) {\n      console.error('Failed to load lessons:', err);\n      error = err instanceof Error ? err.message : ui.error;\n    } finally {\n      isLoading = false;\n    }\n  }\n\n  /**\n   * Generate comprehensive lessons using the enhanced LessonService\n   */\n  async function generateComprehensiveLessons(): Promise<Lesson[]> {\n    const lessons: Lesson[] = [];\n    const vocabularyStats = db.getVocabularyStatsByDifficulty();\n\n    // Generate lessons by difficulty level\n    const difficulties: LessonDifficulty[] = ['A1', 'A2', 'B1', 'B2', 'C1'];\n\n    for (const difficulty of difficulties) {\n      if (vocabularyStats[difficulty] >= 5) {\n        // Generate 2-3 lessons per difficulty level\n        const lessonCount = Math.min(3, Math.floor(vocabularyStats[difficulty] / 5));\n\n        for (let i = 0; i < lessonCount; i++) {\n          try {\n            const lesson = await lessonService.generateLessonFromCriteria({\n              difficulty,\n              limit: 8,\n              type: i === 0 ? 'vocabulary' : (i === 1 ? 'conversation' : 'mixed')\n            });\n            lessons.push(lesson);\n          } catch (error) {\n            console.error(`Failed to generate ${difficulty} lesson ${i + 1}:`, error);\n          }\n        }\n      }\n    }\n\n    // Generate lessons by category\n    const categories: VocabularyCategory[] = [\n      'greetings', 'numbers', 'family', 'food', 'colors', 'animals', 'body-parts', 'clothing'\n    ];\n\n    for (const category of categories) {\n      try {\n        const categoryItems = db.getVocabularyByCategory(category);\n        if (categoryItems.length >= 5) {\n          const lesson = await lessonService.generateLessonFromCriteria({\n            categories: [category],\n            limit: 8,\n            type: 'vocabulary',\n            title: `${ui.categoryPrefix}: ${getCategoryDisplayName(category)}`\n          });\n          lessons.push(lesson);\n        }\n      } catch (error) {\n        console.error(`Failed to generate ${category} category lesson:`, error);\n      }\n    }\n\n    // Generate lessons by part of speech\n    const partsOfSpeech: PartOfSpeech[] = ['noun', 'verb', 'adjective', 'adverb'];\n\n    for (const partOfSpeech of partsOfSpeech) {\n      try {\n        const posItems = db.getVocabularyByPartOfSpeech(partOfSpeech);\n        if (posItems.length >= 5) {\n          const lesson = await lessonService.generateLessonFromCriteria({\n            partOfSpeech,\n            limit: 8,\n            type: 'vocabulary',\n            title: `${ui.grammarPrefix}: ${getPartOfSpeechDisplayName(partOfSpeech)}`\n          });\n          lessons.push(lesson);\n        }\n      } catch (error) {\n        console.error(`Failed to generate ${partOfSpeech} lesson:`, error);\n      }\n    }\n\n    // Generate mixed lessons if we have enough vocabulary\n    if (db.getVocabularyCount() >= 15) {\n      try {\n        const lesson = await lessonService.generateLessonFromCriteria({\n          limit: 10,\n          type: 'mixed',\n          title: ui.mixedEveryday\n        });\n        lessons.push(lesson);\n      } catch (error) {\n        console.error('Failed to generate mixed lesson:', error);\n      }\n    }\n\n    // If no lessons were generated, create fallback lessons\n    if (lessons.length === 0 && db.getVocabularyCount() > 0) {\n      console.warn('No lessons generated, creating fallback lessons');\n      const fallbackLessons = generateFallbackLessons();\n      lessons.push(...fallbackLessons);\n    }\n\n    return lessons;\n  }\n\n  /**\n   * Generate fallback lessons when automatic generation fails\n   */\n  function generateFallbackLessons(): Lesson[] {\n    const lessons: Lesson[] = [];\n    const vocabularyData = db.getVocabulary();\n\n    if (vocabularyData.length >= 5) {\n      // Group vocabulary by difficulty\n      const byDifficulty: Record<LessonDifficulty, VocabularyItem[]> = {\n        A1: [],\n        A2: [],\n        B1: [],\n        B2: [],\n        C1: []\n      };\n\n      vocabularyData.forEach(item => {\n        if (item.difficulty <= 1.5) byDifficulty.A1.push(item);\n        else if (item.difficulty <= 2.5) byDifficulty.A2.push(item);\n        else if (item.difficulty <= 3.5) byDifficulty.B1.push(item);\n        else if (item.difficulty <= 4.5) byDifficulty.B2.push(item);\n        else byDifficulty.C1.push(item);\n      });\n\n      // Create simple fallback lessons\n      for (const [difficulty, items] of Object.entries(byDifficulty)) {\n        if (items.length >= 5) {\n          const lesson = lessonService.generateLessonFromVocabulary(\n            items.slice(0, 8).map((item) => {\n              const transliteration = typeof item.transliteration === 'string'\n                ? { german: item.transliteration }\n                : (item.transliteration ?? {});\n              return {\n                ...item,\n                // Adapt unified vocabulary item to legacy expectations of lesson service\n                isCommon: item.metadata?.isCommon ?? false,\n                isVerified: item.metadata?.isVerified ?? false,\n                learningPhase: item.metadata?.learningPhase ?? 0,\n                cefrLevel: (() => {\n                  const level = item.metadata?.level ?? item.level ?? 'A1';\n                  return (level === 'C1' ? 'B2' : level) as 'A1' | 'A2' | 'B1' | 'B2';\n                })(),\n                transliteration,\n                culturalNotes: item.culturalNotes\n              };\n            }),\n            {\n              title: `${difficulty}: ${ui.basicVocabulary}`,\n              difficulty: difficulty as LessonDifficulty,\n              type: 'vocabulary'\n            }\n          );\n          lessons.push(lesson);\n        }\n      }\n    }\n\n    return lessons;\n  }\n\n  /**\n   * Handle generated lesson\n   */\n  function handleLessonGenerated(lesson: Lesson) {\n    lessons.push(lesson);\n    showGeneratedLesson = lesson;\n    showLessonGenerationModal = false;\n  }\n\n  /**\n   * Close generated lesson view\n   */\n  function closeGeneratedLesson() {\n    showGeneratedLesson = null;\n  }\n\n  /**\n   * Get available lesson types\n   */\n  function getLessonTypes(): string[] {\n    const types = new Set<string>();\n    lessons.forEach(lesson => types.add(lesson.type));\n    return ['all', ...Array.from(types)];\n  }\n\n  /**\n   * Get difficulty levels\n   */\n  function getDifficultyLevels(): LessonDifficulty[] {\n    return ['A1', 'A2', 'B1', 'B2', 'C1'];\n  }\n\n  /**\n   * Get vocabulary categories for lesson generation\n   */\n  // Removed unused getVocabularyCategories to satisfy TS\n  // Use canonical category source from unified schema where needed\n\n  /**\n   * Get parts of speech for lesson generation\n   */\n  // Removed unused helper to satisfy TS and keep file tidy\n  // If needed later, prefer importing from a shared constants module\n  // function getPartsOfSpeech(): PartOfSpeech[] {\n  //   return ['noun', 'verb', 'adjective', 'adverb', 'pronoun', 'preposition', 'conjunction', 'phrase'];\n  // }\n\n  /**\n   * Get lesson type display name\n   */\n  function getLessonTypeName(type: string): string {\n    const labels = appState.languageMode === 'DE_BG' ? typeLabels.de : typeLabels.bg;\n    return labels[type as keyof typeof labels] ?? type;\n  }\n\n  /**\n   * Get category display name\n   */\n  function getCategoryDisplayName(category: VocabularyCategory): string {\n    const labels = appState.languageMode === 'DE_BG' ? categoryLabels.de : categoryLabels.bg;\n    return labels[category] ?? category;\n  }\n\n  /**\n   * Get part of speech display name\n   */\n  function getPartOfSpeechDisplayName(partOfSpeech: PartOfSpeech): string {\n    const labels = appState.languageMode === 'DE_BG' ? partOfSpeechLabels.de : partOfSpeechLabels.bg;\n    // Guard against keys not present in labels (e.g., 'expression', 'article')\n    return (partOfSpeech in labels)\n      ? labels[partOfSpeech as keyof typeof labels]\n      : partOfSpeech;\n  }\n\n  \n</script>\n\n<div class=\"lessons-page\">\n  <header class=\"lessons-header\">\n    <h1>{ui.title}</h1>\n    <p class=\"subtitle\">{ui.subtitle}</p>\n    <button class=\"create-lesson-button\" onclick={() => showLessonGenerationModal = true}>\n      {ui.createDynamicLesson}\n    </button>\n  </header>\n\n  {#if isLoading}\n    <div class=\"loading-state\">\n      <div class=\"spinner\"></div>\n      <p>{ui.loading}</p>\n    </div>\n  {:else if error}\n    <div class=\"error-state\">\n      <div class=\"error-icon\">‚ö†Ô∏è</div>\n      <p>{error}</p>\n      <button class=\"retry-button\" onclick={loadLessons}>{ui.retry}</button>\n    </div>\n  {:else if lessons.length === 0}\n    <div class=\"empty-state\">\n      <div class=\"empty-icon\">üìö</div>\n      <p>{ui.emptyDescription}</p>\n      <button class=\"create-lesson-button\" onclick={() => showLessonGenerationModal = true}>\n        {ui.createFirstLesson}\n      </button>\n    </div>\n  {:else}\n    <div class=\"lessons-filters\">\n      <div class=\"filter-group\">\n        <label for=\"difficulty-filter\">{ui.difficultyLabel}</label>\n        <select id=\"difficulty-filter\" bind:value={selectedDifficulty}>\n          <option value=\"all\">{ui.allLevels}</option>\n          {#each getDifficultyLevels() as level}\n            <option value={level}>{level}</option>\n          {/each}\n        </select>\n      </div>\n\n      <div class=\"filter-group\">\n        <label for=\"type-filter\">{ui.typeLabel}</label>\n        <select id=\"type-filter\" bind:value={selectedType}>\n          <option value=\"all\">{ui.allTypes}</option>\n          {#each getLessonTypes() as type}\n            <option value={type}>{getLessonTypeName(type)}</option>\n          {/each}\n        </select>\n      </div>\n\n      <button class=\"create-lesson-button mobile\" onclick={() => showLessonGenerationModal = true}>\n        {ui.createLesson}\n      </button>\n    </div>\n\n    {#if showGeneratedLesson}\n      <GeneratedLesson lesson={showGeneratedLesson} />\n      <div class=\"back-to-lessons\">\n        <button class=\"back-button\" onclick={closeGeneratedLesson}>\n          {ui.backToLessons}\n        </button>\n      </div>\n    {:else}\n      <div class=\"lessons-grid\">\n        {#each filteredLessons as lesson (lesson.id)}\n          <div class=\"lesson-card-wrapper\">\n            <LessonCard {lesson} />\n          </div>\n        {/each}\n      </div>\n    {/if}\n\n    <div class=\"lessons-summary\">\n      <p>\n        {ui.showingLessons(filteredLessons.length, lessons.length)}\n        {#if selectedDifficulty !== 'all' || selectedType !== 'all'}\n          ‚Ä¢ <button class=\"reset-filters\" onclick={() => { selectedDifficulty = 'all'; selectedType = 'all'; }}>{ui.resetFilters}</button>\n        {/if}\n      </p>\n    </div>\n  {/if}\n\n  <!-- Lesson Generator Component -->\n  <LessonGenerator\n    isOpen={showLessonGenerationModal}\n    onClose={() => showLessonGenerationModal = false}\n    onLessonGenerated={handleLessonGenerated}\n  />\n</div>\n\n<style>\n  .lessons-page {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 2rem;\n  }\n\n  .lessons-header {\n    text-align: center;\n    margin-bottom: 2rem;\n  }\n\n  .lessons-header h1 {\n    font-size: 2rem;\n    font-weight: 700;\n    color: #1e293b;\n    margin-bottom: 0.5rem;\n  }\n\n  .subtitle {\n    color: #64748b;\n    font-size: 1rem;\n  }\n\n  .lessons-filters {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 1rem;\n    margin-bottom: 2rem;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .filter-group {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n  }\n\n  .filter-group label {\n    font-size: 0.875rem;\n    font-weight: 500;\n    color: #475569;\n  }\n\n  select {\n    padding: 0.5rem 1rem;\n    border-radius: 8px;\n    border: 1px solid #e2e8f0;\n    background: white;\n    font-size: 0.875rem;\n    cursor: pointer;\n    min-width: 150px;\n  }\n\n  .lessons-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 2rem;\n  }\n\n  .lesson-card-wrapper {\n    height: 500px;\n  }\n\n  .loading-state, .error-state, .empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    min-height: 400px;\n    text-align: center;\n  }\n\n  .spinner {\n    width: 50px;\n    height: 50px;\n    border: 4px solid #f3f4f6;\n    border-top: 4px solid #3b82f6;\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n    margin-bottom: 1rem;\n  }\n\n  .error-icon, .empty-icon {\n    font-size: 3rem;\n    margin-bottom: 1rem;\n  }\n\n  .error-state p {\n    color: #ef4444;\n    font-size: 1.125rem;\n    margin-bottom: 1rem;\n  }\n\n  .empty-state p {\n    color: #64748b;\n    font-size: 1.125rem;\n  }\n\n  .retry-button {\n    padding: 0.5rem 1rem;\n    background: #3b82f6;\n    color: white;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.875rem;\n  }\n\n  .lessons-summary {\n    text-align: center;\n    color: #64748b;\n    font-size: 0.875rem;\n  }\n\n  .reset-filters {\n    background: none;\n    border: none;\n    color: #3b82f6;\n    cursor: pointer;\n    text-decoration: underline;\n    padding: 0;\n    font-size: 0.875rem;\n  }\n\n  /* Button Styles */\n  .create-lesson-button {\n    padding: 0.5rem 1rem;\n    background: #3b82f6;\n    color: white;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.875rem;\n    transition: background 0.2s ease;\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n  }\n\n  .create-lesson-button:hover {\n    background: #2563eb;\n  }\n\n  .create-lesson-button.mobile {\n    display: none;\n  }\n\n\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n\n  .back-to-lessons {\n    text-align: center;\n    margin: 2rem 0;\n  }\n\n  .back-button {\n    padding: 0.5rem 1rem;\n    background: #f1f5f9;\n    color: #475569;\n    border: 1px solid #e2e8f0;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.875rem;\n  }\n\n  @media (max-width: 768px) {\n    .lessons-page {\n      padding: 1rem;\n    }\n\n    .lessons-grid {\n      grid-template-columns: 1fr;\n    }\n\n    .lessons-filters {\n      flex-direction: column;\n      align-items: stretch;\n    }\n\n    .filter-group {\n      align-items: stretch;\n    }\n\n    select {\n      min-width: 100%;\n    }\n  }\n</style>"],"names":["createAttachmentKey","Symbol","ATTACHMENT_KEY","_SvelteMap","Map","constructor","value","super","__privateAdd","this","_SvelteMap_instances","_sources","_version","state","_size","_update_version","update_version","key","v","set","__privateGet","size","has","sources","s","get","__privateMethod","call","forEach","callbackfn","this_arg","read_all_fn","prev_res","res","version","increment","v_reactions","reactions","Set","every","r","delete","clear","values","keys","entries","iterator","WeakMap","WeakSet","source_fn","source","__superGet","prototype","SvelteMap","lesson","$.prop","$$props","isFlipped","$.state","currentVocabularyIndex","showAllVocabulary","vocabularyItems","$.derived","vocabulary","map","vocab","id","german","split","bulgarian","partOfSpeech","difficulty","Date","now","safeVocabularyItems","$.get","length","currentVocabulary","completionPercentage","Math","round","objectives","filter","obj","isCompleted","toggleFlip","$.set","getDifficultyColor","A1","A2","B1","B2","C1","div","root","div_1","$.child","__keydown","e","div_2","div_3","div_4","div_5","h3","p","div_6","div_7","div_8","span","div_9","div_10","$.each","node_1","slice","span_1","root_2","$.set_text","text_5","span_2","root_3","consequent","node_3","span_3","root_5","text_7","button","root_6","__click","text_8","$.reset","$.append","$$anchor","consequent_2","$$render","consequent_1","alternate","div_11","button_1","$.sibling","onStart","div_12","div_13","button_3","div_14","h3_1","div_15","ul","objective","li","root_7","label","input","$.remove_input_defaults","__change","toggleObjective","objectiveId","updatedAt","span_4","classes","completed","text_11","description","div_16","h4","div_17","button_4","span_5","button_5","div_18","div_19","div_20","div_21","span_6","root_8","$.template_effect","text_16","consequent_3","span_7","root_9","$0","text_17","repeat","consequent_4","div_22","$.index","index","div_23","root_10","span_8","span_9","$.set_class","div_24","title","text","duration","type","text_2","text_3","$.set_style","$.set_attribute","$2","text_9","text_10","text_12","disabled","text_13","text_14","text_15","grammar","conversation","reading","listening","writing","culture","mixed","contextual","getSourceText","item","appState","languageMode","hasError","errorMessage","handleError","error","context","console","currentSectionIndex","showAllObjectives","$.proxy","$.user_effect","Error","err","message","sections","content","metadata","currentSection","hasVocabulary","hasObjectives","hasSections","isFallbackLesson","fallback","nextSection","prevSection","getSectionIcon","introduction","exercise","cultural","summary","sectionNames","t","getSectionTypeName","root_1","window","location","reload","p_1","text_4","$.first_child","fragment_1","h1","tags","tag","h3_2","button_2","li_1","consequent_5","root_11","h3_3","text_18","root_12","text_20","consequent_6","root_13","root_14","root_15","correctPartOfSpeech","noun","verb","adjective","adverb","preposition","conjunction","pos","consequent_7","root_16","consequent_8","getTargetText","consequent_9","getVocabularyPreview","count","join","consequent_10","root_17","div_25","text_25","div_26","button_6","text_27","div_27","div_28","div_29","h2","div_30","div_31","div_32","div_33","root_18","templateId","consequent_11","div_34","div_35","section","div_36","root_19","div_37","div_38","div_39","text_33","text_26","$3","$4","text_29","$8","replace","div_40","root_20","text_35","consequent_12","div_41","node_13","button_7","history","back","button_8","alert","$1","alternate_1","alternate_2","VocabularyItemBaseSchema","z.object","LegacyIdSchema","z.string","min","max","PartOfSpeechSchema","default","z.number","describe","categories","z.array","VocabularyCategorySchemaWithFallback","VocabularyMetadataSchema","optional","createdAt","z.union","z.date","datetime","transform","str","val","isCommon","z.boolean","isVerified","VocabularyReferenceSchema","omit","uuid","LessonDifficultySchema","z.enum","LessonTypeSchema","LearningObjectiveSchema","LessonMetadataSchema","prerequisites","relatedLessons","isPremium","LessonSchema","catch","_ctx","lessonService","lessons","vocabularyData","initialized","initialize","db","vocabData","getVocabulary","normalizeCategories","learningPhase","cefrLevel","normalizeCefrLevel","_error","isInitialized","generateLessonFromVocabulary","options","createFallbackLesson","lessonTitle","generateLessonTitle","lessonDifficulty","determineLessonDifficulty","createLearningObjectives","crypto","randomUUID","generateLessonDescription","calculateLessonDuration","normalizeVocabularyItem","generateLessonTags","validateLesson","generateLessonFromCriteria","criteria","queryVocabulary","limitedItems","limit","difficultyRange","getDifficultyRange","difficultyMatch","categoryMatch","some","includes","category","partOfSpeechMatch","level","add","typeName","categoryEntry","next","done","getCategoryDisplayName","partsOfSpeech","partOfSpeechList","Array","from","getPartOfSpeechDisplayName","itemCount","baseDuration","push","greetings","numbers","family","food","colors","animals","clothing","home","nature","transport","technology","time","weather","professions","places","pronoun","interjection","article","number","phrase","expression","allowed","normalized","Boolean","avgDifficulty","reduce","sum","result","safeParse","success","data","_errorMessage","getLessons","getLessonById","find","addLesson","validatedLesson","updateLesson","updates","findIndex","baseLesson","updatedLesson","removeLesson","initialLength","getLessonsByDifficulty","getLessonsByType","getLessonsByTag","getRandomLessons","sort","random","enhancedLessonService","generateDynamicLesson","params","validatedParams","validateLessonGenerationParams","generatedLesson","lessonGenerationEngine","generateLesson","convertGeneratedLessonToLesson","generateThematicLesson","userId","isLessonDifficulty","includePractice","includeReview","generateGrammarLesson","conceptType","includeComparison","generateMixedLesson","defaults","sectionContent","learningObjectives","uuidv4","normalizeDifficulty","normalizeLessonType","normalizeVocabulary","grammarConcepts","concept","name","displayName","difficultyLevel","focusArea","vocabCount","grammarConceptsText","items","isLessonType","normalizedCriteria","isObject","CLASS_VALUE_PRIMITIVE_TYPES","isClassValue","isArray","Object","getPrototypeOf","BoxSymbol","isWritableSymbol","boxWith","getter","setter","derived","current","composeHandlers","handlers","handler","defaultPrevented","COMMENT_REGEX","NEWLINE_REGEX","WHITESPACE_REGEX","PROPERTY_REGEX","COLON_REGEX","VALUE_REGEX","SEMICOLON_REGEX","TRIM_REGEX","EMPTY_STRING","trim","StyleToObject","style","styleObject","declarations","TypeError","lineno","column","updatePosition","lines","match","i","lastIndexOf","position","start","line","node","Position","whitespace","end","msg","reason","filename","silent","re","m","exec","comments","rules","c","comment","charAt","declaration","prop","ret","property","decl","decls","parse","hasIterator","NUMBER_CHAR_RE","STR_SPLITTERS","isUppercase","char","test","toLowerCase","pascalCase","parts","previousUpper","previousSplitter","buff","isSplitter","isUpper","lastChar","at","splitByCase","toUpperCase","upperFirst","cssToStyleObj","css","styleObj","startsWith","lowerFirst","executeCallbacks","callbacks","args","callback","camelToKebab","matcher","replacer","regex","RegExp","createParser","styleToString","styleToCSS","EVENT_LIST_SET","isEventHandler","mergeProps","props","a","b","aIsFunction","bIsFunction","aHandler","bHandler","aIsClassValue","bIsClassValue","clsx","aIsObject","bIsObject","aIsString","bIsString","parsedStyle","parsedStyleA","parsedStyleB","getOwnPropertySymbols","replaceAll","hidden","defaultWindow","document","__privateSet","_document","createSubscriber","update","cleanupFocusIn","on","cleanupFocusOut","_a","activeElement","shadowRoot","getActiveElement","Context","_name","_key","exists","hasContext","getContext","getOr","setContext","runWatcher","flush","effect","lazy","active","previousValues","$.user_pre_effect","runEffect","cleanup","untrack","watch","onDestroyEffect","fn","afterTick","tick","then","pre","isHTMLElement","nodeType","nodeName","isShadowRoot","isNode","getDocument","isDocument","isWindow","ownerDocument","DOMContext","element","__publicField","getRootNode","defaultView","rootNode","el","selector","querySelector","querySelectorAll","delay","getWindow","setTimeout","timeoutId","clearTimeout","getElementById","attachRef","ref","onChange","isConnected","boolToEmptyStrOrUndef","condition","BitsAttrs","config","_variant","_prefix","getVariant","component","getAttr","bind","attrs","fromEntries","part","variantOverride","createBitsAttrs","bitsAttrs","isBrowser","isIOS","navigator","userAgent","maxTouchPoints","HTMLElement","AnimationsComplete","opts","_AnimationsComplete_instances","_opts","_currentFrame","cleanup_fn","run","getAnimations","requestAnimationFrame","animations","Promise","allSettled","animation","finished","cancelAnimationFrame","executeCallback_fn","execute","PresenceManager","open","enabled","isOpen","_shouldRender","_afterAnimations","onComplete","shouldRender","noop","createId","prefixOrUid","uid","dialogAttrs","DialogRootContext","_triggerNode","_contentNode","_overlayNode","_descriptionNode","_contentId","_titleId","_triggerId","_descriptionId","_cancelNode","_nestedOpenCount","DialogRootState","_DialogRootState","parent","variant","depth","handleOpen","handleClose","contentPresence","contentNode","onOpenChangeComplete","overlayPresence","overlayNode","incrementNested","decrementNested","create","triggerNode","descriptionNode","contentId","titleId","triggerId","descriptionId","cancelNode","nestedOpenCount","sharedProps","DialogCloseState","_DialogCloseState","getBitsAttr","onclick","onkeydown","tabindex","attachment","preventDefault","DialogTitleState","_DialogTitleState","role","DialogDescriptionState","_DialogDescriptionState","DialogContentState","_DialogContentState","pointerEvents","outline","snippetProps","DialogOverlayState","_DialogOverlayState","$.props_id","restProps","$.rest_props","titleState","mergedProps","$.snippet","child","$.attribute_effect","get_key","render_fn","hydrating","hydrate_next","branches","BranchManager","legacy","is_runes","block","ensure","BitsConfigContext","BitsConfigState","resolveConfigOption","currentOpts","createConfigResolver","defaultPortalTo","defaultLocale","resolvePortalToProp","configOption","getProp","getBitsConfig","propValue","option","to","getAllContexts","instance","target","localTarget","unmountInstance","unmount","mount","PortalConsumer","children","debounce","wait","timeout","debounced","destroy","isOrContainsTarget","contains","getOwnerDocument","candidateSelectors","candidateSelector","NoElement","Element","matches","msMatchesSelector","webkitMatchesSelector","_element$getRootNode","_isInert","lookUp","_node$getAttribute","inertAtt","getAttribute","parentNode","getCandidates","includeContainer","candidates","apply","unshift","_getCandidatesIteratively","elements","elementsToCheck","shift","tagName","assigned","assignedElements","nestedCandidates","flatten","scopeParent","getShadowRoot","validShadowRoot","shadowRootFilter","_nestedCandidates","hasTabIndex","isNaN","parseInt","getTabIndex","tabIndex","_node$getAttribute2","attValue","isContentEditable","sortOrderedTabbables","documentOrder","isInput","isNonTabbableRadio","isRadio","radioSet","radioScope","form","queryRadios","CSS","escape","checked","nodes","getCheckedRadio","isTabbableRadio","isZeroArea","_node$getBoundingClie","getBoundingClientRect","width","height","isHidden","_ref","displayCheck","checkVisibility","checkOpacity","opacityProperty","contentVisibilityAuto","visibilityProperty","checkVisibilityCSS","getComputedStyle","visibility","nodeUnderDetails","parentElement","originalNode","assignedSlot","host","_nodeRoot","_nodeRootHost","_nodeRootHost$ownerDo","_node$ownerDocument","nodeRoot","nodeRootHost","attached","_nodeRoot2","_nodeRootHost2","_nodeRootHost2$ownerD","isNodeAttached","getClientRects","isNodeMatchingSelectorFocusable","isHiddenInput","isDetailsWithSummary","isDisabledFromFieldset","isNodeMatchingSelectorTabbable","isShadowRootTabbable","shadowHostNode","_sortByOrder","regularTabbables","orderedTabbables","isScope","candidateTabindex","getSortOrderTabIndex","acc","sortable","concat","focusableCandidateSelector","CONTEXT_MENU_TRIGGER_ATTR","CONTEXT_MENU_CONTENT_ATTR","globalThis","bitsDismissableLayers","_isResponsibleLayer","_isFocusInsideDOMTree","_documentObj","_unsubClickListener","_DismissibleLayerState_instances","addEventListeners_fn","_markInterceptedEvent","_markResponsibleLayer","capture","_markNonInterceptedEvent","_handleFocus","_handleInteractOutside","_resetState","isAnyEventIntercepted_fn","_interceptedEvents","_onfocuscapture","_onblurcapture","DismissibleLayerState","_DismissibleLayerState","pointerdown","event","_isTargetWithinLayer","_onFocusOutside","createWrappedEvent","_interactOutsideProp","isEventValid","isValidEvent","SVGElement","targetIsContextMenuTrigger","closest","nodeIsContextMenu","isValid","documentElement","clientX","clientY","rect","left","right","top","bottom","isClickTrulyOutside","_behaviorType","pointerType","_handleDismiss","once","layersArr","topMostLayer","findLast","_","behaviorType","getTopMostDismissableLayer","firstLayerNode","isResponsibleLayer","eventType","onfocuscapture","onblurcapture","interactOutsideBehavior","onInteractOutside","onFocusOutside","unsubEvents","capturedCurrentTarget","currentTarget","capturedTarget","newEvent","PointerEvent","isPrevented","Proxy","bitsEscapeLayers","_addEventListener","EscapeLayerState","_EscapeLayerState","domContext","_onkeydown","passive","isResponsibleEscapeLayer","clonedEvent","KeyboardEvent","escapeKeydownBehavior","onEscapeKeydown","_FocusScopeManager","_scopeStack","initialValue","simpleBox","_focusHistory","_preFocusHistory","getInstance","register","scope","getActive","pause","body","unregister","resume","setFocusMemory","getFocusMemory","isActiveScope","setPreFocusMemory","getPreFocusMemory","clearPreFocusMemory","FocusScopeManager","_paused","_container","_FocusScope_instances","_cleanupFns","handleOpenAutoFocus_fn","CustomEvent","bubbles","cancelable","onOpenAutoFocus","firstTabbable","getFirstTabbable_fn","focus","handleCloseAutoFocus_fn","onCloseAutoFocus","preFocusedElement","_manager","setupEventListeners_fn","trap","container","doc","lastFocused","isFocusable","firstFocusable","getAllFocusables_fn","loop","tabbables","getTabbables_fn","first","last","shiftKey","observer","MutationObserver","elementToFocus","observe","childList","subtree","disconnect","FocusScope","_FocusScope","paused","use","bitsTextSelectionLayers","_unsubSelectionLock","_TextSelectionLayerState_instances","_pointerdown","_resetSelectionLock","onPointerUp","TextSelectionLayerState","_TextSelectionLayerState","highestLayer","isHighestLayer","onPointerDown","originalBodyUserSelect","getUserSelect","originalNodeUserSelect","setUserSelect","preventTextSelectionOverflow","isEnabled","userSelect","webkitUserSelect","bitsIdCounter","_subscribers","_state","_SharedState_instances","dispose_fn","_scope","lockMap","initialBodyStyle","stopTouchMoveListener","cleanupTimeoutId","isInCleanupTransition","anyLocked","cleanupScheduledAt","bodyLockStackCount","factory","_factory","$.effect_root","cancelPendingCleanup","ensureInitialStyleCaptured","bodyStyle","verticalScrollbarWidth","innerWidth","clientWidth","Number","paddingRight","marginRight","setProperty","overflow","touches","resetBodyStyle","setAttribute","removeProperty","scheduleCleanupIfNoNewLocks","currentCleanupId","actualDelay","isAnyLocked","BodyScrollLock","initialState","restoreScrollDelay","_id","prefix","useId","_restoreScrollDelay","_initialState","_countState","locked","preventScroll","forceMount","overlayState","$.noop","descriptionState","onOpenChange","closeState","trapFocus","contentState","focusScope","$$arg0","focusScopeProps","EscapeLayer","$.spread_props","dismissibleLayerState","DismissibleLayer","preventOverflowTextSelection","TextSelectionLayer","ScrollLock","node_4","focusScopeState","className","rest","DialogPrimitive_Portal","DialogPortal","cn","DialogPrimitive_Overlay","DialogOverlay","DialogPrimitive_Content","DialogPrimitive_Close","color","strokeWidth","iconNode","x1","y1","x2","y2","svg","$$item","$$array","$$element","X","class","onClose","onLessonGenerated","isGenerating","successMessage","lessonParams","isVocabularyLesson","isGrammarLesson","isMixedLesson","generateLabel","generatingLabel","closeModal","getDifficultyLevels","getVocabularyCategories","getPartsOfSpeech","getLessonTypes","DialogPrimitive_Root","$$value","Dialog","DialogContent","DialogHeader","DialogPrimitive_Title","DialogTitle","DialogPrimitive_Description","DialogDescription","text_1","label_1","textarea","$.remove_textarea_child","label_2","select","__value","node_5","option_1","getLessonTypeName","label_3","select_1","option_2","node_6","option_3","label_4","select_2","option_4","node_8","option_5","house","common_phrases","uncategorized","label_5","select_3","option_6","node_9","option_7","$.bind_select_value","label_6","input_1","$.bind_value","node_10","label_7","select_4","option_8","option_9","option_10","option_11","option_12","label_8","input_2","label_9","input_3","text_30","$.bind_checked","label_10","input_4","text_31","DialogFooter","Button","node_14","text_32","node_15","async","isLoading","selectedDifficulty","selectedType","showLessonGenerationModal","showGeneratedLesson","typeLabels","de","bg","categoryLabels","partOfSpeechLabels","ui","subtitle","createDynamicLesson","createLesson","createFirstLesson","loading","retry","emptyTitle","emptyDescription","difficultyLabel","typeLabel","allLevels","allTypes","backToLessons","showingLessons","shown","total","resetFilters","mixedEveryday","basicVocabulary","categoryPrefix","grammarPrefix","filteredLessons","typeMatch","loadLessons","generatedLessons","vocabularyStats","getVocabularyStatsByDifficulty","difficulties","lessonCount","floor","getVocabularyByCategory","getVocabularyByPartOfSpeech","getVocabularyCount","warn","fallbackLessons","byDifficulty","transliteration","culturalNotes","generateFallbackLessons","generateComprehensiveLessons","closeGeneratedLesson","types","labels","header","p_2","p_3","text_6","fragment_2","GeneratedLesson","LessonCard","p_4","fragment_4","alternate_3","LessonGenerator"],"mappings":"+9DA6BO,SAASA,KACf,OAAOC,OAAOC,GACf,CCqBO,MAAMC,GAAN,cAAwBC,IAU9B,WAAAC,CAAYC,GAWX,GAVAC,QAXKC,GAAAC,KAAAC,GAENF,GAAAC,KAAAE,MAAeP,KACfI,GAAAC,KAAAG,EAAWC,GAAM,IACjBL,GAAAC,KAAAK,EAAQD,GAAM,IACdL,GAAAC,KAAAM,EAAkBC,KAAkB,GAgB/BV,EAAO,CACV,IAAA,IAAUW,EAAKC,KAAMZ,EACpBC,MAAMY,IAAIF,EAAKC,GAEhBE,GAAAX,KAAKK,GAAMI,EAAIX,MAAMc,IACtB,CACD,CAgBA,GAAAC,CAAIL,GACH,IAAIM,EAAUH,GAAAX,KAAKE,GACfa,EAAID,EAAQE,IAAIR,GAEpB,QAAU,IAANO,EAAiB,CAEpB,QAAY,IADFjB,MAAMkB,IAAIR,GAanB,OADAQ,GAAIL,QAAKR,KACF,EAXPY,EAAIE,GAAAjB,KAAKC,KAALiB,KAAAlB,KAAa,GAMjBc,EAAQJ,IAAIF,EAAKO,EAOnB,CAGA,OADAC,GAAID,IACG,CACR,CAMA,OAAAI,CAAQC,EAAYC,GACnBJ,GAAAjB,KAAKC,EAAAqB,GAALJ,KAAAlB,MACAF,MAAMqB,QAAQC,EAAYC,EAC3B,CAGA,GAAAL,CAAIR,GACH,IAAIM,EAAUH,GAAAX,KAAKE,GACfa,EAAID,EAAQE,IAAIR,GAEpB,QAAU,IAANO,EAAiB,CAEpB,QAAY,IADFjB,MAAMkB,IAAIR,GAanB,YADAQ,GAAIL,QAAKR,IAVTY,EAAIE,GAAAjB,KAAKC,KAALiB,KAAAlB,KAAa,GAMjBc,EAAQJ,IAAIF,EAAKO,EAOnB,CAGA,OADAC,GAAID,GACGjB,MAAMkB,IAAIR,EAClB,CAMA,GAAAE,CAAIF,EAAKX,GACR,IAAIiB,EAAUH,GAAAX,KAAKE,GACfa,EAAID,EAAQE,IAAIR,GAChBe,EAAWzB,MAAMkB,IAAIR,GACrBgB,EAAM1B,MAAMY,IAAIF,EAAKX,GACrB4B,EAAUd,GAAAX,KAAKG,GAEnB,QAAU,IAANY,EACHA,EAAIE,GAAAjB,KAAKC,KAALiB,KAAAlB,KAAa,GAMjBc,EAAQJ,IAAIF,EAAKO,GACjBL,GAAIC,GAAAX,KAAKK,GAAOP,MAAMc,MACtBc,GAAUD,QACX,GAAWF,IAAa1B,EAAO,CAC9B6B,GAAUX,GAGV,IAAIY,EAAoC,OAAtBF,EAAQG,UAAqB,KAAO,IAAIC,IAAIJ,EAAQG,YAErD,OAAhBD,IACCZ,EAAEa,WAAWE,MAAOC,GAC4BJ,EAAad,IAAIkB,MAGlEL,GAAUD,EAEZ,CAEA,OAAOD,CACR,CAGA,OAAOhB,GACN,IAAIM,EAAUH,GAAAX,KAAKE,GACfa,EAAID,EAAQE,IAAIR,GAChBgB,EAAM1B,MAAMkC,OAAOxB,GASvB,YAPU,IAANO,IACHD,EAAQkB,OAAOxB,GACfE,GAAIC,GAAAX,KAAKK,GAAOP,MAAMc,MACtBF,GAAIK,GAAG,GACPW,GAAUf,QAAKR,KAGTqB,CACR,CAEA,KAAAS,GACC,GAAmB,IAAfnC,MAAMc,KAAV,CAIAd,MAAMmC,QACN,IAAInB,EAAUH,GAAAX,KAAKE,GAEnB,IAAA,IAASa,KADTL,GAAIC,GAAAX,KAAKK,GAAO,GACFS,EAAQoB,UACrBxB,GAAIK,GAAG,GAERW,GAAUf,QAAKR,IACfW,EAAQmB,OATR,CAUD,CAwBA,IAAAE,GAEC,OADAnB,GAAIL,QAAKR,IACFL,MAAMqC,MACd,CAEA,MAAAD,GAEC,OADAjB,GAAAjB,KAAKC,EAAAqB,GAALJ,KAAAlB,MACOF,MAAMoC,QACd,CAEA,OAAAE,GAEC,OADAnB,GAAAjB,KAAKC,EAAAqB,GAALJ,KAAAlB,MACOF,MAAMsC,SACd,CAEA,CAAC5C,OAAO6C,YACP,OAAOrC,KAAKoC,SACb,CAEA,QAAIxB,GAEH,OADAI,GAAIL,QAAKN,IACFP,MAAMc,IACd,GAzNAV,EAAA,IAAAoC,QACAnC,EAAA,IAAAmC,QACAjC,EAAA,IAAAiC,QACAhC,EAAA,IAAAgC,QALMrC,EAAA,IAAAsC,QAsCNC,EAAO,SAAC3C,GACP,OAAOU,KAAmBI,GAAAX,KAAKM,GAAkBF,GAAMP,GAAS4C,GAAO5C,EACxE,EAuIAyB,EAAS,WACRN,GAAIL,QAAKR,IAET,IAAIW,EAAUH,GAAAX,KAAKE,GACnB,GAAIS,GAAAX,KAAKK,GAAMI,IAAMK,EAAQF,KAC5B,IAAA,IAASJ,4BAAOkC,CAAAhD,GAAAiD,UAAA3C,KAAM,QAAAkB,KAANlB,MACf,IAAKc,EAAQD,IAAIL,GAAM,CACtB,IAAIO,EAAIE,GAAAjB,KAAKC,EAAAuC,GAALtB,KAAAlB,KAAa,GAKrBc,EAAQJ,IAAIF,EAAKO,EAClB,CAIF,MAAQA,KAAMJ,QAAKT,GAClBc,GAAID,EAEN,EAnMM,IAAM6B,GAANlD,s8FC1CCmD,EAAMC,GAAAC,EAAA,SAAA,GAGRC,EAAYC,IAAO,GACnBC,EAAyBD,GAAO,GAChCE,EAAoBF,IAAO,GAG3BG,EAAeC,GAAA,IACjBR,IAAOS,WAAWC,IAAKC,GACA,iBAAVA,GAEPC,GAAID,EACJE,OAAQF,EAAMG,MAAM,KAAK,IAAMH,EAC/BI,UAAWJ,EAAMG,MAAM,KAAK,IAAMH,EAClCK,aAAc,OACdC,WAAY,GAELN,GAA0B,iBAAVA,GAEvBC,GAAID,EAAMC,IAAE,SAAaM,KAAKC,QAC9BN,OAAQF,EAAME,QAAUF,EAAMI,WAAa,UAC3CA,UAAWJ,EAAMI,WAAaJ,EAAME,QAAU,UAC9CG,aAAcL,EAAMK,cAAgB,OACpCC,WAAYN,EAAMM,YAAc,IAIhCL,GAAE,SAAWM,KAAKC,QAClBN,OAAQ,UACRE,UAAW,UACXC,aAAc,OACdC,WAAY,KAOhBG,EAAmBZ,GAAA,IAAAa,GAAYd,GAAgBe,OAAS,KAAIf,KAC9DK,GAAI,iBACJC,OAAQ,UACRE,UAAW,SACXC,aAAc,OACdC,WAAY,KAGVM,YAA6BH,GAAmBC,GAAChB,KAAsBgB,GAAKD,GAAoB,IAChGI,EAAoBhB,GAAA,IACtBiB,KAAKC,MAAO1B,IAAO2B,WAAWC,OAAQC,GAAaA,EAAIC,aAAaR,OAAStB,IAAO2B,WAAWL,OAAU,MAIlG,SAAAS,IACPC,GAAA7B,MAAaA,GACf,UAqBS8B,EAAmBhB,SACoB,CAC5CiB,GAAM,+CACNC,GAAM,+CACNC,GAAM,4CACNC,GAAM,4CACNC,GAAM,mDAEMrB,IAAe,2CAC/B,KAmBDsB,EAAGC,KAEDC,EAAAC,GAFFH,GAEEE,EAGCE,UAAWC,GAAe,UAAVA,EAAEjF,KAA6B,MAAViF,EAAEjF,IAAcoE,IAAe,KAKnE,IAAAc,EAAGH,GARLD,GASIK,KADFD,GAEIE,KADFD,QACEC,MAAAA,GAGA,IAAAC,KAHAD,EAAG,QAGHC,GAAG,MAAHA,MAJFF,GASA,IAAAG,KATAH,EAAG,QASHG,GAAE,MAAFA,GAEA,IAAAC,KAFAD,EAAE,QAEFC,GAAC,MAADA,GAIA,IAAAC,KAJAD,EAAC,GAKCE,KADFD,GAEIE,EAAAX,GADFU,MAAAA,GAUA,IAAAE,KAVAF,EAAG,QAUHE,MAAAA,MAXFH,GAcA,IAAAI,KAdAJ,EAAG,GAeDK,KADFD,QACEC,4BAEUC,GAAAC,EAAA,GAAA,IAAArC,GAAAd,GAAgBoD,MAAM,EAAG,SAAMhD,SACnCiD,EAAIC,UAAJD,GAAI,MAAJA,cAAAA,EAAI,QAAAvC,GAA+BV,GAAME,QACvCiD,GAAAC,EAAA1C,GAAAV,GAAME,eADR+C,6BAKAI,EAAIC,UAAJD,MAAAA,uBAAmCzD,GAAgBe,OAAS,UAA5D0C,gBADEzD,GAAgBe,OAAS,KAAC4C,uCAIxBT,GAAAU,EAAA,GAAA,IAAA9C,GAAAd,GAAgBoD,MAAM,EAAG,SAAMhD,SACnCyD,EAAIC,UAAJD,GAAI,MAAJA,cAAAA,EAAI,QAAA/C,GAA+BV,GAAME,QACvCiD,GAAAQ,EAAAjD,GAAAV,GAAME,eADRuD,yBAKA,IAAAG,EAAAC,KAAAD,EAECE,QAAO,IAAAzC,GAAQ1B,GAAoB,GAFpC,IAAAoE,EAAAhC,GAAA6B,GAAAI,GAAAJ,cAAAA,EAAA,aAAA,YAAAlD,GAGyBd,GAAgBe,wCAEtCf,GAAgBe,OAAS,MAL5BsD,GAAAC,EAAAN,gBADEhE,GAAgBe,OAAS,KAACwD,0BAf5BxE,GAAiByE,EAAAC,GAAAD,EAAAE,GAAA,QADvBzB,MADFD,GA8BA,IAAA2B,KA9BA3B,EAAG,GA+BD4B,EAAAzC,GADFwC,GACEC,EAECV,QAAS1C,EAKVqD,GAPAD,EAAA,GASCV,QAAO,IAAAvE,EAAAmF,eAVVH,MA5DFrC,GA+EA,IAAAyC,KA/EAzC,EAAG,GAgFD0C,KADFD,GAEIE,EAAA9C,GADF6C,GACEC,EAECf,QAAS1C,EAKV,IAAA0D,EAAGL,GAPHI,EAAA,QAOAC,MAAAA,MARFF,GAaA,IAAAG,KAbAH,EAAG,QAaHG,GAAE,MAAFA,GAEA,IAAAC,KAFAD,EAAE,GAIAE,QAFFD,GAAG,MAEDC,EAAE,GAAA,IACM5F,IAAO2B,WAAckE,GAAWA,EAAUjF,GAAE,CAAAiE,EAAvBgB,SACzBC,EAAEC,KACAC,KADFF,GAEIG,EAAAvD,GADFsD,GACEE,GAAAD,GAAAA,EAGCE,SAAQ,KAAQC,OArJPC,EAqJsBhF,GAACwE,GAAUjF,GApJxDZ,IAAO2B,WAAa3B,IAAO2B,WAAWjB,IAAKmB,GACzCA,EAAIjB,KAAOyF,EAAW,IAAQxE,EAAKC,aAAcD,EAAIC,aAAgBD,QAEvE7B,IAAOsG,UAAS,IAAOpF,UAJAmF,GAuJV,IAAAE,EAAInB,GALJa,EAAA,kBAKAM,GAAI,MAAJA,MANFP,MADFF,cAEIG,EAAA5E,GAEUwE,GAAU/D,kBAGpByE,EAAI,EAAA,iBAAA,KAAAC,EAAA,CAAAC,UAAApF,GAAkBwE,GAAU/D,cAC9BgC,GAAA4C,EAAArF,GAAAwE,GAAUc,oBARhBb,QAFJF,MAFFD,GAoBA,IAAAiB,KApBAjB,EAAG,GAqBDkB,KADFD,QACEC,MAAAA,GAEA,IAAAC,KAFAD,EAAE,GAGAE,EAAArE,GADFoE,GACEC,EACCtC,QA3KD,cACHpE,GAAyB,MAC3BA,GAAsB,EAE1B,EA6KS,IAAA2G,EAAI5B,GAPJ2B,EAAA,QAOAC,MAAAA,GAGA,IAAAC,EAAA7B,GAHA4B,EAAI,GAGJC,EACCxC,QA3LD,WACHpD,GAAAhB,MAAyBE,GAAgBe,OAAS,MACpDjB,EAEJ,KA2KOyG,GAoBA,IAAAI,KApBAJ,EAAG,GAqBDK,MADFD,SACEC,IAAG,MAAHA,IAGA,IAAAC,MAHAD,GAAG,SAGHC,IAAG,MAAHA,IAGA,IAAAC,MAHAD,GAAG,SAGHC,eAEIC,EAAIC,UAAJD,GAAI,MAAJA,GACEE,GAAA,IAAA1D,GAAA2D,EAAApG,GAAAE,GAAkBP,oBADpBsG,cADEjG,GAAAE,IAAmBP,gBAAY0G,iCAMjCC,EAAIC,UAAJD,GAAI,MAAJA,GACEH,GAAAK,GAAA/D,GAAAgE,EAAAD,GAAA,CAAA,IAAA,IAAIE,OAAM1G,GAACE,GAAkBN,mBAD/B0G,cADEtG,GAAAE,IAAmBN,cAAU+G,SANnCX,OAPFH,GAqBA,IAAAe,MArBAf,EAAG,MAqBHe,GAAG,GAAA,IAAA5G,GACKd,GAAe2H,GAAA,CAAArD,EAAIlE,EAAKwH,KAC5B,IAAAC,EAAAC,KAAAD,EAEC3D,QAAO,IAAAzC,GAAQ3B,EAAyB8H,GAAK,GAF9CC,EAKCzF,UAAWC,GAAe,UAAVA,EAAEjF,IAAeqE,GAAG3B,EAAyB8H,MAAQ,KAEpE,IAAAG,EAAI5F,GAPN0F,QAOEE,GAAI,MAAJA,GACA,IAAAC,KADAD,EAAI,QACJC,GAAI,MAAJA,GARF5D,GAAAyD,WAAAI,GAAAJ,EAAA,EAAA,yBAC8BD,IAAK9G,GAAKhB,GAAyB,SAAW,IAAE,0BAMjDM,IAAOE,QAAU,mBACdF,IAAOI,WAAa,aARpD6D,GAAAC,EAAAuD,QAFJH,OA5CFrB,GA4DA,IAAA6B,MA5DA7B,EAAG,GA6DDlE,GADF+F,IAGGhE,QAAO,IAAAvE,EAAAmF,eAHVoD,OAhGFnD,GAvFFX,GAAAlC,MAFFF,gBAEEiG,GAAA/F,EAAA,EAAA,gBAAApB,GACqBlB,GAAY,UAAY,IAAE,qBAD/CsC,EAAA,aAAA,WAIwBzC,IAAO0I,YAMzB3F,EAAG,EAAA,gBAAA8E,GAAA,KAAA,kBACD/D,GAAA6E,EAAA,GAAA3I,IAAOiB,YAAU,QAAKjB,IAAO4I,UAAQ,aAEvC5F,EAAG,aAAA,gBAAsDhD,IAAO6I,gBAKzC/E,GAAAgF,EAAA9I,IAAO0I,OAG9B5E,GAAAiF,EAAA/I,IAAO2G,aAKLqC,GAAA3F,EAAA,UAAAhC,GAEkBG,OAFlByH,GAAA5F,EAAA,gBAAAhC,GAIgBG,eAKUA,IAAoB,mBA6DhDiE,EAAG,EAAA,gBAAAyD,GAAA,KAAA,kBACDpF,GAAAqF,EAAA,GAAAnJ,IAAOiB,YAAU,QAAKjB,IAAO4I,UAAQ,UAIhB9E,GAAAsF,EAAApJ,IAAO0I,OAuBd5E,GAAAuF,EAAA,eAAAhI,GAAAd,GAAgBe,QAAM,OAGpCyF,EAAAuC,SAEsC,IAFtCjI,GAEWhB,GAMTyD,GAAAyF,EAAA,GAAAlI,GAAAhB,GAAyB,OAACgB,GAAKd,GAAgBe,QAAM,MAEvD2F,EAAAqC,SAAAjI,GAEWhB,KAAsBgB,GAAKd,GAAgBe,OAAS,EAS7DwC,GAAA0F,GAAAnI,GAAAE,GAAkBV,QAGlBiD,GAAA2F,GAAApI,GAAAE,GAAkBR,iBA7IGkB,EAAmBjC,IAAOiB,iBA5BjB,CACrCR,WAAc,KACdiJ,QAAW,KACXC,aAAgB,KAChBC,QAAW,KACXC,UAAa,KACbC,QAAW,KACXC,QAAW,MACXC,MAAS,KACTC,WAAc,MAuBSjK,IAAO6I,OArBV,UAuGQ5G,EAAmBjC,IAAOiB,mBAlG3DsB,OAHD,qnHClGW2H,EAAcC,SACY,UAA1BC,GAASC,aAA2BF,EAAKtJ,OAASsJ,EAAKpJ,SAChE,cAeMf,EAAMC,GAAAC,EAAA,SAAA,GAGRoK,EAAWlK,IAAO,GAClBmK,EAAenK,GAAO,MAGjB,SAAAoK,EAAYC,EAAOC,GAC1BC,QAAQF,MAAK,IAAKC,KAAYD,EAChC,KAGIG,EAAsBxK,GAAO,GAC7BE,EAAoBF,IAAO,GAC3ByK,EAAoBzK,IAAO,GACT0K,GAAA,CAAA,GAGtBC,GAAO,KACD,IAEG,IAAA/K,IACO,MAAA,IAAAgL,MAAM,0BAEpB,OAASC,GACPT,EAAYS,EAAK,kDACjBjJ,GAAAsI,GAAW,MACXC,EAAeU,aAAeD,MAAQC,EAAIC,QAAU,uBAAqB,EAC3E,IAKE,IAAAC,EAAQ3K,GAAA,KACN,WACGR,IAAOmL,UAAuC,IAA3BnL,IAAOmL,SAAS7J,OASjCtB,IAAOmL,WAPVvK,GAAI,kBACJ8H,MAAO,iBACP0C,QAASpL,IAAOoL,SAAW,uBAC3BvC,KAAM,UACNwC,SAAQ,CAAA,GAId,OAASJ,UACPT,EAAYS,EAAK,oCACjBjJ,GAAAsI,GAAW,GACXtI,GAAAuI,EAAe,oCAEb3J,GAAI,gBACJ8H,MAAO,QACP0C,QAAS,gCACTvC,KAAM,UACNwC,SAAQ,CAAA,GAEZ,IAIEC,EAAc9K,GAAA,KACZ,cACK2K,GAAQ9J,GAACuJ,KAAwB,IAC1C,OAASK,UACPT,EAAYS,EAAK,iCACjBjJ,GAAAsI,GAAW,GACXtI,GAAAuI,EAAe,kCACR,IACT,IAGE/I,EAAoBhB,GAAA,KAClB,WACGR,IAAO2B,YAA2C,IAA7B3B,IAAO2B,WAAWL,OACrCG,KAAKC,MAAO1B,IAAO2B,WAAWC,OAAQC,GAAQA,EAAIC,aAAaR,OAAStB,IAAO2B,WAAWL,OAAU,KAD1C,CAEnE,OAAS2J,UACPT,EAAYS,EAAK,6CACjBjJ,GAAAsI,GAAW,GACXtI,GAAAuI,EAAe,gCACR,CACT,IAGEhK,EAAeC,GAAA,KACb,IACK,OAAAR,IAAOS,YAAU,EAC1B,OAASwK,UACPT,EAAYS,EAAK,mCACjBjJ,GAAAsI,GAAW,GACXtI,GAAAuI,EAAe,+BAEjB,IAGEgB,EAAa/K,GAAA,KACX,cACKD,GAAgBe,OAAS,CAClC,OAAS2J,UACPT,EAAYS,EAAK,4CACV,CACT,IAGEO,EAAahL,GAAA,KACX,WACKR,IAAO2B,YAAc3B,IAAO2B,WAAWL,OAAS,CACzD,OAAS2J,UACPT,EAAYS,EAAK,4CACV,CACT,IAGEQ,EAAWjL,GAAA,KACT,cACK2K,GAAS7J,OAAS,CAC3B,OAAS2J,UACPT,EAAYS,EAAK,0CACV,CACT,IAGES,EAAgBlL,GAAA,KACd,IACK,OAA8B,IAA9BR,IAAOqL,UAAUM,QAC1B,OAASV,UACPT,EAAYS,EAAK,oCACV,CACT,IA2BO,SAAAW,IACH,IACEvK,GAAAuJ,MAAsBO,GAAS7J,OAAS,MAC1CsJ,EAEJ,OAASK,GACPT,EAAYS,EAAK,sCACjBjJ,GAAAsI,GAAW,GACXtI,GAAAuI,EAAe,8BACjB,CACF,CAKS,SAAAsB,IACH,OACEjB,GAAsB,MACxBA,GAAmB,EAEvB,OAASK,GACPT,EAAYS,EAAK,0CACjBjJ,GAAAsI,GAAW,GACXtI,GAAAuI,EAAe,8BACjB,CACF,UAeSuB,EAAejD,SACX,CACTkD,aAAgB,KAChBtL,WAAc,KACdiJ,QAAW,KACXsC,SAAY,KACZC,SAAY,MACZC,QAAW,KACXvC,aAAgB,KAChBC,QAAW,KACXC,UAAa,KACbC,QAAW,MAEAjB,IAAS,IACxB,OA6BMsD,EAAY3L,GAAA,KAAA,CAChBuL,aAAgBK,GAAE,0BAA4B,eAC9C3L,WAAc2L,GAAE,wBAA0B,aAC1C1C,QAAW0C,GAAE,qBAAuB,UACpCJ,SAAYI,GAAE,sBAAwB,WACtCH,SAAYG,GAAE,2BAA6B,gBAC3CF,QAAWE,GAAE,qBAAuB,UACpCzC,aAAgByC,GAAE,0BAA4B,eAC9CxC,QAAWwC,GAAE,qBAAuB,UACpCvC,UAAauC,GAAE,uBAAyB,YACxCtC,QAAWsC,GAAE,qBAAuB,sBAG7BC,EAAmBxD,aACnBsD,GAAatD,IAASA,CAC/B,KAoBDtG,EAAGC,UAAHD,aAEIE,EAAG6J,KAEDrJ,QAFFR,GAAG,QAEDQ,GAAE,MAAFA,GACA,IAAAC,KADAD,EAAE,QACFC,GAAC,MAADA,GACA,IAAAqB,KADArB,EAAC,GACDqB,EAAiCE,QAAO,IAAQ8H,OAAOC,SAASC,kBAAhElI,GAAM,MAANA,MAJF9B,0CAEM,IAAA2J,GAAE,mCACH7B,IAAgB6B,GAAE,wBAEnB,IAAAA,GAAE,6BALN3J,uCASAI,EAAGoB,KAEDyB,QAFF7C,GAAG,QAED6C,GAAE,MAAFA,GACA,IAAAgH,KADAhH,EAAE,QACFgH,GAAC,MAADA,GACA,IAAAvH,KADAuH,EAAC,GACDvH,EAAiCV,QAAO,IAAQ8H,OAAOC,SAASC,kBAAhEtH,GAAM,MAANA,MAJFtC,sBAGKiB,GAAA6I,EAAA3M,IAAO2G,sBADN,CAAA,IAAAyF,GAAE,sBAAoB,IAGxBA,GAAE,2BALNvJ,qBASAC,EAAG8J,GAAAC,GACD9J,KADFD,GAEIE,KADFD,QACEC,GAAG,MAAHA,GAGA,IAAA8J,KAHA9J,EAAG,QAGH8J,GAAE,MAAFA,MAJF/J,GAOA,IAAAI,KAPAJ,EAAG,GAQDK,KADFD,QACEC,MAAAA,YAAAA,EAAG,aAIDC,EAAGgB,UAAHhB,eACQrD,IAAOqL,SAAS0B,KAAKpJ,MAAM,EAAG,GAACuE,GAAA,CAAArD,EAAKmI,SACxC1J,EAAIkB,UAAJlB,GAAI,MAAJA,kBAAyB0J,UAAzB1J,6BAGAM,EAAImC,UAAJnC,MAAAA,GAA+B4D,GAAA,IAAA1D,GAAAsF,EAAA,KAAApJ,IAAOqL,SAAS0B,KAAKzL,OAAS,UAA7DsC,aADE5D,IAAOqL,SAAS0B,KAAKzL,OAAS,KAACwD,QAJrCzB,QAAAA,aADErD,IAAOqL,UAAU0B,MAAQ/M,IAAOqL,SAAS0B,KAAKzL,OAAS,GAACyD,EAAA2C,QAJ9DvE,MARFL,GAyBA,IAAAS,KAzBAT,EAAG,QAyBHS,GAAG,MAAHA,GAIA,IAAAC,KAJAD,EAAG,GAKD2B,KADF1B,GAEI8B,EAAA5C,GADFwC,MAAAA,GAUA,IAAAlB,KAVAkB,EAAG,QAUHlB,MAAAA,MAXFR,YAAAA,EAAG,aAeD+B,EAAGgC,KACD9B,KADFF,GAEI0H,KADFxH,QACEwH,GAAE,MAAFA,GACA,IAAAC,EAAA9H,GADA6H,EAAE,GACFC,EAECzI,QAAO,IAAAzC,GAAQ6I,GAAiBxJ,GAAIwJ,IAFrC,IAAArB,EAAA9G,GAAAwK,GAAA,GAAAvI,GAAAuI,MAFFzH,GAUA,IAAAG,KAVAH,EAAG,QAUHG,kBACSiF,GAAoB7K,IAAO2B,WAAa3B,IAAO2B,WAAWgC,MAAM,EAAG,GAAOkC,GAAWA,EAAUjF,GAAE,CAAAiE,EAAvBgB,SAC/EC,EAAE8B,KACA5B,KADFF,GAEIG,EAAAvD,GADFsD,GACEE,GAAAD,GAAAA,EAGCE,SAAQ,aA5NCE,GACnB,QACGrG,IAAO2B,WACA,MAAA,IAAAqJ,MAAM,uCAGlBhL,IAAO2B,WAAa3B,IAAO2B,WAAWjB,IAAKmB,GACzCA,EAAIjB,KAAOyF,EAAW,IAAQxE,EAAKC,aAAcD,EAAIC,aAAgBD,GAEvE7B,IAAOsG,UAAS,IAAOpF,IACzB,OAAS+J,GACPT,EAAYS,EAAK,8BACjBjJ,GAAAsI,GAAW,GACXtI,GAAAuI,EAAe,oCACjB,CACF,CA6MgCnE,CAAe/E,GAACwE,GAAUjF,IAE3C,IAAAwD,EAAIgB,GALJa,EAAA,kBAKA7B,GAAI,MAAJA,MANF4B,MADFF,cAEIG,EAAA5E,GAEUwE,GAAU/D,kBAGpBsC,EAAI,EAAA,gBAAA,KAAAoC,EAAA,CAAAC,UAAApF,GAAkBwE,GAAU/D,cAC9BgC,GAAA2F,EAAApI,GAAAwE,GAAUc,oBARhBb,6BAcAqH,EAAE9E,KACA7C,KADF2H,GACE3H,EAAOf,QAAO,IAAAzC,GAAQ6I,GAAoB,YAA1CrF,MAAAA,MADF2H,kBAEKnN,IAAO2B,WAAWL,OAAS,KAACuG,GAAA,MAAA,CAAA,IAAGuE,GAAE,iCAFtCe,aADEnN,IAAO2B,WAAWL,OAAS,OAAMuJ,IAAiB9F,EAAAiD,QAfxDpC,MAXFL,gCAEQ,IAAA6G,GAAE,gCAKJ,IAAA/K,GAAAwJ,GAAoBuB,GAAE,oBAAsBA,GAAE,0BAPpD7G,gBADEiG,IAAazG,EAAAqI,6BAuCfzH,EAAG0H,KACDzG,KADFjB,GAEI2H,KADF1G,QACE0G,MAAAA,GACA,IAAAvG,EAAA3B,GADAkI,EAAE,GACFvG,EAECtC,QAAO,IAAAzC,GAAQ1B,GAAiBe,GAAIf,IAFrC,IAAAiN,EAAA7K,GAAAqE,GAAA,GAAApC,GAAAoC,MAFFH,GAUA,IAAAE,KAVAF,EAAG,QAUHE,qBAGIP,EAAIiH,UAAJjH,MAAAA,GAA+BiB,GAAAK,GAAA/D,GAAA2J,EAAA,IAAApM,GAAAd,GAAgBe,OAAS,KAACuG,GAAA,MAAA,CAAA,IAAGuE,GAAE,4BAA9D7F,aADElF,GAAAd,GAAgBe,OAAS,OAAMhB,IAAiByE,EAAA2I,QAFtD5G,YAAAA,EAAG,aAQDI,EAAGyG,QAAHzG,EAAG,GAAA,IAAA7F,GACKd,GAAmBI,GAAOA,EAAME,OAAM,CAAAgE,EAAnBlE,SACvBwG,EAAGyG,KAEDxG,KAFFD,QAEEC,GAAG,MAAHA,GAIA,IAAAC,KAJAD,EAAG,QAIHC,GAAG,MAAHA,YAAAA,EAAG,aAIDY,EAAG4F,UAAH5F,GAAG,MAAHA,uBACE6F,MA9ZN,CACTC,KAAQ,OAAQC,KAAQ,OAAQC,UAAa,YAC7CC,OAAU,SAAUC,YAAe,cAAeC,YAAe,eAHxCC,EA+ZShN,GAACV,GAAMK,eA1ZtBqN,MALMA,UA8ZZpG,aADE5G,GAAAV,GAAMK,gBAAYsN,6BAMpBlG,EAAGmG,UAAHnG,GAAG,MAAHA,sBACE,IAAIL,OAAOtG,KAAKC,MAAKL,GAACV,GAAMM,oBAD9BmH,aADE/G,GAAAV,GAAMM,cAAUuN,QAdtBrH,gCAGI,IAAA+C,KAAcvJ,IAId,KAAA8N,OA/ZMtE,KA+ZQxJ,GA9ZI,UAA1ByJ,GAASC,aAA2BF,EAAKpJ,UAAYoJ,EAAKtJ,WAD5CsJ,UAwZVhD,QAFJD,QAAAA,gBADE5G,IAAiByE,EAAA2J,QAlBvB/I,gBAEoC7B,GAAAgE,EAAA,GAAAD,GAAA,OAAAxG,GAAAd,GAAgBe,QAAM,mCAAlD,IAAA8K,GAAE,uBAKJ,IAAA/K,GAAAf,GAAoB8L,GAAE,oBAAsBA,GAAE,mBAKhD,KAAAuC,OA3HqBC,KA2HAtO,GAAiBe,GAAGd,GAAgBe,OAAS,EA1H1C,IAA3BD,GAAAd,GAAgBe,OAAqB,MAEpBf,GAAgBoD,MAAM,EAAGiL,GAE1BlO,IAAKyJ,GAASD,EAAcC,IAAO0E,KAAK,UALhCD,UA+GzBjJ,gBADE4F,IAAaxG,EAAA+J,6BAiDfrG,EAAGsG,KACDC,KADFvG,GAEIxB,EAAAvE,GADFsM,GACE/H,EACCxC,QAASoH,EADV,IAAAoD,EAAAvM,GAAAuE,GAAAtC,GAAAsC,GAQA,IAAAiI,EAAG9J,GARH6B,EAAA,QAQAiI,MAAAA,GAIA,IAAAC,EAAA/J,GAJA8J,EAAG,GAIHC,EACC1K,QAASmH,EADV,IAAAwD,EAAA1M,GAAAyM,GAAAxK,GAAAwK,MAbFH,GAsBA,IAAAK,KAtBAL,EAAG,GAuBDM,KADFD,GAEIE,KADFD,QACEC,GAAG,MAAHA,GAGA,IAAAC,KAHAD,EAAG,QAGHC,GAAE,MAAFA,GAGA,IAAAC,KAHAD,EAAE,QAGFC,GAAG,MAAHA,MAPFH,GAYA,IAAAI,KAZAJ,EAAG,GAaDK,KADFD,QACEC,EAAG,aAGDC,EAAGC,KACD7I,KADF4I,QACE5I,MAAAA,MADF4I,+BAEctE,GAAeD,SAASyE,YAAU,YAFhDF,gBADEtE,GAAeD,UAAUyE,cAAUC,QAHzCL,MAbFL,GA0BA,IAAAW,KA1BAX,EAAG,GA4BDY,QAFFD,GAAG,MAEDC,EAAG,GAAA,IAAA5O,GACK8J,GAAY+E,GAAgBA,EAAQtP,GAAE,CAAAiE,EAA1BqL,EAAO/H,KACvB,IAAAgI,EAAAC,KAAAD,EAEC1L,QAAO,IAAAzC,GAAQ4I,EAAmBvJ,GAAG8G,IAAK,GAF3CgI,EAKCxN,UAAWC,GAAe,UAAVA,EAAEjF,KAA6B,MAAViF,EAAEjF,IAAWqE,GAAG4I,EAAmBvJ,GAAG8G,OAAQ,KAElF,IAAAkI,EAAG3N,GAPLyN,QAOEE,GAAG,MAAHA,GAGA,IAAAC,KAHAD,EAAG,QAGHC,GAAG,MAAHA,GAGA,IAAAC,KAHAD,EAAG,QAGHC,GAAG,MAAHA,GAbF5L,GAAAwL,cAAA3H,GAAA2H,EAAA,EAAA,0BAAA9O,GAC+B8G,KAAK9G,GAAKuJ,GAAsB,SAAW,IAAE,yBAUxE9G,GAAA0M,EAAAnP,GAAA6O,GAAQxH,qBAHRoD,EAAczK,GAAC6O,GAAQrH,UAMvBwD,EAAkBhL,GAAC6O,GAAQrH,QAd/BjE,GAAAC,EAAAsL,QAFJF,MAFFD,MAjDFvH,4BAEIxB,EAAAqC,SAEmC,IAFnCjI,GAEWuJ,GAFX3B,GAAAhC,EAAA,aAAAY,uBASwB/D,GAAA2M,EAAA,GAAAvH,GAAA,MAAA7H,GAAAuJ,GAAsB,KAAC8F,GAAA,MAAArP,GAAoB8J,GAAS7J,QAAM,MAGlF6N,EAAA7F,SAAAjI,GAEWuJ,KAAmBvJ,GAAK8J,GAAS7J,OAAS,EAFrD2H,GAAAkG,EAAA,aAAAwB,+BAeI7M,GAAA8M,EAAAvP,GAAAiK,GAAe5C,kBAQjBiH,EAAG,YAAAkB,KAhCQ,IAAAzE,GAAE,2BAEV,IAAAA,GAAE,mBAIL,IAAAA,GAAE,kBAA8C,IAAAA,GAAE,aAMvC,IAAAA,GAAE,uBAEb,IAAAA,GAAE,mBAOAN,EAAczK,GAACiK,GAAezC,UAM9BwD,EAAkBhL,GAACiK,GAAezC,UAK4BxH,GAACiK,GAAeF,QA1MtF0F,QAAQ,iBAAkB,uBAC1BA,QAAQ,aAAc,eACtBA,QAAQ,WAAY,mBACpBA,QAAQ,MAAO,eAkKfrI,cA2EAsI,EAAGC,UAAHD,GAAG,MAAHA,GACEvJ,GAAAK,GAAA/D,GAAAmN,EAAApJ,GAAA,CAAA,IAAAuE,GAAE,6BADJ2E,gBA5EEtF,GAAW1G,EAAAmM,GAAAnM,EAAAE,GAAA,SAiFfkM,EAAG/L,GAAAgM,EAAA,GACDC,KADFF,GACEE,EAAiC5M,QAAO,IAAQ8H,OAAO+E,QAAQC,gBAA/DF,GAAM,MAANA,GAGA,IAAAG,KAHAH,EAAM,GAGNG,EAA+B/M,QAAO,IAAQgN,MAAMrF,GAAE,gCAAtDoF,GAAM,MAANA,MAJFL,uBAhNInO,EAAG,aAAA,gBAAsDhD,IAAO6I,gBAGvC/E,GAAAQ,EAAAtE,IAAO0I,UAIhCtF,EAAG,EAAA,gBAAAsO,GAAA,KAAA,iBACD5N,GAAAY,EAAA,GAAA1E,IAAOiB,YAAU,QAAKjB,IAAO4I,UAAQ,MAAAM,GAAA,MAgBzCpF,GAAA4C,EAAA1G,IAAO2G,aAKLqC,GAAA1D,EAAA,UAAAjE,GAEkBG,OAFlByH,GAAA3D,EAAA,gBAAAjE,GAIgBG,eAKUA,IAAoB,uCA9GxC,CACTf,WAAc,KACdiJ,QAAW,KACXC,aAAgB,KAChBC,QAAW,KACXC,UAAa,KACbC,QAAW,KACXC,QAAW,MACXC,MAAS,KACTC,WAAc,MAgESjK,IAAO6I,OA9DV,WAtBV,CACV3G,GAAM,+CACNC,GAAM,+CACNC,GAAM,4CACNC,GAAM,4CACNC,GAAM,mDAqFyCtC,IAAOiB,aAnF3B,6CAoFkB,IAAAmL,GAAE,kBA0M5C,IAAAA,GAAE,0BAGF,IAAAA,GAAE,8CAjOCV,GAAgB3G,EAAAC,GAAAD,EAAA4M,GAAA,6BATrBrH,GAAQvF,EAAAb,GAAAa,EAAA6M,GAAA,QADdrP,QAAAA,OAFD,kCCxSA,MAAMsP,GAA2BC,GAAS,CACtClR,GAAImR,GACJlR,OAAQmR,KAAWC,IAAI,GAAGC,IAAI,KAC9BnR,UAAWiR,KAAWC,IAAI,GAAGC,IAAI,KACjClR,aAAcmR,GAAmBC,QAAQ,QACzCnR,WAAYoR,KAAWJ,IAAI,GAAGC,IAAI,GAAGE,QAAQ,GAAGE,SAAS,gCACzDC,WAAYC,GAAQC,IAAsCR,IAAI,GAAGG,QAAQ,CAAC,kBAC1E/G,SAAUqH,GAAyBC,WACnCC,UAAWC,GAAQ,CACfC,KACAd,KAAWe,WAAWC,UAAUC,GAAO,IAAI/R,KAAK+R,MACjDb,QAAQ,IAAIlR,MAAQ8R,UAAUE,GAAOA,aAAehS,KAAOgS,EAAM,IAAIhS,KAAKgS,IAC7E5M,UAAWuM,GAAQ,CACfC,KACAd,KAAWe,WAAWC,UAAUC,GAAO,IAAI/R,KAAK+R,MACjDb,QAAQ,IAAIlR,MAAQ8R,UAAUE,GAAOA,aAAehS,KAAOgS,EAAM,IAAIhS,KAAKgS,IAC7EC,SAAUC,KAAYhB,SAAQ,GAC9BiB,WAAYD,KAAYhB,SAAQ,KAGvBkB,GAA4BT,GAAQ,CAC7ChB,GAAyB0B,KAAK,CAAE3S,IAAI,IACpCmR,GACAC,KAAWwB,SAGFC,GAAyBC,GAAO,CAAC,KAAM,KAAM,KAAM,KAAM,OAEzDC,GAAmBD,GAAO,CACnC,aAAc,UAAW,eAAgB,UAAW,YAAa,UAAW,UAAW,UAG9EE,GAA0B9B,GAAS,CAC5ClR,GAAIoR,KAAWwB,OACf7M,YAAaqL,KAAWC,IAAI,GAAGC,IAAI,KACnCpQ,YAAasR,KAAYhB,SAAQ,GACjCQ,UAAWE,KAASV,QAAQ,IAAIlR,QAGvB2S,GAAuB/B,GAAS,CACzC/E,KAAMyF,GAAQR,MAAYI,QAAQ,IAClC0B,cAAetB,GAAQT,IAAgBK,QAAQ,IAC/C2B,eAAgBvB,GAAQT,IAAgBK,QAAQ,IAChD4B,UAAWZ,KAAYhB,SAAQ,KAChCA,QAAQ,IAEE6B,GAAenC,GAAS,CACjClR,GAAImR,GACJrJ,MAAOsJ,KAAWC,IAAI,GAAGC,IAAI,KAC7BvL,YAAaqL,KAAWC,IAAI,IAAIC,IAAI,KACpCjR,WAAYwS,GAAuBrB,QAAQ,MAC3CvJ,KAAM8K,GAAiBvB,QAAQ,cAC/BxJ,SAAUyJ,KAAWJ,IAAI,GAAGC,IAAI,KAAKE,QAAQ,IAC7C3R,WAAY+R,GAAQc,IAA2BlB,QAAQ,IACvDzQ,WAAY6Q,GAAQoB,IAAyBxB,QAAQ,IACrDhH,QAAS4G,KAAWW,WACpB7Q,YAAasR,KAAYhB,SAAQ,GACjC5Q,qBAAsB6Q,KAAWJ,IAAI,GAAGC,IAAI,KAAKE,QAAQ,GACzDQ,UAAWC,GAAQ,CAACC,KAAUd,KAAWe,WAAWC,aAAiB,IAAI9R,KAAK+R,MAAQb,QAAQ,IAAIlR,MAClGoF,UAAWuM,GAAQ,CAACC,KAAUd,KAAWe,WAAWC,aAAiB,IAAI9R,KAAK+R,MAAQb,QAAQ,IAAIlR,MAClGmK,SAAUwI,KACXK,MAAOC,IACD,CACDvT,GAAI,YAAYM,KAAKC,QACrBuH,MAAO,iBACP/B,YAAa,gCACb1F,WAAY,KACZ4H,KAAM,aACND,SAAU,GACVnI,WAAY,GACZkB,WAAY,GACZiR,cAAe1R,KACfoF,cAAepF,KACfmK,SAAU,CAAA,KCwkBX,MAAM+I,GAAgB,IAtoBtB,MAKL,WAAArX,GAJAI,KAAQkX,QAAoB,GAC5BlX,KAAQmX,eAAmC,GAC3CnX,KAAQoX,aAAc,CAItB,CAKA,gBAAMC,GACJ,IAAIrX,KAAKoX,YAET,UACQE,GAAGD,aACT,MAAME,QAAkBD,GAAGE,gBAE3BxX,KAAKmX,eAAiBI,EAAUhU,IAAKyJ,IAAA,IAChCA,EACHoI,WAAYpV,KAAKyX,oBAAoBzK,EAAKoI,YAC1ClH,SAAWlB,EAAKkB,UAAY,CAAA,EAC5B8H,SAAUhJ,EAAKgJ,WAAY,EAC3BE,WAAYlJ,EAAKkJ,aAAc,EAC/BwB,cAAgB1K,EAAoC0K,eAAiB,EACrEjC,UAAYzI,EAA8ByI,WAAa,IAAI1R,KAC3DoF,UAAY6D,EAA8B7D,WAAa,IAAIpF,KAC3D4T,UAAW3X,KAAK4X,mBAAoB5K,EAAiD2K,cAEvF3X,KAAKoX,aAAc,CACrB,OAASS,GAIP,MAFA7X,KAAKmX,eAAiB,GACtBnX,KAAKoX,aAAc,EACbS,CACR,CACF,CAKA,aAAAC,GACE,OAAO9X,KAAKoX,WACd,CAKA,4BAAAW,CACE3U,EACA4U,EAKI,IAGJ,IAAK5U,GAA8C,IAA3BA,EAAgBe,OACtC,OAAOnE,KAAKiY,qBAAqB,gCAGnC,MAAM1M,MAAEA,EAAAzH,WAAOA,EAAA4H,KAAYA,EAAO,aAAAlC,YAAcA,GAAgBwO,EAG1DE,EAAc3M,GAASvL,KAAKmY,oBAAoB/U,EAAiBsI,GAGjE0M,EAAmBtU,GAAc9D,KAAKqY,0BAA0BjV,GAGhEoB,EAAaxE,KAAKsY,yBAAyBlV,EAAiBgV,EAAkB1M,GAG9E7I,EAAiB,CACrBY,GAAI8U,OAAOC,aACXjN,MAAO2M,EACP1O,YAAaA,GAAexJ,KAAKyY,0BAA0BrV,EAAiBgV,EAAkB1M,GAC9F5H,WAAYsU,EACZ1M,OACAD,SAAUzL,KAAK0Y,wBAAwBtV,EAAgBe,QACvDb,WAAYF,EAAgBG,OAAYvD,KAAK2Y,wBAAwB3L,IACrExI,aACAG,aAAa,EACbN,qBAAsB,EACtBoR,cAAe1R,KACfoF,cAAepF,KACfmK,SAAU,CACR0B,KAAM5P,KAAK4Y,mBAAmBxV,EAAiBgV,EAAkB1M,GACjEiL,cAAe,GACfC,eAAgB,GAChBC,WAAW,IAKf,OAAO7W,KAAK6Y,eAAehW,EAC7B,CAKA,gCAAMiW,CACJC,EAQI,IAEJ,IAEO/Y,KAAKoX,mBACFpX,KAAKqX,aAIb,MAAMjU,EAAkBpD,KAAKgZ,gBAAgBD,GAGvCE,GAAgBF,EAASG,MAC3B9V,EAAgBoD,MAAM,EAAGuS,EAASG,OAClC9V,GAAiBG,IAAIyJ,GAAQhN,KAAK2Y,wBAAwB3L,IAG9D,OAAOhN,KAAK+X,6BAA6BkB,EAAc,CACrD1N,MAAOwN,EAASxN,OAAS,kBACzBzH,WAAYiV,EAASjV,YAAc,KACnC4H,KAAMqN,EAASrN,MAAQ,aACvBlC,YAAauP,EAASvP,aAAe,IAGzC,OAASqO,GAEP,OAAO7X,KAAKiY,qBAAqB,0CACnC,CACF,CAKQ,eAAAe,CAAgBD,GAMtB,GAAmC,IAA/B/Y,KAAKmX,eAAehT,OAEtB,MAAO,GAIT,MAAMgV,EAAkBJ,EAASjV,WAC7B9D,KAAKoZ,mBAAmBL,EAASjV,YACjC,KAEJ,OAAO9D,KAAKmX,eAAe1S,OAAOuI,IAEhC,MAAMqM,GAAkBF,GACpBnM,EAAKlJ,YAAcqV,EAAgBrE,KAAO9H,EAAKlJ,YAAcqV,EAAgBpE,IAI3EuE,IAAgBP,EAAS3D,YAAc2D,EAAS3D,WAAWjR,OAAS,IACtE6I,EAAKoI,WAAWmE,QAAiBR,EAAS3D,YAAYoE,SAASC,IAI7DC,GAAoBX,EAASlV,cAC/BmJ,EAAKnJ,eAAiBkV,EAASlV,aAGnC,OAAOwV,GAAmBC,GAAiBI,GAE/C,CAKQ,kBAAAN,CAAmBtV,GAQzB,MAPuE,CACrEiB,GAAM,CAAE+P,IAAK,EAAGC,IAAK,KACrB/P,GAAM,CAAE8P,IAAK,IAAKC,IAAK,KACvB9P,GAAM,CAAE6P,IAAK,IAAKC,IAAK,KACvB7P,GAAM,CAAE4P,IAAK,IAAKC,IAAK,KACvB5P,GAAM,CAAE2P,IAAK,IAAKC,IAAK,IAEXjR,EAChB,CAEQ,kBAAA8T,CAAmB+B,GACzB,MAAc,OAAVA,GAA4B,OAAVA,GAA4B,OAAVA,GAA4B,OAAVA,EACjDA,EAEF,IACT,CAKQ,mBAAAxB,CAAoB/U,EAAmCsI,GAC7D,GAA+B,IAA3BtI,EAAgBe,OAAc,MAAO,aAGzC,MAAMiR,MAAiBvT,IACvBuB,EAAgBjC,QAAQ6L,IACtBhN,KAAKyX,oBAAoBzK,EAAKoI,YAAYjU,QAAQsY,GAAYrE,EAAWwE,IAAIH,MAI/E,MAYMI,EAZwC,CAC5CvW,WAAc,aACdiJ,QAAW,UACXC,aAAgB,eAChBC,QAAW,UACXC,UAAa,YACbC,QAAW,UACXC,QAAW,UACXC,MAAS,eACTC,WAAc,cAGWpB,IAAS,SAGpC,GAAwB,IAApB0J,EAAWxU,KAAY,CACzB,MAAMkZ,EAAgB1E,EAAWlT,SAAS6X,OAC1C,IAAKD,EAAcE,KACjB,MAAO,GAAGH,MAAa7Z,KAAKia,uBAAuBH,EAAcja,QAErE,CAGA,MAAO,GAAGga,aAAoBzW,EAAgBe,eAChD,CAKQ,yBAAAsU,CACNrV,EACAU,EACA4H,GAEA,MAYMwO,MAAoBrY,IAC1BuB,EAAgBjC,QAAQ6L,GAAQkN,EAAcN,IAAI5M,EAAKnJ,eAEvD,MAAMsW,EAAmBC,MAAMC,KAAKH,GACjC3W,IAAI2N,GAAOlR,KAAKsa,2BAA2BpJ,IAC3CQ,KAAK,MAER,MAAO,QAAQ5N,6BAnBsC,CACnDR,WAAc,sBACdiJ,QAAW,mBACXC,aAAgB,wBAChBC,QAAW,wBACXC,UAAa,mBACbC,QAAW,mBACXC,QAAW,oBACXC,MAAS,0BACTC,WAAc,oBAUsDpB,WAActI,EAAgBe,oCAAoCgW,IAC1I,CAKQ,uBAAAzB,CAAwB6B,GAE9B,MAAMC,EAA2B,EAAZD,EAGrB,OAAIA,EAAY,GACPjW,KAAKwQ,IAAI0F,EAAe,GAAI,KAC1BD,EAAY,GACdC,EAAe,EAEflW,KAAKyQ,IAAIyF,EAAc,GAElC,CAKQ,wBAAAlC,CACNlV,EACAU,EACA4H,GAEA,MAAMlH,EAAkC,GAGxCA,EAAWiW,KAAK,CACdhX,GAAI8U,OAAOC,aACXhP,YAAa,SAASpG,EAAgBe,kCAAkCL,UACxEa,aAAa,EACb8Q,cAAe1R,OA+CjB,OA/BAS,EAAWiW,KAAK,CACdhX,GAAI8U,OAAOC,aACXhP,YAdiD,CACjDlG,WAAc,2CACdiJ,QAAW,wCACXC,aAAgB,kDAChBC,QAAW,qDACXC,UAAa,sDACbC,QAAW,yDACXC,QAAW,4CACXC,MAAS,iDACTC,WAAc,uCAKcpB,GAC5B/G,aAAa,EACb8Q,cAAe1R,OAIE,OAAfD,GAAsC,OAAfA,EACzBU,EAAWiW,KAAK,CACdhX,GAAI8U,OAAOC,aACXhP,YAAa,+CACb7E,aAAa,EACb8Q,cAAe1R,OAEO,OAAfD,GAAsC,OAAfA,EAChCU,EAAWiW,KAAK,CACdhX,GAAI8U,OAAOC,aACXhP,YAAa,qDACb7E,aAAa,EACb8Q,cAAe1R,OAGjBS,EAAWiW,KAAK,CACdhX,GAAI8U,OAAOC,aACXhP,YAAa,+DACb7E,aAAa,EACb8Q,cAAe1R,OAIZS,CACT,CAKQ,kBAAAoU,CACNxV,EACAU,EACA4H,GAEA,MAAMkE,EAAiB,CAAClE,EAAM5H,GAGxBsR,MAAiBvT,IAUvB,OATAuB,EAAgBjC,QAAQ6L,IACtBhN,KAAKyX,oBAAoBzK,EAAKoI,YAAYjU,QAAQsY,GAAYrE,EAAWwE,IAAIH,MAI/EW,MAAMC,KAAKjF,GAAY5O,MAAM,EAAG,GAAGrF,QAAQsY,IACzC7J,EAAK6K,KAAKza,KAAKia,uBAAuBR,MAGjC7J,CACT,CAKO,sBAAAqK,CAAuBR,GAuB5B,MAtByD,CACvDiB,UAAa,YACbC,QAAW,UACXC,OAAU,SACVC,KAAQ,OACRC,OAAU,SACVC,QAAW,UACX,aAAc,aACdC,SAAY,WACZC,KAAQ,eACRC,OAAU,SACVC,UAAa,iBACbC,WAAc,aACdC,KAAQ,cACRC,QAAW,UACXC,YAAe,cACfC,OAAU,SACVjP,QAAW,UACXK,QAAW,UACX,mBAAoB,oBAGF6M,IAAaA,CACnC,CAKQ,0BAAAa,CAA2BzW,GAgBjC,MAfmD,CACjD+M,KAAQ,QACRC,KAAQ,QACRC,UAAa,aACbC,OAAU,UACV0K,QAAW,WACXzK,YAAe,eACfC,YAAe,eACfyK,aAAgB,gBAChBC,QAAW,WACXC,OAAU,UACVC,OAAU,UACVC,WAAc,eAGIjY,IAAiBA,CACvC,CAKQ,mBAAA4T,CAAoBrC,GAC1B,MAAM2G,EAAgC,CACpC,YACA,UACA,SACA,OACA,SACA,UACA,aACA,WACA,OACA,SACA,YACA,aACA,OACA,UACA,cACA,SACA,UACA,UACA,oBAGF,IAAK3G,GAAoC,IAAtBA,EAAWjR,OAC5B,MAAO,CAAC,WAGV,MAAM6X,EAAa5G,EAChB7R,IAAIkW,GAAasC,EAAQvC,SAASC,GAAmCA,EAAkC,WACvGhV,OAAOwX,SAEV,OAAOD,EAAW7X,OAAS,EAAI6X,EAAa,CAAC,UAC/C,CAKQ,uBAAArD,CAAwB3L,GAC9B,MAAO,IACFA,EACHoI,WAAYpV,KAAKyX,oBAAoBzK,EAAKoI,YAC1ClH,SAAWlB,EAAKkB,UAAY,CAAA,EAC5B8H,SAAUhJ,EAAKgJ,WAAY,EAC3BE,WAAYlJ,EAAKkJ,aAAc,EAC/BwB,cAAe1K,EAAK0K,eAAiB,EACrCjC,UAAWzI,EAAKyI,WAAa,IAAI1R,KACjCoF,UAAW6D,EAAK7D,WAAa,IAAIpF,KACjC4T,UAAW3K,EAAK2K,WAAa,KAEjC,CAKQ,yBAAAU,CAA0BjV,GAChC,GAA+B,IAA3BA,EAAgBe,OAAc,MAAO,KAEzC,MACM+X,EADkB9Y,EAAgB+Y,OAAO,CAACC,EAAKpP,IAASoP,EAAMpP,EAAKlJ,WAAY,GAC7CV,EAAgBe,OAExD,OAAI+X,GAAiB,IAAY,KAC7BA,GAAiB,IAAY,KAC7BA,GAAiB,IAAY,KAC7BA,GAAiB,IAAY,KAC1B,IACT,CAKQ,cAAArD,CAAehW,GACrB,MAAMwZ,EAASvF,GAAawF,UAAUzZ,GACtC,OAAIwZ,EAAOE,QACFF,EAAOG,KAGPxc,KAAKiY,qBAAqB,2BAErC,CAKQ,oBAAAA,CAAqBwE,GAG3B,MAAO,CACLhZ,GAAI,YAAYM,KAAKC,SAASuU,OAAOC,eACrCjN,MAAO,qBACP/B,YAAa,8DACb1F,WAAY,KACZ4H,KAAM,aACND,SAAU,GACVnI,WAAY,GACZkB,WAAY,CACV,CACEf,GAAI8U,OAAOC,aACXhP,YAAa,8CACb7E,aAAa,EACb8Q,cAAe1R,OAGnBY,aAAa,EACbN,qBAAsB,EACtBoR,cAAe1R,KACfoF,cAAepF,KACfmK,SAAU,CACR0B,KAAM,CAAC,SACP+G,cAAe,GACfC,eAAgB,GAChBC,WAAW,GAGjB,CAKA,UAAA6F,GACE,OAAO1c,KAAKkX,OACd,CAKA,aAAAyF,CAAclZ,GACZ,OAAOzD,KAAKkX,QAAQ0F,KAAK/Z,GAAUA,EAAOY,KAAOA,EACnD,CAKA,SAAAoZ,CAAUha,GACR,MAAMia,EAAkB9c,KAAK6Y,eAAehW,GAC5C7C,KAAKkX,QAAQuD,KAAKqC,EACpB,CAKA,YAAAC,CAAatZ,EAAYuZ,GACvB,MAAMhS,EAAQhL,KAAKkX,QAAQ+F,UAAUpa,GAAUA,EAAOY,KAAOA,GAC7D,QAAIuH,EAAc,OAElB,MACMkS,EAAa,IADGld,KAAKkX,QAAQlM,MAG9BgS,EACH7T,cAAepF,MAGXoZ,EAAgB,IACjBD,EACHzZ,GAAIyZ,EAAWzZ,IAAM,UAAUM,KAAKC,QACpCuH,MAAO2R,EAAW3R,OAAS,WAC3B/B,YAAa0T,EAAW1T,aAAe,GACvC1F,WAAaoZ,EAAWpZ,YAAc,KACtC4H,KAAOwR,EAAWxR,MAAQ,aAC1BpI,WAAY4Z,EAAW5Z,YAAc,GACrCmI,SAAUyR,EAAWzR,UAAY,EACjCjH,WAAY0Y,EAAW1Y,YAAc,GACrCG,YAAauY,EAAWvY,cAAe,EACvCN,qBAAsB6Y,EAAW7Y,sBAAwB,GAGrDyY,EAAkB9c,KAAK6Y,eAAesE,GAE5C,OADAnd,KAAKkX,QAAQlM,GAAS8R,EACfA,CACT,CAKA,YAAAM,CAAa3Z,GACX,MAAM4Z,EAAgBrd,KAAKkX,QAAQ/S,OAEnC,OADAnE,KAAKkX,QAAUlX,KAAKkX,QAAQzS,OAAO5B,GAAUA,EAAOY,KAAOA,GACpDzD,KAAKkX,QAAQ/S,SAAWkZ,CACjC,CAKA,sBAAAC,CAAuBxZ,GACrB,OAAO9D,KAAKkX,QAAQzS,OAAO5B,GAAUA,EAAOiB,aAAeA,EAC7D,CAKA,gBAAAyZ,CAAiB7R,GACf,OAAO1L,KAAKkX,QAAQzS,OAAO5B,GAAUA,EAAO6I,OAASA,EACvD,CAKA,eAAA8R,CAAgB3N,GACd,OAAO7P,KAAKkX,QAAQzS,OAAO5B,GACzBA,EAAOqL,SAAS0B,KAAK4J,SAAS3J,GAElC,CAKA,gBAAA4N,CAAiBhM,EAAgB,GAC/B,GAA4B,IAAxBzR,KAAKkX,QAAQ/S,aAAqB,GAItC,MADiB,IAAInE,KAAKkX,SAASwG,KAAK,IAAM,GAAMpZ,KAAKqZ,UACzCnX,MAAM,EAAGlC,KAAKwQ,IAAIrD,EAAOzR,KAAKkX,QAAQ/S,QACxD,GCjQK,MAAMyZ,GAAwB,IAjYrC,MAAA,WAAAhe,GACEI,KAAQoX,aAAc,CAAA,CAKtB,gBAAMC,SACEJ,GAAcI,aACpBrX,KAAKoX,aAAc,CACrB,CAKA,aAAAU,GACE,OAAO9X,KAAKoX,WACd,CAOA,2BAAMyG,CAAsBC,GAC1B,IAEE,MAAMC,EAAkB/d,KAAKge,+BAA+BF,GAGtDG,QAAwBC,GAAuBC,eAAeJ,GAGpE,OAAO/d,KAAKoe,+BAA+BH,EAC7C,OAASpG,GAEP,OAAO7X,KAAKiY,qBAAqB6F,EAAOpS,MAAQ,aAAcoS,EAAOha,YAAc,KACrF,CACF,CASA,4BAAMua,CAAuBjJ,EAAkCtR,EAAoBkU,GACjF,MACM8F,EAAiC,CACrCQ,OAAQ,UACR5S,KAAM,aACN5H,WAJ0Bya,GAAmBza,GAAcA,EAAa,KAKxEiV,SAAU,CAAE3D,cACZlH,SAAU,CACRsQ,gBAAiBxG,GAASwG,kBAAmB,EAC7CC,cAAezG,GAASyG,gBAAiB,IAI7C,OAAOze,KAAK6d,sBAAsBC,EACpC,CASA,2BAAMY,CAAsBC,EAAqB7a,EAAoBkU,GACnE,MACM8F,EAAiC,CACrCQ,OAAQ,UACR5S,KAAM,UACN5H,WAJ0Bya,GAAmBza,GAAcA,EAAa,KAKxEiV,SAAU,CAAE4F,eACZzQ,SAAU,CACRsQ,gBAAiBxG,GAASwG,kBAAmB,EAC7CI,kBAAmB5G,GAAS4G,oBAAqB,IAIrD,OAAO5e,KAAK6d,sBAAsBC,EACpC,CASA,yBAAMe,CAAoBpF,EAA8B3V,EAAoBkU,GAC1E,MACM8F,EAAiC,CACrCQ,OAAQ,UACR5S,KAAM,QACN5H,WAJ0Bya,GAAmBza,GAAcA,EAAa,KAKxEiV,SAAU,CAAE3D,WAAY,CAACqE,IACzBvL,SAAU,CACRsQ,gBAAiBxG,GAASwG,kBAAmB,EAC7CC,cAAezG,GAASyG,gBAAiB,IAI7C,OAAOze,KAAK6d,sBAAsBC,EACpC,CAOQ,8BAAAE,CAA+BF,GAErC,MAAMgB,EAAW,CACfR,OAAQ,UACR5S,KAAM,aACN5H,WAAY,KACZiV,SAAU,CAAA,EACV7K,SAAU,CAAA,GAYZ,MARgD,CAC9CoQ,OAAQR,EAAOQ,QAAUQ,EAASR,OAClC5S,KAAO,CAAC,aAAc,UAAW,QAAS,UAAW,cAAwB8N,SAASsE,EAAOpS,MAAeoS,EAAOpS,KAAOoT,EAASpT,KACnI5H,WAAa,CAAC,KAAM,KAAM,KAAM,KAAM,MAAgB0V,SAASsE,EAAOha,YAAqBga,EAAOha,WAAagb,EAAShb,WACxHiV,SAAU+E,EAAO/E,UAAY+F,EAAS/F,SACtC7K,SAAU4P,EAAO5P,UAAY4Q,EAAS5Q,SAI1C,CAOQ,8BAAAkQ,CAA+BH,GAKrC,MAAMc,EAAiBd,EAAgBjQ,SACpCzK,OAAe,MAAMwP,EAAQxH,OAASwH,EAAQrH,SAASqH,EAAQ9E,SAAW,MAC1EyD,KAAK,QAGFlN,EAAkCyZ,EAAgBe,mBAAmBzb,IAAImF,IAAA,CAC7EjF,GAAIwb,KACJzV,YAAad,EACb/D,aAAa,EACb8Q,cAAe1R,QAIX0H,EAA6C,EAAlCwS,EAAgBjQ,SAAS7J,OAAa,EAGjDyL,EAAO5P,KAAK4Y,mBAAmBqF,GA2BrC,MAxBuB,CACrBxa,GAAIwa,EAAgBxa,GACpB8H,MAAO0S,EAAgB1S,MACvB/B,YAAaxJ,KAAKyY,0BAA0BwF,GAC5Cna,WAAY9D,KAAKkf,oBAAoBjB,EAAgBna,YACrD4H,KAAM1L,KAAKmf,oBAAoBlB,EAAgBvS,MAC/CD,WACAnI,WAAYtD,KAAKof,oBAAoBnB,EAAgB3a,YAAc,IACnEkB,aACAyJ,QAAS8Q,GAAkB/e,KAAKyY,0BAA0BwF,GAC1DtZ,aAAa,EACbN,qBAAsB,EACtBoR,UAAWwI,EAAgBxI,WAAa,IAAI1R,KAC5CoF,UAAW8U,EAAgB9U,WAAa,IAAIpF,KAC5CmK,SAAU,CACR0B,OACA+G,cAAe,GACfC,eAAgB,GAChBC,WAAW,KACRoH,EAAgB/P,UAMzB,CAOQ,kBAAA0K,CAAmBqF,GACzB,MAAMrO,EAAiB,GAgBvB,GAbAA,EAAK6K,KAAKwD,EAAgBvS,MAC1BkE,EAAK6K,KAAKwD,EAAgBna,YAGtBma,EAAgBoB,iBAAmBpB,EAAgBoB,gBAAgBlb,OAAS,GAC9E8Z,EAAgBoB,gBAAgBle,QAAQme,IAClCA,EAAQC,MAAM7b,QAChBkM,EAAK6K,KAAK6E,EAAQC,KAAK7b,UAMzBua,EAAgB3a,YAAc2a,EAAgB3a,WAAWa,OAAS,EAAG,CACvE,MAAMiR,MAAiBvT,IACvBoc,EAAgB3a,WAAWnC,QAAQqC,IAC7BA,EAAM4R,YACR5R,EAAM4R,WAAWjU,QAAQsY,IAEvB,MAAM+F,EAAcvI,GAAcgD,uBAAuBR,GACzDrE,EAAWwE,IAAI4F,GACfpK,EAAWwE,IAAIH,OAIrB7J,EAAK6K,QAAQL,MAAMC,KAAKjF,GAC1B,CAEA,OAAOxF,CACT,CAOQ,yBAAA6I,CAA0BwF,GAChC,MAeMwB,EAfwC,CAC5C1a,GAAM,WACNC,GAAM,aACNC,GAAM,eACNC,GAAM,qBACNC,GAAM,YAU8B8Y,EAAgBna,aAAe,WAC/D4b,EARkC,CACtCpc,WAAc,sBACdiJ,QAAW,mBACXM,MAAS,0BACTC,WAAc,uBAIUmR,EAAgBvS,OAAS,oBAG7CiU,EAAa1B,EAAgB3a,YAAYa,QAAU,EAGzD,IAAIyb,EAAsB,GAC1B,GAAI3B,EAAgBoB,iBAAmBpB,EAAgBoB,gBAAgBlb,OAAS,EAAG,CAIjFyb,EAAsB,0CAHD3B,EAAgBoB,gBAClC9b,IAAI+b,GAAWA,EAAQC,MAAM7b,QAAU4b,EAAQ7b,IAC/CiO,KAAK,QAEV,CAEA,MAAO,QAAQ+N,6BAA2CC,UAAkBC,qBAA8BC,GAC5G,CAEQ,mBAAAT,CAAoBzT,GAC1B,MAAa,eAATA,GAAkC,YAATA,GAA+B,iBAATA,GAAoC,YAATA,GAA+B,cAATA,GAAiC,YAATA,GAA+B,YAATA,GAA+B,UAATA,EAC/JA,EAEF,OACT,CAEQ,mBAAAwT,CAAoBpb,GAC1B,MAAmB,OAAfA,GAAsC,OAAfA,GAAsC,OAAfA,GAAsC,OAAfA,GAAsC,OAAfA,EACvFA,EAEF,IACT,CAEQ,mBAAAsb,CAAoBS,GAC1B,OAAOA,EAAMtc,IAAIyJ,IAAA,IACZA,EACHgJ,SAAUhJ,EAAKgJ,WAAY,EAC3BE,WAAYlJ,EAAKkJ,aAAc,EAC/BwB,cAAe1K,EAAK0K,eAAiB,EACrCtC,WAAYpI,EAAKoI,YAAc,GAC/BlH,SAAWlB,EAAKkB,UAAY,CAAA,IAEhC,CAQQ,oBAAA+J,CAAqBvM,EAAc5H,GACzC,MAAO,CACLL,GAAI,mBAAmBwb,OACvB1T,MAAO,qBACP/B,YAAa,mFACb1F,WAAYya,GAAmBza,GAAcA,EAAa,KAC1D4H,KAAMoU,GAAapU,GAAQA,EAAO,aAClCD,SAAU,GACVnI,WAAY,GACZkB,WAAY,GACZG,aAAa,EACbN,qBAAsB,EACtBoR,cAAe1R,KACfoF,cAAepF,KACfmK,SAAU,CACR0B,KAAM,CAAClE,EAAM5H,GACb6S,cAAe,GACfC,eAAgB,GAChBC,WAAW,GAGjB,CAGA,UAAA6F,GACE,OAAOzF,GAAcyF,cAAgB,EACvC,CAEA,aAAAC,CAAclZ,GACZ,OAAOwT,GAAc0F,cAAclZ,EACrC,CAEA,4BAAAsU,CAA6B3U,GAC3B,OAAO6T,GAAcc,6BAA6B3U,EACpD,CAEA,gCAAM0V,CAA2BC,GAC/B,MAAMgH,EAAqB,IACtBhH,EACHrN,KAAMqN,EAASrN,KAAO1L,KAAKmf,oBAAoBpG,EAASrN,WAAQ,EAChE5H,WAAYiV,EAASjV,WAAa9D,KAAKkf,oBAAoBnG,EAASjV,iBAAkC,EACtGsR,WAAY2D,EAAS3D,YAIvB,aADqB6B,GAAc6B,2BAA2BiH,IAC7C/f,KAAKiY,qBAAqB,aAAc,KAC3D,CAEA,sBAAAqF,CAAuBxZ,GACrB,OAAIya,GAAmBza,IACdmT,GAAcqG,uBAAuBxZ,IAEvC,EACT,CAEA,gBAAAyZ,CAAiB7R,GACf,OAAIoU,GAAapU,IACRuL,GAAcsG,iBAAiB7R,IAEjC,EACT,CAEA,eAAA8R,CAAgB3N,GACd,OAAOoH,GAAcuG,gBAAgB3N,IAAQ,EAC/C,CAEA,gBAAA4N,CAAiBhM,GACf,OAAOwF,GAAcwG,iBAAiBhM,IAAU,EAClD,CAEA,SAAAoL,CAAUha,GACR,OAAOoU,GAAc4F,UAAUha,EACjC,CAEA,YAAAka,CAAatZ,EAAYuZ,GACvB,OAAO/F,GAAc8F,aAAatZ,EAAIuZ,EACxC,CAEA,YAAAI,CAAa3Z,GACX,OAAOwT,GAAcmG,aAAa3Z,EACpC,GCzYK,SAASuc,GAASngB,GACrB,OAAiB,OAAVA,GAAmC,iBAAVA,CACpC,CACA,MAAMogB,GAA8B,CAAC,SAAU,SAAU,SAAU,WAC5D,SAASC,GAAargB,GAEzB,OAAIA,YAEAogB,GAA4BzG,gBAAgB3Z,KAG5Cua,MAAM+F,QAAQtgB,GACPA,EAAMiC,MAAOkL,GAASkT,GAAalT,IAEzB,iBAAVnN,GAEHugB,OAAOC,eAAexgB,KAAWugB,OAAOzd,WAKpD,OCvBa2d,UAAmB,OACnBC,UAA0B,eAC9B,SAAAC,GAAQC,EAAQC,GACf,MAAAC,KAAsBF,GACxB,OAAAC,GAEKJ,CAAAA,KAAY,EACZC,CAAAA,KAAmB,EAChB,WAAAK,aACOD,EACX,aACIC,CAAQngB,GACRigB,EAAOjgB,EACX,IAIH6f,CAAAA,KAAY,EACT,WAAAM,UACOH,GACX,EAER,CClBO,SAASI,MAAmBC,GAC/B,OAAO,SAAUrb,GACb,IAAA,MAAWsb,KAAWD,EAClB,GAAKC,EAAL,CAEA,GAAItb,EAAEub,iBACF,OACmB,mBAAZD,EACPA,EAAQ7f,KAAKlB,KAAMyF,GAGnBsb,EAAQH,SAAS1f,KAAKlB,KAAMyF,EAP5B,CAUZ,CACJ,CClBA,IAAIwb,GAAgB,kCAEhBC,GAAgB,MAChBC,GAAmB,OAGnBC,GAAiB,yCACjBC,GAAc,QACdC,GAAc,uDACdC,GAAkB,UAGlBC,GAAa,aAMbC,GAAe,GA0OnB,SAASC,GAAK5L,GACZ,OAAOA,EAAMA,EAAInC,QAAQ6N,GAAYC,IAAgBA,EACvD,CChPA,SAASE,GAAcC,EAAOvf,GAC1B,IAAIwf,EAAc,KAClB,IAAKD,GAA0B,iBAAVA,EACjB,OAAOC,EAEX,MAAMC,EDYV,SAAgBF,EAAO5J,GACrB,GAAqB,iBAAV4J,EACT,MAAM,IAAIG,UAAU,mCAGtB,IAAKH,EAAO,MAAO,GAEnB5J,EAAUA,GAAW,CAAA,EAKrB,IAAIgK,EAAS,EACTC,EAAS,EAOb,SAASC,EAAepM,GACtB,IAAIqM,EAAQrM,EAAIsM,MAAMlB,IAClBiB,OAAiBA,EAAMhe,QAC3B,IAAIke,EAAIvM,EAAIwM,YAvCF,MAwCVL,GAAUI,EAAIvM,EAAI3R,OAASke,EAAIJ,EAASnM,EAAI3R,MAC9C,CAOA,SAASoe,IACP,IAAIC,EAAQ,CAAEC,KAAMT,EAAQC,UAC5B,OAAO,SAAUS,GAGf,OAFAA,EAAKH,SAAW,IAAII,EAASH,GAC7BI,IACOF,CACT,CACF,CAUA,SAASC,EAASH,GAChBxiB,KAAKwiB,MAAQA,EACbxiB,KAAK6iB,IAAM,CAAEJ,KAAMT,EAAQC,UAC3BjiB,KAAKyC,OAASuV,EAAQvV,MACxB,CAaA,SAAS6K,EAAMwV,GACb,IAAIhV,EAAM,IAAID,MACZmK,EAAQvV,OAAS,IAAMuf,EAAS,IAAMC,EAAS,KAAOa,GAQxD,GANAhV,EAAIiV,OAASD,EACbhV,EAAIkV,SAAWhL,EAAQvV,OACvBqL,EAAI2U,KAAOT,EACXlU,EAAImU,OAASA,EACbnU,EAAIrL,OAASmf,GAET5J,EAAQiL,OACV,MAAMnV,CAEV,CAQA,SAASsU,EAAMc,GACb,IAAIC,EAAID,EAAGE,KAAKxB,GAChB,GAAKuB,EAAL,CACA,IAAIrN,EAAMqN,EAAE,GAGZ,OAFAjB,EAAepM,GACf8L,EAAQA,EAAMpb,MAAMsP,EAAI3R,QACjBgf,CAJC,CAKV,CAKA,SAASP,IACPR,EAAMjB,GACR,CAQA,SAASkC,EAASC,GAChB,IAAIC,EAEJ,IADAD,EAAQA,GAAS,GACTC,EAAIC,MACA,IAAND,GACFD,EAAM7I,KAAK8I,GAGf,OAAOD,CACT,CAQA,SAASE,IACP,IAAItS,EAAMqR,IACV,GA/IgB,KA+IKX,EAAM6B,OAAO,IA9IvB,KA8IyC7B,EAAM6B,OAAO,GAAjE,CAGA,IADA,IAAIpB,EAAI,EAENZ,IAAgBG,EAAM6B,OAAOpB,KAlJpB,KAmJIT,EAAM6B,OAAOpB,IApJZ,KAoJmCT,EAAM6B,OAAOpB,EAAI,OAEhEA,EAIJ,GAFAA,GAAK,EAEDZ,KAAiBG,EAAM6B,OAAOpB,EAAI,GACpC,OAAO/U,EAAM,0BAGf,IAAIwI,EAAM8L,EAAMpb,MAAM,EAAG6b,EAAI,GAM7B,OALAJ,GAAU,EACVC,EAAepM,GACf8L,EAAQA,EAAMpb,MAAM6b,GACpBJ,GAAU,EAEH/Q,EAAI,CACTxF,KAhKa,UAiKb8X,QAAS1N,GAvB0D,CAyBvE,CAQA,SAAS4N,IACP,IAAIxS,EAAMqR,IAGNoB,EAAOvB,EAAMhB,IACjB,GAAKuC,EAAL,CAIA,GAHAH,KAGKpB,EAAMf,IAAc,OAAO/T,EAAM,wBAGtC,IAAIyI,EAAMqM,EAAMd,IAEZsC,EAAM1S,EAAI,CACZxF,KAzLiB,cA0LjBmY,SAAUnC,GAAKiC,EAAK,GAAGhQ,QAAQsN,GAAeQ,KAC9C5hB,MAAOkW,EACH2L,GAAK3L,EAAI,GAAGpC,QAAQsN,GAAeQ,KACnCA,KAMN,OAFAW,EAAMb,IAECqC,CApBI,CAqBb,CAyBA,OA1JAjB,EAAShgB,UAAUsL,QAAU2T,EAyJ7BgB,IAjBA,WACE,IAKIkB,EALAC,EAAQ,GAMZ,IAJAV,EAASU,GAIDD,EAAOJ,MACA,IAATI,IACFC,EAAMtJ,KAAKqJ,GACXT,EAASU,IAIb,OAAOA,CACT,CAGOjC,EACT,CCjOyBkC,CAAMpC,GACrBqC,EAAkC,mBAAb5hB,EAc3B,OAbAyf,EAAa3gB,QAASuiB,IAClB,GAAyB,gBAArBA,EAAYhY,KACZ,OAEJ,MAAMmY,SAAEA,EAAAhkB,MAAUA,GAAU6jB,EACxBO,EACA5hB,EAASwhB,EAAUhkB,EAAO6jB,GAErB7jB,IACLgiB,EAAcA,GAAe,CAAA,EAC7BA,EAAYgC,GAAYhkB,KAGzBgiB,CACX,CCrCA,MAAMqC,GAAiB,KACjBC,GAAgB,CAAC,IAAK,IAAK,IAAK,KACtC,SAASC,GAAYC,EAAO,IACxB,IAAIH,GAAeI,KAAKD,GAExB,OAAOA,IAASA,EAAKE,aACzB,CAyCO,SAASC,GAAW1O,GACvB,OAAKA,EAzCT,SAAqBA,GACjB,MAAM2O,EAAQ,GACd,IACIC,EACAC,EAFAC,EAAO,GAGX,IAAA,MAAWP,KAAQvO,EAAK,CAEpB,MAAM+O,EAAaV,GAAc3K,SAAS6K,GAC1C,IAAmB,IAAfQ,EAAqB,CACrBJ,EAAMhK,KAAKmK,GACXA,EAAO,GACPF,OAAgB,EAChB,QACJ,CACA,MAAMI,EAAUV,GAAYC,GAC5B,IAAyB,IAArBM,EAA4B,CAE5B,IAAsB,IAAlBD,IAAuC,IAAZI,EAAkB,CAC7CL,EAAMhK,KAAKmK,GACXA,EAAOP,EACPK,EAAgBI,EAChB,QACJ,CAEA,IAAsB,IAAlBJ,IAAsC,IAAZI,GAAqBF,EAAKzgB,OAAS,EAAG,CAChE,MAAM4gB,EAAWH,EAAKI,IAAG,GACzBP,EAAMhK,KAAKmK,EAAKpe,MAAM,EAAGlC,KAAKyQ,IAAI,EAAG6P,EAAKzgB,OAAS,KACnDygB,EAAOG,EAAWV,EAClBK,EAAgBI,EAChB,QACJ,CACJ,CAEAF,GAAQP,EACRK,EAAgBI,EAChBH,EAAmBE,CACvB,CAEA,OADAJ,EAAMhK,KAAKmK,GACJH,CACX,CAIWQ,CAAYnP,GACdvS,IAAKwC,GAad,SAAoB+P,GAChB,OAAOA,EAAMA,EAAI,GAAGoP,cAAgBpP,EAAItP,MAAM,GAAK,EACvD,CAfoB2e,CAAWpf,IACtB2L,KAAK,IAHC,EAIf,CCnDO,SAAS0T,GAAcC,GAC1B,IAAKA,EACD,MAAO,CAAA,EACX,MAAMC,EAAW,CAAA,EAgBjB,OADAtB,GAAMqB,EAdN,SAAkB9F,EAAM1f,GDgDrB,IAAmBiW,EC/CdyJ,EAAKgG,WAAW,UAChBhG,EAAKgG,WAAW,aAChBhG,EAAKgG,WAAW,SAChBhG,EAAKgG,WAAW,OAChBD,EAASd,GAAWjF,IAAS1f,EAG7B0f,EAAKgG,WAAW,MAChBD,EAAS/F,GAAQ1f,EAGrBylB,GDoCkBxP,ECpCCyJ,EDiD3B,SAAoBzJ,GAChB,OAAOA,EAAMA,EAAI,GAAGyO,cAAgBzO,EAAItP,MAAM,GAAK,EACvD,CAdWgf,CAAWhB,GAAW1O,GAAO,OCrCJjW,CAChC,GAEOylB,CACX,CChBO,SAASG,MAAoBC,GAChC,MAAO,IAAIC,KACP,IAAA,MAAWC,KAAYF,EACK,mBAAbE,GACPA,KAAYD,GAI5B,CCAA,MAAME,GAdN,SAAsBC,EAASC,GAC3B,MAAMC,EAAQC,OAAOH,EAAS,KAC9B,OAAQhQ,IAEJ,GAAmB,iBAARA,EACP,MAAM,IAAIiM,UAAU,uDAAuDjM,GAG/E,OAAKA,EAAIsM,MAAM4D,GAGRlQ,EAAInC,QAAQqS,EAAOD,GAFfjQ,EAInB,CACqBoQ,CAAa,QAAU9D,GAAU,IAAIA,EAAMmC,iBCbzD,SAAS4B,GAAcvE,EAAQ,IAClC,ODaG,SAAoB0D,GACvB,IAAKA,GAAgC,iBAAbA,GAAyBlL,MAAM+F,QAAQmF,GAC3D,MAAM,IAAIvD,UAAU,uDAAuDuD,GAE/E,OAAOlF,OAAOje,KAAKmjB,GACd/hB,IAAKsgB,GAAa,GAAGgC,GAAahC,OAAcyB,EAASzB,OACzDnS,KAAK,KACd,CCpBW0U,CAAWxE,GAAOjO,QAAQ,KAAM,IAC3C,CCHA,MAyGa0S,GAAiB,IAAIxkB,IAzGf,CACf,UACA,oBACA,iBACA,uBACA,mBACA,aACA,gBACA,iBACA,SACA,WACA,YACA,mBACA,WACA,UACA,UACA,mBACA,qBACA,sBACA,gBACA,gBACA,oBACA,SACA,cACA,QACA,aACA,SACA,YACA,cACA,cACA,aACA,cACA,SACA,mBACA,YACA,UACA,UACA,UACA,YACA,aACA,aACA,sBACA,UACA,YACA,YACA,aACA,UACA,SACA,eACA,mBACA,cACA,uBACA,cACA,eACA,eACA,cACA,aACA,cACA,YACA,UACA,UACA,SACA,YACA,kBACA,gBACA,iBACA,iBACA,gBACA,eACA,gBACA,cACA,aACA,eACA,UACA,WACA,WACA,cACA,4BACA,WACA,YACA,WACA,oBACA,gBACA,eACA,YACA,WACA,YACA,eACA,WACA,gBACA,aACA,cACA,eACA,qBACA,kBACA,kBACA,oBACA,iBACA,YACA,uBACA,6BACA,yBACA,wBACA,YC7FJ,SAASykB,GAAe9lB,GACpB,OAAO6lB,GAAexlB,IAAIL,EAC9B,CAUO,SAAS+lB,MAAcZ,GAC1B,MAAMtJ,EAAS,IAAKsJ,EAAK,IACzB,IAAA,IAAStD,EAAI,EAAGA,EAAIsD,EAAKxhB,OAAQke,IAAK,CAClC,MAAMmE,EAAQb,EAAKtD,GACnB,GAAKmE,EAAL,CAGA,IAAA,MAAWhmB,KAAO4f,OAAOje,KAAKqkB,GAAQ,CAClC,MAAMC,EAAIpK,EAAO7b,GACXkmB,EAAIF,EAAMhmB,GACVmmB,EAA2B,mBAANF,EACrBG,EAA2B,mBAANF,EAE3B,GAAIC,GAAqCL,GAAe9lB,GAAM,CAE1D,MAAMqmB,EAAWJ,EACXK,EAAWJ,EACjBrK,EAAO7b,GAAOqgB,GAAgBgG,EAAUC,EAC5C,MAAA,GACSH,GAAeC,EAEpBvK,EAAO7b,GAAOilB,GAAiBgB,EAAGC,QACtC,GACiB,UAARlmB,EAAiB,CAEtB,MAAMumB,EAAgB7G,GAAauG,GAC7BO,EAAgB9G,GAAawG,GAC/BK,GAAiBC,EACjB3K,EAAO7b,GAAOymB,GAAKR,EAAGC,GAEjBK,EACL1K,EAAO7b,GAAOymB,GAAKR,GAEdO,IACL3K,EAAO7b,GAAOymB,GAAKP,GAE3B,MAAA,GACiB,UAARlmB,EAAiB,CACtB,MAAM0mB,EAAyB,iBAANT,EACnBU,EAAyB,iBAANT,EACnBU,EAAyB,iBAANX,EACnBY,EAAyB,iBAANX,EACzB,GAAIQ,GAAaC,EAEb9K,EAAO7b,GAAO,IAAKimB,KAAMC,QAC7B,GACSQ,GAAaG,EAAW,CAE7B,MAAMC,EAAclC,GAAcsB,GAClCrK,EAAO7b,GAAO,IAAKimB,KAAMa,EAC7B,MAAA,GACSF,GAAaD,EAAW,CAE7B,MAAMG,EAAclC,GAAcqB,GAClCpK,EAAO7b,GAAO,IAAK8mB,KAAgBZ,EACvC,MAAA,GACSU,GAAaC,EAAW,CAE7B,MAAME,EAAenC,GAAcqB,GAC7Be,EAAepC,GAAcsB,GACnCrK,EAAO7b,GAAO,IAAK+mB,KAAiBC,EACxC,MACSN,EACL7K,EAAO7b,GAAOimB,EAETU,EACL9K,EAAO7b,GAAOkmB,EAETU,EACL/K,EAAO7b,GAAOimB,EAETY,IACLhL,EAAO7b,GAAOkmB,EAEtB,MAGIrK,EAAO7b,QAAa,IAANkmB,EAAkBA,EAAID,CAE5C,CAEA,IAAA,MAAWjmB,KAAO4f,OAAOqH,sBAAsBjB,GAAQ,CACnD,MAAMC,EAAIpK,EAAO7b,GACXkmB,EAAIF,EAAMhmB,GAEhB6b,EAAO7b,QAAa,IAANkmB,EAAkBA,EAAID,CACxC,CAjFI,CAkFR,CAeA,MAb4B,iBAAjBpK,EAAOuF,QACdvF,EAAOuF,MAAQuE,GAAc9J,EAAOuF,OAAO8F,WAAW,KAAM,OAG1C,IAAlBrL,EAAOsL,SACPtL,EAAOsL,YAAS,SACTtL,EAAOsL,SAGM,IAApBtL,EAAOlQ,WACPkQ,EAAOlQ,cAAW,SACXkQ,EAAOlQ,UAEXkQ,CACX,CC5HO,MAAMuL,GAA6C,oBAAXxY,OAAyBA,YAAS,kCCGpE,MAGT,WAAAxP,CAAYoY,EAAO,gCACP5I,OAAAA,EAASwY,GAAeC,SAAAA,EAAWzY,GAAQyY,UAAa7P,OACjD,IAAX5I,IAEJ0Y,GAAA9nB,KAAI+nB,EAAaF,GACjBC,GAAA9nB,OAAkBgoB,GAAkBC,IAC1B,MAAAC,EAAiBC,GAAG/Y,EAAQ,UAAW6Y,GACvCG,EAAkBD,GAAG/Y,EAAQ,WAAY6Y,cAE3CC,IACAE,QAGZ,CACI,WAAAxH,gBACA,OAAAyH,EAAA1nB,GAAAX,UAAAqoB,EAAAnnB,KAAAlB,MACKW,GAAAX,KAAI+nB,GCbV,SAA0BF,GAC7B,IAAIS,EAAgBT,EAASS,cAC7B,KAAOA,GAAeC,YAAY,CAC9B,MAAM7F,EAAO4F,EAAcC,WAAWD,cACtC,GAAI5F,IAAS4F,EACT,MAEAA,EAAgB5F,CACxB,CACA,OAAO4F,CACX,CDKeE,CAAiB7nB,QAAIonB,IADjB,IAEf,GEzBG,MAAMU,GAOT,WAAA7oB,CAAY2f,GANZxf,GAAAC,KAAA0oB,GACA3oB,GAAAC,KAAA2oB,GAMIb,GAAA9nB,KAAK0oB,EAAQnJ,GACbuI,GAAA9nB,KAAK2oB,EAAOnpB,OAAO+f,GACvB,CAOA,OAAI/e,GACA,OAAOG,GAAAX,KAAK2oB,EAChB,CAMA,MAAAC,GACI,OAAOC,GAAWloB,QAAKgoB,GAC3B,CAQA,GAAA3nB,GACI,MAAMuM,EAAUub,GAAWnoB,GAAAX,KAAK2oB,IAChC,QAAgB,IAAZpb,EACA,MAAM,IAAIM,MAAM,YAAYlN,GAAAX,KAAK0oB,iBAErC,OAAOnb,CACX,CAOA,KAAAwb,CAAMva,GACF,MAAMjB,EAAUub,GAAWnoB,GAAAX,KAAK2oB,IAChC,YAAgB,IAAZpb,EACOiB,EAEJjB,CACX,CAMA,GAAA7M,CAAI6M,GACA,OAAOyb,GAAWroB,GAAAX,KAAK2oB,GAAMpb,EACjC,WCpDK0b,GAAWnoB,EAASooB,EAAOC,EAAQnR,EAAO,CAAA,cACvCoR,GAAO,GAAUpR,EAErB,IAAAqR,GAAUD,EAKVE,EAAiBlP,MAAM+F,QAAQrf,WAE7B,GApBD,SAAUooB,EAAOC,UACdD,OACC,OACDtb,GAAQub,aAEP,MACDI,GAAYJ,GAGxB,CAYIK,CAAUN,EAAK,KACL,MAAAhnB,EAASkY,MAAM+F,QAAQrf,GAAWA,EAAQyC,IAAKd,GAAWA,KAAY3B,IACvE,IAAAuoB,SACDA,GAAS,OACTC,EAAiBpnB,GAGf,MAAAunB,EAAUC,GAAO,IAAOP,EAAOjnB,EAAQonB,WAC7CA,EAAiBpnB,EACVunB,GAEf,CAsBgB,SAAAE,GAAM7oB,EAASqoB,EAAQnR,GACnCiR,GAAWnoB,EAAS,OAAQqoB,EAAQnR,EACxC,UCzDgB4R,GAAgBC,GAC5Bjc,YAEQic,KAGZ,CCLO,SAASC,GAAUD,GACtBE,KAAOC,KAAKH,EAChB,CHDInB,EAAA,IAAApmB,QACAqmB,EAAA,IAAArmB,QC0DJqnB,GAAMM,IAHG,SAASnpB,EAASqoB,EAAQnR,GAC/BiR,GAAWnoB,EAAS,MAAOqoB,EAAQnR,EACvC,EGxDO,SAASkS,GAAcxH,GAC1B,OAAO1C,GAAS0C,IAJC,IAIQA,EAAKyH,UAAsD,iBAAlBzH,EAAK0H,QAC3E,CAeO,SAASC,GAAa3H,GACzB,OAJG,SAAgBA,GACnB,OAAO1C,GAAS0C,SAA2B,IAAlBA,EAAKyH,QAClC,CAEWG,CAAO5H,IAnBa,KAmBJA,EAAKyH,UAAuC,SAAUzH,CACjF,CAsBO,SAAS6H,GAAY7H,GACxB,OAvCG,SAAoBA,GACvB,OAAO1C,GAAS0C,IANE,IAMOA,EAAKyH,QAClC,CAqCQK,CAAW9H,GACJA,EArCR,SAAkBA,GACrB,OAAO1C,GAAS0C,IAAoC,mBAA3BA,EAAK9iB,aAAa2f,IAC/C,CAoCQkL,CAAS/H,GACFA,EAAKmF,SACTnF,GAAMgI,eAAiB7C,QAClC,CCjDa,MAAA8C,GAQT,WAAA/qB,CAAYgrB,GAPZC,GAAA7qB,KAAA,6BAES,IAAAA,KAAK4qB,QAAQhK,eACPiH,gBACM7nB,KAAK4qB,QAAQhK,QAAQkK,eAAiBjD,YAW3DgD,GAAA7qB,KAAA,kBACWuqB,GAAYvqB,KAAKqF,OAE5BwlB,GAAA7qB,KAAA,gBACWA,KAAKuqB,cAAcQ,aAAe3b,QAE7Cyb,GAAA7qB,KAAA,uBDwCG,SAA0BgrB,GAC7B,IAAI1C,EAAgB0C,EAAS1C,cAC7B,KAAOA,GAAeC,YAAY,CAC9B,MAAM0C,EAAK3C,EAAcC,WAAWD,cACpC,GAAI2C,IAAO3C,EACP,MAEAA,EAAgB2C,CACxB,CACA,OAAO3C,CACX,CCjDeE,CAAiBxoB,KAAKqF,OAEjCwlB,GAAA7qB,KAAA,kBAAmB0iB,GACRA,IAAS1iB,KAAKwoB,oBAKzBqC,GAAA7qB,KAAA,gBAAiBkrB,GACRlrB,KAAKqF,KAEHrF,KAAKqF,KAAK8lB,cAAcD,GADpB,MAGfL,GAAA7qB,KAAA,mBAAoBkrB,GACXlrB,KAAKqF,KAEHrF,KAAKqF,KAAK+lB,iBAAiBF,GAFpB,IAIlBL,GAAA7qB,KAAA,aAAU,CAAI4lB,EAAUyF,IACbrrB,KAAKsrB,YAAYC,WAAW3F,EAAUyF,IAEjDR,GAAA7qB,KAAA,eAAgBwrB,GACLxrB,KAAKsrB,YAAYG,aAAaD,IAnCjCxrB,KAAK4qB,QADc,mBAAZA,EACQpK,GAAQoK,GAGRA,CAEvB,SAbAvlB,iCAAAA,CAAIxF,oBA0BJ,cAAA6rB,CAAejoB,GACJ,OAAAzD,KAAKqF,KAAKqmB,eAAejoB,EACpC,ECRG,SAASkoB,GAAUC,EAAKC,GAC3B,MAAO,CACH,CAACtsB,MAAyBmjB,IACtB,OpBGD1C,GADIngB,EoBFO+rB,IpBGQtL,MAAazgB,GoBF3B+rB,EAAIhL,QAAU8B,EACdgH,GAAQ,IAAMmC,IAAWnJ,IAClB,KAEC,gBAAiBA,GAAQA,EAAKoJ,cAElCF,EAAIhL,QAAU,KACdiL,IAAW,UAGnBD,EAAIlJ,GACJgH,GAAQ,IAAMmC,IAAWnJ,IAClB,KAEC,gBAAiBA,GAAQA,EAAKoJ,cAElCF,EAAI,MACJC,IAAW,apBhBZhsB,GoBoBf,CC3CO,SAASksB,GAAsBC,GAClC,OAAOA,EAAY,QAAK,CAC5B,eAgBO,MAAMC,GAIT,WAAArsB,CAAYssB,GAHZnsB,GAAAC,KAAAmsB,GACApsB,GAAAC,KAAAosB,GACAvB,GAAA7qB,KAAA,SAEI8nB,GAAA9nB,KAAKmsB,EAAWD,EAAOG,WAAaH,EAAOG,aAAe,MAC1DvE,GAAA9nB,KAAKosB,EAAUzrB,QAAKwrB,GAAW,QAAQxrB,QAAKwrB,MAAc,QAAQD,EAAOI,cACzEtsB,KAAKusB,QAAUvsB,KAAKusB,QAAQC,KAAKxsB,MACjCA,KAAKkrB,SAAWlrB,KAAKkrB,SAASsB,KAAKxsB,MACnCA,KAAKysB,MAAQrM,OAAOsM,YAAYR,EAAOzH,MAAMlhB,IAAKopB,GAAS,CAACA,EAAM3sB,KAAKusB,QAAQI,KACnF,CACA,OAAAJ,CAAQI,EAAMC,GACV,OAAIA,EACO,QAAQA,KAAmBD,IAC/B,GAAGhsB,GAAAX,KAAKosB,KAAUO,GAC7B,CACA,QAAAzB,CAASyB,EAAMC,GACX,MAAO,IAAI5sB,KAAKusB,QAAQI,EAAMC,KAClC,EAEG,SAASC,GAAgBX,GAC5B,MAAMY,EAAY,IAAIb,GAAUC,GAChC,MAAO,IACAY,EAAUL,MACbvB,SAAU4B,EAAU5B,SACpBqB,QAASO,EAAUP,QAE3B,CA1BIJ,EAAA,IAAA7pB,QACA8pB,EAAA,IAAA9pB,QChBG,MCVMyqB,GAAgC,oBAAblF,SACnBmF,GAEDD,IACJ3d,QAAQ6d,WAAWC,YAClB,iBAAiB5I,KAAKlV,OAAO6d,UAAUC,YAEnC9d,QAAQ6d,WAAWE,eAAiB,GACjC,iBAAiB7I,KAAKlV,QAAQ6d,UAAUC,YAKjD,SAAShD,GAAcU,GAC1B,OAAOA,aAAmBwC,WAC9B,CCdO,MAAMC,GAGT,WAAAztB,CAAY0tB,GAHTvtB,GAAAC,KAAAutB,GACHxtB,GAAAC,KAAAwtB,GACAztB,GAAAC,KAAAytB,EAAgB,MAEZ3F,GAAA9nB,KAAKwtB,EAAQF,GACb1D,GAAgB,IAAM3oB,GAAAjB,KAAKutB,EAAAG,GAALxsB,KAAAlB,MAC1B,CAOA,GAAA2tB,CAAI9D,GAEA5oB,GAAAjB,KAAKutB,EAAAG,GAALxsB,KAAAlB,MACA,MAAM0iB,EAAO/hB,GAAAX,KAAKwtB,GAAM5B,IAAIhL,QACvB8B,IAE6B,mBAAvBA,EAAKkL,cAIhB9F,GAAA9nB,KAAKytB,EAAgBre,OAAOye,sBAAsB,KAC9C,MAAMC,EAAapL,EAAKkL,gBACE,IAAtBE,EAAW3pB,OAIf4pB,QAAQC,WAAWF,EAAWvqB,IAAK0qB,GAAcA,EAAUC,WAAWlE,KAAK,KACvE/oB,GAAAjB,KAAKutB,KAALrsB,KAAAlB,KAAsB6pB,KAJtB5oB,GAAAjB,KAAKutB,KAALrsB,KAAAlB,KAAsB6pB,MAN1B5oB,GAAAjB,KAAKutB,KAALrsB,KAAAlB,KAAsB6pB,GAa9B,EAhCA2D,EAAA,IAAAlrB,QACAmrB,EAAA,IAAAnrB,QAFGirB,EAAA,IAAAhrB,QAOHmrB,EAAQ,WACC/sB,GAAAX,KAAKytB,KAEVre,OAAO+e,qBAAqBxtB,QAAK8sB,IACjC3F,GAAA9nB,KAAKytB,EAAgB,MACzB,EAsBAW,EAAgB,SAACvE,GACb,MAAMwE,EAAU,KACZxE,KAEAlpB,GAAAX,KAAKwtB,GAAM1D,UACXA,GAAUuE,GAGVA,GAER,EC3CS,MAAAC,GAKT,WAAA1uB,CAAY0tB,8CADIrqB,IAAO,IAEnB6kB,GAAA9nB,KAAIwtB,EAASF,GACbzoB,GAAAlE,GAAAX,QAAqBstB,EAAKiB,KAAK3N,SAAO,GACtCkH,GAAA9nB,OAAgBstB,EAAKkB,UAAW,GAChC1G,GAAA9nB,OAAqB,IAAOqtB,GAAkB,CAC1CzB,IAAKjrB,GAAAX,KAAIwtB,GAAO5B,IAChB9B,UAAWnpB,GAAAX,KAAIwtB,GAAOe,QAE1B5E,GAAK,IAAOhpB,GAAAX,KAAIwtB,GAAOe,KAAK3N,QAAU6N,IAC9BA,GAAM5pB,GACNlE,GAAAX,KAAI0uB,IAAiB,GACpB/tB,YAELA,GAAAX,KAAI2uB,GAAkBhB,SACdc,IAAW9tB,GAAAX,KAAIwtB,GAAOe,KAAK3N,UACtBjgB,GAAAX,QAAWuuB,KAAK3N,YACjBjgB,GAAAX,KAAI0uB,IAAiB,GAEzB/tB,GAAAX,KAAIwtB,GAAOoB,mBAI3B,CACI,gBAAAC,GACO,OAAA3qB,GAAAvD,WACX,EC7BG,SAASmuB,KAAS,CCHlB,SAASC,GAASC,EAAaC,GAE9B,MAAO,QAAQD,GAEvB,yDCCM,MAAAE,GAAcrC,GAAe,CAC/BP,UAAW,SACX7H,MAAK,CAAG,UAAW,UAAW,UAAW,QAAS,cAAe,QAAS,SAAU,YAElF0K,GAAiB,IAAO1G,GAAQ,kCAOpB2G,EAAA,IAAA9sB,QACA+sB,EAAA,IAAA/sB,QACAgtB,EAAA,IAAAhtB,QACIitB,EAAA,IAAAjtB,QACNktB,EAAA,IAAAltB,QACFmtB,EAAA,IAAAntB,QACEotB,EAAA,IAAAptB,QACIqtB,EAAA,IAAArtB,QACHstB,EAAA,IAAAttB,QACKutB,EAAA,IAAAvtB,sBAfT,IAAAwtB,GAAA,MAAAC,EAoBT,WAAAnwB,CAAY0tB,EAAM0C,GAflBnF,GAAA7qB,KAAA,QACcD,GAAAC,KAAAovB,EAAAnsB,GAAO,OACPlD,GAAAC,KAAAqvB,EAAApsB,GAAO,OACPlD,GAAAC,KAAAsvB,EAAArsB,GAAO,OACHlD,GAAAC,KAAAuvB,EAAAtsB,GAAO,OACblD,GAAAC,KAAAwvB,EAAAvsB,QAAO,IACTlD,GAAAC,KAAAyvB,EAAAxsB,QAAO,IACLlD,GAAAC,KAAA0vB,EAAAzsB,QAAO,IACHlD,GAAAC,KAAA2vB,EAAA1sB,QAAO,IACVlD,GAAAC,KAAA4vB,EAAA3sB,GAAO,OACFlD,GAAAC,KAAA6vB,EAAA5sB,GAAO,IACzB4nB,GAAA7qB,KAAA,SACA6qB,GAAA7qB,KAAA,UACA6qB,GAAA7qB,KAAA,mBACA6qB,GAAA7qB,KAAA,mBA8CA6qB,GAAA7qB,KAAA,cAAe2sB,GACJuC,GAAY3C,QAAQI,EAAM3sB,KAAKstB,KAAK2C,QAAQrP,mCAanD,cP7E0BoL,EO6EMhsB,KAAKstB,KAAKiB,KAAK3N,QP5E5CoL,EAAY,OAAS,WADzB,IAA2BA,KOmB1BhsB,KAAKstB,KAAOA,EACZttB,KAAKgwB,OAASA,EACdhwB,KAAKkwB,MAAQF,EAASA,EAAOE,MAAQ,EAAI,EACzClwB,KAAKmwB,WAAanwB,KAAKmwB,WAAW3D,KAAKxsB,MACvCA,KAAKowB,YAAcpwB,KAAKowB,YAAY5D,KAAKxsB,MACzCA,KAAKqwB,gBAAe,IAAO/B,GAAe,CACtC1C,IAAKpL,GAAO,IAAOxgB,KAAKswB,aACxB/B,KAAMvuB,KAAKstB,KAAKiB,KAChBC,SAAS,EACTI,gBACI5uB,KAAKstB,KAAKiD,qBAAqB3P,QAAQ5gB,KAAKstB,KAAKiB,KAAK3N,YAG9D5gB,KAAKwwB,gBAAe,IAAOlC,GAAe,CACtC1C,IAAKpL,GAAO,IAAOxgB,KAAKywB,aACxBlC,KAAMvuB,KAAKstB,KAAKiB,KAChBC,SAAS,IAEb7E,GAAY,IAAA3pB,KAAKstB,KAAKiB,KAAK3N,QAAU6N,IAC5BzuB,KAAKgwB,SAENvB,EACAzuB,KAAKgwB,OAAOU,kBAGZ1wB,KAAKgwB,OAAOW,oBAEf,CAAAvH,MAAM,IACXQ,QACQ5pB,KAAKstB,KAAKiB,KAAK3N,SACf5gB,KAAKgwB,QAAQW,mBAGzB,cArDOC,CAAOtD,GACJ,MAAA0C,EAASb,GAAkBpG,MAAM,MAChC,OAAAoG,GAAkBzuB,IAAG,IAAKqvB,EAAgBzC,EAAM0C,GAC3D,gBAEAa,wCAAAA,CAAWhxB,sCACXywB,wCAAAA,CAAWzwB,sCACX4wB,wCAAAA,CAAW5wB,0CACXixB,4CAAAA,CAAejxB,oCACfkxB,sCAAAA,CAASlxB,kCACTmxB,oCAAAA,CAAOnxB,oCACPoxB,sCAAAA,CAASpxB,wCACTqxB,0CAAAA,CAAarxB,qCACbsxB,uCAAAA,CAAUtxB,0CACVuxB,4CAAAA,CAAevxB,uBAwCf,UAAAswB,GACQnwB,KAAKstB,KAAKiB,KAAK3N,UAEnB5gB,KAAKstB,KAAKiB,KAAK3N,SAAU,EAC7B,CACA,WAAAwP,GACSpwB,KAAKstB,KAAKiB,KAAK3N,UAEpB5gB,KAAKstB,KAAKiB,KAAK3N,SAAU,EAC7B,CAIA,eAAA8P,GACI1wB,KAAKoxB,kBACLpxB,KAAKgwB,QAAQU,iBACjB,CACA,eAAAC,GACiC,IAAzB3wB,KAAKoxB,kBAETpxB,KAAKoxB,kBACLpxB,KAAKgwB,QAAQW,kBACjB,gBACAU,wCAAAA,CAAWxxB,oCAiDF,IAAAyxB,GAAA,MAAAC,EAOT,WAAA3xB,CAAY0tB,EAAMjoB,GAHlBwlB,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,iCAwBIyD,GAAIzD,KAAKstB,KAAK7pB,GAAGmd,QAChB,CAAA5gB,KAAKqF,KAAKmsB,YAAYxxB,KAAKstB,KAAK2C,QAAQrP,UAAW,GACpD6Q,QAASzxB,KAAKyxB,QACdC,UAAW1xB,KAAK0xB,UAChBvlB,WAAUnM,KAAKstB,KAAKnhB,SAASyU,cAAiB,EAC9C+Q,SAAU,KACP3xB,KAAKqF,KAAKgsB,eACVrxB,KAAK4xB,eA7BR5xB,KAAKstB,KAAOA,EACZttB,KAAKqF,KAAOA,EACZrF,KAAK4xB,WAAajG,GAAU3rB,KAAKstB,KAAK1B,KACtC5rB,KAAKyxB,QAAUzxB,KAAKyxB,QAAQjF,KAAKxsB,MACjCA,KAAK0xB,UAAY1xB,KAAK0xB,UAAUlF,KAAKxsB,KACzC,cAZO4wB,CAAOtD,GACC,OAAA,IAAAiE,EAAiBjE,EAAM6B,GAAkBnuB,MACxD,CAWA,OAAAywB,CAAQhsB,GACAzF,KAAKstB,KAAKnhB,SAASyU,SAEnBnb,EAAE2B,OAAS,GAEfpH,KAAKqF,KAAK+qB,aACd,CACA,SAAAsB,CAAUjsB,GACFzF,KAAKstB,KAAKnhB,SAASyU,SNlIV,MMoITnb,EAAEjF,KNvJO,UMuJciF,EAAEjF,MACzBiF,EAAEosB,iBACF7xB,KAAKqF,KAAK+qB,cAElB,UACA5J,kCAAAA,CAAK3mB,oCA8BI,IAAAiyB,GAAA,MAAAC,EAOT,WAAAnyB,CAAY0tB,EAAMjoB,GAHlBwlB,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,iCAWIyD,GAAIzD,KAAKstB,KAAK7pB,GAAGmd,QACjBoR,KAAM,UACN,aAAchyB,KAAKstB,KAAK3T,MAAMiH,QAC7B,CAAA5gB,KAAKqF,KAAKmsB,YAAY,UAAW,MAC/BxxB,KAAKqF,KAAKgsB,eACVrxB,KAAK4xB,eAdR5xB,KAAKstB,KAAOA,EACZttB,KAAKqF,KAAOA,EACZrF,KAAKqF,KAAK2rB,QAAUhxB,KAAKstB,KAAK7pB,GAAGmd,QACjC5gB,KAAK4xB,WAAajG,GAAU3rB,KAAKstB,KAAK1B,KACtCjC,GAAMM,IAAG,IAAOjqB,KAAKstB,KAAK7pB,GAAGmd,QAAUnd,IACnCzD,KAAKqF,KAAK2rB,QAAUvtB,GAE5B,cAdOmtB,CAAOtD,GACC,OAAA,IAAAyE,EAAiBzE,EAAM6B,GAAkBnuB,MACxD,UAaAwlB,kCAAAA,CAAK3mB,oCASI,IAAAoyB,GAAA,MAAAC,EAOT,WAAAtyB,CAAY0tB,EAAMjoB,GAHlBwlB,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,iCAaIyD,GAAIzD,KAAKstB,KAAK7pB,GAAGmd,QAChB,CAAA5gB,KAAKqF,KAAKmsB,YAAY,gBAAiB,MACrCxxB,KAAKqF,KAAKgsB,eACVrxB,KAAK4xB,eAdR5xB,KAAKstB,KAAOA,EACZttB,KAAKqF,KAAOA,EACZrF,KAAKqF,KAAK6rB,cAAgBlxB,KAAKstB,KAAK7pB,GAAGmd,QACvC5gB,KAAK4xB,WAAajG,GAAU3rB,KAAKstB,KAAK1B,IAAMnrB,IACxCT,KAAKqF,KAAKyrB,gBAAkBrwB,IAEhCkpB,GAAMM,IAAG,IAAOjqB,KAAKstB,KAAK7pB,GAAGmd,QAAUnd,IACnCzD,KAAKqF,KAAK6rB,cAAgBztB,GAElC,cAhBOmtB,CAAOtD,GACC,OAAA,IAAA4E,EAAuB5E,EAAM6B,GAAkBnuB,MAC9D,UAeAwlB,kCAAAA,CAAK3mB,kDAOI,IAAAsyB,GAAA,MAAAC,EAOT,WAAAxyB,CAAY0tB,EAAMjoB,GAHlBwlB,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,iCASoCuuB,KAAMvuB,KAAKqF,KAAKioB,KAAKiB,KAAK3N,+BAE1Dnd,GAAIzD,KAAKstB,KAAK7pB,GAAGmd,QACjBoR,KAAyC,iBAAnChyB,KAAKqF,KAAKioB,KAAK2C,QAAQrP,QAA6B,cAAgB,SAC1E,aAAc,OACd,mBAAoB5gB,KAAKqF,KAAK6rB,cAC9B,kBAAmBlxB,KAAKqF,KAAK2rB,QAC5B,CAAAhxB,KAAKqF,KAAKmsB,YAAY,YAAa,GACpC5P,MAAK,CACDyQ,cAAe,OACfC,QAA4C,iBAAnCtyB,KAAKqF,KAAKioB,KAAK2C,QAAQrP,QAA6B,YAAS,EACtE,sBAAuB5gB,KAAKqF,KAAK6qB,MACjC,6BAA8BlwB,KAAKqF,KAAK+rB,iBAE5CO,SAA6C,iBAAnC3xB,KAAKqF,KAAKioB,KAAK2C,QAAQrP,SAA0B,OAAQ,EACnE,mBAAoBmL,GAAsB/rB,KAAKqF,KAAK+rB,gBAAkB,GACtE,cAAerF,GAA2C,OAArB/rB,KAAKqF,KAAK2qB,WAC5ChwB,KAAKqF,KAAKgsB,eACVrxB,KAAK4xB,eAzBR5xB,KAAKstB,KAAOA,EACZttB,KAAKqF,KAAOA,EACZrF,KAAK4xB,WAAajG,GAAU3rB,KAAKstB,KAAK1B,IAAMnrB,IACxCT,KAAKqF,KAAKirB,YAAc7vB,EACxBT,KAAKqF,KAAK0rB,UAAYtwB,GAAGgD,IAEjC,cAbOmtB,CAAOtD,GACC,OAAA,IAAA8E,EAAmB9E,EAAM6B,GAAkBnuB,MAC1D,iBAYAuxB,yCAAAA,CAAY1yB,6BACZ2mB,kCAAAA,CAAK3mB,oBAmBD,gBAAAgvB,GACO,OAAA7uB,KAAKqF,KAAKgrB,gBAAgBxB,YACrC,+BAES,IAAA2D,GAAA,MAAAC,EAOT,WAAA7yB,CAAY0tB,EAAMjoB,GAHlBwlB,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,iCAMoCuuB,KAAMvuB,KAAKqF,KAAKioB,KAAKiB,KAAK3N,+BAE1Dnd,GAAIzD,KAAKstB,KAAK7pB,GAAGmd,QAChB,CAAA5gB,KAAKqF,KAAKmsB,YAAY,YAAa,GACpC5P,MAAK,CACDyQ,cAAe,OACf,sBAAuBryB,KAAKqF,KAAK6qB,MACjC,6BAA8BlwB,KAAKqF,KAAK+rB,iBAE5C,mBAAoBrF,GAAsB/rB,KAAKqF,KAAK+rB,gBAAkB,GACtE,cAAerF,GAA2C,OAArB/rB,KAAKqF,KAAK2qB,WAC5ChwB,KAAKqF,KAAKgsB,eACVrxB,KAAK4xB,eAhBR5xB,KAAKstB,KAAOA,EACZttB,KAAKqF,KAAOA,EACZrF,KAAK4xB,WAAajG,GAAU3rB,KAAKstB,KAAK1B,IAAMnrB,GAAOT,KAAKqF,KAAKorB,YAAchwB,EAC/E,cAVOmwB,CAAOtD,GACC,OAAA,IAAAmF,EAAmBnF,EAAM6B,GAAkBnuB,MAC1D,iBASAuxB,yCAAAA,CAAY1yB,6BACZ2mB,kCAAAA,CAAK3mB,oBAaD,gBAAAgvB,GACO,OAAA7uB,KAAKqF,KAAKmrB,gBAAgB3B,YACrC,sDCnTGI,EAAGyD,kBAGRjvB,EAAEX,GAAAC,EAAA,KAAA,GAAA,IAAGgsB,GAASE,IACdrD,gBAAgB,MAGhBjS,iBAAQ,GACLgZ,EAAAC,GAAA7vB,EAAA,+EAGE8vB,EAAaf,GAAiBlB,OAAM,CACzCntB,GAAI+c,GAAO,IAAO/c,KAClBkW,MAAO6G,GAAO,IAAO7G,KACrBiS,IAAKpL,GAAO,IACLoL,IACLnrB,GAAOmrB,EAAMnrB,MAIVqyB,SAAuBvM,GAAWoM,EAAWE,EAAWrM,oDAI7CuM,GAAAxsB,EAAA,IAAAxD,EAAAiwB,MAAA,KAAA,CAAAxM,SAAOsM,yBAEvB1tB,EAAGsB,KAAHusB,GAAA7tB,cAAQ0tB,eAAR1tB,+BAAAA,QAAAA,gDALF,8BCdO,SAAasd,EAAMwQ,EAASC,GAC9BC,IACHC,KAGD,IAAIC,EAAW,IAAIC,GAAc7Q,GAE7B8Q,GAAUC,KAEdC,GAAM,KACL,IAAIlzB,EAAM0yB,IAGNM,GAAkB,OAARhzB,GAA+B,iBAARA,IACpCA,EAAwB,CAAA,GAGzB8yB,EAASK,OAAOnzB,EAAK2yB,IAEvB,wFC5BA,CCFO,MAAMS,GAAoB,IAAInL,GAAQ,cAwCtC,MAAMoL,GAET,WAAAj0B,CAAYowB,EAAQ1C,GADpBzC,GAAA7qB,KAAA,QAEI,MAAM8zB,EA+Bd,SAA8B9D,EAAQ+D,GAClC,OAAQtT,GACiBD,GAAQ,KAEzB,MAAM3gB,EAAQ4gB,EAAOsT,IAAcnT,QACnC,YAAc,IAAV/gB,EACOA,EAEI,OAAXmwB,EAGGvP,EAAOuP,EAAO1C,OAAO1M,aAH5B,GAOZ,CA9CoCoT,CAAqBhE,EAAQ1C,GACzDttB,KAAKstB,KAAO,CACR2G,gBAAiBH,EAAqB5H,GAAWA,EAAO+H,iBACxDC,cAAeJ,EAAqB5H,GAAWA,EAAOgI,eAE9D,ECdG,MAAMC,IA5BeC,GA4B2BlI,GAAWA,EAAO+H,gBA5B/BzlB,GA4BgD,OA3B9E6lB,IACJ,MAAMnI,EDFP,WACH,MAAM1d,EAAW,IAAIqlB,GAAgB,KAAM,CAAA,GAC3C,OAAOD,GAAkB7K,MAAMva,GAAU8e,IAC7C,CCDuBgH,GACf,OAAO9T,GAAQ,KAEX,MAAM+T,EAAYF,IAClB,QAAkB,IAAdE,EACA,OAAOA,EAEX,MAAMC,EAASJ,GAAalI,GAAQtL,QACpC,YAAe,IAAX4T,EACOA,EAEJhmB,OAbnB,IAA4B4lB,GAAc5lB,6BCGnC,MAAAimB,EAAKN,GAAmB,IAAApxB,EAAA0xB,IACxBlnB,EAAUmnB,KAEZ,IA2BAC,EA3BAC,KAEK,WACH,IAAA7H,sBAA8B,KAE/B,IAAA8H,EAA8B,KAEvB,GAAe,iBAAfJ,EAAG7T,QAAsB,CAKnCiU,EAJehN,SAASsD,cAAcsJ,EAAG7T,QAK1C,MACCiU,EAAcJ,EAAG7T,eAUXiU,CACR,GAIS,SAAAC,IACJH,IACHI,GAAQJ,GACRA,EAAW,KAEb,CAEAhL,WAAaiL,GAAM,IAAA7xB,EAAAoJ,UAAA,EAAqByoB,EAAQzoB,SAC1CyoB,IAAUzoB,EAUF,OANbwoB,EAAWK,GAAMC,GAAc,CACtBL,OAAAA,EACRpO,MAAK,CAAI0O,SAAQnyB,EAAAmyB,UACjB3nB,YAGY,KACZunB,KAVAA,4HAaH,CChEO,SAASK,GAAStL,EAAIuL,EAAO,KAChC,IAAIC,EAAU,KACd,MAAMC,EAAY,IAAI3P,KACF,OAAZ0P,GACA5J,aAAa4J,GAEjBA,EAAU9J,WAAW,KACjB1B,KAAMlE,IACPyP,IAQP,OANAE,EAAUC,QAAU,KACA,OAAZF,IACA5J,aAAa4J,GACbA,EAAU,OAGXC,CACX,CClBO,SAASE,GAAmB9S,EAAMkS,GACrC,OAAOlS,IAASkS,GAAUlS,EAAK+S,SAASb,EAC5C,CACO,SAASc,GAAiBzK,GAC7B,OAAOA,GAAIP,eAAiB7C,QAChC,CCIA,IAAI8N,GAAqB,CAAC,qBAAsB,sBAAuB,wBAAyB,uBAAwB,sBAAuB,oCAAqC,+BAAgC,+BAAgC,gEAAiE,6CAA8C,wBAC/VC,GAAmCD,GAAmBjkB,KAAK,KAC3DmkB,GAA+B,oBAAZC,QACnBC,GAAUF,GAAY,WAAa,EAAIC,QAAQnzB,UAAUozB,SAAWD,QAAQnzB,UAAUqzB,mBAAqBF,QAAQnzB,UAAUszB,sBAC7HnL,IAAe+K,IAAaC,QAAQnzB,UAAUmoB,YAAc,SAAUF,GACxE,IAAIsL,EACJ,OAAOtL,SAAmG,QAAhDsL,EAAuBtL,EAAQE,mBAAkD,IAAzBoL,OAAlE,EAA6GA,EAAqBh1B,KAAK0pB,EACzL,EAAI,SAAUA,GACZ,OAAOA,aAAyC,EAASA,EAAQF,aACnE,EAUIyL,GAAW,SAAiBzT,EAAM0T,GACpC,IAAIC,OACW,IAAXD,IACFA,GAAS,GAKX,IAAIE,EAAW5T,SAAyF,QAA5C2T,EAAqB3T,EAAK6T,oBAAiD,IAAvBF,OAA9D,EAAuGA,EAAmBn1B,KAAKwhB,EAAM,SAUvL,MATyB,KAAb4T,GAAgC,SAAbA,GAOTF,GAAU1T,GAAQyT,GAASzT,EAAK8T,WAGxD,EAsBIC,GAAgB,SAAuBxL,EAAIyL,EAAkBjyB,GAG/D,GAAI0xB,GAASlL,GACX,MAAO,GAET,IAAI0L,EAAavc,MAAMzX,UAAU6D,MAAMowB,MAAM3L,EAAGG,iBAAiBwK,KAKjE,OAJIc,GAAoBX,GAAQ70B,KAAK+pB,EAAI2K,KACvCe,EAAWE,QAAQ5L,GAErB0L,EAAaA,EAAWlyB,OAAOA,EAEjC,EAoCIqyB,GAA4B,SAAkCC,EAAUL,EAAkB1e,GAG5F,IAFA,IAAI2e,EAAa,GACbK,EAAkB5c,MAAMC,KAAK0c,GAC1BC,EAAgB7yB,QAAQ,CAC7B,IAAIymB,EAAUoM,EAAgBC,QAC9B,IAAId,GAASvL,GAAS,GAKtB,GAAwB,SAApBA,EAAQsM,QAAoB,CAE9B,IAAIC,EAAWvM,EAAQwM,mBACnBnpB,EAAUkpB,EAAShzB,OAASgzB,EAAWvM,EAAQsK,SAC/CmC,EAAmBP,GAA0B7oB,GAAS,EAAM+J,GAC5DA,EAAQsf,QACVX,EAAWlc,KAAKmc,MAAMD,EAAYU,GAElCV,EAAWlc,KAAK,CACd8c,YAAa3M,EACb+L,WAAYU,GAGlB,KAAO,CAEgBtB,GAAQ70B,KAAK0pB,EAASgL,KACrB5d,EAAQvT,OAAOmmB,KAAa8L,IAAqBK,EAASvd,SAASoR,KACvF+L,EAAWlc,KAAKmQ,GAIlB,IAAIrC,EAAaqC,EAAQrC,YAEQ,mBAA1BvQ,EAAQwf,eAAgCxf,EAAQwf,cAAc5M,GAKjE6M,GAAmBtB,GAAS5N,GAAY,MAAYvQ,EAAQ0f,kBAAoB1f,EAAQ0f,iBAAiB9M,IAC7G,GAAIrC,GAAckP,EAAiB,CAOjC,IAAIE,EAAoBb,IAAyC,IAAfvO,EAAsBqC,EAAQsK,SAAW3M,EAAW2M,UAAU,EAAMld,GAClHA,EAAQsf,QACVX,EAAWlc,KAAKmc,MAAMD,EAAYgB,GAElChB,EAAWlc,KAAK,CACd8c,YAAa3M,EACb+L,WAAYgB,GAGlB,MAGEX,EAAgBH,QAAQD,MAAMI,EAAiBpM,EAAQsK,SAE3D,CACF,CACA,OAAOyB,CACT,EAQIiB,GAAc,SAAqBlV,GACrC,OAAQmV,MAAMC,SAASpV,EAAK6T,aAAa,YAAa,IACxD,EAQIwB,GAAc,SAAqBrV,GACrC,IAAKA,EACH,MAAM,IAAI7U,MAAM,oBAElB,OAAI6U,EAAKsV,SAAW,IAQb,0BAA0B1T,KAAK5B,EAAKwU,UA5JrB,SAA2BxU,GACjD,IAAIuV,EAIAC,EAAWxV,SAA0F,QAA7CuV,EAAsBvV,EAAK6T,oBAAkD,IAAxB0B,OAA/D,EAAyGA,EAAoB/2B,KAAKwhB,EAAM,mBAC1L,MAAoB,KAAbwV,GAAgC,SAAbA,CAC5B,CAqJyDC,CAAkBzV,MAAWkV,GAAYlV,GACrF,EAGJA,EAAKsV,QACd,EAiBII,GAAuB,SAA8B3R,EAAGC,GAC1D,OAAOD,EAAEuR,WAAatR,EAAEsR,SAAWvR,EAAE4R,cAAgB3R,EAAE2R,cAAgB5R,EAAEuR,SAAWtR,EAAEsR,QACxF,EACIM,GAAU,SAAiB5V,GAC7B,MAAwB,UAAjBA,EAAKwU,OACd,EA2CIqB,GAAqB,SAA4B7V,GACnD,OAJY,SAAiBA,GAC7B,OAAO4V,GAAQ5V,IAAuB,UAAdA,EAAKhX,IAC/B,CAES8sB,CAAQ9V,KA3BK,SAAyBA,GAC7C,IAAKA,EAAKnD,KACR,OAAO,EAET,IAIIkZ,EAJAC,EAAahW,EAAKiW,MAAQ7N,GAAYpI,GACtCkW,EAAc,SAAqBrZ,GACrC,OAAOmZ,EAAWtN,iBAAiB,6BAA+B7L,EAAO,KAC3E,EAEA,GAAsB,oBAAXnQ,aAAgD,IAAfA,OAAOypB,KAAoD,mBAAtBzpB,OAAOypB,IAAIC,OAC1FL,EAAWG,EAAYxpB,OAAOypB,IAAIC,OAAOpW,EAAKnD,YAE9C,IACEkZ,EAAWG,EAAYlW,EAAKnD,KAC9B,OAASzR,GAGP,OADAN,QAAQF,MAAM,2IAA4IQ,EAAIC,UACvJ,CACT,CAEF,IAAIgrB,EA3BgB,SAAyBC,EAAOL,GACpD,IAAA,IAAStW,EAAI,EAAGA,EAAI2W,EAAM70B,OAAQke,IAChC,GAAI2W,EAAM3W,GAAG0W,SAAWC,EAAM3W,GAAGsW,OAASA,EACxC,OAAOK,EAAM3W,EAGnB,CAqBgB4W,CAAgBR,EAAU/V,EAAKiW,MAC7C,OAAQI,GAAWA,IAAYrW,CACjC,CAK2BwW,CAAgBxW,EAC3C,EAiDIyW,GAAa,SAAoBzW,GACnC,IAAI0W,EAAwB1W,EAAK2W,wBAC/BC,EAAQF,EAAsBE,MAC9BC,EAASH,EAAsBG,OACjC,OAAiB,IAAVD,GAA0B,IAAXC,CACxB,EACIC,GAAW,SAAkB9W,EAAM+W,GACrC,IAAIC,EAAeD,EAAKC,aACtBlC,EAAgBiC,EAAKjC,cACvB,GAAqB,gBAAjBkC,GACE,oBAAqBhX,EAgBvB,OAbcA,EAAKiX,gBAAgB,CAGjCC,cAAc,EACdC,iBAAiB,EACjBC,uBAAuB,EACvBC,oBAAoB,EAKpBC,oBAAoB,IAY1B,GAA0C,WAAtCC,iBAAiBvX,GAAMwX,WACzB,OAAO,EAET,IACIC,EADkBpE,GAAQ70B,KAAKwhB,EAAM,iCACAA,EAAK0X,cAAgB1X,EAC9D,GAAIqT,GAAQ70B,KAAKi5B,EAAkB,yBACjC,OAAO,EAET,GAAKT,GAAiC,SAAjBA,GAGJ,gBAAjBA,GAAmD,gBAAjBA,GAgElC,GAA4B,kBAAjBA,EAMT,OAAOP,GAAWzW,OAtE8C,CAChE,GAA6B,mBAAlB8U,EAA8B,CAIvC,IADA,IAAI6C,EAAe3X,EACZA,GAAM,CACX,IAAI0X,EAAgB1X,EAAK0X,cACrBpP,EAAWF,GAAYpI,GAC3B,GAAI0X,IAAkBA,EAAc7R,aAA+C,IAAjCiP,EAAc4C,GAI9D,OAAOjB,GAAWzW,GAGlBA,EAFSA,EAAK4X,aAEP5X,EAAK4X,aACFF,GAAiBpP,IAAatI,EAAKgI,cAKtC0P,EAHApP,EAASuP,IAKpB,CACA7X,EAAO2X,CACT,CAWA,GAjIiB,SAAwB3X,GAC3C,IAAI8X,EA+BEC,EAAeC,EAAuBC,EAPxCC,EAAWlY,GAAQoI,GAAYpI,GAC/BmY,EAA0C,QAA1BL,EAAYI,SAAoC,IAAdJ,OAAuB,EAASA,EAAUD,KAI5FO,GAAW,EACf,GAAIF,GAAYA,IAAalY,EAG3B,IADAoY,KAAiD,QAAlCL,EAAgBI,SAA4C,IAAlBJ,GAAsF,QAAzDC,EAAwBD,EAAc/P,qBAAqD,IAA1BgQ,GAAoCA,EAAsBjF,SAASoF,IAAiBnY,SAAmF,QAA9CiY,EAAsBjY,EAAKgI,qBAAmD,IAAxBiQ,GAAkCA,EAAoBlF,SAAS/S,KAC7XoY,GAAYD,GAAc,CAChC,IAAIE,EAAYC,EAAgBC,EAMhCH,IAAkD,QAAnCE,EADfH,EAA2C,QAA3BE,EADhBH,EAAW9P,GAAY+P,UAC2C,IAAfE,OAAwB,EAASA,EAAWR,YAClB,IAAnBS,GAAwF,QAA1DC,EAAwBD,EAAetQ,qBAAqD,IAA1BuQ,IAAoCA,EAAsBxF,SAASoF,GAC/N,CAEF,OAAOC,CACT,CAoFQI,CAAexY,GAKjB,OAAQA,EAAKyY,iBAAiBh3B,OAmBhC,GAAqB,gBAAjBu1B,EACF,OAAO,CAGX,CAWA,OAAO,CACT,EAgCI0B,GAAkC,SAAyCpjB,EAAS0K,GACtF,QAAIA,EAAKvW,UAITgqB,GAASzT,IA7PS,SAAuBA,GACzC,OAAO4V,GAAQ5V,IAAuB,WAAdA,EAAKhX,IAC/B,CA2PoB2vB,CAAc3Y,IAAS8W,GAAS9W,EAAM1K,IA1P/B,SAA8B0K,GAIvD,MAHyB,YAAjBA,EAAKwU,SAAyB9c,MAAMzX,UAAU6D,MAAMowB,MAAMlU,EAAKwS,UAAU3b,KAAK,SAAUyZ,GAC9F,MAAyB,YAAlBA,EAAMkE,OACf,EAEF,CAuPEoE,CAAqB5Y,IAlCM,SAAgCA,GAC3D,GAAI,mCAAmC4B,KAAK5B,EAAKwU,SAG/C,IAFA,IAAIV,EAAa9T,EAAK0X,cAEf5D,GAAY,CACjB,GAA2B,aAAvBA,EAAWU,SAA0BV,EAAWrqB,SAAU,CAE5D,IAAA,IAASkW,EAAI,EAAGA,EAAImU,EAAWtB,SAAS/wB,OAAQke,IAAK,CACnD,IAAI2Q,EAAQwD,EAAWtB,SAASloB,KAAKqV,GAErC,GAAsB,WAAlB2Q,EAAMkE,QAGR,QAAOnB,GAAQ70B,KAAKs1B,EAAY,0BAAkCxD,EAAMyC,SAAS/S,EAErF,CAEA,OAAO,CACT,CACA8T,EAAaA,EAAW4D,aAC1B,CAKF,OAAO,CACT,CAQgCmB,CAAuB7Y,GAIvD,EACI8Y,GAAiC,SAAwCxjB,EAAS0K,GACpF,QAAI6V,GAAmB7V,IAASqV,GAAYrV,GAAQ,IAAM0Y,GAAgCpjB,EAAS0K,GAIrG,EACI+Y,GAAuB,SAA8BC,GACvD,IAAI1D,EAAWF,SAAS4D,EAAenF,aAAa,YAAa,IACjE,SAAIsB,MAAMG,IAAaA,GAAY,EAMrC,EAMI2D,GAAe,SAAqBhF,GACtC,IAAIiF,EAAmB,GACnBC,EAAmB,GAkBvB,OAjBAlF,EAAWx1B,QAAQ,SAAU6L,EAAMqV,GACjC,IAAIyZ,IAAY9uB,EAAKuqB,YACjB3M,EAAUkR,EAAU9uB,EAAKuqB,YAAcvqB,EACvC+uB,EA3SmB,SAA8BrZ,EAAMoZ,GAC7D,IAAI9D,EAAWD,GAAYrV,GAC3B,OAAIsV,EAAW,GAAK8D,IAAYlE,GAAYlV,GACnC,EAEFsV,CACT,CAqS4BgE,CAAqBpR,EAASkR,GAClD/E,EAAW+E,EAAUH,GAAa3uB,EAAK2pB,YAAc/L,EAC/B,IAAtBmR,EACFD,EAAUF,EAAiBnhB,KAAKmc,MAAMgF,EAAkB7E,GAAY6E,EAAiBnhB,KAAKmQ,GAE1FiR,EAAiBphB,KAAK,CACpB4d,cAAehW,EACf2V,SAAU+D,EACV/uB,OACA8uB,UACA7tB,QAAS8oB,GAGf,GACO8E,EAAiBne,KAAK0a,IAAsBjc,OAAO,SAAU8f,EAAKC,GAEvE,OADAA,EAASJ,QAAUG,EAAIxhB,KAAKmc,MAAMqF,EAAKC,EAASjuB,SAAWguB,EAAIxhB,KAAKyhB,EAASjuB,SACtEguB,CACT,EAAG,IAAIE,OAAOP,EAChB,EAwCIQ,GAA4CzG,GAAmBwG,OAAO,UAAUzqB,KAAK,KCvjB5E,MAAA2qB,GAA4B,4BAC5BC,GAA4B,4BAWhBzP,GAAe,CACpCP,UAAW,OACX7H,MAAK,CACD,UACA,UACA,cACA,OACA,QACA,gBACA,iBACA,gBACA,cACA,aACA,YACA,cACA,WChCR8X,WAAWC,wBAAXD,WAAWC,sBAAqB,IAAS78B,+CAWrC88B,EAAA,IAAAn6B,QACAo6B,EAAA,IAAAp6B,QACAq6B,EAAA,IAAAr6B,sBAEAs6B,EAAA,IAAAt6B,sBAdSu6B,EAAA,IAAAt6B,QA+DTu6B,EAAkB,kBACPrX,GAQP0C,GAAGxnB,GAAAX,KAAI28B,GAAe,cAAelX,GAAiB9kB,GAAAX,KAAI+8B,IAAwBp8B,GAAAX,KAAIg9B,KAAsB,CAAKC,SAAS,IAM1H9U,GAAGxnB,QAAIg8B,GAAe,cAAelX,GAAiB9kB,GAAAX,KAAIk9B,IAA2Bv8B,GAAAX,UAIrFmoB,GAAGxnB,GAAAX,KAAI28B,GAAe,UAAWh8B,QAAIw8B,IACzC,gBAQAC,EAAA,IAAA96B,sCAoCA06B,GAAA,IAAA16B,uBAUA+6B,GAAA,IAAA/6B,QAMAg7B,GAAsB,kBACRld,OAAOle,OAAOvB,QAAI48B,IAAqBhkB,KAAK0C,QAE1D,EACAuhB,GAAA,IAAAl7B,QAGAm7B,GAAA,IAAAn7B,QAtJS,IAAAo7B,GAAA,MAAAC,EAeT,WAAA/9B,CAAY0tB,GAfHvtB,GAAAC,KAAA68B,GAIThS,GAAA7qB,KAAA,wCAGkB,CACd49B,aAAa,IAEjB79B,GAAAC,KAAAy8B,GAAsB,GACtB18B,GAAAC,KAAA08B,GAAwB,GACxB38B,GAAAC,KAAA28B,cAEA58B,GAAAC,KAAA48B,EAAsB9N,cAoCN+O,IACRA,EAAM7c,kBAELhhB,KAAKstB,KAAK1B,IAAIhL,SAEnBkJ,QACS9pB,KAAKstB,KAAK1B,IAAIhL,UAAWjgB,GAAAX,KAAI89B,IAAJ58B,KAAAlB,KAA0B69B,EAAMjJ,SAE1DiJ,EAAMjJ,SAAWj0B,GAAAX,KAAI08B,IACrB/7B,GAAAX,KAAI+9B,GAAiBnd,UAAUid,iBAyBzBp4B,IACV,IAAAo4B,EAAQp4B,EACRo4B,EAAM7c,mBACN6c,EAAQG,GAAmBv4B,IAE/B9E,GAAAX,KAAIi+B,GAAsBrd,QAAQnb,KAEtC1F,GAAAC,KAAAo9B,EAAyBjI,GAAU1vB,IAC1B,IAAAzF,KAAKstB,KAAK1B,IAAIhL,oBACfjgB,GAAAX,QAAAkB,KAAAlB,MAGE,MAAAk+B,EAAel+B,KAAKstB,KAAK6Q,aAAavd,QAAQnb,EAAGzF,KAAKstB,KAAK1B,IAAIhL,UAiFpE,SAAanb,EAAGid,SACfkS,EAASnvB,EAAEmvB,UhB1KiBhK,EgB2KPgK,IhB1KpBhK,aAAmBkL,SAAWlL,aAAmBwT,YgB0KvB,OACtB,EhB5KR,IAA+BxT,EgB6K5B,MAAAyT,EAA6BpiB,QAAQ2Y,EAAO0J,YAAYjC,WAC1D,WAAY52B,GAAKA,EAAE2B,OAAS,IAAMi3B,EAA0B,OACrD,KACP,WAAY54B,GAAkB,IAAbA,EAAE2B,QAAgBi3B,EAA0B,OACtD,EACL,MAAAE,EAAoBtiB,QAAQyG,EAAK4b,YAAYhC,WAC/C+B,GAA8BE,EAAiB,OACxC,QAELC,EADgB9I,GAAiBd,GACT6J,gBAAgBhJ,SAASb,KAClDY,GAAmB9S,EAAMkS,IC3L3B,SAA6BiJ,EAAOvN,GACvC,MAAMoO,QAAEA,EAAAC,QAASA,GAAYd,EACvBe,EAAOtO,EAAY+I,wBACzB,OAAQqF,EAAUE,EAAKC,MAAQH,EAAUE,EAAKE,OAASH,EAAUC,EAAKG,KAAOJ,EAAUC,EAAKI,MAChG,CDwLQC,CAAoBx5B,EAAGid,UACpB8b,CACX,CAjGYL,CAAa14B,EAAGzF,KAAKstB,KAAK1B,IAAIhL,aAC7BjgB,GAAAX,KAAIy8B,IAAwBx7B,cAAAC,KAAAlB,QAAkCk+B,cAC/Dv9B,GAAAX,QAAAkB,KAAAlB,MAGA,IAAA69B,EAAQp4B,EACRo4B,EAAM7c,mBACN6c,EAAQG,GAAmBH,IAEI,UAA/Bl9B,QAAIu+B,GAAete,SACY,0BAA/BjgB,GAAAX,KAAIk/B,GAAete,QAID,UAAlBnb,EAAE05B,aACFx+B,GAAAX,QAAAkB,KAAAlB,MACA8nB,GAAA9nB,OAA2BmoB,GAAGxnB,GAAAX,KAAI28B,GAAe,QAASh8B,QAAIy+B,GAAe,CACzEC,MAAM,MAIV1+B,GAAAX,KAAIi+B,GAAsBrd,QAAQid,GAVlCl9B,GAAAX,QAAAkB,KAAAlB,OAYL,gBACsByF,IACrB9E,GAAAX,QAAwByF,EAAEiG,OAAQ,eAEVjG,IACxB9E,GAAAX,QAAwByF,EAAEiG,OAAQ,IAEtC3L,GAAAC,KAAAg9B,QACSh9B,KAAKstB,KAAK1B,IAAIhL,SAEnBkH,GAAA9nB,KAAIy8B,WAiCgB/Z,SAClB4c,EAAS,IAAO/C,WAAWC,uBAO3B+C,EAbM,SAA2BD,EAAS,IAC7C/C,WAAWC,wBAEP,OAAA8C,EAAUE,SAAQ,EAAGC,GAAK7e,QAAS8e,MAAqC,UAAjBA,GAA6C,WAAjBA,EAC9F,CASyBC,CAA2BL,MAC5CC,EAAY,OACLA,EAAa,GAAGjS,KAAK1B,IAAIhL,UAAY8B,QACzCkd,GAAkBN,EAAU,GAC5B,OAAAM,EAAetS,KAAK1B,IAAIhL,UAAY8B,CAC/C,CA9CmCmd,CAAmB7/B,KAAKstB,KAAK1B,IAAIhL,uBAExCgU,KACf50B,KAAKstB,KAAK1B,IAAIhL,SAEZ4U,GAAmBx1B,KAAKstB,KAAK1B,IAAIhL,QAASgU,IAErD70B,GAAAC,KAAAq9B,GAAclI,QACC,IAAA,MAAA2K,KAAan/B,QAAI48B,GACxB58B,GAAAX,KAAIu9B,GAAoBuC,IAAa,EAEzChY,GAAA9nB,KAAIy8B,GAAuB,IAC5B,KAKH18B,GAAAC,KAAAw9B,QACI1V,GAAA9nB,KAAI08B,GAAyB,KAEjC38B,GAAAC,KAAAy9B,QACI3V,GAAA9nB,KAAI08B,GAAyB,KAEjC7R,GAAA7qB,KAAA,QAAK,CACD+/B,eAAgBp/B,GAAAX,KAAIw9B,IACpBwC,cAAer/B,GAAAX,KAAIy9B,MA3InBz9B,KAAKstB,KAAOA,EACZxF,GAAA9nB,KAAIk/B,EAAiB5R,EAAK2S,yBAC1BnY,GAAA9nB,KAAIi+B,EAAwB3Q,EAAK4S,mBACjCpY,GAAA9nB,KAAI+9B,EAAmBzQ,EAAK6S,gBAC5BvyB,QACIka,GAAA9nB,KAAI28B,EAAgBjH,GAAiB11B,KAAKstB,KAAK1B,IAAIhL,YAEnD,IAAAwf,EAActR,GACZ,MAAArF,OACF9oB,GAAAX,SAAAkB,KAAAlB,MACAu8B,WAAWC,sBAAsBx6B,OAAOhC,MACxCW,GAAAX,KAAIo9B,GAAwB7H,UAC5B6K,KAEJzW,QAAa3pB,KAAKstB,KAAKkB,QAAQ5N,QAAO,IAAQ5gB,KAAKstB,KAAK1B,IAAIhL,cACnD,GAAA5gB,KAAKstB,KAAKkB,QAAQ5N,SAAY5gB,KAAKstB,KAAK1B,IAAIhL,eEtClD2K,WFwCa,KACHvrB,KAAKstB,KAAK1B,IAAIhL,UAEnB2b,WAAWC,sBAAsB97B,IAAIV,KAAMW,GAAAX,KAAIk/B,IAC/CkB,IACAA,EAAcn/B,QAAI47B,EAAAC,GAAJ57B,KAAAlB,QALP,GAOJypB,IAEXG,QACIjpB,GAAAX,KAAIq9B,IAAa9H,UACjBgH,WAAWC,sBAAsBx6B,OAAOhC,MACxCW,GAAAX,KAAIo9B,GAAwB7H,UAC5B50B,GAAAX,QAAAkB,KAAAlB,MACAogC,KAER,cAhDOxP,CAAOtD,GACC,OAAA,IAAAqQ,EAAsBrQ,EACrC,YAgMK0Q,GAAmBv4B,SAClB46B,EAAwB56B,EAAE66B,cAC1BC,EAAiB96B,EAAEmvB,WACrB4L,EAEAA,EADA/6B,aAAag7B,iBACEA,aAAah7B,EAAEiG,KAAMjG,GAG5B,IAAOg7B,aAAa,cAAeh7B,GAG3C,IAAAi7B,GAAc,SAEA,IAAOC,MAAMH,EAAQ,CACnCx/B,IAAG,CAAG4zB,EAAQjR,IACG,kBAATA,EACO0c,EAEE,WAAT1c,EACO4c,EAEE,mBAAT5c,OAEI+c,GAAc,EACuB,mBAA1B9L,EAAO/C,gBACd+C,EAAO/C,kBAIN,qBAATlO,EACO+c,EAEP/c,KAAQiR,EAEDA,EAAOjR,GAGXle,EAAEke,IAIrB,CGlPA4Y,WAAWqE,mBAAXrE,WAAWqE,iBAAgB,IAASjhC,KAsBhCkhC,GAAA,IAAAv+B,uBArBS,IAAAw+B,GAAA,MAAAC,EAMT,WAAAnhC,CAAY0tB,GAFZzC,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,cAgBAD,GAAAC,KAAA6gC,OACW1Y,GAAGnoB,KAAKghC,WAAWzW,cAAe,UAAW5pB,GAAAX,KAAIihC,IAAW,CAAIC,SAAS,gBAEtEz7B,OpBnBI,WoBoBVA,EAAEjF,eAUoBm0B,SACxB2K,EAAS,IAAO/C,WAAWqE,kBAO3BrB,EAAeD,EAAUE,SAAQ,EAAGC,GAAK7e,QAAS8e,MAAqC,UAAjBA,GAA6C,WAAjBA,GACpG,GAAAH,EAAY,OACLA,EAAa,KAAO5K,QACxBiL,GAAkBN,EAAU,GAC5B,OAAAM,IAAmBjL,CAC9B,CAvBqCwM,CAAyBnhC,MAAI,OAEpD,MAAAohC,MAAkBC,cAAc57B,EAAEiG,KAAMjG,GAC9CA,EAAEosB,iBACI,MAAA6N,EAAe1/B,KAAKstB,KAAKgU,sBAAsB1gB,QAChC,UAAjB8e,GAA6C,0BAAjBA,GAEhC1/B,KAAKstB,KAAKiU,gBAAgB3gB,QAAQwgB,KAzBlCphC,KAAKstB,KAAOA,EACZttB,KAAKghC,WAAU,IAAOrW,GAAW3qB,KAAKstB,KAAK1B,KACvC,IAAAwU,EAActR,GAClBnF,GAAK,IAAO2D,EAAKkB,QAAQ5N,QAAU4N,IAC3BA,IACA+N,WAAWqE,iBAAiBlgC,IAAIV,KAAMstB,EAAKgU,uBAC3ClB,EAAcz/B,QAAIkgC,IAAJ3/B,KAAAlB,YAGdogC,IACA7D,WAAWqE,iBAAiB5+B,OAAOhC,QAG/C,cAnBO4wB,CAAOtD,GACC,OAAA,IAAAyT,EAAiBzT,EAChC,GCPG,MAAMkU,GAAN,MAAMA,EAAN,WAAA5hC,GAEHG,GAAAC,KAAAyhC,Y3CkGeC,OACX9gB,EAAU3d,GAAM0K,GAAC+zB,WAEhBphB,CAAAA,KAAY,EACZC,CAAAA,KAAmB,EAChB,WAAAK,aACOA,EACX,aACIA,CAAQngB,GACRoE,GAAA+b,EAAUngB,GAAC,EACf,EAER,C2C9GkBkhC,CAAU,KACxB5hC,GAAAC,KAAA4hC,OAAoBt/B,SACpBvC,GAAAC,KAAA6hC,OAAuBv/B,QAAO,CAC9B,kBAAOw/B,GAIH,OAHK9hC,KAAK20B,WACN30B,KAAK20B,SAAW,IAAI6M,GAEjBxhC,KAAK20B,QAChB,CACA,QAAAoN,CAASC,GACL,MAAMphB,EAAU5gB,KAAKiiC,YACjBrhB,GAAWA,IAAYohB,GACvBphB,EAAQshB,QAGZ,MAAM5Z,EAAgBT,SAASS,cAC3BA,GAAiBA,IAAkBT,SAASsa,MAC5CxhC,GAAAX,KAAK6hC,IAAiBnhC,IAAIshC,EAAO1Z,GAErC3nB,GAAAX,KAAKyhC,IAAY7gB,QAAUjgB,GAAAX,KAAKyhC,IAAY7gB,QAAQnc,OAAQ1D,GAAMA,IAAMihC,GACxErhC,GAAAX,KAAKyhC,IAAY7gB,QAAQiW,QAAQmL,EACrC,CACA,UAAAI,CAAWJ,GACPrhC,GAAAX,KAAKyhC,IAAY7gB,QAAUjgB,GAAAX,KAAKyhC,IAAY7gB,QAAQnc,OAAQ1D,GAAMA,IAAMihC,GACxE,MAAMjoB,EAAO/Z,KAAKiiC,YACdloB,GACAA,EAAKsoB,QAEb,CACA,SAAAJ,GACI,OAAOthC,GAAAX,KAAKyhC,IAAY7gB,QAAQ,EACpC,CACA,cAAA0hB,CAAeN,EAAOpX,GAClBjqB,GAAAX,KAAK4hC,IAAclhC,IAAIshC,EAAOpX,EAClC,CACA,cAAA2X,CAAeP,GACX,OAAOrhC,GAAAX,KAAK4hC,IAAc5gC,IAAIghC,EAClC,CACA,aAAAQ,CAAcR,GACV,OAAOhiC,KAAKiiC,cAAgBD,CAChC,CACA,iBAAAS,CAAkBT,EAAOpX,GACrBjqB,GAAAX,KAAK6hC,IAAiBnhC,IAAIshC,EAAOpX,EACrC,CACA,iBAAA8X,CAAkBV,GACd,OAAOrhC,GAAAX,KAAK6hC,IAAiB7gC,IAAIghC,EACrC,CACA,mBAAAW,CAAoBX,GAChBrhC,GAAAX,KAAK6hC,IAAiB7/B,OAAOggC,EACjC,GAjDAP,GAAA,IAAAn/B,QACAs/B,GAAA,IAAAt/B,QACAu/B,GAAA,IAAAv/B,QAHAuoB,GADS2W,GACF,YADJ,IAAMoB,GAANpB,GCIHqB,GAAA,IAAAvgC,QACAwgC,GAAA,IAAAxgC,qDAFSygC,GAAA,IAAAxgC,QAkBTmrB,GAAQ,WACO,IAAA,MAAA7D,KAAMlpB,QAAIqiC,IACjBnZ,IAEJ/B,GAAA9nB,QAAgB,GACpB,EAoBAijC,GAAoB,WACX,IAAAtiC,YAAe,aAEdk9B,EAAK,IAAOqF,YAAY,6BAA4B,CACtDC,SAAS,EACTC,YAAY,IAEhBziC,GAAAX,SAAWqjC,gBAAgBziB,QAAQid,GAC9BA,EAAM7c,kBACP6M,2BACS,IAAAltB,YAAe,aAEd2iC,EAAgBriC,QAAI8hC,GAAAQ,IAAJriC,KAAAlB,MAClBsjC,GACAA,EAAcE,QACd7iC,GAAAX,SAAcsiC,eAAetiC,KAAMsjC,IAGnC3iC,GAAAX,KAAI8iC,IAAYU,SAIhC,EACAC,GAAqB,iBACX5F,EAAK,IAAOqF,YAAY,8BAA6B,CACvDC,SAAS,EACTC,YAAY,OAEhBziC,GAAAX,SAAW0jC,iBAAiB9iB,UAAUid,IACjCA,EAAM7c,iBAAkB,CAEnB,MAAA2iB,EAAoBhjC,GAAAX,KAAI4jC,IAAUlB,kBAAkB1iC,MACtD,GAAA2jC,GAAqB9b,SAAS4N,SAASkO,OAGnCA,EAAkBH,OACtB,CAAA,MAGI3b,SAASsa,KAAKqB,OAClB,CAER,CACJ,EACAK,GAAoB,eACXljC,GAAAX,KAAI8iC,MAAgBniC,GAAAX,SAAW8jC,KAAKljB,QAAO,aAE1CmjB,EAAYpjC,GAAAX,KAAI8iC,IAChBkB,EAAMD,EAAUrZ,cA8CtB/pB,GAAAX,KAAIgjC,IAAavoB,KAAK0N,GAAG6b,EAAK,UA7CTv+B,OACb9E,QAAIkiC,MAAaliC,YAAc6hC,cAAcxiC,MAAI,aAE/C40B,EAASnvB,EAAEmvB,WACZA,EAAM,OAGP,GADamP,EAAUtO,SAASb,GAGhCj0B,GAAAX,SAAcsiC,eAAetiC,KAAM40B,OAElC,CAEK,MAAAqP,EAActjC,GAAAX,KAAI4jC,IAAUrB,eAAeviC,SAC7CikC,GAAeF,EAAUtO,SAASwO,IPwdpC,SAAqBvhB,EAAM1K,GAE3C,GADAA,EAAUA,GAAW,CAAA,GAChB0K,EACH,MAAM,IAAI7U,MAAM,oBAElB,OAAuD,IAAnDkoB,GAAQ70B,KAAKwhB,EAAM0Z,KAGhBhB,GAAgCpjB,EAAS0K,EAClD,COjesEwhB,CAAYD,GAC9Dx+B,EAAEosB,iBACFoS,EAAYT,YAEX,OAEKF,EAAgBriC,QAAI8hC,GAAAQ,IAAJriC,KAAAlB,MAChBmkC,EAAiBljC,GAAAjB,KAAI+iC,GAAAqB,IAAJljC,KAAAlB,MAAyB,IAC/CsjC,GAAiBa,GAAkBJ,GAAWP,OACnD,CACJ,GAqBgD,CAAIvG,SAAS,IAAS9U,GAAG4b,EAAW,UAnBjEt+B,IACd,IAAA9E,QAAI6sB,IAAO6W,MAAQ1jC,QAAIkiC,KAAsB,QAAVp9B,EAAEjF,IAAa,OAElD,IAAAG,GAAAX,KAAI4jC,IAAUpB,cAAcxiC,MAAI,aAE/BskC,EAAYrjC,QAAI8hC,GAAAwB,IAAJrjC,KAAAlB,SACdskC,EAAUngC,OAAS,EAAC,aAElBqgC,EAAQF,EAAU,GAClBG,EAAOH,EAAUA,EAAUngC,OAAS,GACrCsB,EAAEi/B,UAAYV,EAAI1b,gBAAkBmc,EAIhCh/B,EAAEi/B,UAAYV,EAAI1b,gBAAkBkc,IACzC/+B,EAAEosB,iBACF4S,EAAKjB,UALL/9B,EAAEosB,iBACF2S,EAAMhB,kBAQRmB,EAAQ,IAAOC,iBAAgB,KAC3B,MAAAX,EAActjC,GAAAX,KAAI4jC,IAAUrB,eAAeviC,MAC7C,GAAAikC,IAAgBF,EAAUtO,SAASwO,GAAc,OAE3CX,EAAgBriC,QAAI8hC,GAAAQ,IAAJriC,KAAAlB,MAChBmkC,EAAiBljC,GAAAjB,KAAI+iC,GAAAqB,IAAJljC,KAAAlB,MAAyB,GAC1C6kC,EAAiBvB,GAAiBa,EACpCU,GACAA,EAAerB,QACf7iC,GAAAX,SAAcsiC,eAAetiC,KAAM6kC,IAInCd,EAAUP,OAElB,IAEJmB,EAASG,QAAQf,EAAS,CACtBgB,WAAW,EACXC,SAAS,IAEbrkC,GAAAX,SAAiBya,KAAI,IAAOkqB,EAASM,aACzC,EACAV,GAAa,WACJ,OAAA5jC,GAAAX,UPwXoB+jC,EOtXTpjC,QAAImiC,IP0XxBnM,GAHF3e,GAD0CA,EOtXL,CAC3B0e,kBAAkB,EAClBc,eAAe,KPqXJ,CAAA,GAETA,cACGV,GAA0B,CAACiN,GAAY/rB,EAAQ0e,iBAAkB,CAC5EjyB,OAAQ+2B,GAA+BhP,KAAK,KAAMxU,GAClDsf,SAAS,EACTE,cAAexf,EAAQwf,cACvBE,iBAAkB+D,KAGPhF,GAAcsN,EAAW/rB,EAAQ0e,iBAAkB8E,GAA+BhP,KAAK,KAAMxU,IAErG2jB,GAAahF,IOrYM,GPwXb,IAAkBoN,EAAW/rB,EAEtC2e,COpXF,EACA4M,GAAiB,kBACKtiC,QAAI8hC,GAAAwB,IAAJrjC,KAAAlB,MACD,IAAM,IAC3B,EACAokC,GAAiB,WACR,OAAAzjC,GAAAX,UP2XsB+jC,EOzXVpjC,QAAImiC,KP0X3B9qB,GAD4CA,EOzXN,CAC5B0e,kBAAkB,EAClBc,eAAe,KPwXJ,CAAA,GAETA,cACGV,GAA0B,CAACiN,GAAY/rB,EAAQ0e,iBAAkB,CAC5EjyB,OAAQ22B,GAAgC5O,KAAK,KAAMxU,GACnDsf,SAAS,EACTE,cAAexf,EAAQwf,gBAGZf,GAAcsN,EAAW/rB,EAAQ0e,iBAAkB0E,GAAgC5O,KAAK,KAAMxU,KOrYnF,GP2XZ,IAAmB+rB,EAAW/rB,COrX1C,EApLS,IAAAktB,GAAA,MAAAC,EAMT,WAAAvlC,CAAY0tB,GANHvtB,GAAAC,KAAA+iC,IACThjC,GAAAC,KAAA6iC,IAAU,GACV9iC,GAAAC,KAAA8iC,GAAa,iBACFF,GAAkBd,0BAClB,gBAGPha,GAAA9nB,KAAIwtB,GAASF,EACjB,CACI,UAAA8X,GACO,OAAAzkC,GAAAX,QACX,CACA,KAAAkiC,GACIpa,GAAA9nB,KAAI6iC,IAAW,EACnB,CACA,MAAAR,GACIva,GAAA9nB,KAAI6iC,IAAW,EACnB,CAOA,KAAA7N,CAAM+O,GACEpjC,QAAImiC,KACJ9iC,KAAK+0B,UAETjN,GAAA9nB,KAAI8iC,GAAciB,GAClBpjC,GAAAX,KAAI4jC,IAAU7B,SAAS/hC,MACvBiB,GAAAjB,YAAAkB,KAAAlB,MACAiB,GAAAjB,YAAAkB,KAAAlB,KACJ,CACA,OAAA+0B,GACSp0B,cAELM,GAAAjB,YAAAkB,KAAAlB,MAEAiB,GAAAjB,YAAAkB,KAAAlB,MACAW,GAAAX,KAAI4jC,IAAUxB,WAAWpiC,MACzBW,GAAAX,KAAI4jC,IAAUjB,oBAAoB3iC,MAClC8nB,GAAA9nB,KAAI8iC,GAAc,MACtB,WA2IOuC,CAAI/X,GACH,IAAA0U,EAAQ,YACZrY,QAAa2D,EAAK1B,IAAIhL,QAAO,IAAQ0M,EAAKkB,QAAQ5N,SAAO,EAAKgL,EAAK4C,MAC3D5C,GAAO4C,GACFwT,IACDA,EAAK,IAAOmD,EAAW7X,IAE3B0U,EAAMhN,MAAMpJ,IAEPoW,IACLA,EAAMjN,UACNiN,EAAQ,QAGhBpY,QACIoY,GAAOjN,aAGH,SAAAvO,GAEI,MAAA,CAAAmL,YAER,EAER,GC7MJ4K,WAAW+I,0BAAX/I,WAAW+I,wBAAuB,IAAS3lC,KAOvC4lC,GAAA,IAAAjjC,QANSkjC,GAAA,IAAAjjC,QAwBTu6B,GAAkB,WACP,OAAArX,GAAiB0C,GAAGnoB,KAAKghC,WAAWzW,cAAe,cAAe5pB,GAAAX,KAAIylC,KAAgBtd,GAAGnoB,KAAKghC,WAAWzW,cAAe,YAAa1J,GAAgBlgB,GAAAX,KAAI0lC,IAAsB1lC,KAAKstB,KAAKqY,YAAY/kB,UAChN,iBAkBA8kB,GAAA,IAAApjC,QA5CS,IAAAsjC,GAAA,MAAAC,EAOT,WAAAjmC,CAAY0tB,GAPHvtB,GAAAC,KAAAwlC,IAIT3a,GAAA7qB,KAAA,QACA6qB,GAAA7qB,KAAA,cACAD,GAAAC,KAAAulC,GAAsBzW,eAqBNrpB,IACN,MAAAid,EAAO1iB,KAAKstB,KAAK1B,IAAIhL,QACrBgU,EAASnvB,EAAEmvB,OACZ1K,GAAcxH,IAAUwH,GAAc0K,IAAY50B,KAAKstB,KAAKkB,QAAQ5N,kBAkCzD+T,SACd2K,EAAS,IAAO/C,WAAW+I,6BAC5BhG,EAAUn7B,OAAM,OACV,EACL,MAAA2hC,EAAexG,EAAUta,OAC1B,QAAA8gB,GAEEA,EAAa,KAAOnR,CAC/B,CAnCaoR,CAAe/lC,O3BnBrB,SAAkBgwB,EAAQgD,GAC7B,IAAKhD,IAAWgD,EACZ,OAAO,EACX,IAAK9I,GAAc8F,KAAY9F,GAAc8I,GACzC,OAAO,EACX,MAAMhI,EAAWgI,EAAMlI,gBACvB,GAAIkF,IAAWgD,EACX,OAAO,EACX,GAAIhD,EAAOyF,SAASzC,GAChB,OAAO,EACX,GAAIhI,GAAYX,GAAaW,GAAW,CACpC,IAAIjR,EAAOiZ,EACX,KAAOjZ,GAAM,CACT,GAAIiW,IAAWjW,EACX,OAAO,EAEXA,EAAOA,EAAKyc,YAAczc,EAAKwgB,IACnC,CACJ,CACA,OAAO,CACX,C2BDsC9E,CAAS/S,EAAMkS,KAE7C50B,KAAKstB,KAAK0Y,cAAcplB,QAAQnb,GAC5BA,EAAEub,kBAEN8G,GAAA9nB,KAAIulC,GAQH,SAA6B7iB,EAAMyf,SAClC8D,EAAyBC,GAAc/D,GACvCgE,EAAyBD,GAAcxjB,UAC7C0jB,GAAcjE,EAAM,QACpBiE,GAAc1jB,EAAM,aAEhB0jB,GAAcjE,EAAM8D,GACpBG,GAAc1jB,EAAMyjB,GAE5B,CAjBmCE,CAA6B3jB,EAAM1iB,KAAKghC,WAAWzW,cAAc4X,UAEhGpiC,GAAAC,KAAA0lC,QACI/kC,GAAAX,SAAAkB,KAAAlB,MACA8nB,GAAA9nB,KAAIulC,GAAuBzW,MAtC3B9uB,KAAKstB,KAAOA,EACZttB,KAAKghC,WAAU,IAAOrW,GAAW2C,EAAK1B,KAClC,IAAAwU,EAActR,GAClBnF,GAAK,IAAO3pB,KAAKstB,KAAKkB,QAAQ5N,QAAU0lB,IAChCA,IACA/J,WAAW+I,wBAAwB5kC,IAAIV,KAAMA,KAAKstB,KAAKkB,SACvD4R,IACAA,EAAcn/B,GAAAjB,KAAIwlC,GAAA1I,IAAJ57B,KAAAlB,YAGdogC,IACAz/B,GAAAX,SAAAkB,KAAAlB,MACAu8B,WAAW+I,wBAAwBtjC,OAAOhC,QAGtD,cAtBO4wB,CAAOtD,GACC,OAAA,IAAAuY,EAAwBvY,EACvC,GA8CE,MAAA4Y,GAAiBxjB,GAASA,EAAKd,MAAM2kB,YAAc7jB,EAAKd,MAAM4kB,iBAW3D,SAAAJ,GAAc1jB,EAAM7iB,GACzB6iB,EAAKd,MAAM2kB,WAAa1mC,EACxB6iB,EAAKd,MAAM4kB,iBAAmB3mC,CAClC,CCrEA08B,WAAWkK,gBAAXlK,WAAWkK,cAAkB,CAAE7lB,QAAS,mBCEpC8lB,GAAA,IAAApkC,QACAqkC,GAAA,IAAArkC,uBAHSskC,GAAA,IAAArkC,QAQTskC,GAAQ,WACJ/e,GAAA9nB,KAAI0mC,GAAJ/lC,QAAI+lC,IAAiB,GACjB/lC,GAAAX,KAAI8mC,KAAWnmC,GAAAX,UAAqB,IACpCW,GAAAX,SAAAkB,KAAAlB,SACAW,GAAAX,KAAI2mC,SAAU,GACd7e,GAAA9nB,KAAI8mC,QAAU,GAEtB,ECNE,MAAAC,OAAcnkC,OAChBokC,GAAmB/jC,GAAO,MAC1BgkC,GAAwB,KACxBC,GAAmB,KACnBC,IAAwB,QACtBC,GAAY5mB,GAAO,KACV,IAAA,MAAA3gB,KAASknC,GAAQ7kC,SACpB,GAAArC,SACO,SAER,IASP,IAAAwnC,GAAqB,WACnBC,GAAkB,ID7BX,MAKT,WAAA1nC,CAAY2nC,GALHxnC,GAAAC,KAAA4mC,gBAET7mC,GAAAC,KAAA0mC,GAAe,GACf3mC,GAAAC,KAAA2mC,GAAS1jC,kBAGL6kB,GAAA9nB,KAAIwnC,GAAYD,EACpB,CASA,GAAAvmC,IAAO2kB,GAYI,OAXPmC,GAAA9nB,KAAI0mC,GAAJ/lC,QAAI+lC,IAAiB,QACD,IAAhBxiC,GAAAvD,GAAAX,KAAI2mC,MACJ7e,GAAA9nB,KAAI8mC,GAAOW,GAAA,KACP5iC,GAAAlE,YAAcA,GAAAX,KAAIwnC,IAAJtmC,KAAAlB,QAAiB2lB,IAAI,MAG3C/X,YAEQ3M,GAAAjB,YAAAkB,KAAAlB,QAGDkE,GAAAvD,YACX,GCAsC,KAU7B,SAAA+mC,IACoB,OAArBR,KAEJ93B,OAAOqc,aAAayb,IACpBA,GAAmB,KACvB,CAiCS,SAAAS,IAEoB,UAArBX,KAA8C,IAAjBD,GAAQnmC,MAAeumC,IACpDtiC,GAAAmiC,GAAmBnf,SAASsa,KAAK5L,aAAa,UAAO,EAE7D,QACA5M,GAAK,IAAOyd,GAAUxmB,aACb,IAAAwmB,GAAUxmB,QAAO,OAGtB+mB,IAEAR,IAAwB,EAClB,MAAAS,EAAY3N,iBAAiBpS,SAASsa,MAEtC0F,EAAyBz4B,OAAO04B,WAAajgB,SAAS4W,gBAAgBsJ,YAEtE7b,EADe8b,OAAOlQ,SAAS8P,EAAUK,cAAgB,IAAK,IAExCJ,EADtB3b,EAEM8b,OAAOlQ,SAAS8P,EAAUM,aAAe,IAAK,IAEtDL,EAAyB,IACzBhgB,SAASsa,KAAKvgB,MAAMqmB,aAAY,GAAM/b,MACtCrE,SAASsa,KAAKvgB,MAAMsmB,YAAW,GAAMhc,MACrCrE,SAASsa,KAAKvgB,MAAMumB,YAAY,oBAAmB,GAAKN,OACxDhgB,SAASsa,KAAKvgB,MAAMwmB,SAAW,UAE/Bpb,KAEAia,GAAwB9e,GAAGN,SAAU,YAAcpiB,IAC3CA,EAAEmvB,SAAW/M,SAAS4W,kBAEtBh5B,EAAE4iC,QAAQlkC,OAAS,GAEvBsB,EAAEosB,mBACD,CAAAqP,SAAS,KAUlBpX,QACIjC,SAASsa,KAAKvgB,MAAMyQ,cAAgB,OACpCxK,SAASsa,KAAKvgB,MAAMwmB,SAAW,aAGvCxe,YAEQqd,UAIA,WAAAF,UACOA,EACX,EACAuB,eA1GK,WAGLzgB,SAASsa,KAAKoG,aAAa,QAAOrkC,GAAE8iC,KAAoB,IACxDnf,SAASsa,KAAKvgB,MAAM4mB,eAAe,qBACnCxb,IAASia,OAETpiC,GAAAmiC,GAAmB,KACvB,EAmGIyB,4BA5FK,SAA4Bpd,EAAOzF,GACxC8hB,IACAP,IAAwB,EACxBE,GAAqBtjC,KAAKC,MACpB,MAAA0kC,EAAmBrB,GAyBnBsB,EAAwB,OAAVtd,EAAiB,GAAKA,EAC1C6b,GAAmB93B,OAAOmc,gBAdtB2b,GAAmB,KAEfG,KAAuBqB,IAGtBE,GAAY7B,IAKbI,IAAwB,GAJxBA,IAAwB,EACxBvhB,OAOwC+iB,EACpD,EA8DIjB,uBACAC,gCAGK,MAAAkB,GAMT,WAAAjpC,CAAYkpC,EAAcC,EAAkB,IAAS,MALrDhpC,GAAAC,KAAAgpC,GF3IG,SAAeC,EAAS,QAE3B,OADA1M,WAAWkK,cAAc7lB,UAClB,GAAGqoB,KAAU1M,WAAWkK,cAAc7lB,SACjD,CEwIUsoB,gBAENnpC,GAAAC,KAAAmpC,OAA4B,kBAE5Bte,GAAA7qB,KAAA,UAEI8nB,GAAA9nB,KAAIopC,GAAiBN,GACrBhhB,GAAA9nB,KAAImpC,GAAuBJ,GAC3BjhB,GAAA9nB,KAAIqpC,GAAe/B,GAAmBtmC,OACjCL,cASLA,GAAAX,KAAIqpC,IAAa3B,uBAEjB/mC,GAAAX,KAAIqpC,IAAa1B,6BACjBhnC,GAAAX,KAAIqpC,IAAatC,QAAQrmC,IAAIC,QAAIqoC,IAAMroC,GAAAX,KAAIopC,MAAkB,GAC7DppC,KAAKspC,OAAS9oB,OAAc7f,GAAAX,KAAIqpC,IAAatC,QAAQ/lC,IAAIL,QAAIqoC,OAAS,EAAQvoC,GAAME,YAAiBomC,QAAQrmC,IAAIC,GAAAX,KAAIgpC,IAAMvoC,IAC3HmpB,QAGQ,GAFJjpB,GAAAX,KAAIqpC,IAAatC,QAAQ/kC,OAAOrB,GAAAX,KAAIgpC,KAEhCJ,GAAYjoC,GAAAX,KAAIqpC,IAAatC,SAAO,aAElCgC,EAAqBpoC,QAAIwoC,IAAJjoC,KAAAlB,MAO3BW,GAAAX,SAAiByoC,4BAA4BM,OACzCpoC,GAAAX,KAAIqpC,IAAaf,qBAG7B,WAEKM,GAAYrlC,GACL,IAAA,MAAAk8B,EAAG5/B,KAAU0D,EACjB,GAAA1D,SACO,SAER,CACX,2BC1LO,IAAA0pC,0BAAgB,GAAMR,8BAAqB,MAE7CQ,SACCV,GAAeU,IAAa,IAAQR,SAE1C,CDsIIC,GAAA,IAAA1mC,uBAEA6mC,GAAA,IAAA7mC,0EE3IG2sB,EAAGyD,kBAGRjvB,EAAEX,GAAAC,EAAA,KAAA,GAAA,IAAGgsB,GAASE,IACdua,uBAAa,GAGb5d,gBAAgB,MACb+G,EAAAC,GAAA7vB,EAAA,oFAGE0mC,EAAejX,GAAmB5B,OAAM,CAC7CntB,GAAI+c,GAAO,IAAO/c,KAClBmoB,IAAKpL,GAAO,IACLoL,IACLnrB,GAAOmrB,EAAMnrB,MAIVqyB,SAAuBvM,GAAWoM,EAAW8W,EAAajjB,6FAK9CA,MAAOD,GAAUriB,GAAC4uB,OAAiB2W,EAAalX,+DAEhEntB,EAAG0B,QAAH1B,EAAGsF,IAAA,IAAAA,IAAA,CAAA,IAAK6b,GAAUriB,GAAC4uB,eAAnB1tB,GACoB2tB,GAAA/rB,EAAA,IAAAjE,EAAAmyB,UAAAwU,GAAA,IAAAD,EAAalX,iBADjCntB,QAAAA,uDAJEqkC,EAAa5a,cAAgB2a,QAAU3hC,iBAF5C,oDCpBOonB,EAAGyD,kBAGRjvB,EAAEX,GAAAC,EAAA,KAAA,GAAA,IAAGgsB,GAASE,IAGdrD,gBAAgB,MACb+G,EAAAC,GAAA7vB,EAAA,uEAGE4mC,EAAmB1X,GAAuBrB,OAAM,CACrDntB,GAAI+c,GAAO,IAAO/c,KAClBmoB,IAAKpL,GAAO,IACLoL,IACLnrB,GAAOmrB,EAAMnrB,MAIVqyB,SAAuBvM,GAAWoM,EAAWgX,EAAiBnjB,oDAInDuM,GAAAxsB,EAAA,IAAAxD,EAAAiwB,MAAA,KAAA,CAAAxM,SAAOsM,yBAEvB1tB,EAAGsB,KAAHusB,GAAA7tB,cAAQ0tB,eAAR1tB,+BAAAA,QAAAA,gDALF,2BClBE,IAAAmpB,kBAAiB,GACjBqb,wBAAe9a,IACfyB,gCAAuBzB,IAIxBgB,GAAgBc,OAAM,CACrBX,QAASzP,GAAO,IAAO,UACvB+N,KAAM/N,GAAO,IACN+N,IACL9tB,IACA8tB,EAAO9tB,GACPmpC,IAAanpC,KAGf8vB,qBAAsB/P,GAAO,IAAO+P,+DAEtC,0DClBOtB,EAAGyD,kBAKRjvB,EAAEX,GAAAC,EAAA,KAAA,GAAA,IAAGgsB,GAASE,IACdrD,gBAAgB,MAChBzf,qBAAW,GACRwmB,EAAAC,GAAA7vB,EAAA,kFAGE8mC,EAAavY,GAAiBV,OAAM,CACzCX,QAASzP,GAAO,IAAO,SACvB/c,GAAI+c,GAAO,IAAO/c,KAClBmoB,IAAKpL,GAAO,IACLoL,IACLnrB,GAAOmrB,EAAMnrB,IAEf0L,SAAUqU,GAAO,IAAOvE,QAAQ9P,QAG3B2mB,SAAuBvM,GAAWoM,EAAWkX,EAAWrjB,oDAI7CuM,GAAAxsB,EAAA,IAAAxD,EAAAiwB,MAAA,KAAA,CAAAxM,SAAOsM,yBAEvB1rB,EAAMV,KAANusB,GAAA7rB,cAAW0rB,eAAX1rB,+BAAAA,QAAAA,gDALF,6ECjBO6nB,EAAGyD,kBAGRjvB,EAAEX,GAAAC,EAAA,KAAA,GAAA,IAAGgsB,GAASE,IAGdrD,gBAAgB,MAChB4d,uBAAa,GACb9F,4BAAmB5U,IACnBuU,2BAAkBvU,IAClByS,2BAAkBzS,IAClBoR,6BAAoBpR,IACpBgb,sBAAY,GACZP,0BAAgB,GAChBR,8BAAqB,MAClBpW,EAAAC,GAAA7vB,EAAA,gNAGEgnC,EAAe5X,GAAmBvB,OAAM,CAC7CntB,GAAI+c,GAAO,IAAO/c,KAClBmoB,IAAKpL,GAAO,IACLoL,IACLnrB,GAAOmrB,EAAMnrB,MAIVqyB,SAAuBvM,GAAWoM,EAAWoX,EAAavjB,wCAYrDwjB,EAAU,CAAAtiC,EAAAuiC,KAAU,IAAAC,YAAP1jB,8BC1CvB,IAAA8a,iCAAwB,SACxBC,2BAAkBzS,IAMnBgS,GAAiBlQ,OAAM,CACtB0Q,sBAAuB9gB,GAAO,IAAO8gB,KACrCC,gBAAiB/gB,GAAO,IAAO+gB,KAC/B/S,QAAShO,GAAO,IAAAzd,EAAAyrB,SAChB5C,IAAG7oB,EAAA6oB,8DAEL,CD8BIue,CAAAziC,EAAA0iC,GAAA,IAAAlmC,GACI4uB,GAAW,eACN,OAAAiX,EAAa1kC,KAAKioB,KAAKiB,KAAK3N,0BAChCmpB,EAAazc,KAAK1B,KACL2V,gBAAA97B,IACjB87B,IAAgB97B,GACZA,EAAEub,kBACN+oB,EAAa1kC,KAAK+qB,wDElDrB,IAAA6P,mCAA0B,SAC1BC,6BAAoBpR,IACpBqR,0BAAiBrR,IAIjBqP,6BAAqB,SAIhBkM,EAAwB3M,GAAsB9M,OAAM,CACzDntB,GAAI+c,GAAO,IAAAzd,EAAAU,IACXw8B,wBAAyBzf,GAAO,IAAOyf,KACvCC,kBAAmB1f,GAAO,IAAO0f,KACjC1R,QAAShO,GAAO,IAAAzd,EAAAyrB,SAChB2R,eAAgB3f,GAAO,IAAO2f,KAC9BhC,aAAc3d,GAAO,IAAO2d,KAC5BvS,IAAG7oB,EAAA6oB,uDAIiBpF,MAAO6jB,EAAsB7jB,qBAFnD,CFkCK8jB,CAAA5iC,EAAA0iC,GAAA,IAAAlmC,GACI4uB,GAAW,kBACViX,EAAazc,KAAK1B,mBACd,OAAAme,EAAa1kC,KAAKioB,KAAKiB,KAAK3N,SACjBsf,kBAAAz6B,IACnBy6B,IAAkBz6B,GACdA,EAAEub,kBACN+oB,EAAa1kC,KAAK+qB,wDG5DtB,IAAAma,yCAA+B,GAC/BvE,yBAAgBlX,IAChB6W,uBAAc7W,IAOf8W,GAAwBhV,OAAM,CAC7BntB,GAAI+c,GAAO,IAAAzd,EAAAU,IACXuiC,cAAexlB,GAAO,IAAOwlB,KAC7BL,YAAanlB,GAAO,IAAOmlB,KAC3BnX,QAAShO,GAAO,IAAAzd,EAAAyrB,SAAkB+b,KAClC3e,IAAG7oB,EAAA6oB,8DAEL,CH+CM4e,CAAA9iC,EAAA0iC,GAAA,IAAAlmC,GACI4uB,GAAW,kBACViX,EAAazc,KAAK1B,mBACd,OAAAme,EAAa1kC,KAAKioB,KAAKiB,KAAK3N,4EAIlC6pB,GAAU/iC,EAAA,4BAAE6hC,qCAAgBR,iBADzBgB,EAAa1kC,KAAKioB,KAAKiB,KAAK3N,WAAO7Z,mCAIvCyf,MAAOD,GAAUriB,GAAC4uB,GAAaoX,QAC5BH,EAAaxX,8EAGhBkY,GAAUC,EAAA,4BAAEnB,WACZnkC,EAAG6C,GAAAyiC,EAAA,GAAHzX,GAAA7tB,EAAGsF,IAAA,IAAAA,IAAA,CAAA,IAAK6b,GAAUriB,GAAC4uB,GAAaoX,gBAAhC9kC,+BAAAA,wJI9EN,IAAAopB,oBAAU,GACVsb,sBAAY,GACZzF,iBAAO,GACPX,4BAAmB5U,IACnBuU,2BAAkBvU,UAKb6b,EAAkBzF,GAAWG,IAAG,CACrC7W,QAAShO,GAAO,IAAOgO,KACvBsV,KAAMtjB,GAAO,IAAOspB,KACpBzF,KAAMA,IACNX,iBAAkBljB,GAAO,IAAOkjB,KAChCL,gBAAiB7iB,GAAO,IAAO6iB,KAC/BzX,IAAG7oB,EAAA6oB,yDAImBpF,MAAOmkB,EAAgBnkB,qBAF/C,CJiBE0e,CAAAx9B,EAAA,kBACKqiC,EAAazc,KAAK1B,oCAEtBke,mBACQ,OAAAC,EAAa1kC,KAAKioB,KAAKiB,KAAK3N,sCACpCyiB,mCACAK,KAESsG,mDATPD,EAAalb,cAAgB2a,QAAU7hC,iBAF5C,gJK5BS,IAAAijC,sBAAY,GAChBC,EAAAjY,GAAA7vB,EAAA,CAAA,UAAA,WAAA,WAAA,WAAA,yBCLA,IAAA8nC,EAAAjY,GAAA7vB,EAAA,CAAA,UAAA,WAAA,WAAA,oDAIJ+nC,WACID,EAAI,kKAHT,CDOCE,CAAYrjC,EAAA,6DERJ,IAAAkjC,sBAAY,GAChBC,EAAAjY,GAAA7vB,EAAA,CAAA,UAAA,WAAA,WAAA,8BAKG,IAAA2H,EAAArH,GAAA,IAAA2nC,GACN,uDACA,0HACAJ,0BAJDK,EAAgBvjC,EAAA0iC,mCAMZS,kBARL,CFMEK,CAAaxoB,EAAA,gCAENsoB,GACN,8fACAJ,0BAHDO,EAAgBzjC,EAAA0iC,mCAKZS,4JAKHO,EAAgB1jC,EAAA,kUGxBf,IAAA9G,gBAAO,IACPyqC,iBAAQ,gBACRC,uBAAc,GACPV,iBAAY,IAChBC,EAAAjY,GAAA7vB,EAAA,8EAICwoC,EAA4C,CAC/C,CAAA,OAAM,CAAIC,GAAI,KAAMC,GAAI,IAAKC,GAAI,IAAKC,GAAI,OAC1C,CAAA,OAAM,CAAIH,GAAI,IAAKC,GAAI,IAAKC,GAAI,KAAMC,GAAI,QAI9C,IAAAC,EAAAvmC,KAAA4tB,GAAA2Y,EAAA,KAAA,0CAEQhrC,WACCA,2CAGAyqC,mBACMC,qFAGiBV,SAC3BC,KAXLvkC,GAAAslC,EAAA,GAAA,IAaQL,EAAQxgC,GAAA,CAAArD,EAAAmkC,mDAAS,IAAA3nC,GAAA4nC,GAAA,IACG,EAAA,CAAAC,EAAArkC,mBADIxD,GAAA4nC,GAAA,kBAbhCtkC,GAAAokC,GAAAnkC,GAAAC,EAAAkkC,EAFD,CHeII,OAAC,CAAAC,MAAA,2HAjBL,syFIGW,SAAA5+B,EAAYC,EAAgBC,GACnCC,QAAQF,MAAK,IAAKC,KAAYD,EAChC,UAGM,IAAAmhB,mBAAS,GAAOyd,EAAOppC,GAAAC,EAAA,UAAA,EAAA,QAAaopC,EAAiBrpC,GAAAC,EAAA,oBAAA,EAAA,QAGvDqpC,EAAenpC,IAAO,GACtBqK,EAAQrK,GAAsB,MAC9BopC,EAAiBppC,GAAsB,MACvCkK,EAAWlK,IAAO,GAGlBqpC,EAAerpC,GAAM0K,GAAA,CAavBpC,MAAO,GACP/B,YAAa,GACbkC,KAAM,GACN5H,WAAY,GACZ2V,SAAU,GACV5V,aAAc,GACd8a,YAAa,GACbzF,MAAO,GACPsF,iBAAiB,EACjBI,mBAAmB,EACnBH,eAAe,KAIb8tB,EAAkBlpC,GAAA,IAAkC,eAAlCa,GAAYooC,GAAa5gC,MAC3C8gC,EAAenpC,GAAA,IAAkC,YAAlCa,GAAYooC,GAAa5gC,MACxC+gC,EAAappC,GAAA,IAAkC,UAAlCa,GAAYooC,GAAa5gC,MACtCghC,EAAarpC,GAAA,IAAY4L,GAAE,qCAAuC,mBAClE09B,EAAetpC,GAAA,IAAY4L,GAAE,gCAAkC,iBAqB1D,SAAA29B,OAjBPN,GACE/gC,MAAO,GACP/B,YAAa,GACbkC,KAAM,GACN5H,WAAY,GACZ2V,SAAU,GACV5V,aAAc,GACd8a,YAAa,GACbzF,MAAO,GACPsF,iBAAiB,EACjBI,mBAAmB,EACnBH,eAAe,OAEjB5Z,GAAAyI,EAAQ,MACRzI,GAAAwnC,EAAiB,MAKjBH,KACF,CA8KS,SAAAW,IACC,MAAA,CAAA,KAAM,KAAM,KAAM,KAAM,KAClC,CAES,SAAAC,WAEL,YAAa,UAAW,SAAU,OAAQ,SAAU,UAAW,aAC/D,WAAY,OAAQ,SAAU,YAAa,aAAc,OAAQ,UACjE,cAAe,SAAU,UAAW,UAAW,mBAEnD,CAES,SAAAC,WACC,OAAQ,OAAQ,YAAa,SAAU,UAAW,cAAe,cAAe,SAC1F,CAES,SAAAC,IACC,MAAA,CAAA,aAAc,UAAW,QAAS,eAAgB,UAC5D,yBC9QA,IAAAze,kBAAiB,GACdsc,EAAAjY,GAAA7vB,EAAA,CAAA,UAAA,WAAA,WAAA,WAAA,gDAIJkqC,WAEIpC,EAAI,SADRtc,uBAAAA,CAAK2e,+KAHN,CD8QCC,CAAMzlC,EAAA,mBAAO+mB,KAAuBmb,aAAArb,IAC/B,IACGA,GAAMqe,GACb,OAAS9+B,GACPT,EAAYS,EAAK,0CACjBjJ,GAAAsI,GAAW,EACb,oBAECigC,GAAa1lC,EAAA,4FErRP,IAAAkjC,sBAAY,GAChBC,EAAAjY,GAAA7vB,EAAA,CAAA,UAAA,WAAA,WAAA,WAAA,UAIJ,IAAAqC,EAAAC,KAAA4tB,GAAA7tB,EAAAsF,IAAA,CAAAuhC,MAAAvhC,KAEImgC,IAAI,KADDG,GAAG,qDAAsDJ,OADhE,IAAAloB,EAAAnd,GAAAH,sFAAAoC,GAAApC,GAAAqC,GAAAC,EAAAtC,OAFD,CFmRKioC,CAAY3qB,EAAA,6DGzRR,IAAAkoB,sBAAY,GAChBC,EAAAjY,GAAA7vB,EAAA,CAAA,UAAA,WAAA,WAAA,WAAA,2CAKGioC,GAAG,oDAAqDJ,0BAD/D0C,EAAgB5lC,EAAA0iC,mCAEZS,yKAJL,CHuRO0C,CAAWhnC,EAAA,kCAAE8D,GAAAK,GAAA/D,GAAA6E,EAAAd,GAAA,CAAA,IAAAuE,GAAE,mFI1Rb,IAAA27B,sBAAY,GAChBC,EAAAjY,GAAA7vB,EAAA,CAAA,UAAA,WAAA,WAAA,WAAA,2CAKGioC,GAAG,gCAAiCJ,0BAD3C4C,EAAgB9lC,EAAA0iC,mCAEZS,yKAJL,CJwRO4C,SAAiB,kCACfpjC,GAAAK,GAAA/D,GAAA+mC,EAAAhjC,GAAA,CAAA,IAAAuE,GAAE,sGAIN7J,EAAG6C,GAAAya,EAAA,QAAHtd,aAEIE,EAAG+B,UAAH/B,GAEE8B,EAAAa,GAAA0D,GAAAvE,EAECE,QAAO,KACD,IACFzC,GAAAyI,EAAQ,MACRzI,GAAAsI,GAAW,EACb,OAASW,GACPT,EAAYS,EAAK,8BACnB,GARH,IAAAlC,EAAArG,GAAA6B,GAAA,GAAAI,GAAAJ,MAFF9B,wBACKgI,IAAK,gBAYN,CAAA,IAAA2B,GAAE,2BAbN3J,gBADE6H,IAAQvF,EAAAb,6BAoBVrB,EAAGkD,UAAHlD,MAAAA,uBACI2mC,IAAc,YADlB3mC,gBADE2mC,IAAczkC,EAAAC,SAMlBlC,EAAGsC,GAAAyiC,EAAA,GACD5kC,KADFH,QACEG,GAAE,MAAFA,GAEA,IAAAF,KAFAE,EAAE,GAGA+C,KADFjD,QACEiD,GAAK,MAALA,GACA,IAAAC,EAAAb,GADAY,EAAK,GACLE,GAAAD,MAFFlD,GAUA,IAAAC,KAVAD,EAAG,GAWD+nC,KADF9nC,QACE8nC,GAAK,MAALA,GACA,IAAAC,EAAA3lC,GADA0lC,EAAK,GACLE,GAAAD,MAFF/nC,MAbFF,GAwBA,IAAAK,KAxBAL,EAAG,GAyBD4C,KADFvC,QACEuC,GAAE,MAAFA,GAEA,IAAAtC,KAFAsC,EAAE,GAGArC,KADFD,GAEI6nC,KADF5nC,QACE4nC,GAAK,MAALA,GACA,IAAAC,KADAD,EAAK,GAEHtZ,KADFuZ,QACEvZ,GAAM,MAANA,GAAAA,QAAAA,EAAMwZ,QAAA,YAANxZ,GACMluB,GAAA2nC,EAAA,GAAAjB,QAAoBthC,SACxBwiC,EAAM9jC,UAAN8jC,GAAM,MAANA,qCAAcxiC,MAAdwiC,EAAMruC,OAANquC,EAAMF,QAAA9pC,GAAQwH,KAAI,KAAG,CAAA,aA5JTA,SACc,CACrCpI,WAAc2L,GAAE,2BAChB1C,QAAW0C,GAAE,wBACbpC,MAASoC,GAAE,sBACXzC,aAAgByC,GAAE,6BAClBxC,QAAWwC,GAAE,wBACbvC,UAAauC,GAAE,0BACftC,QAAWsC,GAAE,wBACbrC,QAAWqC,GAAE,wBACbnC,WAAcmC,GAAE,4BAEDvD,IAASA,CAC5B,CA+IoCyiC,IAAkBziC,WAAvCwiC,QAHJH,MAFF7nC,GAUA,IAAAE,KAVAF,EAAG,GAWDkoC,KADFhoC,QACEgoC,GAAK,MAALA,GACA,IAAAC,KADAD,EAAK,GAEHE,KADFD,QACEC,GAAM,MAANA,GAAAA,QAAAA,EAAMN,QAAA,aAANM,GACMhoC,GAAAioC,GAAA,GAAA1B,QAAyBlzB,SAC7B60B,EAAM/jC,UAAN+jC,GAAM,MAANA,4BAAsB70B,cAARA,MAAd60B,EAAM3uC,OAAN2uC,EAAMR,QAAA9pC,GAAQyV,KAAK,WAAnB60B,QAHJH,MAFFjoC,MAXFH,aAAAA,EAAG,cAuBDI,EAAG6E,KACDnD,KADF1B,GAEIooC,KADF1mC,QACE0mC,GAAK,MAALA,GACA,IAAAC,KADAD,EAAK,GAEHE,KADFD,QACEC,GAAM,MAANA,GAAAA,QAAAA,EAAMX,QAAA,YAANW,GACMroC,GAAAsoC,EAAA,GAAA9B,QAA6BrzB,SACjCo1B,EAAM3+B,UAAN2+B,GAAM,MAANA,qCAAcp1B,MAAdo1B,EAAMhvC,OAANgvC,EAAMb,QAAA9pC,GAAQuV,KAAQ,KAAG,CAAA,aApKVA,SACY,CACxCiB,UAAazL,GAAE,mCACf0L,QAAW1L,GAAE,iCACb2L,OAAU3L,GAAE,gCACZ4L,KAAQ5L,GAAE,8BACV6L,OAAU7L,GAAE,gCACZ8L,QAAW9L,GAAE,iCACbkzB,KAAQlzB,GAAE,oCACV+L,SAAY/L,GAAE,kCACd6/B,MAAS7/B,GAAE,oCACXiM,OAAUjM,GAAE,gCACZkM,UAAalM,GAAE,wCACfmM,WAAcnM,GAAE,oCAChBoM,KAAQpM,GAAE,mCACVqM,QAAWrM,GAAE,iCACbsM,YAAetM,GAAE,qCACjBuM,OAAUvM,GAAE,gCACZ1C,QAAW0C,GAAE,iCACbrC,QAAWqC,GAAE,iCACb8/B,eAAkB9/B,GAAE,wCACpB+/B,cAAiB//B,GAAE,wCAGDwK,IAAaA,CACnC,CA2I0CQ,IAAuBR,WAAhDo1B,QAHJH,MAFF3mC,GAUA,IAAAI,KAVAJ,EAAG,GAWDknC,KADF9mC,QACE8mC,GAAK,MAALA,GACA,IAAAC,KADAD,EAAK,GAEHE,KADFD,QACEC,GAAM,MAANA,GAAAA,QAAAA,EAAMnB,QAAA,YAANmB,GACM7oC,GAAA8oC,EAAA,GAAArC,QAAsBlpC,SAC1BwrC,EAAMh/B,UAANg/B,GAAM,MAANA,qCAAcxrC,MAAdwrC,EAAMxvC,OAANwvC,EAAMrB,QAAA9pC,GAAQL,KAAY,KAAG,CAAA,aAnJVA,SACQ,CACxC+M,KAAQ3B,GAAE,oCACV4B,KAAQ5B,GAAE,oCACV6B,UAAa7B,GAAE,yCACf8B,OAAU9B,GAAE,sCACZwM,QAAWxM,GAAE,uCACb+B,YAAe/B,GAAE,2CACjBgC,YAAehC,GAAE,2CACjByM,aAAgBzM,GAAE,4CAClB0M,QAAW1M,GAAE,uCACb2M,OAAU3M,GAAE,sCACZ4M,OAAU5M,GAAE,uCAGMpL,IAAiBA,CACvC,CAmI8CyW,IAA2BzW,WAAxDwrC,QAHJH,MAFF/mC,MAXF9B,oDAEiC,IAAA4I,GAAE,6BAEZ,IAAAA,GAAE,iCAQc,IAAAA,GAAE,mCAElB,IAAAA,GAAE,yCAXrBqgC,GAAAZ,SAAwCpC,GAAa7yB,SAAQyzB,GAAAhpC,GAArBooC,GAAa7yB,SAAQyzB,GAU7DoC,GAAAJ,SAA8C5C,GAAazoC,aAAYqpC,GAAAhpC,GAAzBooC,GAAazoC,aAAYqpC,QAb3E7mC,eADEnC,GAAAqoC,OAAsBE,OAAa9kC,iCAyBrCS,EAAGoI,KACD++B,KADFnnC,QACEmnC,GAAK,MAALA,GACA,IAAAC,EAAAvnC,GADAsnC,EAAK,GACLxmC,GAAAymC,MAFFpnC,sBAEE0D,GAAA0jC,EAAA,cAAAj7B,KADiC,IAAAtF,GAAE,oCAKrB,IAAAA,GAAE,kDAJhBwgC,GAAAD,EAAA,IAAAtrC,GAGaooC,GAAa3tB,YAAWuuB,GAAAhpC,GAAxBooC,GAAa3tB,YAAWuuB,QALvC9kC,iBADEokC,IAAe5kC,EAAA2C,UAYnBjC,GAAGL,GAAAynC,GAAA,GACDC,MADFrnC,UACEqnC,IAAK,MAALA,IACA,IAAAC,MADAD,GAAK,GAEHE,MADFD,UACEC,OAAAA,IAAAA,SAAAA,GAAM7B,QAAA,IACN,IAAA8B,MADAD,UACAC,OAAAA,IAAAA,SAAAA,GAAM9B,QAAA,IACN,IAAA+B,MADAD,UACAC,OAAAA,IAAAA,SAAAA,GAAM/B,QAAA,KACN,IAAAgC,MADAD,UACAC,OAAAA,IAAAA,SAAAA,GAAMhC,QAAA,KACN,IAAAiC,MADAD,UACAC,OAAAA,IAAAA,SAAAA,GAAMjC,QAAA,QALR4B,OAFFtnC,OA7DFtC,GAyEA,IAAAwC,MAzEAxC,EAAG,GA0ED8J,MADFtH,UACEsH,IAAE,MAAFA,IAEA,IAAArG,MAFAqG,GAAE,GAGAnG,MADFF,IAEIymC,MADFvmC,IAEIwmC,MADFD,OACEC,cAAAA,OADFD,OADFvmC,cAAAA,GAAG,cAQDI,EAAG0G,KACD2/B,KADFrmC,GAEIsmC,KADFD,MACEC,YAAAA,MADFD,MADFrmC,GAGIM,GAAAK,GAAA/D,GAAA2pC,EAAA,IAAA5lC,GAAA,MAAA,CAAA,IAAAuE,GAAE,kDADFshC,GAAAF,SAAoC/D,GAAa1tB,kBAAiBsuB,GAAAhpC,GAA9BooC,GAAa1tB,kBAAiBsuB,QAFtEnjC,iBADEyiC,IAAe5kC,EAAAiD,iCAUjBb,EAAG0G,KACD8/B,KADFxmC,GAEIymC,KADFD,MACEC,YAAAA,MADFD,MADFxmC,GAGIK,GAAAK,GAAA/D,GAAA+pC,EAAA,IAAAhmC,GAAA,MAAA,CAAA,IAAAuE,GAAE,6CADFshC,GAAAE,SAAoCnE,GAAa7tB,cAAayuB,GAAAhpC,GAA1BooC,GAAa7tB,cAAayuB,QAFlEljC,eADE9F,GAAAqoC,OAAsBE,OAAax8B,SAjBzCxG,OAHFjB,OA3HFpD,0BK7RI,IAAAwlC,sBAAY,GAChBC,EAAAjY,GAAA7vB,EAAA,CAAA,UAAA,WAAA,WAAA,WAAA,UAIJ,IAAAqC,EAAAC,KAAA4tB,GAAA7tB,EAAAsF,IAAA,CAAAuhC,MAAAvhC,KAEImgC,IAAI,KADDG,GAAG,gEAAiEJ,OAD3E,IAAAloB,EAAAnd,GAAAH,sFAAAoC,GAAApC,GAAAqC,GAAAC,EAAAtC,OAFD,CLqbKurC,IA3JAvrC,EAAG,GA2JS,qCACVwrC,GAAAC,EAAA,6CAIgBpf,QAAA,KACT,IACFmb,GACF,OAAS9+B,GACPT,EAAYS,EAAK,yBACjBjJ,GAAAsI,GAAW,EACb,4BAEQi/B,qCAET/hC,GAAAK,GAAA/D,GAAAmqC,EAAApmC,GAAA,CAAA,IAAAuE,GAAE,iEAEJ2hC,GAAAG,EAAA,2CAIgBtf,QAAA,KACT,KA9XGuf,iBACT,OACFnsC,GAAAunC,GAAe,GACfvnC,GAAAyI,EAAQ,MACRzI,GAAAwnC,EAAiB,MACjBxnC,GAAAsI,GAAW,OAGNm/B,GAAa5gC,MAAqC,iBAAjCxH,GAAWooC,GAAa5gC,eAClCmC,MAAMoB,GAAE,4DAGfq9B,GAAaxoC,YAAiD,iBAAvCI,GAAWooC,GAAaxoC,qBACxC+J,MAAMoB,GAAE,wDAIhBgP,EAEA,GAAA/Z,GAAAqoC,GAAoB,OAEhBn3B,EAAUlR,GAAGooC,GAAa7yB,aAAY6yB,GAAa7yB,eAAY,EACrEwE,QAAwBL,GAAsBS,uBAC5CjJ,GAAU,GAAAlR,GACVooC,GAAaxoC,WAAU,CAErB0a,gBAAeta,GAAEooC,GAAa9tB,gBAC9BC,cAAava,GAAEooC,GAAa7tB,eAGlC,MAAA,GAAAva,GACSsoC,GAEPvuB,QAAwBL,GAAsBc,sBAAqBxa,GACjEooC,GAAa3tB,aAAe,QAAOza,GACnCooC,GAAaxoC,WAAU,CAErB0a,gBAAeta,GAAEooC,GAAa9tB,gBAC9BI,kBAAiB1a,GAAEooC,GAAa1tB,yBAGtC,GAAA1a,GACSuoC,GAAe,CAEhB,MAAAhzB,EAAQvV,GAAGooC,GAAa7yB,UAAY,mBAC1CwE,QAAwBL,GAAsBiB,oBAC5CpF,EAAQvV,GACRooC,GAAaxoC,WAAU,CAErB0a,gBAAeta,GAAEooC,GAAa9tB,gBAC9BC,cAAava,GAAEooC,GAAa7tB,eAGlC,KACK,OAEGX,EAAM,CACVpS,KAAIxH,GAAEooC,GAAa5gC,KACnB5H,WAAUI,GAAEooC,GAAaxoC,WACzBiV,SAAQ,CACN3D,WAAUlR,GAAEooC,GAAa7yB,UAAkD,kBAA1CvV,GAAKooC,GAAa7yB,SAAuC,CAAAvV,GAAIooC,GAAa7yB,UAAQ,MAC/GvV,GAAAooC,GAAazoC,cAAiBA,aAAYK,GAAEooC,GAAazoC,iBAC7D8a,YAAWza,GAAEooC,GAAa3tB,YAC1BzF,MAAKhV,GAAEooC,GAAapzB,OAEtBoF,OAAQ,aACRpQ,SAAQ,CACNsQ,gBAAeta,GAAEooC,GAAa9tB,gBAC9BI,kBAAiB1a,GAAEooC,GAAa1tB,kBAChCH,cAAava,GAAEooC,GAAa7tB,gBAIhCR,QAAwBL,GAAsBC,sBAAsBC,EACtE,IAGIwuB,GAAa/gC,QACf0S,EAAgB1S,MAAKrH,GAAGooC,GAAa/gC,UAGnC+gC,GAAa9iC,cACfyU,EAAgBzU,YAAWtF,GAAGooC,GAAa9iC,aAI7C2iC,IAAkBluB,MAGlBouB,EAAiBp9B,GAAE,qCAAkC,GAGrDsc,WAAiB,KACfqhB,KACC,IAEL,OAAS9+B,SACPT,EAAYS,EAAK,gCACjBR,EAAQQ,aAAeD,MAAQC,EAAIC,QAAUkB,GAAE,iDAC/CpK,GAAAsI,GAAW,GAGLW,CACR,CAAA,QACEjJ,GAAAunC,GAAe,EACjB,CACF,CAqRUjuB,EACF,OAASrQ,GAET,4BAEQs+B,oDAELA,GAAYloC,GAAGyoC,GAAezoC,GAAGwoC,gIA1JnC5gC,GAAAhD,EAAA,cAAAiD,WAUAD,GAAA8hC,EAAA,cAAAp6B,yLAdE,IAAAvE,GAAE,sCAGsB,IAAAA,GAAE,iCAKd,IAAAA,GAAE,6CAKgB,IAAAA,GAAE,gCAIpB,IAAAA,GAAE,4CAOd,IAAAA,GAAE,sCAIuB,IAAAA,GAAE,yCAER,IAAAA,GAAE,uCAQU,IAAAA,GAAE,8CAEd,IAAAA,GAAE,sCA6CG,IAAAA,GAAE,oCAEN,IAAAA,GAAE,0BACF,IAAAA,GAAE,0BACS,IAAAA,GAAE,0BACX,IAAAA,GAAE,0BACF,IAAAA,GAAE,0BAMxB,IAAAA,GAAE,4BAMA,IAAAA,GAAE,iDAnGNwgC,GAAA3mC,EAAA,IAAA5E,GAGaooC,GAAa/gC,MAAK2hC,GAAAhpC,GAAlBooC,GAAa/gC,MAAK2hC,GAO/BuC,GAAA7B,EAAA,IAAA1pC,GAEaooC,GAAa9iC,YAAW0jC,GAAAhpC,GAAxBooC,GAAa9iC,YAAW0jC,GAanCoC,GAAAvB,SAAoCzB,GAAa5gC,KAAIwhC,GAAAhpC,GAAjBooC,GAAa5gC,KAAIwhC,GAUrDoC,GAAAjB,SAA0C/B,GAAaxoC,WAAUopC,GAAAhpC,GAAvBooC,GAAaxoC,WAAUopC,GA+CnEoC,GAAAM,UAAqCtD,GAAapzB,MAAKg0B,GAAAhpC,GAAlBooC,GAAapzB,MAAKg0B,GAgBnDqD,GAAAJ,UAAoC7D,GAAa9tB,gBAAe0uB,GAAAhpC,GAA5BooC,GAAa9tB,gBAAe0uB,+DAnJ/E,01DMlQM,IAAAh2B,EAAUjU,GAAM0K,GAAA,KAChBsjC,EAAYhuC,IAAO,GACnBqK,EAAQrK,GAAsB,MAC9BiuC,EAAqBjuC,GAAiC,OACtDkuC,EAAeluC,GAAe,OAC9BmuC,EAA4BnuC,IAAO,GACnCouC,EAAsBpuC,GAAsB,YAE1CquC,EAAU,CACdC,GAAE,CACAjuC,WAAY,YACZiJ,QAAS,YACTC,aAAc,eACdC,QAAS,QACTC,UAAW,QACXC,QAAS,YACTC,QAAS,SACTC,MAAO,YAET2kC,GAAE,CACAluC,WAAY,SACZiJ,QAAS,YACTC,aAAc,WACdC,QAAS,SACTC,UAAW,UACXC,QAAS,SACTC,QAAS,UACTC,MAAO,YAIL4kC,EAAc,CAClBF,GAAE,CACA72B,UAAW,cACXC,QAAS,SACTC,OAAQ,UACRC,KAAM,QACNC,OAAQ,SACRC,QAAS,QACT,aAAc,cACdC,SAAU,WACVC,KAAM,UACNC,OAAQ,QACRC,UAAW,UACXC,WAAY,cACZC,KAAM,OACNC,QAAS,SACTC,YAAa,SACbC,OAAQ,OACRjP,QAAS,YACTK,QAAS,SACT,mBAAoB,kBAEtB4kC,GAAE,CACA92B,UAAW,WACXC,QAAS,QACTC,OAAQ,YACRC,KAAM,QACNC,OAAQ,UACRC,QAAS,UACT,aAAc,kBACdC,SAAU,UACVC,KAAM,MACNC,OAAQ,UACRC,UAAW,YACXC,WAAY,aACZC,KAAM,QACNC,QAAS,UACTC,YAAa,WACbC,OAAQ,QACRjP,QAAS,YACTK,QAAS,UACT,mBAAoB,yBAIlB8kC,EAAkB,CACtBH,GAAE,CACA3gC,KAAM,QACNC,KAAM,SACNC,UAAW,YACXC,OAAQ,YACR0K,QAAS,WACTzK,YAAa,gBACbC,YAAa,gBACbyK,aAAc,iBACdC,QAAS,UACTC,OAAQ,aACRC,OAAQ,iBAEV21B,GAAE,CACA5gC,KAAM,gBACNC,KAAM,UACNC,UAAW,eACXC,OAAQ,UACR0K,QAAS,cACTzK,YAAa,WACbC,YAAa,QACbyK,aAAc,aACdC,QAAS,UACTC,OAAQ,aACRC,OAAQ,WAIN81B,EAAEtuC,GAAA,IAAsC,UAA1B4J,GAASC,cAEvB3B,MAAO,YACPqmC,SAAU,0DACVC,oBAAqB,iCACrBC,aAAc,sBACdC,kBAAmB,+BACnBC,QAAS,8BACT1kC,MAAO,6CACP2kC,MAAO,mBACPC,WAAY,4BACZC,iBAAkB,6CAClBC,gBAAiB,SACjBC,UAAW,MACXC,UAAW,eACXC,SAAU,aACVC,cAAe,8BACfC,gBAAiBC,EAAeC,IAAa,SAAcD,SAAaC,cACxEC,aAAc,sBACdC,cAAe,kCACfC,gBAAiB,kBACjBC,eAAgB,YAChBC,cAAe,cAGfznC,MAAO,QACPqmC,SAAU,4CACVC,oBAAqB,0BACrBC,aAAc,gBACdC,kBAAmB,wBACnBC,QAAS,uBACT1kC,MAAO,sCACP2kC,MAAO,gBACPC,WAAY,qBACZC,iBAAkB,wCAClBC,gBAAiB,OACjBC,UAAW,MACXC,UAAW,cACXC,SAAU,gBACVC,cAAe,2BACfC,gBAAiBC,EAAeC,IAAa,YAAiBD,aAAiBC,UAC/EC,aAAc,mBACdC,cAAe,+BACfC,gBAAiB,kBACjBC,eAAgB,YAChBC,cAAe,cAIjB,IAAAC,YACF/7B,GAAQzS,OAAO5B,UACPwW,EAAyC,QAA1BnV,GAAGgtC,IAAgCruC,EAAOiB,aAAUI,GAAKgtC,GACxEgC,EAA6B,QAApBhvC,GAAGitC,IAA0BtuC,EAAO6I,OAAIxH,GAAKitC,GACrD,OAAA93B,GAAmB65B,KAYflC,eAAAmC,IACT,IACFtuC,GAAAosC,GAAY,GACZpsC,GAAAyI,EAAQ,YAGFsQ,GAAsBvG,aAGtB,MAAA+7B,QAeKpC,uBACP95B,EAAiB,GACjBm8B,EAAkB/7B,GAAGg8B,iCAGrBC,EAAgC,CAAI,KAAM,KAAM,KAAM,KAAM,gBAEvDzvC,KAAcyvC,EACnB,GAAAF,EAAgBvvC,IAAe,EAAG,CAE9B,MAAA0vC,EAAclvC,KAAKwQ,IAAI,EAAGxQ,KAAKmvC,MAAMJ,EAAgBvvC,GAAc,YAEhEue,EAAI,EAAGA,EAAImxB,EAAanxB,IAC3B,UACIxf,QAAeoU,GAAc6B,2BAA0B,CAC3DhV,aACAoV,MAAO,EACPxN,KAAY,IAAN2W,EAAU,aAAsB,IAANA,EAAU,eAAiB,UAE7DnL,EAAQuD,KAAK5X,EACf,OAASyK,GACPE,QAAQF,MAAK,sBAAuBxJ,YAAqBue,EAAI,KAAM/U,EACrE,CAEJ,OAII8H,EAAgC,CACpC,YAAa,UAAW,SAAU,OAAQ,SAAU,UAAW,aAAc,sBAGpEqE,KAAYrE,EACjB,IAEE,GADkBkC,GAAGo8B,wBAAwBj6B,GAC/BtV,QAAU,EAAG,OACvBtB,QAAeoU,GAAc6B,2BAA0B,CAC3D1D,YAAaqE,GACbP,MAAO,EACPxN,KAAM,aACNH,YAAUomC,GAAGoB,mBAAmB94B,EAAuBR,OAEzDvC,EAAQuD,KAAK5X,EACf,CACF,OAASyK,GACPE,QAAQF,MAAK,sBAAuBmM,qBAA6BnM,EACnE,CAII,MAAA4M,GAAiC,OAAQ,OAAQ,YAAa,oBAEzDrW,KAAgBqW,EACrB,IAEE,GADa5C,GAAGq8B,4BAA4B9vC,GACnCM,QAAU,EAAG,OAClBtB,QAAeoU,GAAc6B,2BAA0B,CAC3DjV,eACAqV,MAAO,EACPxN,KAAM,aACNH,YAAUomC,GAAGqB,kBAAkB14B,EAA2BzW,OAE5DqT,EAAQuD,KAAK5X,EACf,CACF,OAASyK,GACPE,QAAQF,MAAK,sBAAuBzJ,YAAwByJ,EAC9D,CAIE,GAAAgK,GAAGs8B,sBAAwB,GACzB,IACI,MAAA/wC,QAAeoU,GAAc6B,2BAA0B,CAC3DI,MAAO,GACPxN,KAAM,QACNH,MAAKrH,GAAEytC,GAAGkB,gBAEZ37B,EAAQuD,KAAK5X,EACf,OAASyK,GACPE,QAAQF,MAAM,mCAAoCA,EACpD,IAIqB,IAAnB4J,EAAQ/S,QAAgBmT,GAAGs8B,qBAAuB,EAAG,CACvDpmC,QAAQqmC,KAAK,mDACP,MAAAC,EAUD,iBACD58B,EAAiB,GACjBC,EAAiBG,GAAGE,gBAEtB,GAAAL,EAAehT,QAAU,EAAG,OAExB4vC,EAAwD,CAC5DhvC,GAAE,GACFC,MACAC,GAAE,GACFC,GAAE,GACFC,GAAE,IAGJgS,EAAehW,QAAQ6L,IACjBA,EAAKlJ,YAAc,IAAKiwC,EAAahvC,GAAG0V,KAAKzN,GACxCA,EAAKlJ,YAAc,IAAKiwC,EAAa/uC,GAAGyV,KAAKzN,GAC7CA,EAAKlJ,YAAc,IAAKiwC,EAAa9uC,GAAGwV,KAAKzN,GAC7CA,EAAKlJ,YAAc,IAAKiwC,EAAa7uC,GAAGuV,KAAKzN,GACjD+mC,EAAa5uC,GAAGsV,KAAKzN,eAIhBlJ,EAAY+b,KAAUO,OAAOhe,QAAQ2xC,GAC3C,GAAAl0B,EAAM1b,QAAU,EAAG,OACftB,EAASoU,GAAcc,6BAC3B8H,EAAMrZ,MAAM,EAAG,GAAGjD,IAAKyJ,IACf,MAAAgnC,EAAkD,iBAAzBhnC,EAAKgnC,iBAC9BtwC,OAAQsJ,EAAKgnC,iBACdhnC,EAAKgnC,iBAAe,CAAA,YAEpBhnC,EAEHgJ,SAAUhJ,EAAKkB,UAAU8H,WAAY,EACrCE,WAAYlJ,EAAKkB,UAAUgI,aAAc,EACzCwB,cAAe1K,EAAKkB,UAAUwJ,eAAiB,EAC/CC,sBACQgC,EAAQ3M,EAAKkB,UAAUyL,OAAS3M,EAAK2M,OAAS,KAC5C,MAAU,OAAVA,EAAiB,KAAOA,CAClC,KACAq6B,kBACAC,cAAejnC,EAAKinC,kBAItB1oC,MAAK,GAAKzH,MAAUI,GAAKytC,GAAGmB,kBAChBhvC,aACZ4H,KAAM,eAGVwL,EAAQuD,KAAK5X,EACf,CAEJ,QAEOqU,CACT,CAlE4Bg9B,GACxBh9B,EAAQuD,QAAQq5B,EAClB,QAEO58B,CACT,CA1GmCi9B,GAE/BtvC,GAAAqS,EAAUk8B,GAAgB,EAE5B,OAAStlC,GACPN,QAAQF,MAAM,0BAA2BQ,MACzCR,EAAQQ,aAAeD,MAAQC,EAAIC,QAAO7J,GAAGytC,GAAGrkC,OAAK,EACvD,CAAA,QACEzI,GAAAosC,GAAY,EACd,CACF,CA2KS,SAAAmD,IACPvvC,GAAAwsC,EAAsB,KACxB,CAKS,SAAArE,IACD,MAAAqH,MAAYxyC,IAEV,UADRqV,GAAQ/V,QAAQ0B,GAAUwxC,EAAMz6B,IAAI/W,EAAO6I,OACnC,CAAA,SAAU0O,MAAMC,KAAKg6B,GAC/B,CAKS,SAAAxH,IACC,MAAA,CAAA,KAAM,KAAM,KAAM,KAAM,KAClC,UA4BS5yB,EAAuBR,UACW,UAA1BxM,GAASC,aAA2BukC,EAAeF,GAAKE,EAAeD,IACxE/3B,IAAaA,CAC7B,UAKSa,EAA2BzW,GAC5B,MAAAywC,EAAmC,UAA1BrnC,GAASC,aAA2BwkC,EAAmBH,GAAKG,EAAmBF,GAEtF,OAAA3tC,KAAgBywC,EACpBA,EAAOzwC,GACPA,CACN,CAjQA+J,GAAO,KACLulC,UAqQH/tC,EAAGC,KACDkvC,KADFnvC,GAEIuK,KADF4kC,QACE5kC,GAAE,MAAFA,GACA,IAAA5J,KADA4J,EAAE,QACF5J,GAAC,MAADA,GACA,IAAAqB,KADArB,EAAC,GACDqB,EAAoCE,QAAO,IAAAzC,GAAQusC,GAA4B,YAA/EhqC,GAAM,MAANA,MAHFmtC,YAAAA,EAAM,aASJjvC,EAAG6J,KAEDI,QAFFjK,GAAG,QAEDiK,GAAC,MAADA,MAFFjK,GAEK+E,GAAA,IAAA1D,GAAAiF,EAAA1H,GAAAytC,GAAGK,eAFR1sC,uCAKAI,EAAGoB,KAED0tC,QAFF9uC,GAAG,QAED8uC,GAAC,MAADA,GACA,IAAAxsC,KADAwsC,EAAC,GACDxsC,EAA4BV,QAAS6rC,WAArCnrC,GAAM,MAANA,MAHFtC,mBAEK4H,IACgD3G,GAAAC,EAAA1C,GAAAytC,GAAGM,cAHxDvsC,uCAMAC,EAAGuB,KAEDutC,QAFF9uC,GAAG,QAED8uC,GAAC,MAADA,GACA,IAAA1kC,KADA0kC,EAAC,GACD1kC,EAAoCzI,QAAO,IAAAzC,GAAQusC,GAA4B,YAA/ErhC,GAAM,MAANA,MAHFpK,WAEKgB,GAAA+tC,EAAAxwC,GAAAytC,GAAGQ,kBAEJxrC,GAAAQ,EAAAjD,GAAAytC,GAAGI,0BAJPpsC,qBAQAC,EAAG6J,GAAAklC,GACD9uC,KADFD,GAEIiD,KADFhD,QACEgD,GAAK,MAALA,GACA,IAAAklC,KADAllC,EAAK,GAEH2rB,KADFuZ,QACEvZ,GAAM,MAANA,GAAAA,QAAAA,EAAMwZ,QAAA,eAANxZ,GACMluB,GAAAU,EAAA,GAAA6lC,QAAyBlzB,SAC7Bu0B,EAAMtlC,UAANslC,GAAM,MAANA,4BAAsBv0B,cAARA,MAAdu0B,EAAMruC,OAANquC,EAAMF,QAAA9pC,GAAQyV,KAAK,WAAnBu0B,QAHJH,MAFFloC,GAUA,IAAAG,KAVAH,EAAG,GAWD8nC,KADF3nC,QACE2nC,GAAK,MAALA,GACA,IAAAU,KADAV,EAAK,GAEHW,KADFD,QACEC,GAAM,MAANA,GAAAA,QAAAA,EAAMN,QAAA,eAANM,GACMhoC,GAAAokC,EAAA,GAAAsC,QAAoBthC,SACxB8iC,EAAMpkC,UAANokC,GAAM,MAANA,qCAAc9iC,MAAd8iC,EAAM3uC,OAAN2uC,EAAMR,QAAA9pC,GAAQwH,KAAI,KAAG,CAAA,aAxELA,UACgB,UAA1BuB,GAASC,aAA2BokC,EAAWC,GAAKD,EAAWE,IAChE9lC,IAAgCA,CAChD,CAqEgCyiC,IAAkBziC,WAAvC8iC,QAHJH,MAFFroC,GAUA,IAAAqC,KAVArC,EAAG,GAUHqC,EAA2Cf,QAAO,IAAAzC,GAAQusC,GAA4B,YAAtF/oC,GAAM,MAANA,MArBFzC,YAAAA,EAAG,4BA2BDgvC,GAAerG,EAAA,wBAAS8C,UACxBprC,EAAGgC,GAAAsmC,EAAA,GACD3kC,KADF3D,GACE2D,EAA2BtC,QAAS8sC,WAApCxqC,GAAM,MAANA,MADF3D,GAEIoE,GAAA,IAAA1D,GAAA2F,EAAApI,GAAAytC,GAAGa,mCAIPtsC,EAAGgF,QAAHhF,EAAG,GAAA,IAAAhC,GACK+uC,GAAmBpwC,GAAQA,EAAOY,GAAE,CAAAiE,EAAjB7E,SACvBuD,EAAG8J,KACD2kC,MADFzuC,GACY,wBAAEvD,SADduD,QAAAA,QAFJF,QAAAA,gBAREmrC,GAAmBzpC,EAAA2C,GAAA3C,EAAAE,GAAA,SAiBvBzB,EAAG4B,GAAAgmC,EAAA,GACD6G,KADFzuC,QACEyuC,4BAGMhrC,EAAM7B,GAAAwH,GAAAslC,IAANjrC,EAA6BxC,QAAO,KAAUzC,GAAAqsC,EAAqB,OAAOrsC,GAAAssC,EAAe,iBAAzFrnC,GAAM,MAANA,GAAoGO,GAAA,IAAA1D,GAAAgE,EAAAzG,GAAAytC,GAAGiB,iCADhF,QAAvB1uC,GAAAgtC,IAAiD,QAArBhtC,GAAIitC,IAAsBvpC,EAAAiD,QAF5DiqC,MADFzuC,UAzCmCM,GAAAY,EAAArD,GAAAytC,GAAGS,iBAEZzrC,GAAAqF,EAAA9H,GAAAytC,GAAGW,WAQA3rC,GAAA4C,EAAArF,GAAAytC,GAAGU,WAEN1rC,GAAAuF,EAAAhI,GAAAytC,GAAGY,UAQzB5rC,GAAA0F,EAAAnI,GAAAytC,GAAGG,yCAuBHH,GAAGc,eAAcvuC,GAAC+uC,GAAgB9uC,OAAMD,GAAEgT,GAAQ/S,aA1ClD4pC,EAAM,IAAA7pC,GAAoCgtC,GAAkBhE,GAAAroC,GAAlBqsC,EAAkBhE,OAU5DmB,EAAM,IAAAnqC,GAA8BitC,GAAYjE,GAAAroC,GAAZssC,EAAYjE,sBAtB1B,OAAnBh2B,GAAQ/S,SAAYwD,GAAAC,EAAA4M,GAAA,6BANpBlH,GAAK1F,EAAAC,GAAAD,EAAA6M,GAAA,6BALVw8B,GAASrpC,EAAAb,GAAAa,EAAAotC,GAAA,KA0EbC,WAAA,wBACS7D,IACOlF,QAAA,IAAArnC,GAAAusC,GAA4B,8BA/JdvuC,MAC7BqU,GAAQuD,KAAK5X,GACbgC,GAAAwsC,EAAsBxuC,GAAM,GAC5BgC,GAAAusC,GAA4B,EAC9B,OAsEDhsC,WAEQuB,GAAA6E,EAAAtH,GAAAytC,GAAGpmC,OACa5E,GAAA+mC,EAAAxpC,GAAAytC,GAAGC,UAErBjrC,GAAAgF,EAAAzH,GAAAytC,GAAGE,4BALTzsC,OAFD","x_google_ignoreList":[0,1,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66]}