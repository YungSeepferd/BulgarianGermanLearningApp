{"version":3,"file":"7.DeylXChb.js","sources":["../../../../../../node_modules/.pnpm/svelte@5.45.8/node_modules/svelte/src/attachments/index.js","../../../../../../src/lib/components/LessonCard.svelte","../../../../../../src/lib/components/GeneratedLesson.svelte","../../../../../../src/lib/schemas/lesson.js","../../../../../../src/lib/services/lesson.ts","../../../../../../src/lib/services/enhanced-lesson.ts","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/is.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/box/box-extras.svelte.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/compose-handlers.js","../../../../../../node_modules/.pnpm/inline-style-parser@0.2.7/node_modules/inline-style-parser/esm/index.mjs","../../../../../../node_modules/.pnpm/style-to-object@1.0.14/node_modules/style-to-object/esm/index.mjs","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/strings.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/css-to-style-obj.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/execute-callbacks.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/style-to-css.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/style.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/event-list.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/merge-props.js","../../../../../../node_modules/.pnpm/runed@0.35.1_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5.45.8_vite_efc45dca40aa31189015e6094218a671/node_modules/runed/dist/internal/configurable-globals.js","../../../../../../node_modules/.pnpm/svelte@5.45.8/node_modules/svelte/src/reactivity/map.js","../../../../../../node_modules/.pnpm/runed@0.35.1_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5.45.8_vite_efc45dca40aa31189015e6094218a671/node_modules/runed/dist/utilities/active-element/active-element.svelte.js","../../../../../../node_modules/.pnpm/runed@0.35.1_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5.45.8_vite_efc45dca40aa31189015e6094218a671/node_modules/runed/dist/internal/utils/dom.js","../../../../../../node_modules/.pnpm/runed@0.35.1_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5.45.8_vite_efc45dca40aa31189015e6094218a671/node_modules/runed/dist/utilities/context/context.js","../../../../../../node_modules/.pnpm/runed@0.35.1_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5.45.8_vite_efc45dca40aa31189015e6094218a671/node_modules/runed/dist/utilities/watch/watch.svelte.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/on-destroy-effect.svelte.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/after-tick.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/dom.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/dom-context.svelte.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/attach-ref.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/attrs.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/kbd-constants.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/is.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/animations-complete.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/presence-manager.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/noop.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/create-id.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/dialog/dialog.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/dialog/components/dialog-title.svelte","../../../../../../node_modules/.pnpm/svelte@5.45.8/node_modules/svelte/src/internal/client/dom/blocks/key.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/portal/portal-consumer.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/config/bits-config.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/config/prop-resolvers.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/portal/portal.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/debounce.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/elements.js","../../../../../../node_modules/.pnpm/tabbable@6.3.0/node_modules/tabbable/dist/index.esm.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/menu/menu.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/dismissible-layer/use-dismissable-layer.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/dom.js","../../../../../../node_modules/.pnpm/svelte-toolbelt@0.10.6_@sveltejs+kit@2.49.2_@sveltejs+vite-plugin-svelte@6.2.1_svelte@5_0c20683231c3a062fc377b53a667af2c/node_modules/svelte-toolbelt/dist/utils/after-sleep.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/escape-layer/use-escape-layer.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/focus-scope/focus-scope-manager.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/focus-scope/focus-scope.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/text-selection-layer/use-text-selection-layer.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/use-id.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/shared-state.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/internal/body-scroll-lock.svelte.js","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/scroll-lock/scroll-lock.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/dialog/components/dialog-overlay.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/dialog/components/dialog-description.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/dialog/components/dialog.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/dialog/components/dialog-close.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/dialog/components/dialog-content.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/escape-layer/escape-layer.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/dismissible-layer/dismissible-layer.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/text-selection-layer/text-selection-layer.svelte","../../../../../../node_modules/.pnpm/bits-ui@2.14.4_@internationalized+date@3.10.0_@sveltejs+kit@2.49.2_@sveltejs+vite-plugi_51a7d0a5c069e413efe8f98a009877e6/node_modules/bits-ui/dist/bits/utilities/focus-scope/focus-scope.svelte","../../../../../../src/lib/components/ui/dialog/dialog-content.svelte","../../../../../../src/lib/components/ui/dialog/dialog-portal.svelte","../../../../../../src/lib/components/ui/dialog/dialog-overlay.svelte","../../../../../../src/lib/components/ui/icons/X.svelte","../../../../../../src/lib/components/LessonGenerator.svelte","../../../../../../src/lib/components/ui/dialog/dialog.svelte","../../../../../../src/lib/components/ui/dialog/dialog-header.svelte","../../../../../../src/lib/components/ui/dialog/dialog-title.svelte","../../../../../../src/lib/components/ui/dialog/dialog-description.svelte","../../../../../../src/lib/components/ui/dialog/dialog-footer.svelte","../../../../../../src/routes/lessons/+page.svelte"],"sourcesContent":["/** @import { Action, ActionReturn } from '../action/public' */\n/** @import { Attachment } from './public' */\nimport { noop, render_effect } from 'svelte/internal/client';\nimport { ATTACHMENT_KEY } from '../constants.js';\nimport { untrack } from '../index-client.js';\nimport { teardown } from '../internal/client/reactivity/effects.js';\n\n/**\n * Creates an object key that will be recognised as an attachment when the object is spread onto an element,\n * as a programmatic alternative to using `{@attach ...}`. This can be useful for library authors, though\n * is generally not needed when building an app.\n *\n * ```svelte\n * <script>\n * \timport { createAttachmentKey } from 'svelte/attachments';\n *\n * \tconst props = {\n * \t\tclass: 'cool',\n * \t\tonclick: () => alert('clicked'),\n * \t\t[createAttachmentKey()]: (node) => {\n * \t\t\tnode.textContent = 'attached!';\n * \t\t}\n * \t};\n * </script>\n *\n * <button {...props}>click me</button>\n * ```\n * @since 5.29\n */\nexport function createAttachmentKey() {\n\treturn Symbol(ATTACHMENT_KEY);\n}\n\n/**\n * Converts an [action](https://svelte.dev/docs/svelte/use) into an [attachment](https://svelte.dev/docs/svelte/@attach) keeping the same behavior.\n * It's useful if you want to start using attachments on components but you have actions provided by a library.\n *\n * Note that the second argument, if provided, must be a function that _returns_ the argument to the\n * action function, not the argument itself.\n *\n * ```svelte\n * <!-- with an action -->\n * <div use:foo={bar}>...</div>\n *\n * <!-- with an attachment -->\n * <div {@attach fromAction(foo, () => bar)}>...</div>\n * ```\n * @template {EventTarget} E\n * @template {unknown} T\n * @overload\n * @param {Action<E, T> | ((element: E, arg: T) => void | ActionReturn<T>)} action The action function\n * @param {() => T} fn A function that returns the argument for the action\n * @returns {Attachment<E>}\n */\n/**\n * Converts an [action](https://svelte.dev/docs/svelte/use) into an [attachment](https://svelte.dev/docs/svelte/@attach) keeping the same behavior.\n * It's useful if you want to start using attachments on components but you have actions provided by a library.\n *\n * Note that the second argument, if provided, must be a function that _returns_ the argument to the\n * action function, not the argument itself.\n *\n * ```svelte\n * <!-- with an action -->\n * <div use:foo={bar}>...</div>\n *\n * <!-- with an attachment -->\n * <div {@attach fromAction(foo, () => bar)}>...</div>\n * ```\n * @template {EventTarget} E\n * @overload\n * @param {Action<E, void> | ((element: E) => void | ActionReturn<void>)} action The action function\n * @returns {Attachment<E>}\n */\n/**\n * Converts an [action](https://svelte.dev/docs/svelte/use) into an [attachment](https://svelte.dev/docs/svelte/@attach) keeping the same behavior.\n * It's useful if you want to start using attachments on components but you have actions provided by a library.\n *\n * Note that the second argument, if provided, must be a function that _returns_ the argument to the\n * action function, not the argument itself.\n *\n * ```svelte\n * <!-- with an action -->\n * <div use:foo={bar}>...</div>\n *\n * <!-- with an attachment -->\n * <div {@attach fromAction(foo, () => bar)}>...</div>\n * ```\n *\n * @template {EventTarget} E\n * @template {unknown} T\n * @param {Action<E, T> | ((element: E, arg: T) => void | ActionReturn<T>)} action The action function\n * @param {() => T} fn A function that returns the argument for the action\n * @returns {Attachment<E>}\n * @since 5.32\n */\nexport function fromAction(action, fn = /** @type {() => T} */ (noop)) {\n\treturn (element) => {\n\t\tconst { update, destroy } = untrack(() => action(element, fn()) ?? {});\n\n\t\tif (update) {\n\t\t\tvar ran = false;\n\t\t\trender_effect(() => {\n\t\t\t\tconst arg = fn();\n\t\t\t\tif (ran) update(arg);\n\t\t\t});\n\t\t\tran = true;\n\t\t}\n\n\t\tif (destroy) {\n\t\t\tteardown(destroy);\n\t\t}\n\t};\n}\n","<script lang=\"ts\">\n  /**\n   * LessonCard Component\n   *\n   * Displays a lesson with vocabulary items and progress tracking.\n   */\n\n  import type { Lesson, LessonDifficulty, LessonType } from '../schemas/lesson';\n\n  // Props\n  let { lesson, onStart } = $props<{ lesson: Lesson; onStart?: () => void }>();\n\n  // State\n  let isFlipped = $state(false);\n  let currentVocabularyIndex = $state(0);\n  let showAllVocabulary = $state(false);\n\n  // Computed\n  let vocabularyItems = $derived(\n    lesson.vocabulary.map((vocab: any) => {\n      if (typeof vocab === 'string') {\n        return {\n          id: vocab,\n          german: vocab.split('-')[0] || vocab,\n          bulgarian: vocab.split('-')[1] || vocab,\n          partOfSpeech: 'noun',\n          difficulty: 1\n        };\n      } else if (vocab && typeof vocab === 'object') {\n        return {\n          id: vocab.id || `vocab-${Date.now()}`,\n          german: vocab.german || vocab.bulgarian || 'Unknown',\n          bulgarian: vocab.bulgarian || vocab.german || 'Unknown',\n          partOfSpeech: vocab.partOfSpeech || 'noun',\n          difficulty: vocab.difficulty || 1\n        };\n      } else {\n        return {\n          id: `vocab-${Date.now()}`,\n          german: 'Unknown',\n          bulgarian: 'Unknown',\n          partOfSpeech: 'noun',\n          difficulty: 1\n        };\n      }\n    })\n  );\n\n  // Ensure vocabularyItems is never empty and currentVocabulary is always valid\n  let safeVocabularyItems = $derived(vocabularyItems.length > 0 ? vocabularyItems : [{\n    id: 'fallback-vocab',\n    german: 'Example',\n    bulgarian: '–ü—Ä–∏–º–µ—Ä',\n    partOfSpeech: 'noun',\n    difficulty: 1\n  }]);\n\n  let currentVocabulary = $derived(safeVocabularyItems[currentVocabularyIndex] || safeVocabularyItems[0]);\n  let completionPercentage = $derived(\n    Math.round((lesson.objectives.filter((obj: any) => obj.isCompleted).length / lesson.objectives.length) * 100)\n  );\n\n  // Methods\n  function toggleFlip() {\n    isFlipped = !isFlipped;\n  }\n\n  function nextVocabulary() {\n    if (currentVocabularyIndex < vocabularyItems.length - 1) {\n      currentVocabularyIndex++;\n    }\n  }\n\n  function prevVocabulary() {\n    if (currentVocabularyIndex > 0) {\n      currentVocabularyIndex--;\n    }\n  }\n\n  function toggleObjective(objectiveId: string) {\n    lesson.objectives = lesson.objectives.map((obj: any) =>\n      obj.id === objectiveId ? { ...obj, isCompleted: !obj.isCompleted } : obj\n    );\n    lesson.updatedAt = new Date();\n  }\n\n  function getDifficultyColor(difficulty: LessonDifficulty): string {\n    const colors: Record<LessonDifficulty, string> = {\n      'A1': 'bg-green-100 text-green-800 border-green-300',\n      'A2': 'bg-green-200 text-green-900 border-green-400',\n      'B1': 'bg-blue-100 text-blue-800 border-blue-300',\n      'B2': 'bg-blue-200 text-blue-900 border-blue-400',\n      'C1': 'bg-purple-100 text-purple-800 border-purple-300'\n    };\n    return colors[difficulty] || 'bg-gray-100 text-gray-800 border-gray-300';\n  }\n\n  function getLessonTypeIcon(type: LessonType): string {\n    const icons: Record<LessonType, string> = {\n      'vocabulary': 'üìö',\n      'grammar': 'üìñ',\n      'conversation': 'üí¨',\n      'reading': 'üìÑ',\n      'listening': 'üîä',\n      'writing': '‚úçÔ∏è',\n      'culture': 'üèõÔ∏è',\n      'mixed': 'üîÑ',\n      'contextual': 'üåê'\n    };\n    return icons[type] || 'üìö';\n  }\n</script>\n\n<!-- Lesson Card Container -->\n<div class=\"lesson-card-container\">\n  <!-- Lesson Card -->\n  <div\n    class=\"lesson-card {isFlipped ? 'flipped' : ''}\"\n    tabindex=\"0\"\n    onkeydown={e => e.key === 'Enter' || e.key === ' ' ? toggleFlip() : null}\n    aria-label={`Lesson: ${lesson.title}`}\n    role=\"button\"\n  >\n    <!-- Front Side -->\n    <div class=\"lesson-card-front\">\n      <div class=\"lesson-header\">\n        <div class=\"lesson-badge {getDifficultyColor(lesson.difficulty)}\">\n          {lesson.difficulty} ‚Ä¢ {lesson.duration} min\n        </div>\n        <div class=\"lesson-type-icon\" aria-label={`Lesson type: ${lesson.type}`}>\n          {getLessonTypeIcon(lesson.type)}\n        </div>\n      </div>\n\n      <h3 class=\"lesson-title\">{lesson.title}</h3>\n\n      <p class=\"lesson-description\">\n        {lesson.description}\n      </p>\n\n      <div class=\"lesson-progress\">\n        <div class=\"progress-bar-container\">\n          <div\n            class=\"progress-bar\"\n            style={`width: ${completionPercentage}%`}\n            role=\"progressbar\"\n            aria-valuenow={completionPercentage}\n            aria-valuemin=\"0\"\n            aria-valuemax=\"100\"\n          ></div>\n        </div>\n        <span class=\"progress-text\">{completionPercentage}% complete</span>\n      </div>\n\n      <div class=\"lesson-vocabulary-preview\">\n        <div class=\"vocabulary-tags\">\n          {#if showAllVocabulary}\n            {#each vocabularyItems.slice(0, 5) as vocab}\n              <span class=\"vocabulary-tag\" title={vocab.german}>\n                {vocab.german}\n              </span>\n            {/each}\n            {#if vocabularyItems.length > 5}\n              <span class=\"vocabulary-tag more\">+{vocabularyItems.length - 5}</span>\n            {/if}\n          {:else}\n            {#each vocabularyItems.slice(0, 3) as vocab}\n              <span class=\"vocabulary-tag\" title={vocab.german}>\n                {vocab.german}\n              </span>\n            {/each}\n            {#if vocabularyItems.length > 3}\n              <button\n                class=\"show-more-button\"\n                onclick={() => showAllVocabulary = true}\n                aria-label={`Show all ${vocabularyItems.length} vocabulary items`}\n              >\n                +{vocabularyItems.length - 3}\n              </button>\n            {/if}\n          {/if}\n        </div>\n      </div>\n\n      <div class=\"lesson-actions\">\n        <button\n          class=\"action-button primary\"\n          onclick={toggleFlip}\n          aria-label=\"View lesson details\"\n        >\n          View Details\n        </button>\n        <button\n          class=\"action-button secondary\"\n          onclick={() => onStart?.()}\n          aria-label=\"Start this lesson\"\n        >\n          ‚ñ∂Ô∏è Start\n        </button>\n      </div>\n    </div>\n\n    <!-- Back Side -->\n    <div class=\"lesson-card-back\">\n      <div class=\"lesson-header\">\n        <button\n          class=\"back-button\"\n          onclick={toggleFlip}\n          aria-label=\"Back to lesson overview\"\n        >\n          ‚Üê Back\n        </button>\n        <div class=\"lesson-badge {getDifficultyColor(lesson.difficulty)}\">\n          {lesson.difficulty} ‚Ä¢ {lesson.duration} min\n        </div>\n      </div>\n\n      <h3 class=\"lesson-title\">{lesson.title}</h3>\n\n      <div class=\"lesson-objectives\">\n        <h4>Learning Objectives</h4>\n        <ul class=\"objectives-list\">\n          {#each lesson.objectives as objective (objective.id)}\n            <li class=\"objective-item\">\n              <label class=\"objective-checkbox\">\n                <input\n                  type=\"checkbox\"\n                  checked={objective.isCompleted}\n                  onchange={() => toggleObjective(objective.id)}\n                />\n                <span class:completed={objective.isCompleted}>\n                  {objective.description}\n                </span>\n              </label>\n            </li>\n          {/each}\n        </ul>\n      </div>\n\n      <div class=\"lesson-vocabulary-details\">\n        <h4>Vocabulary ({vocabularyItems.length})</h4>\n\n        <div class=\"vocabulary-navigation\">\n          <button\n            onclick={prevVocabulary}\n            disabled={currentVocabularyIndex === 0}\n            aria-label=\"Previous vocabulary item\"\n          >\n            ‚óÄÔ∏è\n          </button>\n          <span class=\"vocabulary-counter\">\n            {currentVocabularyIndex + 1} / {vocabularyItems.length}\n          </span>\n          <button\n            onclick={nextVocabulary}\n            disabled={currentVocabularyIndex === vocabularyItems.length - 1}\n            aria-label=\"Next vocabulary item\"\n          >\n            ‚ñ∂Ô∏è\n          </button>\n        </div>\n\n        <div class=\"vocabulary-card\">\n          <div class=\"vocabulary-language german\">\n            {currentVocabulary.german}\n          </div>\n          <div class=\"vocabulary-language bulgarian\">\n            {currentVocabulary.bulgarian}\n          </div>\n          <div class=\"vocabulary-meta\">\n            {#if currentVocabulary?.partOfSpeech}\n              <span class=\"part-of-speech\">\n                {currentVocabulary.partOfSpeech}\n              </span>\n            {/if}\n            {#if currentVocabulary?.difficulty}\n              <span class=\"difficulty-indicator\">\n                {'‚≠ê'.repeat(currentVocabulary.difficulty)}\n              </span>\n            {/if}\n          </div>\n        </div>\n\n        <div class=\"vocabulary-list\">\n          {#each vocabularyItems as vocab, index}\n            <div\n              class=\"vocabulary-list-item {index === currentVocabularyIndex ? 'active' : ''}\"\n              onclick={() => currentVocabularyIndex = index}\n              role=\"button\"\n              tabindex=\"0\"\n              onkeydown={e => e.key === 'Enter' ? currentVocabularyIndex = index : null}\n            >\n              <span class=\"vocab-german\">{vocab?.german || 'Unknown'}</span>\n              <span class=\"vocab-bulgarian\">{vocab?.bulgarian || 'Unknown'}</span>\n            </div>\n          {/each}\n        </div>\n      </div>\n\n      <div class=\"lesson-actions\">\n        <button\n          class=\"action-button primary\"\n          onclick={() => onStart?.()}\n          aria-label=\"Start this lesson\"\n        >\n          Start Lesson\n        </button>\n      </div>\n    </div>\n  </div>\n</div>\n\n<!-- Styles -->\n<style>\n  .lesson-card-container {\n    perspective: 1000px;\n    width: 100%;\n    max-width: 400px;\n    height: 500px;\n  }\n\n  .lesson-card {\n    width: 100%;\n    height: 100%;\n    position: relative;\n    transform-style: preserve-3d;\n    transition: transform 0.6s;\n    border-radius: 12px;\n    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);\n    background: white;\n    overflow: hidden;\n  }\n\n  .lesson-card.flipped {\n    transform: rotateY(180deg);\n  }\n\n  .lesson-card-front, .lesson-card-back {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    backface-visibility: hidden;\n    padding: 20px;\n    display: flex;\n    flex-direction: column;\n    overflow-y: auto;\n  }\n\n  .lesson-card-front {\n    z-index: 2;\n  }\n\n  .lesson-card-back {\n    transform: rotateY(180deg);\n    background: #f8fafc;\n  }\n\n  .lesson-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 12px;\n  }\n\n  .lesson-badge {\n    padding: 4px 10px;\n    border-radius: 20px;\n    font-size: 0.75rem;\n    font-weight: 600;\n    border: 1px solid;\n    display: inline-block;\n  }\n\n  .lesson-type-icon {\n    font-size: 1.5rem;\n    width: 36px;\n    height: 36px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 50%;\n    background: rgba(59, 130, 246, 0.1);\n  }\n\n  .lesson-title {\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 8px;\n    line-height: 1.5;\n  }\n\n  .lesson-description {\n    color: #64748b;\n    font-size: 0.875rem;\n    line-height: 1.5;\n    margin-bottom: 16px;\n  }\n\n  .lesson-progress {\n    margin-bottom: 16px;\n  }\n\n  .progress-bar-container {\n    height: 6px;\n    background: #e2e8f0;\n    border-radius: 3px;\n    margin-bottom: 6px;\n    overflow: hidden;\n  }\n\n  .progress-bar {\n    height: 100%;\n    background: #3b82f6;\n    border-radius: 3px;\n    transition: width 0.3s ease;\n  }\n\n  .progress-text {\n    font-size: 0.75rem;\n    color: #64748b;\n    font-weight: 500;\n  }\n\n  .lesson-vocabulary-preview {\n    margin-bottom: 16px;\n  }\n\n  .vocabulary-tags {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 6px;\n  }\n\n  .vocabulary-tag {\n    padding: 4px 10px;\n    background: #f1f5f9;\n    border-radius: 20px;\n    font-size: 0.75rem;\n    color: #475569;\n    border: 1px solid #e2e8f0;\n    max-width: 100px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n  }\n\n  .vocabulary-tag.more {\n    background: #e2e8f0;\n  }\n\n  .show-more-button {\n    padding: 4px 8px;\n    background: #f1f5f9;\n    border-radius: 20px;\n    font-size: 0.75rem;\n    color: #475569;\n    border: 1px solid #e2e8f0;\n    cursor: pointer;\n    margin-left: 4px;\n  }\n\n  .lesson-actions {\n    display: flex;\n    gap: 8px;\n    margin-top: auto;\n  }\n\n  .action-button {\n    flex: 1;\n    padding: 10px;\n    border-radius: 8px;\n    font-weight: 500;\n    cursor: pointer;\n    transition: all 0.2s ease;\n    border: none;\n    font-size: 0.875rem;\n  }\n\n  .action-button.primary {\n    background: #3b82f6;\n    color: white;\n  }\n\n  .action-button.primary:hover {\n    background: #2563eb;\n  }\n\n  .action-button.secondary {\n    background: #e2e8f0;\n    color: #475569;\n  }\n\n  .action-button.secondary:hover {\n    background: #cbd5e1;\n  }\n\n  .back-button {\n    padding: 6px 12px;\n    background: #f1f5f9;\n    border-radius: 6px;\n    font-size: 0.875rem;\n    color: #475569;\n    border: 1px solid #e2e8f0;\n    cursor: pointer;\n  }\n\n  .lesson-objectives {\n    margin-bottom: 20px;\n  }\n\n  .lesson-objectives h4 {\n    font-size: 1rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 12px;\n  }\n\n  .objectives-list {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n  }\n\n  .objective-item {\n    margin-bottom: 8px;\n  }\n\n  .objective-checkbox {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    cursor: pointer;\n  }\n\n  .objective-checkbox input {\n    margin: 0;\n  }\n\n  .objective-checkbox span {\n    font-size: 0.875rem;\n    color: #475569;\n  }\n\n  .objective-checkbox span.completed {\n    text-decoration: line-through;\n    color: #94a3b8;\n  }\n\n  .lesson-vocabulary-details h4 {\n    font-size: 1rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 12px;\n  }\n\n  .vocabulary-navigation {\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    gap: 16px;\n    margin-bottom: 16px;\n  }\n\n  .vocabulary-counter {\n    font-size: 0.875rem;\n    color: #64748b;\n  }\n\n  .vocabulary-navigation button {\n    padding: 6px;\n    background: #f1f5f9;\n    border-radius: 50%;\n    border: 1px solid #e2e8f0;\n    cursor: pointer;\n    width: 32px;\n    height: 32px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .vocabulary-navigation button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .vocabulary-card {\n    background: white;\n    border-radius: 12px;\n    padding: 20px;\n    margin-bottom: 16px;\n    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);\n    text-align: center;\n  }\n\n  .vocabulary-language {\n    font-size: 1.5rem;\n    font-weight: 600;\n    margin-bottom: 8px;\n  }\n\n  .vocabulary-language.german {\n    color: #1e293b;\n  }\n\n  .vocabulary-language.bulgarian {\n    color: #3b82f6;\n    font-size: 1.25rem;\n  }\n\n  .vocabulary-meta {\n    display: flex;\n    justify-content: center;\n    gap: 8px;\n    margin-top: 12px;\n  }\n\n  .part-of-speech {\n    padding: 2px 8px;\n    background: #f1f5f9;\n    border-radius: 12px;\n    font-size: 0.75rem;\n    color: #475569;\n  }\n\n  .difficulty-indicator {\n    color: #f59e0b;\n  }\n\n  .vocabulary-list {\n    max-height: 200px;\n    overflow-y: auto;\n    border: 1px solid #e2e8f0;\n    border-radius: 8px;\n  }\n\n  .vocabulary-list-item {\n    padding: 12px 16px;\n    border-bottom: 1px solid #e2e8f0;\n    cursor: pointer;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n  }\n\n  .vocabulary-list-item:last-child {\n    border-bottom: none;\n  }\n\n  .vocabulary-list-item.active {\n    background: #f1f5f9;\n  }\n\n  .vocabulary-list-item:hover {\n    background: #f8fafc;\n  }\n\n  .vocab-german {\n    font-weight: 500;\n    color: #1e293b;\n  }\n\n  .vocab-bulgarian {\n    color: #64748b;\n    font-size: 0.875rem;\n  }\n\n  @media (max-width: 640px) {\n    .lesson-card-container {\n      height: 480px;\n    }\n\n    .lesson-title {\n      font-size: 1.125rem;\n    }\n  }\n</style>","<script>\n  /**\n   * GeneratedLesson Component\n   *\n   * Displays a dynamically generated lesson with all its sections and content.\n   * Supports different section types (introduction, vocabulary, grammar, exercise, cultural, summary)\n   * and provides a rich, interactive learning experience with bilingual support.\n   */\n\n  import { t } from '$lib/services/localization';\n  import { appState } from '$lib/state/app-state';\n\n  // Language adapter functions\n  function getSourceText(item) {\n    return appState.languageMode === 'DE_BG' ? item.german : item.bulgarian;\n  }\n\n  function getTargetText(item) {\n    return appState.languageMode === 'DE_BG' ? item.bulgarian : item.german;\n  }\n\n  function correctPartOfSpeech(pos) {\n    const parts = {\n      'noun': 'Noun', 'verb': 'Verb', 'adjective': 'Adjective',\n      'adverb': 'Adverb', 'preposition': 'Preposition', 'conjunction': 'Conjunction'\n    };\n    return parts[pos] || pos;\n  }\n\n  // Props\n  let { lesson } = $props();\n\n  // Error state\n  let hasError = $state(false);\n  let errorMessage = $state(null);\n\n  // Simple error handler\n  function handleError(error, context) {\n    console.error(`[${context}]`, error);\n  }\n\n  // State\n  let currentSectionIndex = $state(0);\n  let showAllVocabulary = $state(false);\n  let showAllObjectives = $state(false);\n  let showSectionDetails = $state({});\n\n  // Initialize with error handling\n  $effect(() => {\n    try {\n      // Validate lesson data on initialization\n      if (!lesson) {\n        throw new Error('Lesson data is required');\n      }\n    } catch (err) {\n      handleError(err, 'Failed to initialize GeneratedLesson component');\n      hasError = true;\n      errorMessage = err instanceof Error ? err.message : 'Invalid lesson data';\n    }\n  });\n\n  // Computed\n  // Derived state with error handling\n  let sections = $derived.by(() => {\n    try {\n      if (!lesson.sections || lesson.sections.length === 0) {\n        return [{\n          id: 'default-section',\n          title: 'Lesson Content',\n          content: lesson.content || 'No content available',\n          type: 'summary',\n          metadata: {}\n        }];\n      }\n      return lesson.sections;\n    } catch (err) {\n      handleError(err, 'Failed to derive lesson sections');\n      hasError = true;\n      errorMessage = 'Failed to load lesson sections';\n      return [{\n        id: 'error-section',\n        title: 'Error',\n        content: 'Failed to load lesson content',\n        type: 'summary',\n        metadata: {}\n      }];\n    }\n  });\n\n  // Current section with error handling\n  let currentSection = $derived.by(() => {\n    try {\n      return sections[currentSectionIndex] || null;\n    } catch (err) {\n      handleError(err, 'Failed to get current section');\n      hasError = true;\n      errorMessage = 'Failed to load section content';\n      return null;\n    }\n  });\n  // Completion percentage with error handling\n  let completionPercentage = $derived.by(() => {\n    try {\n      if (!lesson.objectives || lesson.objectives.length === 0) return 0;\n      return Math.round((lesson.objectives.filter((obj) => obj.isCompleted).length / lesson.objectives.length) * 100);\n    } catch (err) {\n      handleError(err, 'Failed to calculate completion percentage');\n      hasError = true;\n      errorMessage = 'Failed to calculate progress';\n      return 0;\n    }\n  });\n  // Vocabulary items with error handling\n  let vocabularyItems = $derived.by(() => {\n    try {\n      return lesson.vocabulary || [];\n    } catch (err) {\n      handleError(err, 'Failed to load vocabulary items');\n      hasError = true;\n      errorMessage = 'Failed to load vocabulary';\n      return [];\n    }\n  });\n  // Derived boolean states with error handling\n  let hasVocabulary = $derived.by(() => {\n    try {\n      return vocabularyItems.length > 0;\n    } catch (err) {\n      handleError(err, 'Failed to check vocabulary availability');\n      return false;\n    }\n  });\n\n  let hasObjectives = $derived.by(() => {\n    try {\n      return lesson.objectives && lesson.objectives.length > 0;\n    } catch (err) {\n      handleError(err, 'Failed to check objectives availability');\n      return false;\n    }\n  });\n\n  let hasSections = $derived.by(() => {\n    try {\n      return sections.length > 0;\n    } catch (err) {\n      handleError(err, 'Failed to check sections availability');\n      return false;\n    }\n  });\n\n  let isFallbackLesson = $derived.by(() => {\n    try {\n      return lesson.metadata?.fallback === true;\n    } catch (err) {\n      handleError(err, 'Failed to check fallback status');\n      return false;\n    }\n  });\n\n  // Methods\n  /**\n   * Toggle objective completion status with error handling\n   */\n  function toggleObjective(objectiveId) {\n    try {\n      if (!lesson.objectives) {\n        throw new Error('Lesson objectives are not available');\n      }\n\n      lesson.objectives = lesson.objectives.map((obj) =>\n        obj.id === objectiveId ? { ...obj, isCompleted: !obj.isCompleted } : obj\n      );\n      lesson.updatedAt = new Date();\n    } catch (err) {\n      handleError(err, 'Failed to toggle objective');\n      hasError = true;\n      errorMessage = 'Failed to update objective status';\n    }\n  }\n\n  /**\n   * Navigate to next section with error handling\n   */\n  function nextSection() {\n    try {\n      if (currentSectionIndex < sections.length - 1) {\n        currentSectionIndex++;\n      }\n    } catch (err) {\n      handleError(err, 'Failed to navigate to next section');\n      hasError = true;\n      errorMessage = 'Failed to navigate sections';\n    }\n  }\n\n  /**\n   * Navigate to previous section with error handling\n   */\n  function prevSection() {\n    try {\n      if (currentSectionIndex > 0) {\n        currentSectionIndex--;\n      }\n    } catch (err) {\n      handleError(err, 'Failed to navigate to previous section');\n      hasError = true;\n      errorMessage = 'Failed to navigate sections';\n    }\n  }\n\n  /**\n   * Toggle section details visibility with error handling\n   */\n  function toggleSectionDetails(sectionId) {\n    try {\n      showSectionDetails[sectionId] = !showSectionDetails[sectionId];\n    } catch (err) {\n      handleError(err, 'Failed to toggle section details');\n      hasError = true;\n      errorMessage = 'Failed to toggle section details';\n    }\n  }\n\n  function getSectionIcon(type) {\n    const icons = {\n      'introduction': 'üìò',\n      'vocabulary': 'üìö',\n      'grammar': 'üìñ',\n      'exercise': '‚úèÔ∏è',\n      'cultural': 'üèõÔ∏è',\n      'summary': 'üìù',\n      'conversation': 'üí¨',\n      'reading': 'üìÑ',\n      'listening': 'üîä',\n      'writing': '‚úçÔ∏è'\n    };\n    return icons[type] || 'üìñ';\n  }\n\n  function getDifficultyColor(difficulty) {\n    const colors = {\n      'A1': 'bg-green-100 text-green-800 border-green-300',\n      'A2': 'bg-green-200 text-green-900 border-green-400',\n      'B1': 'bg-blue-100 text-blue-800 border-blue-300',\n      'B2': 'bg-blue-200 text-blue-900 border-blue-400',\n      'C1': 'bg-purple-100 text-purple-800 border-purple-300'\n    };\n    return colors[difficulty] || 'bg-gray-100 text-gray-800 border-gray-300';\n  }\n\n  function getLessonTypeIcon(type) {\n    const icons = {\n      'vocabulary': 'üìö',\n      'grammar': 'üìñ',\n      'conversation': 'üí¨',\n      'reading': 'üìÑ',\n      'listening': 'üîä',\n      'writing': '‚úçÔ∏è',\n      'culture': 'üèõÔ∏è',\n      'mixed': 'üéØ',\n      'contextual': 'üåç'\n    };\n    return icons[type] || 'üìö';\n  }\n\n  function getSectionTypeName(type) {\n    // Reactive section names\n    $: names = {\n      'introduction': t('sections.introduction') || 'Introduction',\n      'vocabulary': t('sections.vocabulary') || 'Vocabulary',\n      'grammar': t('sections.grammar') || 'Grammar',\n      'exercise': t('sections.exercise') || 'Exercise',\n      'cultural': t('sections.cultural_note') || 'Cultural Note',\n      'summary': t('sections.summary') || 'Summary',\n      'conversation': t('sections.conversation') || 'Conversation',\n      'reading': t('sections.reading') || 'Reading',\n      'listening': t('sections.listening') || 'Listening',\n      'writing': t('sections.writing') || 'Writing'\n    };\n    return names[type] || type;\n  }\n\n  function renderSectionContent(content) {\n    // Simple markdown-like rendering for basic formatting\n    return content\n      .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\n      .replace(/\\*(.*?)\\*/g, '<em>$1</em>')\n      .replace(/`(.*?)`/g, '<code>$1</code>')\n      .replace(/\\n/g, '<br>');\n  }\n\n  function getVocabularyPreview(count) {\n    if (vocabularyItems.length === 0) return '';\n\n    const previewItems = vocabularyItems.slice(0, count);\n    // Show only the source language based on current direction\n    return previewItems.map((item) => getSourceText(item)).join(', ');\n  }\n</script>\n\n<div class=\"generated-lesson-container\">\n  {#if hasError}\n    <div class=\"error-message\">\n      <div class=\"error-icon\">‚ö†Ô∏è</div>\n      <h3>{t('errors.lesson_load_error')}</h3>\n      <p>{errorMessage || t('errors.unknown_error')}</p>\n      <button class=\"btn btn-secondary\" onclick={() => window.location.reload()}>\n        {t('common.reload_page')}\n      </button>\n    </div>\n  {:else if isFallbackLesson}\n    <div class=\"fallback-lesson-message\">\n      <div class=\"fallback-icon\">‚ö†Ô∏è</div>\n      <h3>{t('lesson.unavailable')}</h3>\n      <p>{lesson.description}</p>\n      <button class=\"btn btn-secondary\" onclick={() => window.location.reload()}>\n        {t('common.try_again')}\n      </button>\n    </div>\n  {:else}\n    <div class=\"lesson-header\">\n      <div class=\"lesson-title-section\">\n        <div class=\"lesson-type-icon\" aria-label={`Lesson type: ${lesson.type}`}>\n          {getLessonTypeIcon(lesson.type)}\n        </div>\n        <h1 class=\"lesson-title\">{lesson.title}</h1>\n      </div>\n\n      <div class=\"lesson-meta\">\n        <div class=\"lesson-badge {getDifficultyColor(lesson.difficulty)}\">\n          {lesson.difficulty} ‚Ä¢ {lesson.duration} {t('common.minutes')}\n        </div>\n        {#if lesson.metadata?.tags && lesson.metadata.tags.length > 0}\n          <div class=\"lesson-tags\">\n            {#each lesson.metadata.tags.slice(0, 3) as tag}\n              <span class=\"lesson-tag\">{tag}</span>\n            {/each}\n            {#if lesson.metadata.tags.length > 3}\n              <span class=\"lesson-tag more\">+{lesson.metadata.tags.length - 3}</span>\n            {/if}\n          </div>\n        {/if}\n      </div>\n    </div>\n\n    <div class=\"lesson-description\">\n      {lesson.description}\n    </div>\n\n    <div class=\"lesson-progress-container\">\n      <div class=\"progress-bar-container\">\n        <div\n          class=\"progress-bar\"\n          style={`width: ${completionPercentage}%`}\n          role=\"progressbar\"\n          aria-valuenow={completionPercentage}\n          aria-valuemin=\"0\"\n          aria-valuemax=\"100\"\n        ></div>\n      </div>\n      <span class=\"progress-text\">{completionPercentage}% complete</span>\n    </div>\n\n    {#if hasObjectives}\n      <div class=\"lesson-objectives\">\n        <div class=\"objectives-header\">\n          <h3>{t('sections.learning_objectives')}</h3>\n          <button\n            class=\"toggle-objectives\"\n            onclick={() => showAllObjectives = !showAllObjectives}\n          >\n            {showAllObjectives ? t('common.show_less') : t('common.show_all')}\n          </button>\n        </div>\n\n        <ul class=\"objectives-list\">\n          {#each (showAllObjectives ? lesson.objectives : lesson.objectives.slice(0, 3)) as objective (objective.id)}\n            <li class=\"objective-item\">\n              <label class=\"objective-checkbox\">\n                <input\n                  type=\"checkbox\"\n                  checked={objective.isCompleted}\n                  onchange={() => toggleObjective(objective.id)}\n                />\n                <span class:completed={objective.isCompleted}>\n                  {objective.description}\n                </span>\n              </label>\n            </li>\n          {/each}\n          {#if lesson.objectives.length > 3 && !showAllObjectives}\n            <li class=\"objective-item more-objectives\">\n              <button onclick={() => showAllObjectives = true}>\n                +{lesson.objectives.length - 3} {t('common.more_objectives')}\n              </button>\n            </li>\n          {/if}\n        </ul>\n      </div>\n    {/if}\n\n    {#if hasVocabulary}\n      <div class=\"lesson-vocabulary\">\n        <div class=\"vocabulary-header\">\n          <h3>{t('sections.vocabulary')} ({vocabularyItems.length})</h3>\n          <button\n            class=\"toggle-vocabulary\"\n            onclick={() => showAllVocabulary = !showAllVocabulary}\n          >\n            {showAllVocabulary ? t('common.show_less') : t('common.show_all')}\n          </button>\n        </div>\n\n        <div class=\"vocabulary-preview\">\n          {getVocabularyPreview(showAllVocabulary ? vocabularyItems.length : 5)}\n          {#if vocabularyItems.length > 5 && !showAllVocabulary}\n            <span class=\"more-vocabulary\">+{vocabularyItems.length - 5} {t('common.more_words')}</span>\n          {/if}\n        </div>\n\n        {#if showAllVocabulary}\n          <div class=\"vocabulary-list\">\n            {#each vocabularyItems as vocab (vocab.german)}\n              <div class=\"vocabulary-item\">\n                <!-- Show source language prominently -->\n                <div class=\"vocabulary-source\">\n                  {getSourceText(vocab)}\n                </div>\n                <!-- Show target language on hover/click or as secondary info -->\n                <div class=\"vocabulary-target\">\n                  {getTargetText(vocab)}\n                </div>\n                {#if vocab.partOfSpeech}\n                  <div class=\"vocabulary-part-of-speech\">\n                    {correctPartOfSpeech(vocab.partOfSpeech)}\n                  </div>\n                {/if}\n                {#if vocab.difficulty}\n                  <div class=\"vocabulary-difficulty\">\n                    {'‚≠ê'.repeat(Math.round(vocab.difficulty))}\n                  </div>\n                {/if}\n              </div>\n            {/each}\n          </div>\n        {/if}\n      </div>\n    {/if}\n\n    {#if hasSections}\n      <div class=\"lesson-sections\">\n        <div class=\"sections-navigation\">\n          <button\n            onclick={prevSection}\n            disabled={currentSectionIndex === 0}\n            aria-label={t('common.previous_section')}\n          >\n            ‚óÄÔ∏è {t('common.previous')}\n          </button>\n\n          <div class=\"section-indicator\">\n            {t('common.section')} {currentSectionIndex + 1} {t('common.of')} {sections.length}\n          </div>\n\n          <button\n            onclick={nextSection}\n            disabled={currentSectionIndex === sections.length - 1}\n            aria-label={t('common.next_section')}\n          >\n            {t('common.next')} ‚ñ∂Ô∏è\n          </button>\n        </div>\n\n        <div class=\"section-content\">\n          <div class=\"section-header\">\n            <div class=\"section-icon\">\n              {getSectionIcon(currentSection.type)}\n            </div>\n            <h2 class=\"section-title\">\n              {currentSection.title}\n            </h2>\n            <div class=\"section-type\">\n              {getSectionTypeName(currentSection.type)}\n            </div>\n          </div>\n\n          <div class=\"section-body\">\n            <div class=\"section-content-text\" innerHTML={renderSectionContent(currentSection.content)}></div>\n\n            {#if currentSection.metadata?.templateId}\n              <div class=\"section-meta\">\n                <span class=\"template-id\">\n                  Template: {currentSection.metadata.templateId}\n                </span>\n              </div>\n            {/if}\n          </div>\n        </div>\n\n        <div class=\"sections-overview\">\n          <h3>Lesson Sections</h3>\n          <div class=\"sections-list\">\n            {#each sections as section, index (section.id)}\n              <div\n                class=\"section-overview-item {index === currentSectionIndex ? 'active' : ''}\"\n                onclick={() => currentSectionIndex = index}\n                role=\"button\"\n                tabindex=\"0\"\n                onkeydown={e => e.key === 'Enter' || e.key === ' ' ? currentSectionIndex = index : null}\n              >\n                <div class=\"section-overview-icon\">\n                  {getSectionIcon(section.type)}\n                </div>\n                <div class=\"section-overview-title\">\n                  {section.title}\n                </div>\n                <div class=\"section-overview-type\">\n                  {getSectionTypeName(section.type)}\n                </div>\n              </div>\n            {/each}\n          </div>\n        </div>\n      </div>\n    {:else}\n      <div class=\"no-sections-message\">\n        {t('lesson.no_sections')}\n      </div>\n    {/if}\n\n    <div class=\"lesson-actions\">\n      <button class=\"btn btn-secondary\" onclick={() => window.history.back()}>\n        {t('common.back_to_lessons')}\n      </button>\n      <button class=\"btn btn-primary\" onclick={() => alert(t('lesson.start_alert'))}>\n        {t('common.start_lesson')}\n      </button>\n    </div>\n  {/if}\n</div>\n\n<style>\n  .generated-lesson-container {\n    max-width: 800px;\n    margin: 0 auto;\n    padding: 2rem;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  }\n\n  .fallback-lesson-message {\n    text-align: center;\n    padding: 2rem;\n    background: #fef2f2;\n    border-radius: 12px;\n    margin: 2rem 0;\n  }\n\n  .fallback-icon {\n    font-size: 3rem;\n    margin-bottom: 1rem;\n  }\n\n  .lesson-header {\n    margin-bottom: 1.5rem;\n    display: flex;\n    flex-direction: column;\n    gap: 1rem;\n  }\n\n  .lesson-title-section {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n  }\n\n  .lesson-type-icon {\n    font-size: 2rem;\n    width: 50px;\n    height: 50px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: 50%;\n    background: rgba(59, 130, 246, 0.1);\n  }\n\n  .lesson-title {\n    font-size: 2rem;\n    font-weight: 700;\n    color: #1e293b;\n    margin: 0;\n  }\n\n  .lesson-meta {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n    align-items: center;\n  }\n\n  .lesson-badge {\n    padding: 0.25rem 0.75rem;\n    border-radius: 20px;\n    font-size: 0.875rem;\n    font-weight: 600;\n    border: 1px solid;\n    display: inline-block;\n  }\n\n  .lesson-tags {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 0.5rem;\n  }\n\n  .lesson-tag {\n    padding: 0.25rem 0.75rem;\n    background: #f1f5f9;\n    border-radius: 20px;\n    font-size: 0.75rem;\n    color: #475569;\n    border: 1px solid #e2e8f0;\n  }\n\n  .lesson-tag.more {\n    background: #e2e8f0;\n  }\n\n  .lesson-description {\n    color: #64748b;\n    font-size: 1rem;\n    line-height: 1.6;\n    margin-bottom: 1.5rem;\n  }\n\n  .lesson-progress-container {\n    margin-bottom: 2rem;\n  }\n\n  .progress-text {\n    display: block;\n    text-align: right;\n    font-size: 0.875rem;\n    color: #64748b;\n    margin-top: 0.5rem;\n  }\n\n  .lesson-objectives {\n    background: #f8fafc;\n    border-radius: 12px;\n    padding: 1.5rem;\n    margin-bottom: 2rem;\n  }\n\n  .objectives-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n  }\n\n  .objectives-header h3 {\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin: 0;\n  }\n\n  .toggle-objectives {\n    background: none;\n    border: none;\n    color: #3b82f6;\n    cursor: pointer;\n    font-size: 0.875rem;\n    text-decoration: underline;\n  }\n\n  .objectives-list {\n    list-style: none;\n    padding: 0;\n    margin: 0;\n  }\n\n  .objective-item {\n    margin-bottom: 0.75rem;\n    padding: 0.5rem 0;\n  }\n\n  .objective-item:last-child {\n    margin-bottom: 0;\n  }\n\n  .objective-checkbox {\n    display: flex;\n    align-items: center;\n    gap: 0.75rem;\n    cursor: pointer;\n  }\n\n  .objective-checkbox input {\n    margin: 0;\n  }\n\n  .objective-checkbox span {\n    font-size: 0.95rem;\n    color: #475569;\n  }\n\n  .objective-checkbox span.completed {\n    text-decoration: line-through;\n    color: #94a3b8;\n  }\n\n  .more-objectives {\n    color: #3b82f6;\n    font-size: 0.875rem;\n  }\n\n  .more-objectives button {\n    background: none;\n    border: none;\n    color: #3b82f6;\n    cursor: pointer;\n    text-decoration: underline;\n    padding: 0;\n  }\n\n  .lesson-vocabulary {\n    background: #f8fafc;\n    border-radius: 12px;\n    padding: 1.5rem;\n    margin-bottom: 2rem;\n  }\n\n  .vocabulary-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1rem;\n  }\n\n  .vocabulary-header h3 {\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin: 0;\n  }\n\n  .toggle-vocabulary {\n    background: none;\n    border: none;\n    color: #3b82f6;\n    cursor: pointer;\n    font-size: 0.875rem;\n    text-decoration: underline;\n  }\n\n  .vocabulary-preview {\n    font-size: 0.95rem;\n    color: #475569;\n    line-height: 1.5;\n  }\n\n  .more-vocabulary {\n    color: #3b82f6;\n    font-size: 0.875rem;\n  }\n\n  .vocabulary-list {\n    margin-top: 1rem;\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));\n    gap: 1rem;\n  }\n\n  .vocabulary-item {\n    background: white;\n    border-radius: 8px;\n    padding: 1rem;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  }\n\n  .vocabulary-source {\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 0.5rem;\n    font-size: 1.1rem;\n  }\n\n  .vocabulary-target {\n    color: #3b82f6;\n    margin-bottom: 0.5rem;\n    opacity: 0.8;\n    font-size: 0.95rem;\n  }\n\n  .vocabulary-part-of-speech {\n    font-size: 0.75rem;\n    color: #64748b;\n    background: #f1f5f9;\n    padding: 0.25rem 0.5rem;\n    border-radius: 4px;\n    display: inline-block;\n    margin-right: 0.5rem;\n  }\n\n  .vocabulary-difficulty {\n    font-size: 0.75rem;\n    color: #f59e0b;\n  }\n\n  .lesson-sections {\n    margin-bottom: 2rem;\n  }\n\n  .sections-navigation {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 1.5rem;\n  }\n\n  .sections-navigation button {\n    padding: 0.5rem 1rem;\n    background: #f1f5f9;\n    border: 1px solid #e2e8f0;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.875rem;\n  }\n\n  .sections-navigation button:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n  }\n\n  .section-indicator {\n    font-size: 0.875rem;\n    color: #64748b;\n  }\n\n  .section-content {\n    background: white;\n    border-radius: 12px;\n    padding: 2rem;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);\n  }\n\n  .section-header {\n    display: flex;\n    align-items: center;\n    gap: 1rem;\n    margin-bottom: 1.5rem;\n    border-bottom: 1px solid #e2e8f0;\n    padding-bottom: 1rem;\n  }\n\n  .section-icon {\n    font-size: 1.5rem;\n  }\n\n  .section-title {\n    font-size: 1.5rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin: 0;\n    flex: 1;\n  }\n\n  .section-type {\n    padding: 0.25rem 0.75rem;\n    background: #f1f5f9;\n    border-radius: 20px;\n    font-size: 0.75rem;\n    color: #475569;\n  }\n\n  .section-body {\n    line-height: 1.7;\n  }\n\n  .section-content-text {\n    font-size: 1rem;\n    color: #334155;\n  }\n\n  .section-content-text :global(strong) {\n    font-weight: 600;\n    color: #1e293b;\n  }\n\n  .section-content-text :global(em) {\n    font-style: italic;\n  }\n\n  .section-content-text :global(code) {\n    background: #f1f5f9;\n    padding: 0.1rem 0.3rem;\n    border-radius: 4px;\n    font-family: monospace;\n  }\n\n  .section-meta {\n    margin-top: 1rem;\n    font-size: 0.75rem;\n    color: #94a3b8;\n  }\n\n  .sections-overview {\n    margin-top: 2rem;\n  }\n\n  .sections-overview h3 {\n    font-size: 1.25rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 1rem;\n  }\n\n  .sections-list {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\n    gap: 1rem;\n  }\n\n  .section-overview-item {\n    background: #f8fafc;\n    border-radius: 8px;\n    padding: 1rem;\n    cursor: pointer;\n    transition: background 0.2s ease;\n  }\n\n  .section-overview-item:hover {\n    background: #f1f5f9;\n  }\n\n  .section-overview-item.active {\n    background: #e2e8f0;\n    border-left: 3px solid #3b82f6;\n  }\n\n  .section-overview-icon {\n    font-size: 1.25rem;\n    margin-bottom: 0.5rem;\n  }\n\n  .section-overview-title {\n    font-weight: 500;\n    color: #1e293b;\n    margin-bottom: 0.25rem;\n  }\n\n  .section-overview-type {\n    font-size: 0.75rem;\n    color: #64748b;\n  }\n\n  .no-sections-message {\n    text-align: center;\n    padding: 2rem;\n    color: #64748b;\n    font-size: 1rem;\n  }\n\n  .lesson-actions {\n    display: flex;\n    justify-content: flex-end;\n    gap: 1rem;\n    margin-top: 2rem;\n  }\n\n  @media (max-width: 768px) {\n    .generated-lesson-container {\n      padding: 1rem;\n    }\n\n    .lesson-title {\n      font-size: 1.5rem;\n    }\n\n    .sections-list {\n      grid-template-columns: 1fr;\n    }\n\n    .vocabulary-list {\n      grid-template-columns: 1fr;\n    }\n\n    .lesson-actions {\n      flex-direction: column;\n    }\n  }\n</style>","// Lesson Schema for Bulgarian-German Language Learning Application\nimport { z } from 'zod';\nimport { VocabularyCategorySchemaWithFallback, VocabularyMetadataSchema, LegacyIdSchema, PartOfSpeechSchema } from './vocabulary';\n// Create a base schema without catch for omit operations\nconst VocabularyItemBaseSchema = z.object({\n    id: LegacyIdSchema,\n    german: z.string().min(1).max(100),\n    bulgarian: z.string().min(1).max(100),\n    partOfSpeech: PartOfSpeechSchema.default('noun'),\n    difficulty: z.number().min(1).max(5).default(1).describe('1-5 scale where 1 is easiest'),\n    categories: z.array(VocabularyCategorySchemaWithFallback).min(1).default(['uncategorized']),\n    metadata: VocabularyMetadataSchema.optional(),\n    createdAt: z.union([\n        z.date(),\n        z.string().datetime().transform(str => new Date(str))\n    ]).default(new Date()).transform(val => val instanceof Date ? val : new Date(val)),\n    updatedAt: z.union([\n        z.date(),\n        z.string().datetime().transform(str => new Date(str))\n    ]).default(new Date()).transform(val => val instanceof Date ? val : new Date(val)),\n    isCommon: z.boolean().default(false),\n    isVerified: z.boolean().default(false)\n});\n// Vocabulary reference schema\nexport const VocabularyReferenceSchema = z.union([\n    VocabularyItemBaseSchema.omit({ id: true }), // Use base schema for omit()\n    LegacyIdSchema,\n    z.string().uuid()\n]);\n// Lesson difficulty levels\nexport const LessonDifficultySchema = z.enum(['A1', 'A2', 'B1', 'B2', 'C1']);\n// Lesson types\nexport const LessonTypeSchema = z.enum([\n    'vocabulary', 'grammar', 'conversation', 'reading', 'listening', 'writing', 'culture', 'mixed'\n]);\n// Learning objective schema\nexport const LearningObjectiveSchema = z.object({\n    id: z.string().uuid(),\n    description: z.string().min(5).max(200),\n    isCompleted: z.boolean().default(false),\n    createdAt: z.date().default(new Date())\n});\n// Lesson metadata\nexport const LessonMetadataSchema = z.object({\n    tags: z.array(z.string()).default([]),\n    prerequisites: z.array(LegacyIdSchema).default([]),\n    relatedLessons: z.array(LegacyIdSchema).default([]),\n    isPremium: z.boolean().default(false)\n}).default({});\n// Main Lesson Schema\nexport const LessonSchema = z.object({\n    id: LegacyIdSchema,\n    title: z.string().min(3).max(100),\n    description: z.string().min(10).max(1000),\n    difficulty: LessonDifficultySchema.default('A1'),\n    type: LessonTypeSchema.default('vocabulary'),\n    duration: z.number().min(5).max(120).default(15),\n    vocabulary: z.array(VocabularyReferenceSchema).default([]),\n    objectives: z.array(LearningObjectiveSchema).default([]),\n    content: z.string().optional(),\n    isCompleted: z.boolean().default(false),\n    completionPercentage: z.number().min(0).max(100).default(0),\n    createdAt: z.union([z.date(), z.string().datetime().transform(str => new Date(str))]).default(new Date()),\n    updatedAt: z.union([z.date(), z.string().datetime().transform(str => new Date(str))]).default(new Date()),\n    metadata: LessonMetadataSchema\n}).catch((_ctx) => {\n  return {\n        id: `fallback-${Date.now()}`,\n        title: 'Invalid Lesson',\n        description: 'This lesson failed validation',\n        difficulty: 'A1',\n        type: 'vocabulary',\n        duration: 15,\n        vocabulary: [],\n        objectives: [],\n        createdAt: new Date(),\n        updatedAt: new Date(),\n        metadata: {}\n    };\n});\n//# sourceMappingURL=lesson.js.map","/**\n * Lesson Service for Bulgarian-German Language Learning Application\n *\n * This service provides comprehensive business logic for creating, managing, and delivering\n * curriculum-based lessons with robust vocabulary integration, error handling, and performance optimization.\n */\n\nimport { LessonSchema } from '../schemas/lesson';\nimport type { Lesson, LearningObjective, LessonDifficulty, LessonType } from '../schemas/lesson';\nimport type { VocabularyItem, VocabularyCategory, PartOfSpeech } from '../types/vocabulary';\nimport { vocabularyDb as db } from '../data/db.svelte.js';\n\n/**\n * Lesson Service Class\n */\nexport class LessonService {\n  private lessons: Lesson[] = [];\n  private vocabularyData: VocabularyItem[] = [];\n  private initialized = false;\n\n  constructor() {\n    // Initialize will be called explicitly to prevent SSR issues\n  }\n\n  /**\n   * Initialize the lesson service with vocabulary data\n   */\n  async initialize() {\n    if (this.initialized) return;\n\n    try {\n      await db.initialize();\n      const vocabData = await db.getVocabulary();\n      // Normalize unified vocabulary items to lesson service expectations\n      this.vocabularyData = vocabData.map((item) => ({\n        ...item,\n        categories: this.normalizeCategories(item.categories as VocabularyCategory[] | undefined),\n        metadata: (item.metadata ?? {}) as any,\n        isCommon: item.isCommon ?? false,\n        isVerified: item.isVerified ?? false,\n        learningPhase: (item as { learningPhase?: number }).learningPhase ?? 0,\n        createdAt: (item as { createdAt?: Date }).createdAt ?? new Date(),\n        updatedAt: (item as { updatedAt?: Date }).updatedAt ?? new Date(),\n        cefrLevel: this.normalizeCefrLevel((item as { cefrLevel?: LessonDifficulty | 'C1' }).cefrLevel)\n      }));\n      this.initialized = true;\n    } catch (_error) {\n      // Failed to initialize LessonService\n      this.vocabularyData = [];\n      this.initialized = false;\n      throw _error;\n    }\n  }\n\n  /**\n   * Check if service is initialized\n   */\n  isInitialized(): boolean {\n    return this.initialized;\n  }\n\n  /**\n   * Generate a lesson from specific vocabulary items\n   */\n  generateLessonFromVocabulary(\n    vocabularyItems: VocabularyItem[],\n    options: {\n      title?: string;\n      difficulty?: LessonDifficulty;\n      type?: LessonType;\n      description?: string;\n    } = {}\n  ): Lesson {\n    // Validate input\n    if (!vocabularyItems || vocabularyItems.length === 0) {\n      return this.createFallbackLesson('No vocabulary items provided');\n    }\n\n    const { title, difficulty, type = 'vocabulary', description } = options;\n\n    // Determine lesson title\n    const lessonTitle = title || this.generateLessonTitle(vocabularyItems, type);\n\n    // Determine difficulty if not provided\n    const lessonDifficulty = difficulty || this.determineLessonDifficulty(vocabularyItems);\n\n    // Create learning objectives\n    const objectives = this.createLearningObjectives(vocabularyItems, lessonDifficulty, type);\n\n    // Create the lesson\n    const lesson: Lesson = {\n      id: crypto.randomUUID(),\n      title: lessonTitle,\n      description: description || this.generateLessonDescription(vocabularyItems, lessonDifficulty, type),\n      difficulty: lessonDifficulty,\n      type,\n      duration: this.calculateLessonDuration(vocabularyItems.length),\n      vocabulary: vocabularyItems.map(item => this.normalizeVocabularyItem(item)),\n      objectives,\n      isCompleted: false,\n      completionPercentage: 0,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      metadata: {\n        tags: this.generateLessonTags(vocabularyItems, lessonDifficulty, type),\n        prerequisites: [],\n        relatedLessons: [],\n        isPremium: false\n      }\n    };\n\n    // Validate the lesson\n    return this.validateLesson(lesson);\n  }\n\n  /**\n   * Generate a lesson from criteria (difficulty, type, theme, etc.)\n   */\n  async generateLessonFromCriteria(\n    criteria: {\n      difficulty?: LessonDifficulty;\n      type?: LessonType;\n      categories?: VocabularyCategory[];\n      partOfSpeech?: PartOfSpeech;\n      limit?: number;\n      title?: string;\n      description?: string;\n    } = {}\n  ): Promise<Lesson> {\n    try {\n      // Ensure service is initialized\n      if (!this.initialized) {\n        await this.initialize();\n      }\n\n      // Query vocabulary based on criteria\n      const vocabularyItems = this.queryVocabulary(criteria);\n\n      // Apply limit if specified and normalize items for schema compatibility\n      const limitedItems = (criteria.limit\n        ? vocabularyItems.slice(0, criteria.limit)\n        : vocabularyItems).map(item => this.normalizeVocabularyItem(item));\n\n      // Generate lesson\n      return this.generateLessonFromVocabulary(limitedItems, {\n        title: criteria.title ?? 'Untitled Lesson',\n        difficulty: criteria.difficulty ?? 'A1',\n        type: criteria.type ?? 'vocabulary',\n        description: criteria.description ?? ''\n      });\n\n    } catch (_error) {\n      // Failed to generate lesson from criteria\n      return this.createFallbackLesson('Failed to generate lesson from criteria');\n    }\n  }\n\n  /**\n   * Query vocabulary based on criteria\n   */\n  private queryVocabulary(criteria: {\n    difficulty?: LessonDifficulty;\n    categories?: VocabularyCategory[];\n    partOfSpeech?: PartOfSpeech;\n    limit?: number;\n  }): VocabularyItem[] {\n    if (this.vocabularyData.length === 0) {\n      // No vocabulary data available\n      return [];\n    }\n\n    // Convert difficulty level to numeric range if provided\n    const difficultyRange = criteria.difficulty\n      ? this.getDifficultyRange(criteria.difficulty)\n      : null;\n\n    return this.vocabularyData.filter(item => {\n      // Filter by difficulty\n      const difficultyMatch = difficultyRange\n        ? item.difficulty >= difficultyRange.min && item.difficulty <= difficultyRange.max\n        : true;\n\n      // Filter by categories\n      const categoryMatch = criteria.categories && criteria.categories.length > 0\n        ? item.categories.some(category => criteria.categories?.includes(category))\n        : true;\n\n      // Filter by part of speech\n      const partOfSpeechMatch = criteria.partOfSpeech\n        ? item.partOfSpeech === criteria.partOfSpeech\n        : true;\n\n      return difficultyMatch && categoryMatch && partOfSpeechMatch;\n    });\n  }\n\n  /**\n   * Get numeric difficulty range for a CEFR level\n   */\n  private getDifficultyRange(difficulty: LessonDifficulty): { min: number; max: number } {\n    const ranges: Record<LessonDifficulty, { min: number; max: number }> = {\n      'A1': { min: 1, max: 1.5 },\n      'A2': { min: 1.5, max: 2.5 },\n      'B1': { min: 2.5, max: 3.5 },\n      'B2': { min: 3.5, max: 4.5 },\n      'C1': { min: 4.5, max: 5 }\n    };\n    return ranges[difficulty];\n  }\n\n  private normalizeCefrLevel(level?: LessonDifficulty | 'C1'): LessonDifficulty {\n    if (level === 'A1' || level === 'A2' || level === 'B1' || level === 'B2') {\n      return level;\n    }\n    return 'A1';\n  }\n\n  /**\n   * Generate a lesson title based on vocabulary content\n   */\n  private generateLessonTitle(vocabularyItems: VocabularyItem[], type: LessonType): string {\n    if (vocabularyItems.length === 0) return 'New Lesson';\n\n    // Extract unique categories\n    const categories = new Set<VocabularyCategory>();\n    vocabularyItems.forEach(item => {\n      this.normalizeCategories(item.categories).forEach(category => categories.add(category));\n    });\n\n    // Determine lesson type name\n    const typeNames: Record<LessonType, string> = {\n      'vocabulary': 'Vocabulary',\n      'grammar': 'Grammar',\n      'conversation': 'Conversation',\n      'reading': 'Reading',\n      'listening': 'Listening',\n      'writing': 'Writing',\n      'culture': 'Culture',\n      'mixed': 'Mixed Topics',\n      'contextual': 'Contextual'\n    };\n\n    const typeName = typeNames[type] || 'Lesson';\n\n    // If single category, use it in the title\n    if (categories.size === 1) {\n      const categoryEntry = categories.values().next();\n      if (!categoryEntry.done) {\n        return `${typeName}: ${this.getCategoryDisplayName(categoryEntry.value)}`;\n      }\n    }\n\n    // If multiple categories, use a generic title\n    return `${typeName} Lesson (${vocabularyItems.length} items)`;\n  }\n\n  /**\n   * Generate a lesson description\n   */\n  private generateLessonDescription(\n    vocabularyItems: VocabularyItem[],\n    difficulty: LessonDifficulty,\n    type: LessonType\n  ): string {\n    const typeDescriptions: Record<LessonType, string> = {\n      'vocabulary': 'vocabulary building',\n      'grammar': 'grammar concepts',\n      'conversation': 'conversation practice',\n      'reading': 'reading comprehension',\n      'listening': 'listening skills',\n      'writing': 'writing practice',\n      'culture': 'cultural insights',\n      'mixed': 'various language skills',\n      'contextual': 'contextual usage'\n    };\n\n    const partsOfSpeech = new Set<PartOfSpeech>();\n    vocabularyItems.forEach(item => partsOfSpeech.add(item.partOfSpeech));\n\n    const partOfSpeechList = Array.from(partsOfSpeech)\n      .map(pos => this.getPartOfSpeechDisplayName(pos))\n      .join(', ');\n\n    return `This ${difficulty} level lesson focuses on ${typeDescriptions[type]} with ${vocabularyItems.length} vocabulary items covering ${partOfSpeechList}.`;\n  }\n\n  /**\n   * Calculate lesson duration based on number of vocabulary items\n   */\n  private calculateLessonDuration(itemCount: number): number {\n    // Base duration: 2 minutes per item\n    const baseDuration = itemCount * 2;\n\n    // Add buffer time for lessons with many items\n    if (itemCount > 15) {\n      return Math.min(baseDuration + 10, 120); // Max 120 minutes\n    } else if (itemCount > 10) {\n      return baseDuration + 5;\n    } else {\n      return Math.max(baseDuration, 15); // Minimum 15 minutes\n    }\n  }\n\n  /**\n   * Create learning objectives for a lesson\n   */\n  private createLearningObjectives(\n    vocabularyItems: VocabularyItem[],\n    difficulty: LessonDifficulty,\n    type: LessonType\n  ): LearningObjective[] {\n    const objectives: LearningObjective[] = [];\n\n    // Base objectives\n    objectives.push({\n      id: crypto.randomUUID(),\n      description: `Learn ${vocabularyItems.length} new vocabulary items at ${difficulty} level`,\n      isCompleted: false,\n      createdAt: new Date()\n    });\n\n    // Type-specific objectives\n    const typeObjectives: Record<LessonType, string> = {\n      'vocabulary': 'Practice using new vocabulary in context',\n      'grammar': 'Understand and apply grammar concepts',\n      'conversation': 'Engage in conversation using learned vocabulary',\n      'reading': 'Read and comprehend texts using learned vocabulary',\n      'listening': 'Listen and understand spoken language at this level',\n      'writing': 'Write sentences or paragraphs using learned vocabulary',\n      'culture': 'Understand cultural context of vocabulary',\n      'mixed': 'Practice various language skills at this level',\n      'contextual': 'Use vocabulary in specific contexts'\n    };\n\n    objectives.push({\n      id: crypto.randomUUID(),\n      description: typeObjectives[type],\n      isCompleted: false,\n      createdAt: new Date()\n    });\n\n    // Difficulty-specific objectives\n    if (difficulty === 'A1' || difficulty === 'A2') {\n      objectives.push({\n        id: crypto.randomUUID(),\n        description: 'Recognize basic words and phrases in context',\n        isCompleted: false,\n        createdAt: new Date()\n      });\n    } else if (difficulty === 'B1' || difficulty === 'B2') {\n      objectives.push({\n        id: crypto.randomUUID(),\n        description: 'Use vocabulary in complete sentences and questions',\n        isCompleted: false,\n        createdAt: new Date()\n      });\n    } else {\n      objectives.push({\n        id: crypto.randomUUID(),\n        description: 'Use advanced vocabulary in complex sentences and discussions',\n        isCompleted: false,\n        createdAt: new Date()\n      });\n    }\n\n    return objectives;\n  }\n\n  /**\n   * Generate tags for a lesson\n   */\n  private generateLessonTags(\n    vocabularyItems: VocabularyItem[],\n    difficulty: LessonDifficulty,\n    type: LessonType\n  ): string[] {\n    const tags: string[] = [type, difficulty];\n\n    // Add categories as tags\n    const categories = new Set<VocabularyCategory>();\n    vocabularyItems.forEach(item => {\n      this.normalizeCategories(item.categories).forEach(category => categories.add(category));\n    });\n\n    // Add up to 3 categories as tags\n    Array.from(categories).slice(0, 3).forEach(category => {\n      tags.push(this.getCategoryDisplayName(category));\n    });\n\n    return tags;\n  }\n\n  /**\n   * Get display name for a vocabulary category\n   */\n  public getCategoryDisplayName(category: VocabularyCategory): string {\n    const displayNames: Record<VocabularyCategory, string> = {\n      'greetings': 'Greetings',\n      'numbers': 'Numbers',\n      'family': 'Family',\n      'food': 'Food',\n      'colors': 'Colors',\n      'animals': 'Animals',\n      'body-parts': 'Body Parts',\n      'clothing': 'Clothing',\n      'home': 'House & Home',\n      'nature': 'Nature',\n      'transport': 'Transportation',\n      'technology': 'Technology',\n      'time': 'Time & Date',\n      'weather': 'Weather',\n      'professions': 'Professions',\n      'places': 'Places',\n      'grammar': 'Grammar',\n      'culture': 'Culture',\n      'everyday-phrases': 'Everyday Phrases'\n    };\n\n    return displayNames[category] || category;\n  }\n\n  /**\n   * Get display name for part of speech\n   */\n  private getPartOfSpeechDisplayName(partOfSpeech: PartOfSpeech): string {\n    const displayNames: Record<PartOfSpeech, string> = {\n      'noun': 'Nouns',\n      'verb': 'Verbs',\n      'adjective': 'Adjectives',\n      'adverb': 'Adverbs',\n      'pronoun': 'Pronouns',\n      'preposition': 'Prepositions',\n      'conjunction': 'Conjunctions',\n      'interjection': 'Interjections',\n      'article': 'Articles',\n      'number': 'Numbers',\n      'phrase': 'Phrases',\n      'expression': 'Expressions'\n    };\n\n    return displayNames[partOfSpeech] || partOfSpeech;\n  }\n\n  /**\n   * Coerce category strings into the schema-backed category union\n   */\n  private normalizeCategories(categories?: VocabularyCategory[] | string[]): VocabularyCategory[] {\n    const allowed: VocabularyCategory[] = [\n      'greetings',\n      'numbers',\n      'family',\n      'food',\n      'colors',\n      'animals',\n      'body-parts',\n      'clothing',\n      'home',\n      'nature',\n      'transport',\n      'technology',\n      'time',\n      'weather',\n      'professions',\n      'places',\n      'grammar',\n      'culture',\n      'everyday-phrases'\n    ];\n\n    if (!categories || categories.length === 0) {\n      return ['culture'];\n    }\n\n    const normalized = categories\n      .map(category => (allowed.includes(category as VocabularyCategory) ? (category as VocabularyCategory) : 'culture'))\n      .filter(Boolean) as VocabularyCategory[];\n\n    return normalized.length > 0 ? normalized : ['culture'];\n  }\n\n  /**\n   * Align vocabulary items with LessonSchema requirements\n   */\n  private normalizeVocabularyItem(item: VocabularyItem): VocabularyItem {\n    return {\n      ...item,\n      categories: this.normalizeCategories(item.categories),\n      metadata: (item.metadata ?? {}) as any,\n      isCommon: item.isCommon ?? false,\n      isVerified: item.isVerified ?? false,\n      learningPhase: item.learningPhase ?? 0,\n      createdAt: item.createdAt ?? new Date(),\n      updatedAt: item.updatedAt ?? new Date(),\n      cefrLevel: item.cefrLevel ?? 'A1'\n    };\n  }\n\n  /**\n   * Determine lesson difficulty based on vocabulary items\n   */\n  private determineLessonDifficulty(vocabularyItems: VocabularyItem[]): LessonDifficulty {\n    if (vocabularyItems.length === 0) return 'A1';\n\n    const totalDifficulty = vocabularyItems.reduce((sum, item) => sum + item.difficulty, 0);\n    const avgDifficulty = totalDifficulty / vocabularyItems.length;\n\n    if (avgDifficulty <= 1.5) return 'A1';\n    if (avgDifficulty <= 2.5) return 'A2';\n    if (avgDifficulty <= 3.5) return 'B1';\n    if (avgDifficulty <= 4.5) return 'B2';\n    return 'C1';\n  }\n\n  /**\n   * Validate a lesson against the schema\n   */\n  private validateLesson(lesson: Lesson): Lesson {\n    const result = LessonSchema.safeParse(lesson);\n    if (result.success) {\n      return result.data;\n    } else {\n      // Lesson validation failed\n      return this.createFallbackLesson('Lesson validation failed');\n    }\n  }\n\n  /**\n   * Create a fallback lesson when validation or generation fails\n   */\n  private createFallbackLesson(_errorMessage: string): Lesson {\n    // Creating fallback lesson\n\n    return {\n      id: `fallback-${Date.now()}-${crypto.randomUUID()}`,\n      title: 'Lesson Unavailable',\n      description: 'This lesson could not be generated. Please try again later.',\n      difficulty: 'A1',\n      type: 'vocabulary',\n      duration: 15,\n      vocabulary: [],\n      objectives: [\n        {\n          id: crypto.randomUUID(),\n          description: 'Lesson generation failed - please try again',\n          isCompleted: false,\n          createdAt: new Date()\n        }\n      ],\n      isCompleted: false,\n      completionPercentage: 0,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      metadata: {\n        tags: ['error'],\n        prerequisites: [],\n        relatedLessons: [],\n        isPremium: false\n      }\n    };\n  }\n\n  /**\n   * Get all lessons\n   */\n  getLessons(): Lesson[] {\n    return this.lessons;\n  }\n\n  /**\n   * Get a specific lesson by ID\n   */\n  getLessonById(id: string): Lesson | undefined {\n    return this.lessons.find(lesson => lesson.id === id);\n  }\n\n  /**\n   * Add a lesson to the collection\n   */\n  addLesson(lesson: Lesson): void {\n    const validatedLesson = this.validateLesson(lesson);\n    this.lessons.push(validatedLesson);\n  }\n\n  /**\n   * Update a lesson\n   */\n  updateLesson(id: string, updates: Partial<Lesson>): Lesson | undefined {\n    const index = this.lessons.findIndex(lesson => lesson.id === id);\n    if (index === -1) return undefined;\n\n    const currentLesson = this.lessons[index];\n    const baseLesson = {\n      ...currentLesson,\n      ...updates,\n      updatedAt: new Date()\n    };\n\n    const updatedLesson = {\n      ...baseLesson,\n      id: baseLesson.id ?? `lesson_${Date.now()}`,\n      title: baseLesson.title ?? 'Untitled',\n      description: baseLesson.description ?? '',\n      difficulty: (baseLesson.difficulty ?? 'A1') as 'A1' | 'A2' | 'B1' | 'B2' | 'C1',\n      type: (baseLesson.type ?? 'vocabulary') as LessonType,\n      vocabulary: baseLesson.vocabulary ?? [],\n      duration: baseLesson.duration ?? 0,\n      objectives: baseLesson.objectives ?? [],\n      isCompleted: baseLesson.isCompleted ?? false,\n      completionPercentage: baseLesson.completionPercentage ?? 0\n    };\n\n    const validatedLesson = this.validateLesson(updatedLesson as Lesson);\n    this.lessons[index] = validatedLesson;\n    return validatedLesson;\n  }\n\n  /**\n   * Remove a lesson\n   */\n  removeLesson(id: string): boolean {\n    const initialLength = this.lessons.length;\n    this.lessons = this.lessons.filter(lesson => lesson.id !== id);\n    return this.lessons.length !== initialLength;\n  }\n\n  /**\n   * Get lessons by difficulty level\n   */\n  getLessonsByDifficulty(difficulty: LessonDifficulty): Lesson[] {\n    return this.lessons.filter(lesson => lesson.difficulty === difficulty);\n  }\n\n  /**\n   * Get lessons by type\n   */\n  getLessonsByType(type: LessonType): Lesson[] {\n    return this.lessons.filter(lesson => lesson.type === type);\n  }\n\n  /**\n   * Get lessons by tag\n   */\n  getLessonsByTag(tag: string): Lesson[] {\n    return this.lessons.filter(lesson =>\n      lesson.metadata.tags.includes(tag)\n    );\n  }\n\n  /**\n   * Get random lessons for recommendation\n   */\n  getRandomLessons(count: number = 3): Lesson[] {\n    if (this.lessons.length === 0) return [];\n\n    // Shuffle array and take first N items\n    const shuffled = [...this.lessons].sort(() => 0.5 - Math.random());\n    return shuffled.slice(0, Math.min(count, this.lessons.length));\n  }\n}\n\n// Export a singleton instance\nexport const lessonService = new LessonService();","/**\n * EnhancedLessonService - Extends the base LessonService to support dynamic lesson generation\n * while maintaining backward compatibility with existing functionality.\n *\n * This service integrates with the LessonGenerationEngine to provide dynamic lesson creation\n * based on templates, vocabulary, grammar concepts, and cultural context.\n */\nimport { lessonService } from './lesson';\nimport { lessonGenerationEngine } from './lesson-generation/lesson-generator';\nimport type { LessonGenerationParams, GeneratedLesson, EnhancedLessonCriteria } from './lesson-generation/types';\nimport { isLessonDifficulty, isLessonType } from './lesson-generation/types';\nimport type { Lesson, LearningObjective, LessonType, LessonDifficulty } from '../schemas/lesson';\nimport type { VocabularyItem, VocabularyCategory } from '../types/vocabulary';\nimport { v4 as uuidv4 } from 'uuid';\n\nclass EnhancedLessonService {\n  private initialized = false;\n\n  /**\n   * Initialize the service\n   */\n  async initialize(): Promise<void> {\n    await lessonService.initialize();\n    this.initialized = true;\n  }\n\n  /**\n   * Check if the service is initialized\n   */\n  isInitialized(): boolean {\n    return this.initialized;\n  }\n\n  /**\n   * Generate a dynamic lesson based on the provided parameters\n   * @param params Lesson generation parameters\n   * @returns Generated lesson in standard Lesson format\n   */\n  async generateDynamicLesson(params: LessonGenerationParams): Promise<Lesson> {\n    try {\n      // Validate parameters\n      const validatedParams = this.validateLessonGenerationParams(params);\n\n      // Generate the lesson using the LessonGenerationEngine\n      const generatedLesson = await lessonGenerationEngine.generateLesson(validatedParams);\n\n      // Convert the generated lesson to the standard Lesson format\n      return this.convertGeneratedLessonToLesson(generatedLesson);\n    } catch (_error) {\n      // Error handling is done by returning a fallback lesson\n      return this.createFallbackLesson(params.type || 'vocabulary', params.difficulty || 'A1');\n    }\n  }\n\n  /**\n   * Generate a thematic lesson focused on specific vocabulary categories\n   * @param categories Array of vocabulary categories\n   * @param difficulty Lesson difficulty level\n   * @param options Additional options for lesson generation\n   * @returns Generated lesson in standard Lesson format\n   */\n  async generateThematicLesson(categories: VocabularyCategory[], difficulty: string, options?: { includePractice?: boolean; includeReview?: boolean }): Promise<Lesson> {\n    const validatedDifficulty = isLessonDifficulty(difficulty) ? difficulty : 'A1';\n    const params: LessonGenerationParams = {\n      userId: 'default',\n      type: 'vocabulary',\n      difficulty: validatedDifficulty,\n      criteria: { categories },\n      metadata: {\n        includePractice: options?.includePractice ?? true,\n        includeReview: options?.includeReview ?? false\n      }\n    };\n\n    return this.generateDynamicLesson(params);\n  }\n\n  /**\n   * Generate a grammar lesson focused on a specific grammar concept\n   * @param conceptType Grammar concept type\n   * @param difficulty Lesson difficulty level\n   * @param options Additional options for lesson generation\n   * @returns Generated lesson in standard Lesson format\n   */\n  async generateGrammarLesson(conceptType: string, difficulty: string, options?: { includePractice?: boolean; includeComparison?: boolean }): Promise<Lesson> {\n    const validatedDifficulty = isLessonDifficulty(difficulty) ? difficulty : 'A1';\n    const params: LessonGenerationParams = {\n      userId: 'default',\n      type: 'grammar',\n      difficulty: validatedDifficulty,\n      criteria: { conceptType },\n      metadata: {\n        includePractice: options?.includePractice ?? true,\n        includeComparison: options?.includeComparison ?? false\n      }\n    };\n\n    return this.generateDynamicLesson(params);\n  }\n\n  /**\n   * Generate a mixed lesson combining vocabulary and grammar\n   * @param category Vocabulary category\n   * @param difficulty Lesson difficulty level\n   * @param options Additional options for lesson generation\n   * @returns Generated lesson in standard Lesson format\n   */\n  async generateMixedLesson(category: VocabularyCategory, difficulty: string, options?: { includePractice?: boolean; includeReview?: boolean }): Promise<Lesson> {\n    const validatedDifficulty = isLessonDifficulty(difficulty) ? difficulty : 'A1';\n    const params: LessonGenerationParams = {\n      userId: 'default',\n      type: 'mixed',\n      difficulty: validatedDifficulty,\n      criteria: { categories: [category] },\n      metadata: {\n        includePractice: options?.includePractice ?? true,\n        includeReview: options?.includeReview ?? false\n      }\n    };\n\n    return this.generateDynamicLesson(params);\n  }\n\n  /**\n   * Validate lesson generation parameters and provide defaults for invalid values\n   * @param params Lesson generation parameters\n   * @returns Validated parameters with defaults applied\n   */\n  private validateLessonGenerationParams(params: LessonGenerationParams): LessonGenerationParams {\n    // Default values\n    const defaults = {\n      userId: 'default',\n      type: 'vocabulary' as const,\n      difficulty: 'A1' as const,\n      criteria: {},\n      metadata: {}\n    };\n\n    // Validate and apply defaults\n    const validatedParams: LessonGenerationParams = {\n      userId: params.userId || defaults.userId,\n      type: (['vocabulary', 'grammar', 'mixed', 'culture', 'contextual'] as const).includes(params.type as any) ? params.type : defaults.type,\n      difficulty: (['A1', 'A2', 'B1', 'B2', 'C1'] as const).includes(params.difficulty as any) ? params.difficulty : defaults.difficulty,\n      criteria: params.criteria || defaults.criteria,\n      metadata: params.metadata || defaults.metadata\n    };\n\n    return validatedParams;\n  }\n\n  /**\n   * Convert a GeneratedLesson to the standard Lesson format\n   * @param generatedLesson The lesson generated by the LessonGenerationEngine\n   * @returns Lesson in standard format\n   */\n  private convertGeneratedLessonToLesson(generatedLesson: GeneratedLesson): Lesson {\n    // Converting generated lesson to standard format\n\n    // Note: Lesson schema does NOT have sections field\n    // Convert sections to content string instead\n    const sectionContent = generatedLesson.sections\n      .map(section => `## ${section.title || section.type}\\n${section.content || ''}`)\n      .join('\\n\\n');\n\n    // Convert learning objectives\n    const objectives: LearningObjective[] = generatedLesson.learningObjectives.map(objective => ({\n      id: uuidv4(),\n      description: objective,\n      isCompleted: false,\n      createdAt: new Date()\n    }));\n\n    // Calculate duration (5 minutes per section + 5 minutes buffer)\n    const duration = generatedLesson.sections.length * 5 + 5;\n\n    // Generate tags\n    const tags = this.generateLessonTags(generatedLesson);\n\n    // Create the lesson object\n    const lesson: Lesson = {\n      id: generatedLesson.id,\n      title: generatedLesson.title,\n      description: this.generateLessonDescription(generatedLesson),\n      difficulty: this.normalizeDifficulty(generatedLesson.difficulty),\n      type: this.normalizeLessonType(generatedLesson.type),\n      duration,\n      vocabulary: this.normalizeVocabulary(generatedLesson.vocabulary || []),\n      objectives,\n      content: sectionContent || this.generateLessonDescription(generatedLesson),\n      isCompleted: false,\n      completionPercentage: 0,\n      createdAt: generatedLesson.createdAt || new Date(),\n      updatedAt: generatedLesson.updatedAt || new Date(),\n      metadata: {\n        tags,\n        prerequisites: [],\n        relatedLessons: [],\n        isPremium: false,\n        ...generatedLesson.metadata\n      }\n    };\n\n    // Lesson object created successfully\n    return lesson;\n  }\n\n  /**\n   * Generate appropriate tags for the lesson\n   * @param generatedLesson The generated lesson\n   * @returns Array of tags\n   */\n  private generateLessonTags(generatedLesson: GeneratedLesson): string[] {\n    const tags: string[] = [];\n\n    // Add basic type and difficulty tags\n    tags.push(generatedLesson.type);\n    tags.push(generatedLesson.difficulty);\n\n    // Add grammar concept names if available\n    if (generatedLesson.grammarConcepts && generatedLesson.grammarConcepts.length > 0) {\n      generatedLesson.grammarConcepts.forEach(concept => {\n        if (concept.name?.german) {\n          tags.push(concept.name.german);\n        }\n      });\n    }\n\n    // Add vocabulary categories if available\n    if (generatedLesson.vocabulary && generatedLesson.vocabulary.length > 0) {\n      const categories = new Set<string>();\n      generatedLesson.vocabulary.forEach(vocab => {\n        if (vocab.categories) {\n          vocab.categories.forEach(category => {\n            // Add both display name and raw category name\n            const displayName = lessonService.getCategoryDisplayName(category);\n            categories.add(displayName);\n            categories.add(category); // Add raw category name as well\n          });\n        }\n      });\n      tags.push(...Array.from(categories));\n    }\n\n    return tags;\n  }\n\n  /**\n   * Generate a meaningful description for the lesson\n   * @param generatedLesson The generated lesson\n   * @returns Lesson description\n   */\n  private generateLessonDescription(generatedLesson: GeneratedLesson): string {\n    const difficultyMap: Record<string, string> = {\n      'A1': 'beginner',\n      'A2': 'elementary',\n      'B1': 'intermediate',\n      'B2': 'upper intermediate',\n      'C1': 'advanced'\n    };\n\n    const typeMap: Record<string, string> = {\n      'vocabulary': 'vocabulary building',\n      'grammar': 'grammar concepts',\n      'mixed': 'various language skills',\n      'contextual': 'contextual learning'\n    };\n\n    const difficultyLevel = difficultyMap[generatedLesson.difficulty] || 'beginner';\n    const focusArea = typeMap[generatedLesson.type] || 'language learning';\n\n    // Count vocabulary items\n    const vocabCount = generatedLesson.vocabulary?.length || 0;\n\n    // List grammar concepts\n    let grammarConceptsText = '';\n    if (generatedLesson.grammarConcepts && generatedLesson.grammarConcepts.length > 0) {\n      const conceptNames = generatedLesson.grammarConcepts\n        .map(concept => concept.name?.german || concept.id)\n        .join(', ');\n      grammarConceptsText = `. It covers grammar concepts including ${conceptNames}.`;\n    }\n\n    return `This ${difficultyLevel} level lesson focuses on ${focusArea} with ${vocabCount} vocabulary items${grammarConceptsText}`;\n  }\n\n  private normalizeLessonType(type: LessonType | 'contextual' | undefined): LessonType {\n    if (type === 'vocabulary' || type === 'grammar' || type === 'conversation' || type === 'reading' || type === 'listening' || type === 'writing' || type === 'culture' || type === 'mixed') {\n      return type;\n    }\n    return 'mixed';\n  }\n\n  private normalizeDifficulty(difficulty: LessonDifficulty | undefined): LessonDifficulty {\n    if (difficulty === 'A1' || difficulty === 'A2' || difficulty === 'B1' || difficulty === 'B2' || difficulty === 'C1') {\n      return difficulty;\n    }\n    return 'A1';\n  }\n\n  private normalizeVocabulary(items: VocabularyItem[]): VocabularyItem[] {\n    return items.map(item => ({\n      ...item,\n      isCommon: item.isCommon ?? false,\n      isVerified: item.isVerified ?? false,\n      learningPhase: item.learningPhase ?? 0,\n      categories: item.categories ?? [],\n      metadata: (item.metadata ?? {}) as any\n    }));\n  }\n\n  /**\n   * Create a fallback lesson when generation fails\n   * @param type Lesson type\n   * @param difficulty Lesson difficulty\n   * @returns Fallback lesson\n   */\n  private createFallbackLesson(type: string, difficulty: string): Lesson {\n    return {\n      id: `fallback-lesson-${uuidv4()}`,\n      title: 'Lesson Unavailable',\n      description: 'Dynamic lesson generation failed. Please try again or select a different lesson.',\n      difficulty: isLessonDifficulty(difficulty) ? difficulty : 'A1',\n      type: isLessonType(type) ? type : 'vocabulary',\n      duration: 10,\n      vocabulary: [],\n      objectives: [],\n      isCompleted: false,\n      completionPercentage: 0,\n      createdAt: new Date(),\n      updatedAt: new Date(),\n      metadata: {\n        tags: [type, difficulty],\n        prerequisites: [],\n        relatedLessons: [],\n        isPremium: false\n      }\n    };\n  }\n\n  // Proxy methods for backward compatibility with existing LessonService\n  getLessons() {\n    return lessonService.getLessons() || [];\n  }\n\n  getLessonById(id: string) {\n    return lessonService.getLessonById(id);\n  }\n\n  generateLessonFromVocabulary(vocabularyItems: VocabularyItem[]) {\n    return lessonService.generateLessonFromVocabulary(vocabularyItems);\n  }\n\n  async generateLessonFromCriteria(criteria: EnhancedLessonCriteria) {\n    const normalizedCriteria = {\n      ...criteria,\n      type: criteria.type ? this.normalizeLessonType(criteria.type) : undefined,\n      difficulty: criteria.difficulty ? this.normalizeDifficulty(criteria.difficulty as LessonDifficulty) : undefined,\n      categories: criteria.categories as VocabularyCategory[] | undefined\n    };\n\n    const result = await lessonService.generateLessonFromCriteria(normalizedCriteria as any);\n    return result || this.createFallbackLesson('vocabulary', 'A1');\n  }\n\n  getLessonsByDifficulty(difficulty: string) {\n    if (isLessonDifficulty(difficulty)) {\n      return lessonService.getLessonsByDifficulty(difficulty) || [];\n    }\n    return [];\n  }\n\n  getLessonsByType(type: string) {\n    if (isLessonType(type)) {\n      return lessonService.getLessonsByType(type) || [];\n    }\n    return [];\n  }\n\n  getLessonsByTag(tag: string) {\n    return lessonService.getLessonsByTag(tag) || [];\n  }\n\n  getRandomLessons(count: number) {\n    return lessonService.getRandomLessons(count) || [];\n  }\n\n  addLesson(lesson: Lesson) {\n    return lessonService.addLesson(lesson);\n  }\n\n  updateLesson(id: string, updates: Partial<Lesson>) {\n    return lessonService.updateLesson(id, updates);\n  }\n\n  removeLesson(id: string) {\n    return lessonService.removeLesson(id);\n  }\n}\n\n// Export a singleton instance\nexport const enhancedLessonService = new EnhancedLessonService();","export function isFunction(value) {\n    return typeof value === \"function\";\n}\nexport function isObject(value) {\n    return value !== null && typeof value === \"object\";\n}\nconst CLASS_VALUE_PRIMITIVE_TYPES = [\"string\", \"number\", \"bigint\", \"boolean\"];\nexport function isClassValue(value) {\n    // handle primitive types\n    if (value === null || value === undefined)\n        return true;\n    if (CLASS_VALUE_PRIMITIVE_TYPES.includes(typeof value))\n        return true;\n    // handle arrays (ClassArray)\n    if (Array.isArray(value))\n        return value.every((item) => isClassValue(item));\n    // handle objects (ClassDictionary)\n    if (typeof value === \"object\") {\n        // ensure it's a plain object and not some other object type\n        if (Object.getPrototypeOf(value) !== Object.prototype)\n            return false;\n        return true;\n    }\n    return false;\n}\n","import { isFunction, isObject } from \"../utils/is.js\";\nexport const BoxSymbol = Symbol(\"box\");\nexport const isWritableSymbol = Symbol(\"is-writable\");\nfunction boxWith(getter, setter) {\n    const derived = $derived.by(getter);\n    if (setter) {\n        return {\n            [BoxSymbol]: true,\n            [isWritableSymbol]: true,\n            get current() {\n                return derived;\n            },\n            set current(v) {\n                setter(v);\n            }\n        };\n    }\n    return {\n        [BoxSymbol]: true,\n        get current() {\n            return getter();\n        }\n    };\n}\n/**\n * @returns Whether the value is a Box\n *\n * @see {@link https://runed.dev/docs/functions/box}\n */\nfunction isBox(value) {\n    return isObject(value) && BoxSymbol in value;\n}\n/**\n * @returns Whether the value is a WritableBox\n *\n * @see {@link https://runed.dev/docs/functions/box}\n */\nfunction isWritableBox(value) {\n    return isBox(value) && isWritableSymbol in value;\n}\nfunction boxFrom(value) {\n    if (isBox(value))\n        return value;\n    if (isFunction(value))\n        return boxWith(value);\n    return simpleBox(value);\n}\n/**\n * Function that gets an object of boxes, and returns an object of reactive values\n *\n * @example\n * const count = box(0)\n * const flat = box.flatten({ count, double: box.with(() => count.current) })\n * // type of flat is { count: number, readonly double: number }\n *\n * @see {@link https://runed.dev/docs/functions/box}\n */\nfunction boxFlatten(boxes) {\n    return Object.entries(boxes).reduce((acc, [key, b]) => {\n        if (!isBox(b)) {\n            return Object.assign(acc, { [key]: b });\n        }\n        if (isWritableBox(b)) {\n            Object.defineProperty(acc, key, {\n                get() {\n                    return b.current;\n                },\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n                set(v) {\n                    b.current = v;\n                }\n            });\n        }\n        else {\n            Object.defineProperty(acc, key, {\n                get() {\n                    return b.current;\n                }\n            });\n        }\n        return acc;\n    }, {});\n}\n/**\n * Function that converts a box to a readonly box.\n *\n * @example\n * const count = box(0) // WritableBox<number>\n * const countReadonly = box.readonly(count) // ReadableBox<number>\n *\n * @see {@link https://runed.dev/docs/functions/box}\n */\nfunction toReadonlyBox(b) {\n    if (!isWritableBox(b))\n        return b;\n    return {\n        [BoxSymbol]: true,\n        get current() {\n            return b.current;\n        }\n    };\n}\nfunction simpleBox(initialValue) {\n    let current = $state(initialValue);\n    return {\n        [BoxSymbol]: true,\n        [isWritableSymbol]: true,\n        get current() {\n            return current;\n        },\n        set current(v) {\n            current = v;\n        }\n    };\n}\nexport { boxWith, isBox, isWritableBox, boxFrom, boxFlatten, toReadonlyBox, simpleBox };\n","/**\n * Composes event handlers into a single function that can be called with an event.\n * If the previous handler cancels the event using `event.preventDefault()`, the handlers\n * that follow will not be called.\n */\nexport function composeHandlers(...handlers) {\n    return function (e) {\n        for (const handler of handlers) {\n            if (!handler)\n                continue;\n            if (e.defaultPrevented)\n                return;\n            if (typeof handler === \"function\") {\n                handler.call(this, e);\n            }\n            else {\n                handler.current?.call(this, e);\n            }\n        }\n    };\n}\n","// http://www.w3.org/TR/CSS21/grammar.html\n// https://github.com/visionmedia/css-parse/pull/49#issuecomment-30088027\nvar COMMENT_REGEX = /\\/\\*[^*]*\\*+([^/*][^*]*\\*+)*\\//g;\n\nvar NEWLINE_REGEX = /\\n/g;\nvar WHITESPACE_REGEX = /^\\s*/;\n\n// declaration\nvar PROPERTY_REGEX = /^(\\*?[-#/*\\\\\\w]+(\\[[0-9a-z_-]+\\])?)\\s*/;\nvar COLON_REGEX = /^:\\s*/;\nvar VALUE_REGEX = /^((?:'(?:\\\\'|.)*?'|\"(?:\\\\\"|.)*?\"|\\([^)]*?\\)|[^};])+)/;\nvar SEMICOLON_REGEX = /^[;\\s]*/;\n\n// https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String/Trim#Polyfill\nvar TRIM_REGEX = /^\\s+|\\s+$/g;\n\n// strings\nvar NEWLINE = '\\n';\nvar FORWARD_SLASH = '/';\nvar ASTERISK = '*';\nvar EMPTY_STRING = '';\n\n// types\nvar TYPE_COMMENT = 'comment';\nvar TYPE_DECLARATION = 'declaration';\n\n/**\n * @param {String} style\n * @param {Object} [options]\n * @return {Object[]}\n * @throws {TypeError}\n * @throws {Error}\n */\nfunction index (style, options) {\n  if (typeof style !== 'string') {\n    throw new TypeError('First argument must be a string');\n  }\n\n  if (!style) return [];\n\n  options = options || {};\n\n  /**\n   * Positional.\n   */\n  var lineno = 1;\n  var column = 1;\n\n  /**\n   * Update lineno and column based on `str`.\n   *\n   * @param {String} str\n   */\n  function updatePosition(str) {\n    var lines = str.match(NEWLINE_REGEX);\n    if (lines) lineno += lines.length;\n    var i = str.lastIndexOf(NEWLINE);\n    column = ~i ? str.length - i : column + str.length;\n  }\n\n  /**\n   * Mark position and patch `node.position`.\n   *\n   * @return {Function}\n   */\n  function position() {\n    var start = { line: lineno, column: column };\n    return function (node) {\n      node.position = new Position(start);\n      whitespace();\n      return node;\n    };\n  }\n\n  /**\n   * Store position information for a node.\n   *\n   * @constructor\n   * @property {Object} start\n   * @property {Object} end\n   * @property {undefined|String} source\n   */\n  function Position(start) {\n    this.start = start;\n    this.end = { line: lineno, column: column };\n    this.source = options.source;\n  }\n\n  /**\n   * Non-enumerable source string.\n   */\n  Position.prototype.content = style;\n\n  /**\n   * Error `msg`.\n   *\n   * @param {String} msg\n   * @throws {Error}\n   */\n  function error(msg) {\n    var err = new Error(\n      options.source + ':' + lineno + ':' + column + ': ' + msg\n    );\n    err.reason = msg;\n    err.filename = options.source;\n    err.line = lineno;\n    err.column = column;\n    err.source = style;\n\n    if (options.silent) ; else {\n      throw err;\n    }\n  }\n\n  /**\n   * Match `re` and return captures.\n   *\n   * @param {RegExp} re\n   * @return {undefined|Array}\n   */\n  function match(re) {\n    var m = re.exec(style);\n    if (!m) return;\n    var str = m[0];\n    updatePosition(str);\n    style = style.slice(str.length);\n    return m;\n  }\n\n  /**\n   * Parse whitespace.\n   */\n  function whitespace() {\n    match(WHITESPACE_REGEX);\n  }\n\n  /**\n   * Parse comments.\n   *\n   * @param {Object[]} [rules]\n   * @return {Object[]}\n   */\n  function comments(rules) {\n    var c;\n    rules = rules || [];\n    while ((c = comment())) {\n      if (c !== false) {\n        rules.push(c);\n      }\n    }\n    return rules;\n  }\n\n  /**\n   * Parse comment.\n   *\n   * @return {Object}\n   * @throws {Error}\n   */\n  function comment() {\n    var pos = position();\n    if (FORWARD_SLASH != style.charAt(0) || ASTERISK != style.charAt(1)) return;\n\n    var i = 2;\n    while (\n      EMPTY_STRING != style.charAt(i) &&\n      (ASTERISK != style.charAt(i) || FORWARD_SLASH != style.charAt(i + 1))\n    ) {\n      ++i;\n    }\n    i += 2;\n\n    if (EMPTY_STRING === style.charAt(i - 1)) {\n      return error('End of comment missing');\n    }\n\n    var str = style.slice(2, i - 2);\n    column += 2;\n    updatePosition(str);\n    style = style.slice(i);\n    column += 2;\n\n    return pos({\n      type: TYPE_COMMENT,\n      comment: str\n    });\n  }\n\n  /**\n   * Parse declaration.\n   *\n   * @return {Object}\n   * @throws {Error}\n   */\n  function declaration() {\n    var pos = position();\n\n    // prop\n    var prop = match(PROPERTY_REGEX);\n    if (!prop) return;\n    comment();\n\n    // :\n    if (!match(COLON_REGEX)) return error(\"property missing ':'\");\n\n    // val\n    var val = match(VALUE_REGEX);\n\n    var ret = pos({\n      type: TYPE_DECLARATION,\n      property: trim(prop[0].replace(COMMENT_REGEX, EMPTY_STRING)),\n      value: val\n        ? trim(val[0].replace(COMMENT_REGEX, EMPTY_STRING))\n        : EMPTY_STRING\n    });\n\n    // ;\n    match(SEMICOLON_REGEX);\n\n    return ret;\n  }\n\n  /**\n   * Parse declarations.\n   *\n   * @return {Object[]}\n   */\n  function declarations() {\n    var decls = [];\n\n    comments(decls);\n\n    // declarations\n    var decl;\n    while ((decl = declaration())) {\n      if (decl !== false) {\n        decls.push(decl);\n        comments(decls);\n      }\n    }\n\n    return decls;\n  }\n\n  whitespace();\n  return declarations();\n}\n\n/**\n * Trim `str`.\n *\n * @param {String} str\n * @return {String}\n */\nfunction trim(str) {\n  return str ? str.replace(TRIM_REGEX, EMPTY_STRING) : EMPTY_STRING;\n}\n\nexport { index as default };\n//# sourceMappingURL=index.mjs.map\n","import parse from 'inline-style-parser';\n\n/**\n * Parses inline style to object.\n *\n * @param style - Inline style.\n * @param iterator - Iterator.\n * @returns - Style object or null.\n *\n * @example Parsing inline style to object:\n *\n * ```js\n * import parse from 'style-to-object';\n * parse('line-height: 42;'); // { 'line-height': '42' }\n * ```\n */\nfunction StyleToObject(style, iterator) {\n    let styleObject = null;\n    if (!style || typeof style !== 'string') {\n        return styleObject;\n    }\n    const declarations = parse(style);\n    const hasIterator = typeof iterator === 'function';\n    declarations.forEach((declaration) => {\n        if (declaration.type !== 'declaration') {\n            return;\n        }\n        const { property, value } = declaration;\n        if (hasIterator) {\n            iterator(property, value, declaration);\n        }\n        else if (value) {\n            styleObject = styleObject || {};\n            styleObject[property] = value;\n        }\n    });\n    return styleObject;\n}\n\nexport { StyleToObject as default };\n//# sourceMappingURL=index.mjs.map\n","const NUMBER_CHAR_RE = /\\d/;\nconst STR_SPLITTERS = [\"-\", \"_\", \"/\", \".\"];\nfunction isUppercase(char = \"\") {\n    if (NUMBER_CHAR_RE.test(char))\n        return undefined;\n    return char !== char.toLowerCase();\n}\nfunction splitByCase(str) {\n    const parts = [];\n    let buff = \"\";\n    let previousUpper;\n    let previousSplitter;\n    for (const char of str) {\n        // Splitter\n        const isSplitter = STR_SPLITTERS.includes(char);\n        if (isSplitter === true) {\n            parts.push(buff);\n            buff = \"\";\n            previousUpper = undefined;\n            continue;\n        }\n        const isUpper = isUppercase(char);\n        if (previousSplitter === false) {\n            // Case rising edge\n            if (previousUpper === false && isUpper === true) {\n                parts.push(buff);\n                buff = char;\n                previousUpper = isUpper;\n                continue;\n            }\n            // Case falling edge\n            if (previousUpper === true && isUpper === false && buff.length > 1) {\n                const lastChar = buff.at(-1);\n                parts.push(buff.slice(0, Math.max(0, buff.length - 1)));\n                buff = lastChar + char;\n                previousUpper = isUpper;\n                continue;\n            }\n        }\n        // Normal char\n        buff += char;\n        previousUpper = isUpper;\n        previousSplitter = isSplitter;\n    }\n    parts.push(buff);\n    return parts;\n}\nexport function pascalCase(str) {\n    if (!str)\n        return \"\";\n    return splitByCase(str)\n        .map((p) => upperFirst(p))\n        .join(\"\");\n}\nexport function camelCase(str) {\n    return lowerFirst(pascalCase(str || \"\"));\n}\nexport function kebabCase(str) {\n    return str\n        ? splitByCase(str)\n            .map((p) => p.toLowerCase())\n            .join(\"-\")\n        : \"\";\n}\nfunction upperFirst(str) {\n    return str ? str[0].toUpperCase() + str.slice(1) : \"\";\n}\nfunction lowerFirst(str) {\n    return str ? str[0].toLowerCase() + str.slice(1) : \"\";\n}\n","import parse from \"style-to-object\";\nimport { camelCase, pascalCase } from \"./strings.js\";\nexport function cssToStyleObj(css) {\n    if (!css)\n        return {};\n    const styleObj = {};\n    function iterator(name, value) {\n        if (name.startsWith(\"-moz-\") ||\n            name.startsWith(\"-webkit-\") ||\n            name.startsWith(\"-ms-\") ||\n            name.startsWith(\"-o-\")) {\n            styleObj[pascalCase(name)] = value;\n            return;\n        }\n        if (name.startsWith(\"--\")) {\n            styleObj[name] = value;\n            return;\n        }\n        styleObj[camelCase(name)] = value;\n    }\n    parse(css, iterator);\n    return styleObj;\n}\n","/**\n * Executes an array of callback functions with the same arguments.\n * @template T The types of the arguments that the callback functions take.\n * @param callbacks array of callback functions to execute.\n * @returns A new function that executes all of the original callback functions with the same arguments.\n */\nexport function executeCallbacks(...callbacks) {\n    return (...args) => {\n        for (const callback of callbacks) {\n            if (typeof callback === \"function\") {\n                callback(...args);\n            }\n        }\n    };\n}\n","function createParser(matcher, replacer) {\n    const regex = RegExp(matcher, \"g\");\n    return (str) => {\n        // throw an error if not a string\n        if (typeof str !== \"string\") {\n            throw new TypeError(`expected an argument of type string, but got ${typeof str}`);\n        }\n        // if no match between string and matcher\n        if (!str.match(regex))\n            return str;\n        // executes the replacer function for each match\n        return str.replace(regex, replacer);\n    };\n}\nconst camelToKebab = createParser(/[A-Z]/, (match) => `-${match.toLowerCase()}`);\nexport function styleToCSS(styleObj) {\n    if (!styleObj || typeof styleObj !== \"object\" || Array.isArray(styleObj)) {\n        throw new TypeError(`expected an argument of type object, but got ${typeof styleObj}`);\n    }\n    return Object.keys(styleObj)\n        .map((property) => `${camelToKebab(property)}: ${styleObj[property]};`)\n        .join(\"\\n\");\n}\n","import { styleToCSS } from \"./style-to-css.js\";\nexport function styleToString(style = {}) {\n    return styleToCSS(style).replace(\"\\n\", \" \");\n}\n","const EVENT_LIST = [\n    \"onabort\",\n    \"onanimationcancel\",\n    \"onanimationend\",\n    \"onanimationiteration\",\n    \"onanimationstart\",\n    \"onauxclick\",\n    \"onbeforeinput\",\n    \"onbeforetoggle\",\n    \"onblur\",\n    \"oncancel\",\n    \"oncanplay\",\n    \"oncanplaythrough\",\n    \"onchange\",\n    \"onclick\",\n    \"onclose\",\n    \"oncompositionend\",\n    \"oncompositionstart\",\n    \"oncompositionupdate\",\n    \"oncontextlost\",\n    \"oncontextmenu\",\n    \"oncontextrestored\",\n    \"oncopy\",\n    \"oncuechange\",\n    \"oncut\",\n    \"ondblclick\",\n    \"ondrag\",\n    \"ondragend\",\n    \"ondragenter\",\n    \"ondragleave\",\n    \"ondragover\",\n    \"ondragstart\",\n    \"ondrop\",\n    \"ondurationchange\",\n    \"onemptied\",\n    \"onended\",\n    \"onerror\",\n    \"onfocus\",\n    \"onfocusin\",\n    \"onfocusout\",\n    \"onformdata\",\n    \"ongotpointercapture\",\n    \"oninput\",\n    \"oninvalid\",\n    \"onkeydown\",\n    \"onkeypress\",\n    \"onkeyup\",\n    \"onload\",\n    \"onloadeddata\",\n    \"onloadedmetadata\",\n    \"onloadstart\",\n    \"onlostpointercapture\",\n    \"onmousedown\",\n    \"onmouseenter\",\n    \"onmouseleave\",\n    \"onmousemove\",\n    \"onmouseout\",\n    \"onmouseover\",\n    \"onmouseup\",\n    \"onpaste\",\n    \"onpause\",\n    \"onplay\",\n    \"onplaying\",\n    \"onpointercancel\",\n    \"onpointerdown\",\n    \"onpointerenter\",\n    \"onpointerleave\",\n    \"onpointermove\",\n    \"onpointerout\",\n    \"onpointerover\",\n    \"onpointerup\",\n    \"onprogress\",\n    \"onratechange\",\n    \"onreset\",\n    \"onresize\",\n    \"onscroll\",\n    \"onscrollend\",\n    \"onsecuritypolicyviolation\",\n    \"onseeked\",\n    \"onseeking\",\n    \"onselect\",\n    \"onselectionchange\",\n    \"onselectstart\",\n    \"onslotchange\",\n    \"onstalled\",\n    \"onsubmit\",\n    \"onsuspend\",\n    \"ontimeupdate\",\n    \"ontoggle\",\n    \"ontouchcancel\",\n    \"ontouchend\",\n    \"ontouchmove\",\n    \"ontouchstart\",\n    \"ontransitioncancel\",\n    \"ontransitionend\",\n    \"ontransitionrun\",\n    \"ontransitionstart\",\n    \"onvolumechange\",\n    \"onwaiting\",\n    \"onwebkitanimationend\",\n    \"onwebkitanimationiteration\",\n    \"onwebkitanimationstart\",\n    \"onwebkittransitionend\",\n    \"onwheel\"\n];\nexport const EVENT_LIST_SET = new Set(EVENT_LIST);\n","/**\n * Modified from https://github.com/adobe/react-spectrum/blob/main/packages/%40react-aria/utils/src/mergeProps.ts (see NOTICE.txt for source)\n */\nimport { clsx } from \"clsx\";\nimport { composeHandlers } from \"./compose-handlers.js\";\nimport { cssToStyleObj } from \"./css-to-style-obj.js\";\nimport { isClassValue } from \"./is.js\";\nimport { executeCallbacks } from \"./execute-callbacks.js\";\nimport { styleToString } from \"./style.js\";\nimport { EVENT_LIST_SET } from \"./event-list.js\";\nfunction isEventHandler(key) {\n    return EVENT_LIST_SET.has(key);\n}\n/**\n * Given a list of prop objects, merges them into a single object.\n * - Automatically composes event handlers (e.g. `onclick`, `oninput`, etc.)\n * - Chains regular functions with the same name so they are called in order\n * - Merges class strings with `clsx`\n * - Merges style objects and converts them to strings\n * - Handles a bug with Svelte where setting the `hidden` attribute to `false` doesn't remove it\n * - Overrides other values with the last one\n */\nexport function mergeProps(...args) {\n    const result = { ...args[0] };\n    for (let i = 1; i < args.length; i++) {\n        const props = args[i];\n        if (!props)\n            continue;\n        // Handle string keys\n        for (const key of Object.keys(props)) {\n            const a = result[key];\n            const b = props[key];\n            const aIsFunction = typeof a === \"function\";\n            const bIsFunction = typeof b === \"function\";\n            // compose event handlers\n            if (aIsFunction && typeof bIsFunction && isEventHandler(key)) {\n                // handle merging of event handlers\n                const aHandler = a;\n                const bHandler = b;\n                result[key] = composeHandlers(aHandler, bHandler);\n            }\n            else if (aIsFunction && bIsFunction) {\n                // chain non-event handler functions\n                result[key] = executeCallbacks(a, b);\n            }\n            else if (key === \"class\") {\n                // handle merging acceptable class values from clsx\n                const aIsClassValue = isClassValue(a);\n                const bIsClassValue = isClassValue(b);\n                if (aIsClassValue && bIsClassValue) {\n                    result[key] = clsx(a, b);\n                }\n                else if (aIsClassValue) {\n                    result[key] = clsx(a);\n                }\n                else if (bIsClassValue) {\n                    result[key] = clsx(b);\n                }\n            }\n            else if (key === \"style\") {\n                const aIsObject = typeof a === \"object\";\n                const bIsObject = typeof b === \"object\";\n                const aIsString = typeof a === \"string\";\n                const bIsString = typeof b === \"string\";\n                if (aIsObject && bIsObject) {\n                    // both are style objects, merge them\n                    result[key] = { ...a, ...b };\n                }\n                else if (aIsObject && bIsString) {\n                    // a is style object, b is string, convert b to style object and merge\n                    const parsedStyle = cssToStyleObj(b);\n                    result[key] = { ...a, ...parsedStyle };\n                }\n                else if (aIsString && bIsObject) {\n                    // a is string, b is style object, convert a to style object and merge\n                    const parsedStyle = cssToStyleObj(a);\n                    result[key] = { ...parsedStyle, ...b };\n                }\n                else if (aIsString && bIsString) {\n                    // both are strings, convert both to objects and merge\n                    const parsedStyleA = cssToStyleObj(a);\n                    const parsedStyleB = cssToStyleObj(b);\n                    result[key] = { ...parsedStyleA, ...parsedStyleB };\n                }\n                else if (aIsObject) {\n                    result[key] = a;\n                }\n                else if (bIsObject) {\n                    result[key] = b;\n                }\n                else if (aIsString) {\n                    result[key] = a;\n                }\n                else if (bIsString) {\n                    result[key] = b;\n                }\n            }\n            else {\n                // override other values\n                result[key] = b !== undefined ? b : a;\n            }\n        }\n        // handle symbol keys (mostly for `Attachments`)\n        for (const key of Object.getOwnPropertySymbols(props)) {\n            const a = result[key];\n            const b = props[key];\n            // for matching symbols, we just override\n            result[key] = b !== undefined ? b : a;\n        }\n    }\n    // convert style object to string\n    if (typeof result.style === \"object\") {\n        result.style = styleToString(result.style).replaceAll(\"\\n\", \" \");\n    }\n    // handle weird svelte bug where `hidden` is not removed when set to `false`\n    if (result.hidden === false) {\n        result.hidden = undefined;\n        delete result.hidden;\n    }\n    // handle weird svelte bug where `disabled` is not removed when set to `false`\n    if (result.disabled === false) {\n        result.disabled = undefined;\n        delete result.disabled;\n    }\n    return result;\n}\n","import { BROWSER } from \"esm-env\";\nexport const defaultWindow = BROWSER && typeof window !== \"undefined\" ? window : undefined;\nexport const defaultDocument = BROWSER && typeof window !== \"undefined\" ? window.document : undefined;\nexport const defaultNavigator = BROWSER && typeof window !== \"undefined\" ? window.navigator : undefined;\nexport const defaultLocation = BROWSER && typeof window !== \"undefined\" ? window.location : undefined;\n","/** @import { Source } from '#client' */\nimport { DEV } from 'esm-env';\nimport { set, source, state, increment } from '../internal/client/reactivity/sources.js';\nimport { label, tag } from '../internal/client/dev/tracing.js';\nimport { get, update_version } from '../internal/client/runtime.js';\n\n/**\n * A reactive version of the built-in [`Map`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map) object.\n * Reading contents of the map (by iterating, or by reading `map.size` or calling `map.get(...)` or `map.has(...)` as in the [tic-tac-toe example](https://svelte.dev/playground/0b0ff4aa49c9443f9b47fe5203c78293) below) in an [effect](https://svelte.dev/docs/svelte/$effect) or [derived](https://svelte.dev/docs/svelte/$derived)\n * will cause it to be re-evaluated as necessary when the map is updated.\n *\n * Note that values in a reactive map are _not_ made [deeply reactive](https://svelte.dev/docs/svelte/$state#Deep-state).\n *\n * ```svelte\n * <script>\n * \timport { SvelteMap } from 'svelte/reactivity';\n * \timport { result } from './game.js';\n *\n * \tlet board = new SvelteMap();\n * \tlet player = $state('x');\n * \tlet winner = $derived(result(board));\n *\n * \tfunction reset() {\n * \t\tplayer = 'x';\n * \t\tboard.clear();\n * \t}\n * </script>\n *\n * <div class=\"board\">\n * \t{#each Array(9), i}\n * \t\t<button\n * \t\t\tdisabled={board.has(i) || winner}\n * \t\t\tonclick={() => {\n * \t\t\t\tboard.set(i, player);\n * \t\t\t\tplayer = player === 'x' ? 'o' : 'x';\n * \t\t\t}}\n * \t\t>{board.get(i)}</button>\n * \t{/each}\n * </div>\n *\n * {#if winner}\n * \t<p>{winner} wins!</p>\n * \t<button onclick={reset}>reset</button>\n * {:else}\n * \t<p>{player} is next</p>\n * {/if}\n * ```\n *\n * @template K\n * @template V\n * @extends {Map<K, V>}\n */\nexport class SvelteMap extends Map {\n\t/** @type {Map<K, Source<number>>} */\n\t#sources = new Map();\n\t#version = state(0);\n\t#size = state(0);\n\t#update_version = update_version || -1;\n\n\t/**\n\t * @param {Iterable<readonly [K, V]> | null | undefined} [value]\n\t */\n\tconstructor(value) {\n\t\tsuper();\n\n\t\tif (DEV) {\n\t\t\t// If the value is invalid then the native exception will fire here\n\t\t\tvalue = new Map(value);\n\n\t\t\ttag(this.#version, 'SvelteMap version');\n\t\t\ttag(this.#size, 'SvelteMap.size');\n\t\t}\n\n\t\tif (value) {\n\t\t\tfor (var [key, v] of value) {\n\t\t\t\tsuper.set(key, v);\n\t\t\t}\n\t\t\tthis.#size.v = super.size;\n\t\t}\n\t}\n\n\t/**\n\t * If the source is being created inside the same reaction as the SvelteMap instance,\n\t * we use `state` so that it will not be a dependency of the reaction. Otherwise we\n\t * use `source` so it will be.\n\t *\n\t * @template T\n\t * @param {T} value\n\t * @returns {Source<T>}\n\t */\n\t#source(value) {\n\t\treturn update_version === this.#update_version ? state(value) : source(value);\n\t}\n\n\t/** @param {K} key */\n\thas(key) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\n\t\tif (s === undefined) {\n\t\t\tvar ret = super.get(key);\n\t\t\tif (ret !== undefined) {\n\t\t\t\ts = this.#source(0);\n\n\t\t\t\tif (DEV) {\n\t\t\t\t\ttag(s, `SvelteMap get(${label(key)})`);\n\t\t\t\t}\n\n\t\t\t\tsources.set(key, s);\n\t\t\t} else {\n\t\t\t\t// We should always track the version in case\n\t\t\t\t// the Set ever gets this value in the future.\n\t\t\t\tget(this.#version);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tget(s);\n\t\treturn true;\n\t}\n\n\t/**\n\t * @param {(value: V, key: K, map: Map<K, V>) => void} callbackfn\n\t * @param {any} [this_arg]\n\t */\n\tforEach(callbackfn, this_arg) {\n\t\tthis.#read_all();\n\t\tsuper.forEach(callbackfn, this_arg);\n\t}\n\n\t/** @param {K} key */\n\tget(key) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\n\t\tif (s === undefined) {\n\t\t\tvar ret = super.get(key);\n\t\t\tif (ret !== undefined) {\n\t\t\t\ts = this.#source(0);\n\n\t\t\t\tif (DEV) {\n\t\t\t\t\ttag(s, `SvelteMap get(${label(key)})`);\n\t\t\t\t}\n\n\t\t\t\tsources.set(key, s);\n\t\t\t} else {\n\t\t\t\t// We should always track the version in case\n\t\t\t\t// the Set ever gets this value in the future.\n\t\t\t\tget(this.#version);\n\t\t\t\treturn undefined;\n\t\t\t}\n\t\t}\n\n\t\tget(s);\n\t\treturn super.get(key);\n\t}\n\n\t/**\n\t * @param {K} key\n\t * @param {V} value\n\t * */\n\tset(key, value) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\t\tvar prev_res = super.get(key);\n\t\tvar res = super.set(key, value);\n\t\tvar version = this.#version;\n\n\t\tif (s === undefined) {\n\t\t\ts = this.#source(0);\n\n\t\t\tif (DEV) {\n\t\t\t\ttag(s, `SvelteMap get(${label(key)})`);\n\t\t\t}\n\n\t\t\tsources.set(key, s);\n\t\t\tset(this.#size, super.size);\n\t\t\tincrement(version);\n\t\t} else if (prev_res !== value) {\n\t\t\tincrement(s);\n\n\t\t\t// if not every reaction of s is a reaction of version we need to also include version\n\t\t\tvar v_reactions = version.reactions === null ? null : new Set(version.reactions);\n\t\t\tvar needs_version_increase =\n\t\t\t\tv_reactions === null ||\n\t\t\t\t!s.reactions?.every((r) =>\n\t\t\t\t\t/** @type {NonNullable<typeof v_reactions>} */ (v_reactions).has(r)\n\t\t\t\t);\n\t\t\tif (needs_version_increase) {\n\t\t\t\tincrement(version);\n\t\t\t}\n\t\t}\n\n\t\treturn res;\n\t}\n\n\t/** @param {K} key */\n\tdelete(key) {\n\t\tvar sources = this.#sources;\n\t\tvar s = sources.get(key);\n\t\tvar res = super.delete(key);\n\n\t\tif (s !== undefined) {\n\t\t\tsources.delete(key);\n\t\t\tset(this.#size, super.size);\n\t\t\tset(s, -1);\n\t\t\tincrement(this.#version);\n\t\t}\n\n\t\treturn res;\n\t}\n\n\tclear() {\n\t\tif (super.size === 0) {\n\t\t\treturn;\n\t\t}\n\t\t// Clear first, so we get nice console.log outputs with $inspect\n\t\tsuper.clear();\n\t\tvar sources = this.#sources;\n\t\tset(this.#size, 0);\n\t\tfor (var s of sources.values()) {\n\t\t\tset(s, -1);\n\t\t}\n\t\tincrement(this.#version);\n\t\tsources.clear();\n\t}\n\n\t#read_all() {\n\t\tget(this.#version);\n\n\t\tvar sources = this.#sources;\n\t\tif (this.#size.v !== sources.size) {\n\t\t\tfor (var key of super.keys()) {\n\t\t\t\tif (!sources.has(key)) {\n\t\t\t\t\tvar s = this.#source(0);\n\t\t\t\t\tif (DEV) {\n\t\t\t\t\t\ttag(s, `SvelteMap get(${label(key)})`);\n\t\t\t\t\t}\n\n\t\t\t\t\tsources.set(key, s);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor ([, s] of this.#sources) {\n\t\t\tget(s);\n\t\t}\n\t}\n\n\tkeys() {\n\t\tget(this.#version);\n\t\treturn super.keys();\n\t}\n\n\tvalues() {\n\t\tthis.#read_all();\n\t\treturn super.values();\n\t}\n\n\tentries() {\n\t\tthis.#read_all();\n\t\treturn super.entries();\n\t}\n\n\t[Symbol.iterator]() {\n\t\treturn this.entries();\n\t}\n\n\tget size() {\n\t\tget(this.#size);\n\t\treturn super.size;\n\t}\n}\n","import { defaultWindow, } from \"../../internal/configurable-globals.js\";\nimport { getActiveElement } from \"../../internal/utils/dom.js\";\nimport { on } from \"svelte/events\";\nimport { createSubscriber } from \"svelte/reactivity\";\nexport class ActiveElement {\n    #document;\n    #subscribe;\n    constructor(options = {}) {\n        const { window = defaultWindow, document = window?.document } = options;\n        if (window === undefined)\n            return;\n        this.#document = document;\n        this.#subscribe = createSubscriber((update) => {\n            const cleanupFocusIn = on(window, \"focusin\", update);\n            const cleanupFocusOut = on(window, \"focusout\", update);\n            return () => {\n                cleanupFocusIn();\n                cleanupFocusOut();\n            };\n        });\n    }\n    get current() {\n        this.#subscribe?.();\n        if (!this.#document)\n            return null;\n        return getActiveElement(this.#document);\n    }\n}\n/**\n * An object holding a reactive value that is equal to `document.activeElement`.\n * It automatically listens for changes, keeping the reference up to date.\n *\n * If you wish to use a custom document or shadowRoot, you should use\n * [useActiveElement](https://runed.dev/docs/utilities/active-element) instead.\n *\n * @see {@link https://runed.dev/docs/utilities/active-element}\n */\nexport const activeElement = new ActiveElement();\n","import { defaultDocument } from \"../configurable-globals.js\";\n/**\n * Handles getting the active element in a document or shadow root.\n * If the active element is within a shadow root, it will traverse the shadow root\n * to find the active element.\n * If not, it will return the active element in the document.\n *\n * @param document A document or shadow root to get the active element from.\n * @returns The active element in the document or shadow root.\n */\nexport function getActiveElement(document) {\n    let activeElement = document.activeElement;\n    while (activeElement?.shadowRoot) {\n        const node = activeElement.shadowRoot.activeElement;\n        if (node === activeElement)\n            break;\n        else\n            activeElement = node;\n    }\n    return activeElement;\n}\n/**\n * Returns the owner document of a given element.\n *\n * @param node The element to get the owner document from.\n * @returns\n */\nexport function getOwnerDocument(node, fallback = defaultDocument) {\n    return node?.ownerDocument ?? fallback;\n}\n/**\n * Checks if an element is or is contained by another element.\n *\n * @param node The element to check if it or its descendants contain the target element.\n * @param target The element to check if it is contained by the node.\n * @returns\n */\nexport function isOrContainsTarget(node, target) {\n    return node === target || node.contains(target);\n}\n","import { getContext, hasContext, setContext } from \"svelte\";\nexport class Context {\n    #name;\n    #key;\n    /**\n     * @param name The name of the context.\n     * This is used for generating the context key and error messages.\n     */\n    constructor(name) {\n        this.#name = name;\n        this.#key = Symbol(name);\n    }\n    /**\n     * The key used to get and set the context.\n     *\n     * It is not recommended to use this value directly.\n     * Instead, use the methods provided by this class.\n     */\n    get key() {\n        return this.#key;\n    }\n    /**\n     * Checks whether this has been set in the context of a parent component.\n     *\n     * Must be called during component initialisation.\n     */\n    exists() {\n        return hasContext(this.#key);\n    }\n    /**\n     * Retrieves the context that belongs to the closest parent component.\n     *\n     * Must be called during component initialisation.\n     *\n     * @throws An error if the context does not exist.\n     */\n    get() {\n        const context = getContext(this.#key);\n        if (context === undefined) {\n            throw new Error(`Context \"${this.#name}\" not found`);\n        }\n        return context;\n    }\n    /**\n     * Retrieves the context that belongs to the closest parent component,\n     * or the given fallback value if the context does not exist.\n     *\n     * Must be called during component initialisation.\n     */\n    getOr(fallback) {\n        const context = getContext(this.#key);\n        if (context === undefined) {\n            return fallback;\n        }\n        return context;\n    }\n    /**\n     * Associates the given value with the current component and returns it.\n     *\n     * Must be called during component initialisation.\n     */\n    set(context) {\n        return setContext(this.#key, context);\n    }\n}\n","import { untrack } from \"svelte\";\nfunction runEffect(flush, effect) {\n    switch (flush) {\n        case \"post\":\n            $effect(effect);\n            break;\n        case \"pre\":\n            $effect.pre(effect);\n            break;\n    }\n}\nfunction runWatcher(sources, flush, effect, options = {}) {\n    const { lazy = false } = options;\n    // Run the effect immediately if `lazy` is `false`.\n    let active = !lazy;\n    // On the first run, if the dependencies are an array, pass an empty array\n    // to the previous value instead of `undefined` to allow destructuring.\n    //\n    // watch(() => [a, b], ([a, b], [prevA, prevB]) => { ... });\n    let previousValues = Array.isArray(sources)\n        ? []\n        : undefined;\n    runEffect(flush, () => {\n        const values = Array.isArray(sources) ? sources.map((source) => source()) : sources();\n        if (!active) {\n            active = true;\n            previousValues = values;\n            return;\n        }\n        const cleanup = untrack(() => effect(values, previousValues));\n        previousValues = values;\n        return cleanup;\n    });\n}\nfunction runWatcherOnce(sources, flush, effect) {\n    const cleanupRoot = $effect.root(() => {\n        let stop = false;\n        runWatcher(sources, flush, (values, previousValues) => {\n            if (stop) {\n                cleanupRoot();\n                return;\n            }\n            // Since `lazy` is `true`, `previousValues` is always defined.\n            const cleanup = effect(values, previousValues);\n            stop = true;\n            return cleanup;\n        }, \n        // Running the effect immediately just once makes no sense at all.\n        // That's just `onMount` with extra steps.\n        { lazy: true });\n    });\n    $effect(() => {\n        return cleanupRoot;\n    });\n}\nexport function watch(sources, effect, options) {\n    runWatcher(sources, \"post\", effect, options);\n}\nfunction watchPre(sources, effect, options) {\n    runWatcher(sources, \"pre\", effect, options);\n}\nwatch.pre = watchPre;\nexport function watchOnce(source, effect) {\n    runWatcherOnce(source, \"post\", effect);\n}\nfunction watchOncePre(source, effect) {\n    runWatcherOnce(source, \"pre\", effect);\n}\nwatchOnce.pre = watchOncePre;\n","export function onDestroyEffect(fn) {\n    $effect(() => {\n        return () => {\n            fn();\n        };\n    });\n}\n","import { tick } from \"svelte\";\nexport function afterTick(fn) {\n    tick().then(fn);\n}\n","import { isObject } from \"./is.js\";\nconst ELEMENT_NODE = 1;\nconst DOCUMENT_NODE = 9;\nconst DOCUMENT_FRAGMENT_NODE = 11;\nexport function isHTMLElement(node) {\n    return isObject(node) && node.nodeType === ELEMENT_NODE && typeof node.nodeName === \"string\";\n}\nexport function isDocument(node) {\n    return isObject(node) && node.nodeType === DOCUMENT_NODE;\n}\nexport function isWindow(node) {\n    return isObject(node) && node.constructor?.name === \"VisualViewport\";\n}\nexport function getNodeName(node) {\n    if (isHTMLElement(node))\n        return node.localName ?? \"\";\n    return \"#document\";\n}\nexport function isNode(node) {\n    return isObject(node) && node.nodeType !== undefined;\n}\nexport function isShadowRoot(node) {\n    return isNode(node) && node.nodeType === DOCUMENT_FRAGMENT_NODE && \"host\" in node;\n}\nexport function contains(parent, child) {\n    if (!parent || !child)\n        return false;\n    if (!isHTMLElement(parent) || !isHTMLElement(child))\n        return false;\n    const rootNode = child.getRootNode?.();\n    if (parent === child)\n        return true;\n    if (parent.contains(child))\n        return true;\n    if (rootNode && isShadowRoot(rootNode)) {\n        let next = child;\n        while (next) {\n            if (parent === next)\n                return true;\n            // @ts-expect-error - host is not typed\n            next = next.parentNode || next.host;\n        }\n    }\n    return false;\n}\nexport function getDocument(node) {\n    if (isDocument(node))\n        return node;\n    if (isWindow(node))\n        return node.document;\n    return node?.ownerDocument ?? document;\n}\nexport function getDocumentElement(node) {\n    return getDocument(node).documentElement;\n}\nexport function getWindow(node) {\n    if (isShadowRoot(node))\n        return getWindow(node.host);\n    if (isDocument(node))\n        return node.defaultView ?? window;\n    if (isHTMLElement(node))\n        return node.ownerDocument?.defaultView ?? window;\n    return window;\n}\nexport function getActiveElement(rootNode) {\n    let activeElement = rootNode.activeElement;\n    while (activeElement?.shadowRoot) {\n        const el = activeElement.shadowRoot.activeElement;\n        if (el === activeElement)\n            break;\n        else\n            activeElement = el;\n    }\n    return activeElement;\n}\nexport function getParentNode(node) {\n    if (getNodeName(node) === \"html\")\n        return node;\n    const result = \n    // @ts-expect-error - assignedSlot is not typed\n    node.assignedSlot ||\n        node.parentNode ||\n        (isShadowRoot(node) && node.host) ||\n        getDocumentElement(node);\n    return isShadowRoot(result) ? result.host : result;\n}\n","import { boxWith } from \"../box/box-extras.svelte.js\";\nimport { getActiveElement, getDocument } from \"./dom.js\";\nexport class DOMContext {\n    element;\n    root = $derived.by(() => {\n        if (!this.element.current)\n            return document;\n        const rootNode = this.element.current.getRootNode() ?? document;\n        return rootNode;\n    });\n    constructor(element) {\n        if (typeof element === \"function\") {\n            this.element = boxWith(element);\n        }\n        else {\n            this.element = element;\n        }\n    }\n    getDocument = () => {\n        return getDocument(this.root);\n    };\n    getWindow = () => {\n        return this.getDocument().defaultView ?? window;\n    };\n    getActiveElement = () => {\n        return getActiveElement(this.root);\n    };\n    isActiveElement = (node) => {\n        return node === this.getActiveElement();\n    };\n    getElementById(id) {\n        return this.root.getElementById(id);\n    }\n    querySelector = (selector) => {\n        if (!this.root)\n            return null;\n        return this.root.querySelector(selector);\n    };\n    querySelectorAll = (selector) => {\n        if (!this.root)\n            return [];\n        return this.root.querySelectorAll(selector);\n    };\n    setTimeout = (callback, delay) => {\n        return this.getWindow().setTimeout(callback, delay);\n    };\n    clearTimeout = (timeoutId) => {\n        return this.getWindow().clearTimeout(timeoutId);\n    };\n}\n","import { untrack } from \"svelte\";\nimport { isBox } from \"../box/box-extras.svelte.js\";\nimport { createAttachmentKey } from \"svelte/attachments\";\n/**\n * Creates a Svelte Attachment that attaches a DOM element to a ref.\n * The ref can be either a WritableBox or a callback function.\n *\n * @param ref - Either a WritableBox to store the element in, or a callback function that receives the element\n * @param onChange - Optional callback that fires when the ref changes\n * @returns An object with a spreadable attachment key that should be spread onto the element\n *\n * @example\n * // Using with WritableBox\n * const ref = box<HTMLDivElement | null>(null);\n * <div {...attachRef(ref)}>Content</div>\n *\n * @example\n * // Using with callback\n * <div {...attachRef((node) => myNode = node)}>Content</div>\n *\n * @example\n * // Using with onChange\n * <div {...attachRef(ref, (node) => console.log(node))}>Content</div>\n */\nexport function attachRef(ref, onChange) {\n    return {\n        [createAttachmentKey()]: (node) => {\n            if (isBox(ref)) {\n                ref.current = node;\n                untrack(() => onChange?.(node));\n                return () => {\n                    // we don't want to detach the node if it's still connected\n                    if (\"isConnected\" in node && node.isConnected)\n                        return;\n                    ref.current = null;\n                    onChange?.(null);\n                };\n            }\n            ref(node);\n            untrack(() => onChange?.(node));\n            return () => {\n                // we don't want to detach the node if it's still connected\n                if (\"isConnected\" in node && node.isConnected)\n                    return;\n                ref(null);\n                onChange?.(null);\n            };\n        }\n    };\n}\n","export function boolToStr(condition) {\n    return condition ? \"true\" : \"false\";\n}\nexport function boolToStrTrueOrUndef(condition) {\n    return condition ? \"true\" : undefined;\n}\nexport function boolToEmptyStrOrUndef(condition) {\n    return condition ? \"\" : undefined;\n}\nexport function boolToTrueOrUndef(condition) {\n    return condition ? true : undefined;\n}\nexport function getDataOpenClosed(condition) {\n    return condition ? \"open\" : \"closed\";\n}\nexport function getDataChecked(condition) {\n    return condition ? \"checked\" : \"unchecked\";\n}\nexport function getAriaChecked(checked, indeterminate) {\n    if (indeterminate) {\n        return \"mixed\";\n    }\n    return checked ? \"true\" : \"false\";\n}\nexport class BitsAttrs {\n    #variant;\n    #prefix;\n    attrs;\n    constructor(config) {\n        this.#variant = config.getVariant ? config.getVariant() : null;\n        this.#prefix = this.#variant ? `data-${this.#variant}-` : `data-${config.component}-`;\n        this.getAttr = this.getAttr.bind(this);\n        this.selector = this.selector.bind(this);\n        this.attrs = Object.fromEntries(config.parts.map((part) => [part, this.getAttr(part)]));\n    }\n    getAttr(part, variantOverride) {\n        if (variantOverride)\n            return `data-${variantOverride}-${part}`;\n        return `${this.#prefix}${part}`;\n    }\n    selector(part, variantOverride) {\n        return `[${this.getAttr(part, variantOverride)}]`;\n    }\n}\nexport function createBitsAttrs(config) {\n    const bitsAttrs = new BitsAttrs(config);\n    return {\n        ...bitsAttrs.attrs,\n        selector: bitsAttrs.selector,\n        getAttr: bitsAttrs.getAttr,\n    };\n}\n","export const ALT = \"Alt\";\nexport const ARROW_DOWN = \"ArrowDown\";\nexport const ARROW_LEFT = \"ArrowLeft\";\nexport const ARROW_RIGHT = \"ArrowRight\";\nexport const ARROW_UP = \"ArrowUp\";\nexport const BACKSPACE = \"Backspace\";\nexport const CAPS_LOCK = \"CapsLock\";\nexport const CONTROL = \"Control\";\nexport const DELETE = \"Delete\";\nexport const END = \"End\";\nexport const ENTER = \"Enter\";\nexport const ESCAPE = \"Escape\";\nexport const F1 = \"F1\";\nexport const F10 = \"F10\";\nexport const F11 = \"F11\";\nexport const F12 = \"F12\";\nexport const F2 = \"F2\";\nexport const F3 = \"F3\";\nexport const F4 = \"F4\";\nexport const F5 = \"F5\";\nexport const F6 = \"F6\";\nexport const F7 = \"F7\";\nexport const F8 = \"F8\";\nexport const F9 = \"F9\";\nexport const HOME = \"Home\";\nexport const META = \"Meta\";\nexport const PAGE_DOWN = \"PageDown\";\nexport const PAGE_UP = \"PageUp\";\nexport const SHIFT = \"Shift\";\nexport const SPACE = \" \";\nexport const TAB = \"Tab\";\nexport const CTRL = \"Control\";\nexport const ASTERISK = \"*\";\nexport const a = \"a\";\nexport const P = \"P\";\nexport const A = \"A\";\nexport const p = \"p\";\nexport const n = \"n\";\nexport const j = \"j\";\nexport const k = \"k\";\nexport const h = \"h\";\nexport const l = \"l\";\n","export const isBrowser = typeof document !== \"undefined\";\nexport const isIOS = getIsIOS();\nfunction getIsIOS() {\n    return (isBrowser &&\n        window?.navigator?.userAgent &&\n        (/iP(ad|hone|od)/.test(window.navigator.userAgent) ||\n            // The new iPad Pro Gen3 does not identify itself as iPad, but as Macintosh.\n            (window?.navigator?.maxTouchPoints > 2 &&\n                /iPad|Macintosh/.test(window?.navigator.userAgent))));\n}\nexport function isFunction(value) {\n    return typeof value === \"function\";\n}\nexport function isHTMLElement(element) {\n    return element instanceof HTMLElement;\n}\nexport function isElement(element) {\n    return element instanceof Element;\n}\nexport function isElementOrSVGElement(element) {\n    return element instanceof Element || element instanceof SVGElement;\n}\nexport function isNumberString(value) {\n    return !Number.isNaN(Number(value)) && !Number.isNaN(Number.parseFloat(value));\n}\nexport function isNull(value) {\n    return value === null;\n}\nexport function isTouch(e) {\n    return e.pointerType === \"touch\";\n}\nexport function isFocusVisible(element) {\n    return element.matches(\":focus-visible\");\n}\nexport function isNotNull(value) {\n    return value !== null;\n}\n/**\n * Determines if the provided object is a valid `HTMLInputElement` with\n * a `select` method available.\n */\nexport function isSelectableInput(element) {\n    return element instanceof HTMLInputElement && \"select\" in element;\n}\n/**\n * Given a node, determine if it is hidden by walking up the\n * DOM tree until we hit the `stopAt` node (exclusive), if provided)\n * otherwise we stop at the document root.\n */\nexport function isElementHidden(node, stopAt) {\n    if (getComputedStyle(node).visibility === \"hidden\")\n        return true;\n    while (node) {\n        // we stop at `upTo` (excluding it)\n        if (stopAt !== undefined && node === stopAt)\n            return false;\n        if (getComputedStyle(node).display === \"none\")\n            return true;\n        node = node.parentElement;\n    }\n    return false;\n}\n","import { afterTick, onDestroyEffect } from \"svelte-toolbelt\";\nexport class AnimationsComplete {\n    #opts;\n    #currentFrame = null;\n    constructor(opts) {\n        this.#opts = opts;\n        onDestroyEffect(() => this.#cleanup());\n    }\n    #cleanup() {\n        if (!this.#currentFrame)\n            return;\n        window.cancelAnimationFrame(this.#currentFrame);\n        this.#currentFrame = null;\n    }\n    run(fn) {\n        // if already running, cleanup and restart\n        this.#cleanup();\n        const node = this.#opts.ref.current;\n        if (!node)\n            return;\n        if (typeof node.getAnimations !== \"function\") {\n            this.#executeCallback(fn);\n            return;\n        }\n        this.#currentFrame = window.requestAnimationFrame(() => {\n            const animations = node.getAnimations();\n            if (animations.length === 0) {\n                this.#executeCallback(fn);\n                return;\n            }\n            Promise.allSettled(animations.map((animation) => animation.finished)).then(() => {\n                this.#executeCallback(fn);\n            });\n        });\n    }\n    #executeCallback(fn) {\n        const execute = () => {\n            fn();\n        };\n        if (this.#opts.afterTick) {\n            afterTick(execute);\n        }\n        else {\n            execute();\n        }\n    }\n}\n","import { watch } from \"runed\";\nimport { AnimationsComplete } from \"./animations-complete.js\";\nexport class PresenceManager {\n    #opts;\n    #enabled;\n    #afterAnimations;\n    #shouldRender = $state(false);\n    constructor(opts) {\n        this.#opts = opts;\n        this.#shouldRender = opts.open.current;\n        this.#enabled = opts.enabled ?? true;\n        this.#afterAnimations = new AnimationsComplete({\n            ref: this.#opts.ref,\n            afterTick: this.#opts.open,\n        });\n        watch(() => this.#opts.open.current, (isOpen) => {\n            if (isOpen)\n                this.#shouldRender = true;\n            if (!this.#enabled)\n                return;\n            this.#afterAnimations.run(() => {\n                if (isOpen === this.#opts.open.current) {\n                    if (!this.#opts.open.current) {\n                        this.#shouldRender = false;\n                    }\n                    this.#opts.onComplete?.();\n                }\n            });\n        });\n    }\n    get shouldRender() {\n        return this.#shouldRender;\n    }\n}\n","/**\n * A no operation function (does nothing)\n */\nexport function noop() { }\n","export function createId(prefixOrUid, uid) {\n    if (uid === undefined)\n        return `bits-${prefixOrUid}`;\n    return `bits-${prefixOrUid}-${uid}`;\n}\n","import { attachRef, boxWith, onDestroyEffect, } from \"svelte-toolbelt\";\nimport { Context, watch } from \"runed\";\nimport { createBitsAttrs, boolToStr, getDataOpenClosed, boolToEmptyStrOrUndef, } from \"../../internal/attrs.js\";\nimport { kbd } from \"../../internal/kbd.js\";\nimport { PresenceManager } from \"../../internal/presence-manager.svelte.js\";\nconst dialogAttrs = createBitsAttrs({\n    component: \"dialog\",\n    parts: [\"content\", \"trigger\", \"overlay\", \"title\", \"description\", \"close\", \"cancel\", \"action\"],\n});\nconst DialogRootContext = new Context(\"Dialog.Root | AlertDialog.Root\");\nexport class DialogRootState {\n    static create(opts) {\n        const parent = DialogRootContext.getOr(null);\n        return DialogRootContext.set(new DialogRootState(opts, parent));\n    }\n    opts;\n    triggerNode = $state(null);\n    contentNode = $state(null);\n    overlayNode = $state(null);\n    descriptionNode = $state(null);\n    contentId = $state(undefined);\n    titleId = $state(undefined);\n    triggerId = $state(undefined);\n    descriptionId = $state(undefined);\n    cancelNode = $state(null);\n    nestedOpenCount = $state(0);\n    depth;\n    parent;\n    contentPresence;\n    overlayPresence;\n    constructor(opts, parent) {\n        this.opts = opts;\n        this.parent = parent;\n        this.depth = parent ? parent.depth + 1 : 0;\n        this.handleOpen = this.handleOpen.bind(this);\n        this.handleClose = this.handleClose.bind(this);\n        this.contentPresence = new PresenceManager({\n            ref: boxWith(() => this.contentNode),\n            open: this.opts.open,\n            enabled: true,\n            onComplete: () => {\n                this.opts.onOpenChangeComplete.current(this.opts.open.current);\n            },\n        });\n        this.overlayPresence = new PresenceManager({\n            ref: boxWith(() => this.overlayNode),\n            open: this.opts.open,\n            enabled: true,\n        });\n        watch(() => this.opts.open.current, (isOpen) => {\n            if (!this.parent)\n                return;\n            if (isOpen) {\n                this.parent.incrementNested();\n            }\n            else {\n                this.parent.decrementNested();\n            }\n        }, { lazy: true });\n        onDestroyEffect(() => {\n            if (this.opts.open.current) {\n                this.parent?.decrementNested();\n            }\n        });\n    }\n    handleOpen() {\n        if (this.opts.open.current)\n            return;\n        this.opts.open.current = true;\n    }\n    handleClose() {\n        if (!this.opts.open.current)\n            return;\n        this.opts.open.current = false;\n    }\n    getBitsAttr = (part) => {\n        return dialogAttrs.getAttr(part, this.opts.variant.current);\n    };\n    incrementNested() {\n        this.nestedOpenCount++;\n        this.parent?.incrementNested();\n    }\n    decrementNested() {\n        if (this.nestedOpenCount === 0)\n            return;\n        this.nestedOpenCount--;\n        this.parent?.decrementNested();\n    }\n    sharedProps = $derived.by(() => ({\n        \"data-state\": getDataOpenClosed(this.opts.open.current),\n    }));\n}\nexport class DialogTriggerState {\n    static create(opts) {\n        return new DialogTriggerState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref, (v) => {\n            this.root.triggerNode = v;\n            this.root.triggerId = v?.id;\n        });\n        this.onclick = this.onclick.bind(this);\n        this.onkeydown = this.onkeydown.bind(this);\n    }\n    onclick(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.button > 0)\n            return;\n        this.root.handleOpen();\n    }\n    onkeydown(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.key === kbd.SPACE || e.key === kbd.ENTER) {\n            e.preventDefault();\n            this.root.handleOpen();\n        }\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        \"aria-haspopup\": \"dialog\",\n        \"aria-expanded\": boolToStr(this.root.opts.open.current),\n        \"aria-controls\": this.root.contentId,\n        [this.root.getBitsAttr(\"trigger\")]: \"\",\n        onkeydown: this.onkeydown,\n        onclick: this.onclick,\n        disabled: this.opts.disabled.current ? true : undefined,\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\nexport class DialogCloseState {\n    static create(opts) {\n        return new DialogCloseState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref);\n        this.onclick = this.onclick.bind(this);\n        this.onkeydown = this.onkeydown.bind(this);\n    }\n    onclick(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.button > 0)\n            return;\n        this.root.handleClose();\n    }\n    onkeydown(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.key === kbd.SPACE || e.key === kbd.ENTER) {\n            e.preventDefault();\n            this.root.handleClose();\n        }\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(this.opts.variant.current)]: \"\",\n        onclick: this.onclick,\n        onkeydown: this.onkeydown,\n        disabled: this.opts.disabled.current ? true : undefined,\n        tabindex: 0,\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\nexport class DialogActionState {\n    static create(opts) {\n        return new DialogActionState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"action\")]: \"\",\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\nexport class DialogTitleState {\n    static create(opts) {\n        return new DialogTitleState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.root.titleId = this.opts.id.current;\n        this.attachment = attachRef(this.opts.ref);\n        watch.pre(() => this.opts.id.current, (id) => {\n            this.root.titleId = id;\n        });\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: \"heading\",\n        \"aria-level\": this.opts.level.current,\n        [this.root.getBitsAttr(\"title\")]: \"\",\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\nexport class DialogDescriptionState {\n    static create(opts) {\n        return new DialogDescriptionState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.root.descriptionId = this.opts.id.current;\n        this.attachment = attachRef(this.opts.ref, (v) => {\n            this.root.descriptionNode = v;\n        });\n        watch.pre(() => this.opts.id.current, (id) => {\n            this.root.descriptionId = id;\n        });\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"description\")]: \"\",\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\nexport class DialogContentState {\n    static create(opts) {\n        return new DialogContentState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref, (v) => {\n            this.root.contentNode = v;\n            this.root.contentId = v?.id;\n        });\n    }\n    snippetProps = $derived.by(() => ({ open: this.root.opts.open.current }));\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: this.root.opts.variant.current === \"alert-dialog\" ? \"alertdialog\" : \"dialog\",\n        \"aria-modal\": \"true\",\n        \"aria-describedby\": this.root.descriptionId,\n        \"aria-labelledby\": this.root.titleId,\n        [this.root.getBitsAttr(\"content\")]: \"\",\n        style: {\n            pointerEvents: \"auto\",\n            outline: this.root.opts.variant.current === \"alert-dialog\" ? \"none\" : undefined,\n            \"--bits-dialog-depth\": this.root.depth,\n            \"--bits-dialog-nested-count\": this.root.nestedOpenCount,\n        },\n        tabindex: this.root.opts.variant.current === \"alert-dialog\" ? -1 : undefined,\n        \"data-nested-open\": boolToEmptyStrOrUndef(this.root.nestedOpenCount > 0),\n        \"data-nested\": boolToEmptyStrOrUndef(this.root.parent !== null),\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n    get shouldRender() {\n        return this.root.contentPresence.shouldRender;\n    }\n}\nexport class DialogOverlayState {\n    static create(opts) {\n        return new DialogOverlayState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.root.overlayNode = v));\n    }\n    snippetProps = $derived.by(() => ({ open: this.root.opts.open.current }));\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"overlay\")]: \"\",\n        style: {\n            pointerEvents: \"auto\",\n            \"--bits-dialog-depth\": this.root.depth,\n            \"--bits-dialog-nested-count\": this.root.nestedOpenCount,\n        },\n        \"data-nested-open\": boolToEmptyStrOrUndef(this.root.nestedOpenCount > 0),\n        \"data-nested\": boolToEmptyStrOrUndef(this.root.parent !== null),\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n    get shouldRender() {\n        return this.root.overlayPresence.shouldRender;\n    }\n}\nexport class AlertDialogCancelState {\n    static create(opts) {\n        return new AlertDialogCancelState(opts, DialogRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.root.cancelNode = v));\n        this.onclick = this.onclick.bind(this);\n        this.onkeydown = this.onkeydown.bind(this);\n    }\n    onclick(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.button > 0)\n            return;\n        this.root.handleClose();\n    }\n    onkeydown(e) {\n        if (this.opts.disabled.current)\n            return;\n        if (e.key === kbd.SPACE || e.key === kbd.ENTER) {\n            e.preventDefault();\n            this.root.handleClose();\n        }\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"cancel\")]: \"\",\n        onclick: this.onclick,\n        onkeydown: this.onkeydown,\n        tabindex: 0,\n        ...this.root.sharedProps,\n        ...this.attachment,\n    }));\n}\n","<script lang=\"ts\">\n\timport { boxWith, mergeProps } from \"svelte-toolbelt\";\n\timport { DialogTitleState } from \"../dialog.svelte.js\";\n\timport type { DialogTitleProps } from \"../types.js\";\n\timport { createId } from \"../../../internal/create-id.js\";\n\n\tconst uid = $props.id();\n\n\tlet {\n\t\tid = createId(uid),\n\t\tref = $bindable(null),\n\t\tchild,\n\t\tchildren,\n\t\tlevel = 2,\n\t\t...restProps\n\t}: DialogTitleProps = $props();\n\n\tconst titleState = DialogTitleState.create({\n\t\tid: boxWith(() => id),\n\t\tlevel: boxWith(() => level),\n\t\tref: boxWith(\n\t\t\t() => ref,\n\t\t\t(v) => (ref = v)\n\t\t),\n\t});\n\n\tconst mergedProps = $derived(mergeProps(restProps, titleState.props));\n</script>\n\n{#if child}\n\t{@render child({ props: mergedProps })}\n{:else}\n\t<div {...mergedProps}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","/** @import { TemplateNode } from '#client' */\nimport { is_runes } from '../../context.js';\nimport { block } from '../../reactivity/effects.js';\nimport { hydrate_next, hydrating } from '../hydration.js';\nimport { BranchManager } from './branches.js';\n\n/**\n * @template V\n * @param {TemplateNode} node\n * @param {() => V} get_key\n * @param {(anchor: Node) => TemplateNode | void} render_fn\n * @returns {void}\n */\nexport function key(node, get_key, render_fn) {\n\tif (hydrating) {\n\t\thydrate_next();\n\t}\n\n\tvar branches = new BranchManager(node);\n\n\tvar legacy = !is_runes();\n\n\tblock(() => {\n\t\tvar key = get_key();\n\n\t\t// key blocks in Svelte <5 had stupid semantics\n\t\tif (legacy && key !== null && typeof key === 'object') {\n\t\t\tkey = /** @type {V} */ ({});\n\t\t}\n\n\t\tbranches.ensure(key, render_fn);\n\t});\n}\n","<script lang=\"ts\">\n\timport type { Snippet } from \"svelte\";\n\n\tconst { children }: { children?: Snippet } = $props();\n</script>\n\n{#key children}\n\t{@render children?.()}\n{/key}\n","import { Context } from \"runed\";\nimport { boxWith } from \"svelte-toolbelt\";\nexport const BitsConfigContext = new Context(\"BitsConfig\");\n/**\n * Gets the current Bits UI configuration state from the context.\n *\n * Returns a default configuration (where all values are `undefined`) if no configuration is found.\n */\nexport function getBitsConfig() {\n    const fallback = new BitsConfigState(null, {});\n    return BitsConfigContext.getOr(fallback).opts;\n}\n/**\n * Creates and sets a new Bits UI configuration state that inherits from parent configs.\n *\n * @param opts - Configuration options for this level\n * @returns The configuration state instance\n *\n * @example\n * ```typescript\n * // In a component that wants to set a default portal target\n * const config = useBitsConfig({ defaultPortalTo: box(\"#some-element\") });\n *\n * // Child components will inherit this config and can override specific values\n * const childConfig = useBitsConfig({ someOtherProp: box(\"value\") });\n * // childConfig still has defaultPortalTo=\"#some-element\" from parent\n * ```\n */\nexport function useBitsConfig(opts) {\n    return BitsConfigContext.set(new BitsConfigState(BitsConfigContext.getOr(null), opts));\n}\n/**\n * Configuration state that inherits from parent configurations.\n *\n * @example\n * Config resolution:\n * ```\n * Level 1: { defaultPortalTo: \"#some-element\", theme: \"dark\" }\n * Level 2: { spacing: \"large\" } // inherits defaultPortalTo=\"#some-element\", theme=\"dark\"\n * Level 3: { theme: \"light\" }   // inherits defaultPortalTo=\"#some-element\", spacing=\"large\", overrides theme=\"light\"\n * ```\n */\nexport class BitsConfigState {\n    opts;\n    constructor(parent, opts) {\n        const resolveConfigOption = createConfigResolver(parent, opts);\n        this.opts = {\n            defaultPortalTo: resolveConfigOption((config) => config.defaultPortalTo),\n            defaultLocale: resolveConfigOption((config) => config.defaultLocale),\n        };\n    }\n}\n/**\n * Returns a config resolver that resolves a given config option's value.\n *\n * The resolver creates reactive boxes that resolve config option values using this priority:\n * 1. Current level's value (if defined)\n * 2. Parent level's value (if defined and current is undefined)\n * 3. `undefined` (if no value is found in either parent or child)\n *\n * @param parent - Parent configuration state (null if this is root level)\n * @param currentOpts - Current level's configuration options\n *\n * @example\n * ```typescript\n * // Given this hierarchy:\n * // Root: { defaultPortalTo: \"#some-element\" }\n * // Child: { someOtherProp: \"value\" } // no defaultPortalTo specified\n *\n * const resolveConfigOption = createConfigResolver(parent, opts);\n * const portalTo = resolveConfigOption(config => config.defaultPortalTo);\n *\n * // portalTo.current === \"#some-element\" (inherited from parent)\n * // even when child didn't specify `defaultPortalTo`\n * ```\n */\nfunction createConfigResolver(parent, currentOpts) {\n    return (getter) => {\n        const configOption = boxWith(() => {\n            // try current opts first\n            const value = getter(currentOpts)?.current;\n            if (value !== undefined)\n                return value;\n            // if no parent, return undefined\n            if (parent === null)\n                return undefined;\n            // get value from parent (which already has its own chain resolved)\n            return getter(parent.opts)?.current;\n        });\n        return configOption;\n    };\n}\n","import { boxWith } from \"svelte-toolbelt\";\nimport { getBitsConfig } from \"./bits-config.js\";\n/**\n * Creates a generic prop resolver that follows a standard priority chain:\n * 1. The getter's prop value (if defined)\n * 2. The config default value (if no getter prop value is defined)\n * 3. The fallback value (if no config value found)\n */\nfunction createPropResolver(configOption, fallback) {\n    return (getProp) => {\n        const config = getBitsConfig();\n        return boxWith(() => {\n            // 1. return the prop's value, if provided\n            const propValue = getProp();\n            if (propValue !== undefined)\n                return propValue;\n            // 2. return the resolved config option value, if available\n            const option = configOption(config).current;\n            if (option !== undefined)\n                return option;\n            // 3. return the fallback if no other value is found\n            return fallback;\n        });\n    };\n}\n/**\n * Resolves a locale value using the prop, the config default, or a fallback.\n *\n * Default value: `\"en\"`\n */\nexport const resolveLocaleProp = createPropResolver((config) => config.defaultLocale, \"en\");\n/**\n * Resolves a portal's `to` value using the prop, the config default, or a fallback.\n *\n * Default value: `\"body\"`\n */\nexport const resolvePortalToProp = createPropResolver((config) => config.defaultPortalTo, \"body\");\n","<script lang=\"ts\">\n\timport { getAllContexts, mount, unmount } from \"svelte\";\n\timport { DEV } from \"esm-env\";\n\timport { watch } from \"runed\";\n\timport PortalConsumer from \"./portal-consumer.svelte\";\n\timport type { PortalProps } from \"./types.js\";\n\timport { isBrowser } from \"../../../internal/is.js\";\n\timport { resolvePortalToProp } from \"../config/prop-resolvers.js\";\n\n\tlet { to: toProp, children, disabled }: PortalProps = $props();\n\n\tconst to = resolvePortalToProp(() => toProp);\n\tconst context = getAllContexts();\n\n\tlet target = $derived(getTarget());\n\n\tfunction getTarget() {\n\t\tif (!isBrowser || disabled) return null;\n\n\t\tlet localTarget: Element | null = null;\n\n\t\tif (typeof to.current === \"string\") {\n\t\t\tconst target = document.querySelector(to.current);\n\t\t\tif (DEV && target === null) {\n\t\t\t\tthrow new Error(`Target element \"${to.current}\" not found.`);\n\t\t\t}\n\t\t\tlocalTarget = target;\n\t\t} else {\n\t\t\tlocalTarget = to.current;\n\t\t}\n\n\t\tif (DEV && !(localTarget instanceof Element)) {\n\t\t\tconst type = localTarget === null ? \"null\" : typeof localTarget;\n\t\t\tthrow new TypeError(\n\t\t\t\t`Unknown portal target type: ${type}. Allowed types: string (query selector) or Element.`\n\t\t\t);\n\t\t}\n\n\t\treturn localTarget;\n\t}\n\n\tlet instance: ReturnType<typeof mount> | null;\n\n\tfunction unmountInstance() {\n\t\tif (instance) {\n\t\t\tunmount(instance);\n\t\t\tinstance = null;\n\t\t}\n\t}\n\n\twatch([() => target, () => disabled], ([target, disabled]) => {\n\t\tif (!target || disabled) {\n\t\t\tunmountInstance();\n\t\t\treturn;\n\t\t}\n\t\tinstance = mount(PortalConsumer, {\n\t\t\ttarget: target,\n\t\t\tprops: { children },\n\t\t\tcontext,\n\t\t});\n\n\t\treturn () => {\n\t\t\tunmountInstance();\n\t\t};\n\t});\n</script>\n\n{#if disabled}\n\t{@render children?.()}\n{/if}\n","// oxlint-disable-next-line no-explicit-any\nexport function debounce(fn, wait = 500) {\n    let timeout = null;\n    const debounced = (...args) => {\n        if (timeout !== null) {\n            clearTimeout(timeout);\n        }\n        timeout = setTimeout(() => {\n            fn(...args);\n        }, wait);\n    };\n    debounced.destroy = () => {\n        if (timeout !== null) {\n            clearTimeout(timeout);\n            timeout = null;\n        }\n    };\n    return debounced;\n}\n","export function isOrContainsTarget(node, target) {\n    return node === target || node.contains(target);\n}\nexport function getOwnerDocument(el) {\n    return el?.ownerDocument ?? document;\n}\n","/*!\n* tabbable 6.3.0\n* @license MIT, https://github.com/focus-trap/tabbable/blob/master/LICENSE\n*/\n// NOTE: separate `:not()` selectors has broader browser support than the newer\n//  `:not([inert], [inert] *)` (Feb 2023)\n// CAREFUL: JSDom does not support `:not([inert] *)` as a selector; using it causes\n//  the entire query to fail, resulting in no nodes found, which will break a lot\n//  of things... so we have to rely on JS to identify nodes inside an inert container\nvar candidateSelectors = ['input:not([inert])', 'select:not([inert])', 'textarea:not([inert])', 'a[href]:not([inert])', 'button:not([inert])', '[tabindex]:not(slot):not([inert])', 'audio[controls]:not([inert])', 'video[controls]:not([inert])', '[contenteditable]:not([contenteditable=\"false\"]):not([inert])', 'details>summary:first-of-type:not([inert])', 'details:not([inert])'];\nvar candidateSelector = /* #__PURE__ */candidateSelectors.join(',');\nvar NoElement = typeof Element === 'undefined';\nvar matches = NoElement ? function () {} : Element.prototype.matches || Element.prototype.msMatchesSelector || Element.prototype.webkitMatchesSelector;\nvar getRootNode = !NoElement && Element.prototype.getRootNode ? function (element) {\n  var _element$getRootNode;\n  return element === null || element === void 0 ? void 0 : (_element$getRootNode = element.getRootNode) === null || _element$getRootNode === void 0 ? void 0 : _element$getRootNode.call(element);\n} : function (element) {\n  return element === null || element === void 0 ? void 0 : element.ownerDocument;\n};\n\n/**\n * Determines if a node is inert or in an inert ancestor.\n * @param {Element} [node]\n * @param {boolean} [lookUp] If true and `node` is not inert, looks up at ancestors to\n *  see if any of them are inert. If false, only `node` itself is considered.\n * @returns {boolean} True if inert itself or by way of being in an inert ancestor.\n *  False if `node` is falsy.\n */\nvar _isInert = function isInert(node, lookUp) {\n  var _node$getAttribute;\n  if (lookUp === void 0) {\n    lookUp = true;\n  }\n  // CAREFUL: JSDom does not support inert at all, so we can't use the `HTMLElement.inert`\n  //  JS API property; we have to check the attribute, which can either be empty or 'true';\n  //  if it's `null` (not specified) or 'false', it's an active element\n  var inertAtt = node === null || node === void 0 ? void 0 : (_node$getAttribute = node.getAttribute) === null || _node$getAttribute === void 0 ? void 0 : _node$getAttribute.call(node, 'inert');\n  var inert = inertAtt === '' || inertAtt === 'true';\n\n  // NOTE: this could also be handled with `node.matches('[inert], :is([inert] *)')`\n  //  if it weren't for `matches()` not being a function on shadow roots; the following\n  //  code works for any kind of node\n  // CAREFUL: JSDom does not appear to support certain selectors like `:not([inert] *)`\n  //  so it likely would not support `:is([inert] *)` either...\n  var result = inert || lookUp && node && _isInert(node.parentNode); // recursive\n\n  return result;\n};\n\n/**\n * Determines if a node's content is editable.\n * @param {Element} [node]\n * @returns True if it's content-editable; false if it's not or `node` is falsy.\n */\nvar isContentEditable = function isContentEditable(node) {\n  var _node$getAttribute2;\n  // CAREFUL: JSDom does not support the `HTMLElement.isContentEditable` API so we have\n  //  to use the attribute directly to check for this, which can either be empty or 'true';\n  //  if it's `null` (not specified) or 'false', it's a non-editable element\n  var attValue = node === null || node === void 0 ? void 0 : (_node$getAttribute2 = node.getAttribute) === null || _node$getAttribute2 === void 0 ? void 0 : _node$getAttribute2.call(node, 'contenteditable');\n  return attValue === '' || attValue === 'true';\n};\n\n/**\n * @param {Element} el container to check in\n * @param {boolean} includeContainer add container to check\n * @param {(node: Element) => boolean} filter filter candidates\n * @returns {Element[]}\n */\nvar getCandidates = function getCandidates(el, includeContainer, filter) {\n  // even if `includeContainer=false`, we still have to check it for inertness because\n  //  if it's inert, all its children are inert\n  if (_isInert(el)) {\n    return [];\n  }\n  var candidates = Array.prototype.slice.apply(el.querySelectorAll(candidateSelector));\n  if (includeContainer && matches.call(el, candidateSelector)) {\n    candidates.unshift(el);\n  }\n  candidates = candidates.filter(filter);\n  return candidates;\n};\n\n/**\n * @callback GetShadowRoot\n * @param {Element} element to check for shadow root\n * @returns {ShadowRoot|boolean} ShadowRoot if available or boolean indicating if a shadowRoot is attached but not available.\n */\n\n/**\n * @callback ShadowRootFilter\n * @param {Element} shadowHostNode the element which contains shadow content\n * @returns {boolean} true if a shadow root could potentially contain valid candidates.\n */\n\n/**\n * @typedef {Object} CandidateScope\n * @property {Element} scopeParent contains inner candidates\n * @property {Element[]} candidates list of candidates found in the scope parent\n */\n\n/**\n * @typedef {Object} IterativeOptions\n * @property {GetShadowRoot|boolean} getShadowRoot true if shadow support is enabled; falsy if not;\n *  if a function, implies shadow support is enabled and either returns the shadow root of an element\n *  or a boolean stating if it has an undisclosed shadow root\n * @property {(node: Element) => boolean} filter filter candidates\n * @property {boolean} flatten if true then result will flatten any CandidateScope into the returned list\n * @property {ShadowRootFilter} shadowRootFilter filter shadow roots;\n */\n\n/**\n * @param {Element[]} elements list of element containers to match candidates from\n * @param {boolean} includeContainer add container list to check\n * @param {IterativeOptions} options\n * @returns {Array.<Element|CandidateScope>}\n */\nvar _getCandidatesIteratively = function getCandidatesIteratively(elements, includeContainer, options) {\n  var candidates = [];\n  var elementsToCheck = Array.from(elements);\n  while (elementsToCheck.length) {\n    var element = elementsToCheck.shift();\n    if (_isInert(element, false)) {\n      // no need to look up since we're drilling down\n      // anything inside this container will also be inert\n      continue;\n    }\n    if (element.tagName === 'SLOT') {\n      // add shadow dom slot scope (slot itself cannot be focusable)\n      var assigned = element.assignedElements();\n      var content = assigned.length ? assigned : element.children;\n      var nestedCandidates = _getCandidatesIteratively(content, true, options);\n      if (options.flatten) {\n        candidates.push.apply(candidates, nestedCandidates);\n      } else {\n        candidates.push({\n          scopeParent: element,\n          candidates: nestedCandidates\n        });\n      }\n    } else {\n      // check candidate element\n      var validCandidate = matches.call(element, candidateSelector);\n      if (validCandidate && options.filter(element) && (includeContainer || !elements.includes(element))) {\n        candidates.push(element);\n      }\n\n      // iterate over shadow content if possible\n      var shadowRoot = element.shadowRoot ||\n      // check for an undisclosed shadow\n      typeof options.getShadowRoot === 'function' && options.getShadowRoot(element);\n\n      // no inert look up because we're already drilling down and checking for inertness\n      //  on the way down, so all containers to this root node should have already been\n      //  vetted as non-inert\n      var validShadowRoot = !_isInert(shadowRoot, false) && (!options.shadowRootFilter || options.shadowRootFilter(element));\n      if (shadowRoot && validShadowRoot) {\n        // add shadow dom scope IIF a shadow root node was given; otherwise, an undisclosed\n        //  shadow exists, so look at light dom children as fallback BUT create a scope for any\n        //  child candidates found because they're likely slotted elements (elements that are\n        //  children of the web component element (which has the shadow), in the light dom, but\n        //  slotted somewhere _inside_ the undisclosed shadow) -- the scope is created below,\n        //  _after_ we return from this recursive call\n        var _nestedCandidates = _getCandidatesIteratively(shadowRoot === true ? element.children : shadowRoot.children, true, options);\n        if (options.flatten) {\n          candidates.push.apply(candidates, _nestedCandidates);\n        } else {\n          candidates.push({\n            scopeParent: element,\n            candidates: _nestedCandidates\n          });\n        }\n      } else {\n        // there's not shadow so just dig into the element's (light dom) children\n        //  __without__ giving the element special scope treatment\n        elementsToCheck.unshift.apply(elementsToCheck, element.children);\n      }\n    }\n  }\n  return candidates;\n};\n\n/**\n * @private\n * Determines if the node has an explicitly specified `tabindex` attribute.\n * @param {HTMLElement} node\n * @returns {boolean} True if so; false if not.\n */\nvar hasTabIndex = function hasTabIndex(node) {\n  return !isNaN(parseInt(node.getAttribute('tabindex'), 10));\n};\n\n/**\n * Determine the tab index of a given node.\n * @param {HTMLElement} node\n * @returns {number} Tab order (negative, 0, or positive number).\n * @throws {Error} If `node` is falsy.\n */\nvar getTabIndex = function getTabIndex(node) {\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (node.tabIndex < 0) {\n    // in Chrome, <details/>, <audio controls/> and <video controls/> elements get a default\n    // `tabIndex` of -1 when the 'tabindex' attribute isn't specified in the DOM,\n    // yet they are still part of the regular tab order; in FF, they get a default\n    // `tabIndex` of 0; since Chrome still puts those elements in the regular tab\n    // order, consider their tab index to be 0.\n    // Also browsers do not return `tabIndex` correctly for contentEditable nodes;\n    // so if they don't have a tabindex attribute specifically set, assume it's 0.\n    if ((/^(AUDIO|VIDEO|DETAILS)$/.test(node.tagName) || isContentEditable(node)) && !hasTabIndex(node)) {\n      return 0;\n    }\n  }\n  return node.tabIndex;\n};\n\n/**\n * Determine the tab index of a given node __for sort order purposes__.\n * @param {HTMLElement} node\n * @param {boolean} [isScope] True for a custom element with shadow root or slot that, by default,\n *  has tabIndex -1, but needs to be sorted by document order in order for its content to be\n *  inserted into the correct sort position.\n * @returns {number} Tab order (negative, 0, or positive number).\n */\nvar getSortOrderTabIndex = function getSortOrderTabIndex(node, isScope) {\n  var tabIndex = getTabIndex(node);\n  if (tabIndex < 0 && isScope && !hasTabIndex(node)) {\n    return 0;\n  }\n  return tabIndex;\n};\nvar sortOrderedTabbables = function sortOrderedTabbables(a, b) {\n  return a.tabIndex === b.tabIndex ? a.documentOrder - b.documentOrder : a.tabIndex - b.tabIndex;\n};\nvar isInput = function isInput(node) {\n  return node.tagName === 'INPUT';\n};\nvar isHiddenInput = function isHiddenInput(node) {\n  return isInput(node) && node.type === 'hidden';\n};\nvar isDetailsWithSummary = function isDetailsWithSummary(node) {\n  var r = node.tagName === 'DETAILS' && Array.prototype.slice.apply(node.children).some(function (child) {\n    return child.tagName === 'SUMMARY';\n  });\n  return r;\n};\nvar getCheckedRadio = function getCheckedRadio(nodes, form) {\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i].checked && nodes[i].form === form) {\n      return nodes[i];\n    }\n  }\n};\nvar isTabbableRadio = function isTabbableRadio(node) {\n  if (!node.name) {\n    return true;\n  }\n  var radioScope = node.form || getRootNode(node);\n  var queryRadios = function queryRadios(name) {\n    return radioScope.querySelectorAll('input[type=\"radio\"][name=\"' + name + '\"]');\n  };\n  var radioSet;\n  if (typeof window !== 'undefined' && typeof window.CSS !== 'undefined' && typeof window.CSS.escape === 'function') {\n    radioSet = queryRadios(window.CSS.escape(node.name));\n  } else {\n    try {\n      radioSet = queryRadios(node.name);\n    } catch (err) {\n      // eslint-disable-next-line no-console\n      console.error('Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s', err.message);\n      return false;\n    }\n  }\n  var checked = getCheckedRadio(radioSet, node.form);\n  return !checked || checked === node;\n};\nvar isRadio = function isRadio(node) {\n  return isInput(node) && node.type === 'radio';\n};\nvar isNonTabbableRadio = function isNonTabbableRadio(node) {\n  return isRadio(node) && !isTabbableRadio(node);\n};\n\n// determines if a node is ultimately attached to the window's document\nvar isNodeAttached = function isNodeAttached(node) {\n  var _nodeRoot;\n  // The root node is the shadow root if the node is in a shadow DOM; some document otherwise\n  //  (but NOT _the_ document; see second 'If' comment below for more).\n  // If rootNode is shadow root, it'll have a host, which is the element to which the shadow\n  //  is attached, and the one we need to check if it's in the document or not (because the\n  //  shadow, and all nodes it contains, is never considered in the document since shadows\n  //  behave like self-contained DOMs; but if the shadow's HOST, which is part of the document,\n  //  is hidden, or is not in the document itself but is detached, it will affect the shadow's\n  //  visibility, including all the nodes it contains). The host could be any normal node,\n  //  or a custom element (i.e. web component). Either way, that's the one that is considered\n  //  part of the document, not the shadow root, nor any of its children (i.e. the node being\n  //  tested).\n  // To further complicate things, we have to look all the way up until we find a shadow HOST\n  //  that is attached (or find none) because the node might be in nested shadows...\n  // If rootNode is not a shadow root, it won't have a host, and so rootNode should be the\n  //  document (per the docs) and while it's a Document-type object, that document does not\n  //  appear to be the same as the node's `ownerDocument` for some reason, so it's safer\n  //  to ignore the rootNode at this point, and use `node.ownerDocument`. Otherwise,\n  //  using `rootNode.contains(node)` will _always_ be true we'll get false-positives when\n  //  node is actually detached.\n  // NOTE: If `nodeRootHost` or `node` happens to be the `document` itself (which is possible\n  //  if a tabbable/focusable node was quickly added to the DOM, focused, and then removed\n  //  from the DOM as in https://github.com/focus-trap/focus-trap-react/issues/905), then\n  //  `ownerDocument` will be `null`, hence the optional chaining on it.\n  var nodeRoot = node && getRootNode(node);\n  var nodeRootHost = (_nodeRoot = nodeRoot) === null || _nodeRoot === void 0 ? void 0 : _nodeRoot.host;\n\n  // in some cases, a detached node will return itself as the root instead of a document or\n  //  shadow root object, in which case, we shouldn't try to look further up the host chain\n  var attached = false;\n  if (nodeRoot && nodeRoot !== node) {\n    var _nodeRootHost, _nodeRootHost$ownerDo, _node$ownerDocument;\n    attached = !!((_nodeRootHost = nodeRootHost) !== null && _nodeRootHost !== void 0 && (_nodeRootHost$ownerDo = _nodeRootHost.ownerDocument) !== null && _nodeRootHost$ownerDo !== void 0 && _nodeRootHost$ownerDo.contains(nodeRootHost) || node !== null && node !== void 0 && (_node$ownerDocument = node.ownerDocument) !== null && _node$ownerDocument !== void 0 && _node$ownerDocument.contains(node));\n    while (!attached && nodeRootHost) {\n      var _nodeRoot2, _nodeRootHost2, _nodeRootHost2$ownerD;\n      // since it's not attached and we have a root host, the node MUST be in a nested shadow DOM,\n      //  which means we need to get the host's host and check if that parent host is contained\n      //  in (i.e. attached to) the document\n      nodeRoot = getRootNode(nodeRootHost);\n      nodeRootHost = (_nodeRoot2 = nodeRoot) === null || _nodeRoot2 === void 0 ? void 0 : _nodeRoot2.host;\n      attached = !!((_nodeRootHost2 = nodeRootHost) !== null && _nodeRootHost2 !== void 0 && (_nodeRootHost2$ownerD = _nodeRootHost2.ownerDocument) !== null && _nodeRootHost2$ownerD !== void 0 && _nodeRootHost2$ownerD.contains(nodeRootHost));\n    }\n  }\n  return attached;\n};\nvar isZeroArea = function isZeroArea(node) {\n  var _node$getBoundingClie = node.getBoundingClientRect(),\n    width = _node$getBoundingClie.width,\n    height = _node$getBoundingClie.height;\n  return width === 0 && height === 0;\n};\nvar isHidden = function isHidden(node, _ref) {\n  var displayCheck = _ref.displayCheck,\n    getShadowRoot = _ref.getShadowRoot;\n  if (displayCheck === 'full-native') {\n    if ('checkVisibility' in node) {\n      // Chrome >= 105, Edge >= 105, Firefox >= 106, Safari >= 17.4\n      // @see https://developer.mozilla.org/en-US/docs/Web/API/Element/checkVisibility#browser_compatibility\n      var visible = node.checkVisibility({\n        // Checking opacity might be desirable for some use cases, but natively,\n        // opacity zero elements _are_ focusable and tabbable.\n        checkOpacity: false,\n        opacityProperty: false,\n        contentVisibilityAuto: true,\n        visibilityProperty: true,\n        // This is an alias for `visibilityProperty`. Contemporary browsers\n        // support both. However, this alias has wider browser support (Chrome\n        // >= 105 and Firefox >= 106, vs. Chrome >= 121 and Firefox >= 122), so\n        // we include it anyway.\n        checkVisibilityCSS: true\n      });\n      return !visible;\n    }\n    // Fall through to manual visibility checks\n  }\n\n  // NOTE: visibility will be `undefined` if node is detached from the document\n  //  (see notes about this further down), which means we will consider it visible\n  //  (this is legacy behavior from a very long way back)\n  // NOTE: we check this regardless of `displayCheck=\"none\"` because this is a\n  //  _visibility_ check, not a _display_ check\n  if (getComputedStyle(node).visibility === 'hidden') {\n    return true;\n  }\n  var isDirectSummary = matches.call(node, 'details>summary:first-of-type');\n  var nodeUnderDetails = isDirectSummary ? node.parentElement : node;\n  if (matches.call(nodeUnderDetails, 'details:not([open]) *')) {\n    return true;\n  }\n  if (!displayCheck || displayCheck === 'full' ||\n  // full-native can run this branch when it falls through in case\n  // Element#checkVisibility is unsupported\n  displayCheck === 'full-native' || displayCheck === 'legacy-full') {\n    if (typeof getShadowRoot === 'function') {\n      // figure out if we should consider the node to be in an undisclosed shadow and use the\n      //  'non-zero-area' fallback\n      var originalNode = node;\n      while (node) {\n        var parentElement = node.parentElement;\n        var rootNode = getRootNode(node);\n        if (parentElement && !parentElement.shadowRoot && getShadowRoot(parentElement) === true // check if there's an undisclosed shadow\n        ) {\n          // node has an undisclosed shadow which means we can only treat it as a black box, so we\n          //  fall back to a non-zero-area test\n          return isZeroArea(node);\n        } else if (node.assignedSlot) {\n          // iterate up slot\n          node = node.assignedSlot;\n        } else if (!parentElement && rootNode !== node.ownerDocument) {\n          // cross shadow boundary\n          node = rootNode.host;\n        } else {\n          // iterate up normal dom\n          node = parentElement;\n        }\n      }\n      node = originalNode;\n    }\n    // else, `getShadowRoot` might be true, but all that does is enable shadow DOM support\n    //  (i.e. it does not also presume that all nodes might have undisclosed shadows); or\n    //  it might be a falsy value, which means shadow DOM support is disabled\n\n    // Since we didn't find it sitting in an undisclosed shadow (or shadows are disabled)\n    //  now we can just test to see if it would normally be visible or not, provided it's\n    //  attached to the main document.\n    // NOTE: We must consider case where node is inside a shadow DOM and given directly to\n    //  `isTabbable()` or `isFocusable()` -- regardless of `getShadowRoot` option setting.\n\n    if (isNodeAttached(node)) {\n      // this works wherever the node is: if there's at least one client rect, it's\n      //  somehow displayed; it also covers the CSS 'display: contents' case where the\n      //  node itself is hidden in place of its contents; and there's no need to search\n      //  up the hierarchy either\n      return !node.getClientRects().length;\n    }\n\n    // Else, the node isn't attached to the document, which means the `getClientRects()`\n    //  API will __always__ return zero rects (this can happen, for example, if React\n    //  is used to render nodes onto a detached tree, as confirmed in this thread:\n    //  https://github.com/facebook/react/issues/9117#issuecomment-284228870)\n    //\n    // It also means that even window.getComputedStyle(node).display will return `undefined`\n    //  because styles are only computed for nodes that are in the document.\n    //\n    // NOTE: THIS HAS BEEN THE CASE FOR YEARS. It is not new, nor is it caused by tabbable\n    //  somehow. Though it was never stated officially, anyone who has ever used tabbable\n    //  APIs on nodes in detached containers has actually implicitly used tabbable in what\n    //  was later (as of v5.2.0 on Apr 9, 2021) called `displayCheck=\"none\"` mode -- essentially\n    //  considering __everything__ to be visible because of the innability to determine styles.\n    //\n    // v6.0.0: As of this major release, the default 'full' option __no longer treats detached\n    //  nodes as visible with the 'none' fallback.__\n    if (displayCheck !== 'legacy-full') {\n      return true; // hidden\n    }\n    // else, fallback to 'none' mode and consider the node visible\n  } else if (displayCheck === 'non-zero-area') {\n    // NOTE: Even though this tests that the node's client rect is non-zero to determine\n    //  whether it's displayed, and that a detached node will __always__ have a zero-area\n    //  client rect, we don't special-case for whether the node is attached or not. In\n    //  this mode, we do want to consider nodes that have a zero area to be hidden at all\n    //  times, and that includes attached or not.\n    return isZeroArea(node);\n  }\n\n  // visible, as far as we can tell, or per current `displayCheck=none` mode, we assume\n  //  it's visible\n  return false;\n};\n\n// form fields (nested) inside a disabled fieldset are not focusable/tabbable\n//  unless they are in the _first_ <legend> element of the top-most disabled\n//  fieldset\nvar isDisabledFromFieldset = function isDisabledFromFieldset(node) {\n  if (/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(node.tagName)) {\n    var parentNode = node.parentElement;\n    // check if `node` is contained in a disabled <fieldset>\n    while (parentNode) {\n      if (parentNode.tagName === 'FIELDSET' && parentNode.disabled) {\n        // look for the first <legend> among the children of the disabled <fieldset>\n        for (var i = 0; i < parentNode.children.length; i++) {\n          var child = parentNode.children.item(i);\n          // when the first <legend> (in document order) is found\n          if (child.tagName === 'LEGEND') {\n            // if its parent <fieldset> is not nested in another disabled <fieldset>,\n            // return whether `node` is a descendant of its first <legend>\n            return matches.call(parentNode, 'fieldset[disabled] *') ? true : !child.contains(node);\n          }\n        }\n        // the disabled <fieldset> containing `node` has no <legend>\n        return true;\n      }\n      parentNode = parentNode.parentElement;\n    }\n  }\n\n  // else, node's tabbable/focusable state should not be affected by a fieldset's\n  //  enabled/disabled state\n  return false;\n};\nvar isNodeMatchingSelectorFocusable = function isNodeMatchingSelectorFocusable(options, node) {\n  if (node.disabled ||\n  // we must do an inert look up to filter out any elements inside an inert ancestor\n  //  because we're limited in the type of selectors we can use in JSDom (see related\n  //  note related to `candidateSelectors`)\n  _isInert(node) || isHiddenInput(node) || isHidden(node, options) ||\n  // For a details element with a summary, the summary element gets the focus\n  isDetailsWithSummary(node) || isDisabledFromFieldset(node)) {\n    return false;\n  }\n  return true;\n};\nvar isNodeMatchingSelectorTabbable = function isNodeMatchingSelectorTabbable(options, node) {\n  if (isNonTabbableRadio(node) || getTabIndex(node) < 0 || !isNodeMatchingSelectorFocusable(options, node)) {\n    return false;\n  }\n  return true;\n};\nvar isShadowRootTabbable = function isShadowRootTabbable(shadowHostNode) {\n  var tabIndex = parseInt(shadowHostNode.getAttribute('tabindex'), 10);\n  if (isNaN(tabIndex) || tabIndex >= 0) {\n    return true;\n  }\n  // If a custom element has an explicit negative tabindex,\n  // browsers will not allow tab targeting said element's children.\n  return false;\n};\n\n/**\n * @param {Array.<Element|CandidateScope>} candidates\n * @returns Element[]\n */\nvar _sortByOrder = function sortByOrder(candidates) {\n  var regularTabbables = [];\n  var orderedTabbables = [];\n  candidates.forEach(function (item, i) {\n    var isScope = !!item.scopeParent;\n    var element = isScope ? item.scopeParent : item;\n    var candidateTabindex = getSortOrderTabIndex(element, isScope);\n    var elements = isScope ? _sortByOrder(item.candidates) : element;\n    if (candidateTabindex === 0) {\n      isScope ? regularTabbables.push.apply(regularTabbables, elements) : regularTabbables.push(element);\n    } else {\n      orderedTabbables.push({\n        documentOrder: i,\n        tabIndex: candidateTabindex,\n        item: item,\n        isScope: isScope,\n        content: elements\n      });\n    }\n  });\n  return orderedTabbables.sort(sortOrderedTabbables).reduce(function (acc, sortable) {\n    sortable.isScope ? acc.push.apply(acc, sortable.content) : acc.push(sortable.content);\n    return acc;\n  }, []).concat(regularTabbables);\n};\nvar tabbable = function tabbable(container, options) {\n  options = options || {};\n  var candidates;\n  if (options.getShadowRoot) {\n    candidates = _getCandidatesIteratively([container], options.includeContainer, {\n      filter: isNodeMatchingSelectorTabbable.bind(null, options),\n      flatten: false,\n      getShadowRoot: options.getShadowRoot,\n      shadowRootFilter: isShadowRootTabbable\n    });\n  } else {\n    candidates = getCandidates(container, options.includeContainer, isNodeMatchingSelectorTabbable.bind(null, options));\n  }\n  return _sortByOrder(candidates);\n};\nvar focusable = function focusable(container, options) {\n  options = options || {};\n  var candidates;\n  if (options.getShadowRoot) {\n    candidates = _getCandidatesIteratively([container], options.includeContainer, {\n      filter: isNodeMatchingSelectorFocusable.bind(null, options),\n      flatten: true,\n      getShadowRoot: options.getShadowRoot\n    });\n  } else {\n    candidates = getCandidates(container, options.includeContainer, isNodeMatchingSelectorFocusable.bind(null, options));\n  }\n  return candidates;\n};\nvar isTabbable = function isTabbable(node, options) {\n  options = options || {};\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (matches.call(node, candidateSelector) === false) {\n    return false;\n  }\n  return isNodeMatchingSelectorTabbable(options, node);\n};\nvar focusableCandidateSelector = /* #__PURE__ */candidateSelectors.concat('iframe').join(',');\nvar isFocusable = function isFocusable(node, options) {\n  options = options || {};\n  if (!node) {\n    throw new Error('No node provided');\n  }\n  if (matches.call(node, focusableCandidateSelector) === false) {\n    return false;\n  }\n  return isNodeMatchingSelectorFocusable(options, node);\n};\n\nexport { focusable, getTabIndex, isFocusable, isTabbable, tabbable };\n//# sourceMappingURL=index.esm.js.map\n","import { afterTick, mergeProps, onDestroyEffect, attachRef, DOMContext, getWindow, simpleBox, boxWith, } from \"svelte-toolbelt\";\nimport { Context, watch } from \"runed\";\nimport { FIRST_LAST_KEYS, LAST_KEYS, SELECTION_KEYS, SUB_OPEN_KEYS, getCheckedState, isMouseEvent, } from \"./utils.js\";\nimport { focusFirst } from \"../../internal/focus.js\";\nimport { CustomEventDispatcher } from \"../../internal/events.js\";\nimport { isElement, isElementOrSVGElement, isHTMLElement } from \"../../internal/is.js\";\nimport { kbd } from \"../../internal/kbd.js\";\nimport { createBitsAttrs, getAriaChecked, boolToStr, getDataOpenClosed, boolToEmptyStrOrUndef, } from \"../../internal/attrs.js\";\nimport { IsUsingKeyboard } from \"../../index.js\";\nimport { getTabbableFrom } from \"../../internal/tabbable.js\";\nimport { isTabbable } from \"tabbable\";\nimport { DOMTypeahead } from \"../../internal/dom-typeahead.svelte.js\";\nimport { RovingFocusGroup } from \"../../internal/roving-focus-group.js\";\nimport { GraceArea } from \"../../internal/grace-area.svelte.js\";\nimport { PresenceManager } from \"../../internal/presence-manager.svelte.js\";\nexport const CONTEXT_MENU_TRIGGER_ATTR = \"data-context-menu-trigger\";\nexport const CONTEXT_MENU_CONTENT_ATTR = \"data-context-menu-content\";\nconst MenuRootContext = new Context(\"Menu.Root\");\nconst MenuMenuContext = new Context(\"Menu.Root | Menu.Sub\");\nconst MenuContentContext = new Context(\"Menu.Content\");\nconst MenuGroupContext = new Context(\"Menu.Group | Menu.RadioGroup\");\nconst MenuRadioGroupContext = new Context(\"Menu.RadioGroup\");\nexport const MenuCheckboxGroupContext = new Context(\"Menu.CheckboxGroup\");\nexport const MenuOpenEvent = new CustomEventDispatcher(\"bitsmenuopen\", {\n    bubbles: false,\n    cancelable: true,\n});\nexport const menuAttrs = createBitsAttrs({\n    component: \"menu\",\n    parts: [\n        \"trigger\",\n        \"content\",\n        \"sub-trigger\",\n        \"item\",\n        \"group\",\n        \"group-heading\",\n        \"checkbox-group\",\n        \"checkbox-item\",\n        \"radio-group\",\n        \"radio-item\",\n        \"separator\",\n        \"sub-content\",\n        \"arrow\",\n    ],\n});\nexport class MenuRootState {\n    static create(opts) {\n        const root = new MenuRootState(opts);\n        return MenuRootContext.set(root);\n    }\n    opts;\n    isUsingKeyboard = new IsUsingKeyboard();\n    ignoreCloseAutoFocus = $state(false);\n    isPointerInTransit = $state(false);\n    constructor(opts) {\n        this.opts = opts;\n    }\n    getBitsAttr = (part) => {\n        return menuAttrs.getAttr(part, this.opts.variant.current);\n    };\n}\nexport class MenuMenuState {\n    static create(opts, root) {\n        return MenuMenuContext.set(new MenuMenuState(opts, root, null));\n    }\n    opts;\n    root;\n    parentMenu;\n    contentId = boxWith(() => \"\");\n    contentNode = $state(null);\n    contentPresence;\n    triggerNode = $state(null);\n    constructor(opts, root, parentMenu) {\n        this.opts = opts;\n        this.root = root;\n        this.parentMenu = parentMenu;\n        this.contentPresence = new PresenceManager({\n            ref: boxWith(() => this.contentNode),\n            open: this.opts.open,\n            onComplete: () => {\n                this.opts.onOpenChangeComplete.current(this.opts.open.current);\n            },\n        });\n        if (parentMenu) {\n            watch(() => parentMenu.opts.open.current, () => {\n                if (parentMenu.opts.open.current)\n                    return;\n                this.opts.open.current = false;\n            });\n        }\n    }\n    toggleOpen() {\n        this.opts.open.current = !this.opts.open.current;\n    }\n    onOpen() {\n        this.opts.open.current = true;\n    }\n    onClose() {\n        this.opts.open.current = false;\n    }\n}\nexport class MenuContentState {\n    static create(opts) {\n        return MenuContentContext.set(new MenuContentState(opts, MenuMenuContext.get()));\n    }\n    opts;\n    parentMenu;\n    rovingFocusGroup;\n    domContext;\n    attachment;\n    search = $state(\"\");\n    #timer = 0;\n    #handleTypeaheadSearch;\n    mounted = $state(false);\n    #isSub;\n    constructor(opts, parentMenu) {\n        this.opts = opts;\n        this.parentMenu = parentMenu;\n        this.domContext = new DOMContext(opts.ref);\n        this.attachment = attachRef(this.opts.ref, (v) => {\n            if (this.parentMenu.contentNode !== v) {\n                this.parentMenu.contentNode = v;\n            }\n        });\n        parentMenu.contentId = opts.id;\n        this.#isSub = opts.isSub ?? false;\n        this.onkeydown = this.onkeydown.bind(this);\n        this.onblur = this.onblur.bind(this);\n        this.onfocus = this.onfocus.bind(this);\n        this.handleInteractOutside = this.handleInteractOutside.bind(this);\n        new GraceArea({\n            contentNode: () => this.parentMenu.contentNode,\n            triggerNode: () => this.parentMenu.triggerNode,\n            enabled: () => this.parentMenu.opts.open.current &&\n                Boolean(this.parentMenu.triggerNode?.hasAttribute(this.parentMenu.root.getBitsAttr(\"sub-trigger\"))),\n            onPointerExit: () => {\n                this.parentMenu.opts.open.current = false;\n            },\n            setIsPointerInTransit: (value) => {\n                this.parentMenu.root.isPointerInTransit = value;\n            },\n        });\n        this.#handleTypeaheadSearch = new DOMTypeahead({\n            getActiveElement: () => this.domContext.getActiveElement(),\n            getWindow: () => this.domContext.getWindow(),\n        }).handleTypeaheadSearch;\n        this.rovingFocusGroup = new RovingFocusGroup({\n            rootNode: boxWith(() => this.parentMenu.contentNode),\n            candidateAttr: this.parentMenu.root.getBitsAttr(\"item\"),\n            loop: this.opts.loop,\n            orientation: boxWith(() => \"vertical\"),\n        });\n        watch(() => this.parentMenu.contentNode, (contentNode) => {\n            if (!contentNode)\n                return;\n            const handler = () => {\n                afterTick(() => {\n                    if (!this.parentMenu.root.isUsingKeyboard.current)\n                        return;\n                    this.rovingFocusGroup.focusFirstCandidate();\n                });\n            };\n            return MenuOpenEvent.listen(contentNode, handler);\n        });\n        $effect(() => {\n            if (!this.parentMenu.opts.open.current) {\n                this.domContext.getWindow().clearTimeout(this.#timer);\n            }\n        });\n    }\n    #getCandidateNodes() {\n        const node = this.parentMenu.contentNode;\n        if (!node)\n            return [];\n        const candidates = Array.from(node.querySelectorAll(`[${this.parentMenu.root.getBitsAttr(\"item\")}]:not([data-disabled])`));\n        return candidates;\n    }\n    #isPointerMovingToSubmenu() {\n        return this.parentMenu.root.isPointerInTransit;\n    }\n    onCloseAutoFocus = (e) => {\n        this.opts.onCloseAutoFocus.current?.(e);\n        if (e.defaultPrevented || this.#isSub)\n            return;\n        if (this.parentMenu.triggerNode && isTabbable(this.parentMenu.triggerNode)) {\n            e.preventDefault();\n            this.parentMenu.triggerNode.focus();\n        }\n    };\n    handleTabKeyDown(e) {\n        /**\n         * We locate the root `menu`'s trigger by going up the tree until\n         * we find a menu that has no parent. This will allow us to focus the next\n         * tabbable element before/after the root trigger.\n         */\n        let rootMenu = this.parentMenu;\n        while (rootMenu.parentMenu !== null) {\n            rootMenu = rootMenu.parentMenu;\n        }\n        // if for some unforeseen reason the root menu has no trigger, we bail\n        if (!rootMenu.triggerNode)\n            return;\n        // cancel default tab behavior\n        e.preventDefault();\n        // find the next/previous tabbable\n        const nodeToFocus = getTabbableFrom(rootMenu.triggerNode, e.shiftKey ? \"prev\" : \"next\");\n        if (nodeToFocus) {\n            /**\n             * We set a flag to ignore the `onCloseAutoFocus` event handler\n             * as well as the fallbacks inside the focus scope to prevent\n             * race conditions causing focus to fall back to the body even\n             * though we're trying to focus the next tabbable element.\n             */\n            this.parentMenu.root.ignoreCloseAutoFocus = true;\n            rootMenu.onClose();\n            afterTick(() => {\n                nodeToFocus.focus();\n                afterTick(() => {\n                    this.parentMenu.root.ignoreCloseAutoFocus = false;\n                });\n            });\n        }\n        else {\n            this.domContext.getDocument().body.focus();\n        }\n    }\n    onkeydown(e) {\n        if (e.defaultPrevented)\n            return;\n        if (e.key === kbd.TAB) {\n            this.handleTabKeyDown(e);\n            return;\n        }\n        const target = e.target;\n        const currentTarget = e.currentTarget;\n        if (!isHTMLElement(target) || !isHTMLElement(currentTarget))\n            return;\n        const isKeydownInside = target.closest(`[${this.parentMenu.root.getBitsAttr(\"content\")}]`)?.id ===\n            this.parentMenu.contentId.current;\n        const isModifierKey = e.ctrlKey || e.altKey || e.metaKey;\n        const isCharacterKey = e.key.length === 1;\n        const kbdFocusedEl = this.rovingFocusGroup.handleKeydown(target, e);\n        if (kbdFocusedEl)\n            return;\n        // prevent space from being considered with typeahead\n        if (e.code === \"Space\")\n            return;\n        const candidateNodes = this.#getCandidateNodes();\n        if (isKeydownInside) {\n            if (!isModifierKey && isCharacterKey) {\n                this.#handleTypeaheadSearch(e.key, candidateNodes);\n            }\n        }\n        // focus first/last based on key pressed\n        if (e.target?.id !== this.parentMenu.contentId.current)\n            return;\n        if (!FIRST_LAST_KEYS.includes(e.key))\n            return;\n        e.preventDefault();\n        if (LAST_KEYS.includes(e.key)) {\n            candidateNodes.reverse();\n        }\n        focusFirst(candidateNodes, { select: false }, () => this.domContext.getActiveElement());\n    }\n    onblur(e) {\n        if (!isElement(e.currentTarget))\n            return;\n        if (!isElement(e.target))\n            return;\n        // clear search buffer when leaving the menu\n        if (!e.currentTarget.contains?.(e.target)) {\n            this.domContext.getWindow().clearTimeout(this.#timer);\n            this.search = \"\";\n        }\n    }\n    onfocus(_) {\n        if (!this.parentMenu.root.isUsingKeyboard.current)\n            return;\n        afterTick(() => this.rovingFocusGroup.focusFirstCandidate());\n    }\n    onItemEnter() {\n        return this.#isPointerMovingToSubmenu();\n    }\n    onItemLeave(e) {\n        if (e.currentTarget.hasAttribute(this.parentMenu.root.getBitsAttr(\"sub-trigger\")))\n            return;\n        if (this.#isPointerMovingToSubmenu() || this.parentMenu.root.isUsingKeyboard.current)\n            return;\n        const contentNode = this.parentMenu.contentNode;\n        contentNode?.focus();\n        this.rovingFocusGroup.setCurrentTabStopId(\"\");\n    }\n    onTriggerLeave() {\n        if (this.#isPointerMovingToSubmenu())\n            return true;\n        return false;\n    }\n    handleInteractOutside(e) {\n        if (!isElementOrSVGElement(e.target))\n            return;\n        const triggerId = this.parentMenu.triggerNode?.id;\n        if (e.target.id === triggerId) {\n            e.preventDefault();\n            return;\n        }\n        if (e.target.closest(`#${triggerId}`)) {\n            e.preventDefault();\n        }\n    }\n    get shouldRender() {\n        return this.parentMenu.contentPresence.shouldRender;\n    }\n    snippetProps = $derived.by(() => ({ open: this.parentMenu.opts.open.current }));\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: \"menu\",\n        \"aria-orientation\": \"vertical\",\n        [this.parentMenu.root.getBitsAttr(\"content\")]: \"\",\n        \"data-state\": getDataOpenClosed(this.parentMenu.opts.open.current),\n        onkeydown: this.onkeydown,\n        onblur: this.onblur,\n        onfocus: this.onfocus,\n        dir: this.parentMenu.root.opts.dir.current,\n        style: {\n            pointerEvents: \"auto\",\n        },\n        ...this.attachment,\n    }));\n    popperProps = {\n        onCloseAutoFocus: (e) => this.onCloseAutoFocus(e),\n    };\n}\nclass MenuItemSharedState {\n    opts;\n    content;\n    attachment;\n    #isFocused = $state(false);\n    constructor(opts, content) {\n        this.opts = opts;\n        this.content = content;\n        this.attachment = attachRef(this.opts.ref);\n        this.onpointermove = this.onpointermove.bind(this);\n        this.onpointerleave = this.onpointerleave.bind(this);\n        this.onfocus = this.onfocus.bind(this);\n        this.onblur = this.onblur.bind(this);\n    }\n    onpointermove(e) {\n        if (e.defaultPrevented)\n            return;\n        if (!isMouseEvent(e))\n            return;\n        if (this.opts.disabled.current) {\n            this.content.onItemLeave(e);\n        }\n        else {\n            const defaultPrevented = this.content.onItemEnter();\n            if (defaultPrevented)\n                return;\n            const item = e.currentTarget;\n            if (!isHTMLElement(item))\n                return;\n            item.focus();\n        }\n    }\n    onpointerleave(e) {\n        if (e.defaultPrevented)\n            return;\n        if (!isMouseEvent(e))\n            return;\n        this.content.onItemLeave(e);\n    }\n    onfocus(e) {\n        afterTick(() => {\n            if (e.defaultPrevented || this.opts.disabled.current)\n                return;\n            this.#isFocused = true;\n        });\n    }\n    onblur(e) {\n        afterTick(() => {\n            if (e.defaultPrevented)\n                return;\n            this.#isFocused = false;\n        });\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        tabindex: -1,\n        role: \"menuitem\",\n        \"aria-disabled\": boolToStr(this.opts.disabled.current),\n        \"data-disabled\": boolToEmptyStrOrUndef(this.opts.disabled.current),\n        \"data-highlighted\": this.#isFocused ? \"\" : undefined,\n        [this.content.parentMenu.root.getBitsAttr(\"item\")]: \"\",\n        //\n        onpointermove: this.onpointermove,\n        onpointerleave: this.onpointerleave,\n        onfocus: this.onfocus,\n        onblur: this.onblur,\n        ...this.attachment,\n    }));\n}\nexport class MenuItemState {\n    static create(opts) {\n        const item = new MenuItemSharedState(opts, MenuContentContext.get());\n        return new MenuItemState(opts, item);\n    }\n    opts;\n    item;\n    root;\n    #isPointerDown = false;\n    constructor(opts, item) {\n        this.opts = opts;\n        this.item = item;\n        this.root = item.content.parentMenu.root;\n        this.onkeydown = this.onkeydown.bind(this);\n        this.onclick = this.onclick.bind(this);\n        this.onpointerdown = this.onpointerdown.bind(this);\n        this.onpointerup = this.onpointerup.bind(this);\n    }\n    #handleSelect() {\n        if (this.item.opts.disabled.current)\n            return;\n        const selectEvent = new CustomEvent(\"menuitemselect\", { bubbles: true, cancelable: true });\n        this.opts.onSelect.current(selectEvent);\n        if (selectEvent.defaultPrevented) {\n            this.item.content.parentMenu.root.isUsingKeyboard.current = false;\n            return;\n        }\n        if (this.opts.closeOnSelect.current) {\n            this.item.content.parentMenu.root.opts.onClose();\n        }\n    }\n    onkeydown(e) {\n        const isTypingAhead = this.item.content.search !== \"\";\n        if (this.item.opts.disabled.current || (isTypingAhead && e.key === kbd.SPACE))\n            return;\n        if (SELECTION_KEYS.includes(e.key)) {\n            if (!isHTMLElement(e.currentTarget))\n                return;\n            e.currentTarget.click();\n            /**\n             * We prevent default browser behavior for selection keys as they should trigger\n             * a selection only:\n             * - prevents space from scrolling the page.\n             * - if keydown causes focus to move, prevents keydown from firing on the new target.\n             */\n            e.preventDefault();\n        }\n    }\n    onclick(_) {\n        if (this.item.opts.disabled.current)\n            return;\n        this.#handleSelect();\n    }\n    onpointerup(e) {\n        if (e.defaultPrevented)\n            return;\n        if (!this.#isPointerDown) {\n            if (!isHTMLElement(e.currentTarget))\n                return;\n            e.currentTarget?.click();\n        }\n    }\n    onpointerdown(_) {\n        this.#isPointerDown = true;\n    }\n    props = $derived.by(() => mergeProps(this.item.props, {\n        onclick: this.onclick,\n        onpointerdown: this.onpointerdown,\n        onpointerup: this.onpointerup,\n        onkeydown: this.onkeydown,\n    }));\n}\nexport class MenuSubTriggerState {\n    static create(opts) {\n        const content = MenuContentContext.get();\n        const item = new MenuItemSharedState(opts, content);\n        const submenu = MenuMenuContext.get();\n        return new MenuSubTriggerState(opts, item, content, submenu);\n    }\n    opts;\n    item;\n    content;\n    submenu;\n    attachment;\n    #openTimer = null;\n    constructor(opts, item, content, submenu) {\n        this.opts = opts;\n        this.item = item;\n        this.content = content;\n        this.submenu = submenu;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.submenu.triggerNode = v));\n        this.onpointerleave = this.onpointerleave.bind(this);\n        this.onpointermove = this.onpointermove.bind(this);\n        this.onkeydown = this.onkeydown.bind(this);\n        this.onclick = this.onclick.bind(this);\n        onDestroyEffect(() => {\n            this.#clearOpenTimer();\n        });\n    }\n    #clearOpenTimer() {\n        if (this.#openTimer === null)\n            return;\n        this.content.domContext.getWindow().clearTimeout(this.#openTimer);\n        this.#openTimer = null;\n    }\n    onpointermove(e) {\n        if (!isMouseEvent(e))\n            return;\n        if (!this.item.opts.disabled.current &&\n            !this.submenu.opts.open.current &&\n            !this.#openTimer &&\n            !this.content.parentMenu.root.isPointerInTransit) {\n            this.#openTimer = this.content.domContext.setTimeout(() => {\n                this.submenu.onOpen();\n                this.#clearOpenTimer();\n            }, this.opts.openDelay.current);\n        }\n    }\n    onpointerleave(e) {\n        if (!isMouseEvent(e))\n            return;\n        this.#clearOpenTimer();\n    }\n    onkeydown(e) {\n        const isTypingAhead = this.content.search !== \"\";\n        if (this.item.opts.disabled.current || (isTypingAhead && e.key === kbd.SPACE))\n            return;\n        if (SUB_OPEN_KEYS[this.submenu.root.opts.dir.current].includes(e.key)) {\n            e.currentTarget.click();\n            e.preventDefault();\n        }\n    }\n    onclick(e) {\n        if (this.item.opts.disabled.current)\n            return;\n        /**\n         * We manually focus because iOS Safari doesn't always focus on click (e.g. buttons)\n         * and we rely heavily on `onFocusOutside` for submenus to close when switching\n         * between separate submenus.\n         */\n        if (!isHTMLElement(e.currentTarget))\n            return;\n        e.currentTarget.focus();\n        const selectEvent = new CustomEvent(\"menusubtriggerselect\", {\n            bubbles: true,\n            cancelable: true,\n        });\n        this.opts.onSelect.current(selectEvent);\n        if (!this.submenu.opts.open.current) {\n            this.submenu.onOpen();\n            afterTick(() => {\n                const contentNode = this.submenu.contentNode;\n                if (!contentNode)\n                    return;\n                MenuOpenEvent.dispatch(contentNode);\n            });\n        }\n    }\n    props = $derived.by(() => mergeProps({\n        \"aria-haspopup\": \"menu\",\n        \"aria-expanded\": boolToStr(this.submenu.opts.open.current),\n        \"data-state\": getDataOpenClosed(this.submenu.opts.open.current),\n        \"aria-controls\": this.submenu.opts.open.current\n            ? this.submenu.contentId.current\n            : undefined,\n        [this.submenu.root.getBitsAttr(\"sub-trigger\")]: \"\",\n        onclick: this.onclick,\n        onpointermove: this.onpointermove,\n        onpointerleave: this.onpointerleave,\n        onkeydown: this.onkeydown,\n        ...this.attachment,\n    }, this.item.props));\n}\nexport class MenuCheckboxItemState {\n    static create(opts, checkboxGroup) {\n        const item = new MenuItemState(opts, new MenuItemSharedState(opts, MenuContentContext.get()));\n        return new MenuCheckboxItemState(opts, item, checkboxGroup);\n    }\n    opts;\n    item;\n    group;\n    constructor(opts, item, group = null) {\n        this.opts = opts;\n        this.item = item;\n        this.group = group;\n        // Watch for value changes in the group if we're part of one\n        if (this.group) {\n            watch(() => this.group.opts.value.current, (groupValues) => {\n                this.opts.checked.current = groupValues.includes(this.opts.value.current);\n            });\n            // Watch for checked state changes and sync with group\n            watch(() => this.opts.checked.current, (checked) => {\n                if (checked) {\n                    this.group.addValue(this.opts.value.current);\n                }\n                else {\n                    this.group.removeValue(this.opts.value.current);\n                }\n            });\n        }\n    }\n    toggleChecked() {\n        if (this.opts.indeterminate.current) {\n            this.opts.indeterminate.current = false;\n            this.opts.checked.current = true;\n        }\n        else {\n            this.opts.checked.current = !this.opts.checked.current;\n        }\n    }\n    snippetProps = $derived.by(() => ({\n        checked: this.opts.checked.current,\n        indeterminate: this.opts.indeterminate.current,\n    }));\n    props = $derived.by(() => ({\n        ...this.item.props,\n        role: \"menuitemcheckbox\",\n        \"aria-checked\": getAriaChecked(this.opts.checked.current, this.opts.indeterminate.current),\n        \"data-state\": getCheckedState(this.opts.checked.current),\n        [this.item.root.getBitsAttr(\"checkbox-item\")]: \"\",\n    }));\n}\nexport class MenuGroupState {\n    static create(opts) {\n        return MenuGroupContext.set(new MenuGroupState(opts, MenuRootContext.get()));\n    }\n    opts;\n    root;\n    attachment;\n    groupHeadingId = $state(undefined);\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: \"group\",\n        \"aria-labelledby\": this.groupHeadingId,\n        [this.root.getBitsAttr(\"group\")]: \"\",\n        ...this.attachment,\n    }));\n}\nexport class MenuGroupHeadingState {\n    static create(opts) {\n        // Try to get checkbox group first, then radio group, then regular group\n        const checkboxGroup = MenuCheckboxGroupContext.getOr(null);\n        if (checkboxGroup)\n            return new MenuGroupHeadingState(opts, checkboxGroup);\n        const radioGroup = MenuRadioGroupContext.getOr(null);\n        if (radioGroup)\n            return new MenuGroupHeadingState(opts, radioGroup);\n        return new MenuGroupHeadingState(opts, MenuGroupContext.get());\n    }\n    opts;\n    group;\n    attachment;\n    constructor(opts, group) {\n        this.opts = opts;\n        this.group = group;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.group.groupHeadingId = v?.id));\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: \"group\",\n        [this.group.root.getBitsAttr(\"group-heading\")]: \"\",\n        ...this.attachment,\n    }));\n}\nexport class MenuSeparatorState {\n    static create(opts) {\n        return new MenuSeparatorState(opts, MenuRootContext.get());\n    }\n    opts;\n    root;\n    attachment;\n    constructor(opts, root) {\n        this.opts = opts;\n        this.root = root;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        role: \"group\",\n        [this.root.getBitsAttr(\"separator\")]: \"\",\n        ...this.attachment,\n    }));\n}\nexport class MenuArrowState {\n    static create() {\n        return new MenuArrowState(MenuRootContext.get());\n    }\n    root;\n    constructor(root) {\n        this.root = root;\n    }\n    props = $derived.by(() => ({\n        [this.root.getBitsAttr(\"arrow\")]: \"\",\n    }));\n}\nexport class MenuRadioGroupState {\n    static create(opts) {\n        return MenuGroupContext.set(MenuRadioGroupContext.set(new MenuRadioGroupState(opts, MenuContentContext.get())));\n    }\n    opts;\n    content;\n    attachment;\n    groupHeadingId = $state(null);\n    root;\n    constructor(opts, content) {\n        this.opts = opts;\n        this.content = content;\n        this.root = content.parentMenu.root;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    setValue(v) {\n        this.opts.value.current = v;\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"radio-group\")]: \"\",\n        role: \"group\",\n        \"aria-labelledby\": this.groupHeadingId,\n        ...this.attachment,\n    }));\n}\nexport class MenuRadioItemState {\n    static create(opts) {\n        const radioGroup = MenuRadioGroupContext.get();\n        const sharedItem = new MenuItemSharedState(opts, radioGroup.content);\n        const item = new MenuItemState(opts, sharedItem);\n        return new MenuRadioItemState(opts, item, radioGroup);\n    }\n    opts;\n    item;\n    group;\n    attachment;\n    isChecked = $derived.by(() => this.group.opts.value.current === this.opts.value.current);\n    constructor(opts, item, group) {\n        this.opts = opts;\n        this.item = item;\n        this.group = group;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    selectValue() {\n        this.group.setValue(this.opts.value.current);\n    }\n    props = $derived.by(() => ({\n        [this.group.root.getBitsAttr(\"radio-item\")]: \"\",\n        ...this.item.props,\n        role: \"menuitemradio\",\n        \"aria-checked\": getAriaChecked(this.isChecked, false),\n        \"data-state\": getCheckedState(this.isChecked),\n        ...this.attachment,\n    }));\n}\nexport class DropdownMenuTriggerState {\n    static create(opts) {\n        return new DropdownMenuTriggerState(opts, MenuMenuContext.get());\n    }\n    opts;\n    parentMenu;\n    attachment;\n    constructor(opts, parentMenu) {\n        this.opts = opts;\n        this.parentMenu = parentMenu;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.parentMenu.triggerNode = v));\n    }\n    onclick = (e) => {\n        /**\n         * MacOS VoiceOver sends a click in Safari/Firefox bypassing the keydown event\n         * when V0+Space is pressed. Since we already handle the keydown event and the\n         * pointerdown events separately, we ignore it if the detail is not 0.\n         */\n        if (this.opts.disabled.current || e.detail !== 0)\n            return;\n        this.parentMenu.toggleOpen();\n        e.preventDefault();\n    };\n    onpointerdown = (e) => {\n        if (this.opts.disabled.current)\n            return;\n        if (e.pointerType === \"touch\")\n            return e.preventDefault();\n        if (e.button === 0 && e.ctrlKey === false) {\n            this.parentMenu.toggleOpen();\n            // prevent trigger focusing when opening to allow\n            // the content to be given focus without competition\n            if (!this.parentMenu.opts.open.current)\n                e.preventDefault();\n        }\n    };\n    onpointerup = (e) => {\n        if (this.opts.disabled.current)\n            return;\n        if (e.pointerType === \"touch\") {\n            e.preventDefault();\n            this.parentMenu.toggleOpen();\n        }\n    };\n    onkeydown = (e) => {\n        if (this.opts.disabled.current)\n            return;\n        if (e.key === kbd.SPACE || e.key === kbd.ENTER) {\n            this.parentMenu.toggleOpen();\n            e.preventDefault();\n            return;\n        }\n        if (e.key === kbd.ARROW_DOWN) {\n            this.parentMenu.onOpen();\n            e.preventDefault();\n        }\n    };\n    #ariaControls = $derived.by(() => {\n        if (this.parentMenu.opts.open.current && this.parentMenu.contentId.current)\n            return this.parentMenu.contentId.current;\n        return undefined;\n    });\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        disabled: this.opts.disabled.current,\n        \"aria-haspopup\": \"menu\",\n        \"aria-expanded\": boolToStr(this.parentMenu.opts.open.current),\n        \"aria-controls\": this.#ariaControls,\n        \"data-disabled\": boolToEmptyStrOrUndef(this.opts.disabled.current),\n        \"data-state\": getDataOpenClosed(this.parentMenu.opts.open.current),\n        [this.parentMenu.root.getBitsAttr(\"trigger\")]: \"\",\n        //\n        onclick: this.onclick,\n        onpointerdown: this.onpointerdown,\n        onpointerup: this.onpointerup,\n        onkeydown: this.onkeydown,\n        ...this.attachment,\n    }));\n}\nexport class ContextMenuTriggerState {\n    static create(opts) {\n        return new ContextMenuTriggerState(opts, MenuMenuContext.get());\n    }\n    opts;\n    parentMenu;\n    attachment;\n    #point = $state({ x: 0, y: 0 });\n    virtualElement = simpleBox({\n        getBoundingClientRect: () => DOMRect.fromRect({ width: 0, height: 0, ...this.#point }),\n    });\n    #longPressTimer = null;\n    constructor(opts, parentMenu) {\n        this.opts = opts;\n        this.parentMenu = parentMenu;\n        this.attachment = attachRef(this.opts.ref, (v) => (this.parentMenu.triggerNode = v));\n        this.oncontextmenu = this.oncontextmenu.bind(this);\n        this.onpointerdown = this.onpointerdown.bind(this);\n        this.onpointermove = this.onpointermove.bind(this);\n        this.onpointercancel = this.onpointercancel.bind(this);\n        this.onpointerup = this.onpointerup.bind(this);\n        watch(() => this.#point, (point) => {\n            this.virtualElement.current = {\n                getBoundingClientRect: () => DOMRect.fromRect({ width: 0, height: 0, ...point }),\n            };\n        });\n        watch(() => this.opts.disabled.current, (isDisabled) => {\n            if (isDisabled) {\n                this.#clearLongPressTimer();\n            }\n        });\n        onDestroyEffect(() => this.#clearLongPressTimer());\n    }\n    #clearLongPressTimer() {\n        if (this.#longPressTimer === null)\n            return;\n        getWindow(this.opts.ref.current).clearTimeout(this.#longPressTimer);\n    }\n    #handleOpen(e) {\n        this.#point = { x: e.clientX, y: e.clientY };\n        this.parentMenu.onOpen();\n    }\n    oncontextmenu(e) {\n        if (e.defaultPrevented || this.opts.disabled.current)\n            return;\n        this.#clearLongPressTimer();\n        this.#handleOpen(e);\n        e.preventDefault();\n        this.parentMenu.contentNode?.focus();\n    }\n    onpointerdown(e) {\n        if (this.opts.disabled.current || isMouseEvent(e))\n            return;\n        this.#clearLongPressTimer();\n        this.#longPressTimer = getWindow(this.opts.ref.current).setTimeout(() => this.#handleOpen(e), 700);\n    }\n    onpointermove(e) {\n        if (this.opts.disabled.current || isMouseEvent(e))\n            return;\n        this.#clearLongPressTimer();\n    }\n    onpointercancel(e) {\n        if (this.opts.disabled.current || isMouseEvent(e))\n            return;\n        this.#clearLongPressTimer();\n    }\n    onpointerup(e) {\n        if (this.opts.disabled.current || isMouseEvent(e))\n            return;\n        this.#clearLongPressTimer();\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        disabled: this.opts.disabled.current,\n        \"data-disabled\": boolToEmptyStrOrUndef(this.opts.disabled.current),\n        \"data-state\": getDataOpenClosed(this.parentMenu.opts.open.current),\n        [CONTEXT_MENU_TRIGGER_ATTR]: \"\",\n        tabindex: -1,\n        //\n        onpointerdown: this.onpointerdown,\n        onpointermove: this.onpointermove,\n        onpointercancel: this.onpointercancel,\n        onpointerup: this.onpointerup,\n        oncontextmenu: this.oncontextmenu,\n        ...this.attachment,\n    }));\n}\nexport class MenuCheckboxGroupState {\n    static create(opts) {\n        return MenuCheckboxGroupContext.set(new MenuCheckboxGroupState(opts, MenuContentContext.get()));\n    }\n    opts;\n    content;\n    root;\n    attachment;\n    groupHeadingId = $state(null);\n    constructor(opts, content) {\n        this.opts = opts;\n        this.content = content;\n        this.root = content.parentMenu.root;\n        this.attachment = attachRef(this.opts.ref);\n    }\n    addValue(checkboxValue) {\n        if (!checkboxValue)\n            return;\n        if (!this.opts.value.current.includes(checkboxValue)) {\n            const newValue = [...$state.snapshot(this.opts.value.current), checkboxValue];\n            this.opts.value.current = newValue;\n            this.opts.onValueChange.current(newValue);\n        }\n    }\n    removeValue(checkboxValue) {\n        if (!checkboxValue)\n            return;\n        const index = this.opts.value.current.indexOf(checkboxValue);\n        if (index === -1)\n            return;\n        const newValue = this.opts.value.current.filter((v) => v !== checkboxValue);\n        this.opts.value.current = newValue;\n        this.opts.onValueChange.current(newValue);\n    }\n    props = $derived.by(() => ({\n        id: this.opts.id.current,\n        [this.root.getBitsAttr(\"checkbox-group\")]: \"\",\n        role: \"group\",\n        \"aria-labelledby\": this.groupHeadingId,\n        ...this.attachment,\n    }));\n}\nexport class MenuSubmenuState {\n    static create(opts) {\n        const menu = MenuMenuContext.get();\n        return MenuMenuContext.set(new MenuMenuState(opts, menu.root, menu));\n    }\n}\n","import { afterSleep, afterTick, executeCallbacks, onDestroyEffect, } from \"svelte-toolbelt\";\nimport { watch } from \"runed\";\nimport { on } from \"svelte/events\";\nimport {} from \"../../../internal/events.js\";\nimport { debounce } from \"../../../internal/debounce.js\";\nimport { noop } from \"../../../internal/noop.js\";\nimport { getOwnerDocument, isOrContainsTarget } from \"../../../internal/elements.js\";\nimport { isElementOrSVGElement } from \"../../../internal/is.js\";\nimport { isClickTrulyOutside } from \"../../../internal/dom.js\";\nimport { CONTEXT_MENU_CONTENT_ATTR, CONTEXT_MENU_TRIGGER_ATTR, } from \"../../menu/menu.svelte.js\";\nglobalThis.bitsDismissableLayers ??= new Map();\nexport class DismissibleLayerState {\n    static create(opts) {\n        return new DismissibleLayerState(opts);\n    }\n    opts;\n    #interactOutsideProp;\n    #behaviorType;\n    #interceptedEvents = {\n        pointerdown: false,\n    };\n    #isResponsibleLayer = false;\n    #isFocusInsideDOMTree = false;\n    #documentObj = undefined;\n    #onFocusOutside;\n    #unsubClickListener = noop;\n    constructor(opts) {\n        this.opts = opts;\n        this.#behaviorType = opts.interactOutsideBehavior;\n        this.#interactOutsideProp = opts.onInteractOutside;\n        this.#onFocusOutside = opts.onFocusOutside;\n        $effect(() => {\n            this.#documentObj = getOwnerDocument(this.opts.ref.current);\n        });\n        let unsubEvents = noop;\n        const cleanup = () => {\n            this.#resetState();\n            globalThis.bitsDismissableLayers.delete(this);\n            this.#handleInteractOutside.destroy();\n            unsubEvents();\n        };\n        watch([() => this.opts.enabled.current, () => this.opts.ref.current], () => {\n            if (!this.opts.enabled.current || !this.opts.ref.current)\n                return;\n            afterSleep(1, () => {\n                if (!this.opts.ref.current)\n                    return;\n                globalThis.bitsDismissableLayers.set(this, this.#behaviorType);\n                unsubEvents();\n                unsubEvents = this.#addEventListeners();\n            });\n            return cleanup;\n        });\n        onDestroyEffect(() => {\n            this.#resetState.destroy();\n            globalThis.bitsDismissableLayers.delete(this);\n            this.#handleInteractOutside.destroy();\n            this.#unsubClickListener();\n            unsubEvents();\n        });\n    }\n    #handleFocus = (event) => {\n        if (event.defaultPrevented)\n            return;\n        if (!this.opts.ref.current)\n            return;\n        afterTick(() => {\n            if (!this.opts.ref.current || this.#isTargetWithinLayer(event.target))\n                return;\n            if (event.target && !this.#isFocusInsideDOMTree) {\n                this.#onFocusOutside.current?.(event);\n            }\n        });\n    };\n    #addEventListeners() {\n        return executeCallbacks(\n        /**\n         * CAPTURE INTERACTION START\n         * mark interaction-start event as intercepted.\n         * mark responsible layer during interaction start\n         * to avoid checking if is responsible layer during interaction end\n         * when a new floating element may have been opened.\n         */\n        on(this.#documentObj, \"pointerdown\", executeCallbacks(this.#markInterceptedEvent, this.#markResponsibleLayer), { capture: true }), \n        /**\n         * BUBBLE INTERACTION START\n         * Mark interaction-start event as non-intercepted. Debounce `onInteractOutsideStart`\n         * to avoid prematurely checking if other events were intercepted.\n         */\n        on(this.#documentObj, \"pointerdown\", executeCallbacks(this.#markNonInterceptedEvent, this.#handleInteractOutside)), \n        /**\n         * HANDLE FOCUS OUTSIDE\n         */\n        on(this.#documentObj, \"focusin\", this.#handleFocus));\n    }\n    #handleDismiss = (e) => {\n        let event = e;\n        if (event.defaultPrevented) {\n            event = createWrappedEvent(e);\n        }\n        this.#interactOutsideProp.current(e);\n    };\n    #handleInteractOutside = debounce((e) => {\n        if (!this.opts.ref.current) {\n            this.#unsubClickListener();\n            return;\n        }\n        const isEventValid = this.opts.isValidEvent.current(e, this.opts.ref.current) ||\n            isValidEvent(e, this.opts.ref.current);\n        if (!this.#isResponsibleLayer || this.#isAnyEventIntercepted() || !isEventValid) {\n            this.#unsubClickListener();\n            return;\n        }\n        let event = e;\n        if (event.defaultPrevented) {\n            event = createWrappedEvent(event);\n        }\n        if (this.#behaviorType.current !== \"close\" &&\n            this.#behaviorType.current !== \"defer-otherwise-close\") {\n            this.#unsubClickListener();\n            return;\n        }\n        if (e.pointerType === \"touch\") {\n            this.#unsubClickListener();\n            this.#unsubClickListener = on(this.#documentObj, \"click\", this.#handleDismiss, {\n                once: true,\n            });\n        }\n        else {\n            this.#interactOutsideProp.current(event);\n        }\n    }, 10);\n    #markInterceptedEvent = (e) => {\n        this.#interceptedEvents[e.type] = true;\n    };\n    #markNonInterceptedEvent = (e) => {\n        this.#interceptedEvents[e.type] = false;\n    };\n    #markResponsibleLayer = () => {\n        if (!this.opts.ref.current)\n            return;\n        this.#isResponsibleLayer = isResponsibleLayer(this.opts.ref.current);\n    };\n    #isTargetWithinLayer = (target) => {\n        if (!this.opts.ref.current)\n            return false;\n        return isOrContainsTarget(this.opts.ref.current, target);\n    };\n    #resetState = debounce(() => {\n        for (const eventType in this.#interceptedEvents) {\n            this.#interceptedEvents[eventType] = false;\n        }\n        this.#isResponsibleLayer = false;\n    }, 20);\n    #isAnyEventIntercepted() {\n        const i = Object.values(this.#interceptedEvents).some(Boolean);\n        return i;\n    }\n    #onfocuscapture = () => {\n        this.#isFocusInsideDOMTree = true;\n    };\n    #onblurcapture = () => {\n        this.#isFocusInsideDOMTree = false;\n    };\n    props = {\n        onfocuscapture: this.#onfocuscapture,\n        onblurcapture: this.#onblurcapture,\n    };\n}\nexport function getTopMostDismissableLayer(layersArr = [\n    ...globalThis.bitsDismissableLayers,\n]) {\n    return layersArr.findLast(([_, { current: behaviorType }]) => behaviorType === \"close\" || behaviorType === \"ignore\");\n}\nfunction isResponsibleLayer(node) {\n    const layersArr = [...globalThis.bitsDismissableLayers];\n    /**\n     * We first check if we can find a top layer with `close` or `ignore`.\n     * If that top layer was found and matches the provided node, then the node is\n     * responsible for the outside interaction. Otherwise, we know that all layers defer so\n     * the first layer is the responsible one.\n     */\n    const topMostLayer = getTopMostDismissableLayer(layersArr);\n    if (topMostLayer)\n        return topMostLayer[0].opts.ref.current === node;\n    const [firstLayerNode] = layersArr[0];\n    return firstLayerNode.opts.ref.current === node;\n}\nfunction isValidEvent(e, node) {\n    const target = e.target;\n    if (!isElementOrSVGElement(target))\n        return false;\n    const targetIsContextMenuTrigger = Boolean(target.closest(`[${CONTEXT_MENU_TRIGGER_ATTR}]`));\n    if (\"button\" in e && e.button > 0 && !targetIsContextMenuTrigger)\n        return false;\n    if (\"button\" in e && e.button === 0 && targetIsContextMenuTrigger)\n        return true;\n    const nodeIsContextMenu = Boolean(node.closest(`[${CONTEXT_MENU_CONTENT_ATTR}]`));\n    if (targetIsContextMenuTrigger && nodeIsContextMenu)\n        return false;\n    const ownerDocument = getOwnerDocument(target);\n    const isValid = ownerDocument.documentElement.contains(target) &&\n        !isOrContainsTarget(node, target) &&\n        isClickTrulyOutside(e, node);\n    return isValid;\n}\nfunction createWrappedEvent(e) {\n    const capturedCurrentTarget = e.currentTarget;\n    const capturedTarget = e.target;\n    let newEvent;\n    if (e instanceof PointerEvent) {\n        newEvent = new PointerEvent(e.type, e);\n    }\n    else {\n        newEvent = new PointerEvent(\"pointerdown\", e);\n    }\n    // track the prevented state separately\n    let isPrevented = false;\n    // Create a proxy to intercept property access and method calls\n    const wrappedEvent = new Proxy(newEvent, {\n        get: (target, prop) => {\n            if (prop === \"currentTarget\") {\n                return capturedCurrentTarget;\n            }\n            if (prop === \"target\") {\n                return capturedTarget;\n            }\n            if (prop === \"preventDefault\") {\n                return () => {\n                    isPrevented = true;\n                    if (typeof target.preventDefault === \"function\") {\n                        target.preventDefault();\n                    }\n                };\n            }\n            if (prop === \"defaultPrevented\") {\n                return isPrevented;\n            }\n            if (prop in target) {\n                // oxlint-disable-next-line no-explicit-any\n                return target[prop];\n            }\n            // oxlint-disable-next-line no-explicit-any\n            return e[prop];\n        },\n    });\n    return wrappedEvent;\n}\n","export function getFirstNonCommentChild(element) {\n    if (!element)\n        return null;\n    for (const child of element.childNodes) {\n        if (child.nodeType !== Node.COMMENT_NODE) {\n            return child;\n        }\n    }\n    return null;\n}\n/**\n * Determines if the click event truly occurred outside the content node.\n * This was added to handle password managers and other elements that may be injected\n * into the DOM but visually appear inside the content.\n */\nexport function isClickTrulyOutside(event, contentNode) {\n    const { clientX, clientY } = event;\n    const rect = contentNode.getBoundingClientRect();\n    return (clientX < rect.left || clientX > rect.right || clientY < rect.top || clientY > rect.bottom);\n}\n","/**\n * A utility function that executes a callback after a specified number of milliseconds.\n */\nexport function afterSleep(ms, cb) {\n    return setTimeout(cb, ms);\n}\n","import { DOMContext } from \"svelte-toolbelt\";\nimport { watch } from \"runed\";\nimport { on } from \"svelte/events\";\nimport { kbd } from \"../../../internal/kbd.js\";\nimport { noop } from \"../../../internal/noop.js\";\nglobalThis.bitsEscapeLayers ??= new Map();\nexport class EscapeLayerState {\n    static create(opts) {\n        return new EscapeLayerState(opts);\n    }\n    opts;\n    domContext;\n    constructor(opts) {\n        this.opts = opts;\n        this.domContext = new DOMContext(this.opts.ref);\n        let unsubEvents = noop;\n        watch(() => opts.enabled.current, (enabled) => {\n            if (enabled) {\n                globalThis.bitsEscapeLayers.set(this, opts.escapeKeydownBehavior);\n                unsubEvents = this.#addEventListener();\n            }\n            return () => {\n                unsubEvents();\n                globalThis.bitsEscapeLayers.delete(this);\n            };\n        });\n    }\n    #addEventListener = () => {\n        return on(this.domContext.getDocument(), \"keydown\", this.#onkeydown, { passive: false });\n    };\n    #onkeydown = (e) => {\n        if (e.key !== kbd.ESCAPE || !isResponsibleEscapeLayer(this))\n            return;\n        const clonedEvent = new KeyboardEvent(e.type, e);\n        e.preventDefault();\n        const behaviorType = this.opts.escapeKeydownBehavior.current;\n        if (behaviorType !== \"close\" && behaviorType !== \"defer-otherwise-close\")\n            return;\n        this.opts.onEscapeKeydown.current(clonedEvent);\n    };\n}\nfunction isResponsibleEscapeLayer(instance) {\n    const layersArr = [...globalThis.bitsEscapeLayers];\n    /**\n     * We first check if we can find a top layer with `close` or `ignore`.\n     * If that top layer was found and matches the provided node, then the node is\n     * responsible for the escape. Otherwise, we know that all layers defer so\n     * the first layer is the responsible one.\n     */\n    const topMostLayer = layersArr.findLast(([_, { current: behaviorType }]) => behaviorType === \"close\" || behaviorType === \"ignore\");\n    if (topMostLayer)\n        return topMostLayer[0] === instance;\n    const [firstLayerNode] = layersArr[0];\n    return firstLayerNode === instance;\n}\n","import { simpleBox } from \"svelte-toolbelt\";\nimport { FocusScope } from \"./focus-scope.svelte.js\";\nexport class FocusScopeManager {\n    static instance;\n    #scopeStack = simpleBox([]);\n    #focusHistory = new WeakMap();\n    #preFocusHistory = new WeakMap();\n    static getInstance() {\n        if (!this.instance) {\n            this.instance = new FocusScopeManager();\n        }\n        return this.instance;\n    }\n    register(scope) {\n        const current = this.getActive();\n        if (current && current !== scope) {\n            current.pause();\n        }\n        // capture the currently focused element before this scope becomes active\n        const activeElement = document.activeElement;\n        if (activeElement && activeElement !== document.body) {\n            this.#preFocusHistory.set(scope, activeElement);\n        }\n        this.#scopeStack.current = this.#scopeStack.current.filter((s) => s !== scope);\n        this.#scopeStack.current.unshift(scope);\n    }\n    unregister(scope) {\n        this.#scopeStack.current = this.#scopeStack.current.filter((s) => s !== scope);\n        const next = this.getActive();\n        if (next) {\n            next.resume();\n        }\n    }\n    getActive() {\n        return this.#scopeStack.current[0];\n    }\n    setFocusMemory(scope, element) {\n        this.#focusHistory.set(scope, element);\n    }\n    getFocusMemory(scope) {\n        return this.#focusHistory.get(scope);\n    }\n    isActiveScope(scope) {\n        return this.getActive() === scope;\n    }\n    setPreFocusMemory(scope, element) {\n        this.#preFocusHistory.set(scope, element);\n    }\n    getPreFocusMemory(scope) {\n        return this.#preFocusHistory.get(scope);\n    }\n    clearPreFocusMemory(scope) {\n        this.#preFocusHistory.delete(scope);\n    }\n}\n","import { onDestroyEffect } from \"svelte-toolbelt\";\nimport { FocusScopeManager } from \"./focus-scope-manager.js\";\nimport { focusable, isFocusable, tabbable } from \"tabbable\";\nimport { on } from \"svelte/events\";\nimport { watch } from \"runed\";\nexport class FocusScope {\n    #paused = false;\n    #container = null;\n    #manager = FocusScopeManager.getInstance();\n    #cleanupFns = [];\n    #opts;\n    constructor(opts) {\n        this.#opts = opts;\n    }\n    get paused() {\n        return this.#paused;\n    }\n    pause() {\n        this.#paused = true;\n    }\n    resume() {\n        this.#paused = false;\n    }\n    #cleanup() {\n        for (const fn of this.#cleanupFns) {\n            fn();\n        }\n        this.#cleanupFns = [];\n    }\n    mount(container) {\n        if (this.#container) {\n            this.unmount();\n        }\n        this.#container = container;\n        this.#manager.register(this);\n        this.#setupEventListeners();\n        this.#handleOpenAutoFocus();\n    }\n    unmount() {\n        if (!this.#container)\n            return;\n        this.#cleanup();\n        // handle close auto-focus\n        this.#handleCloseAutoFocus();\n        this.#manager.unregister(this);\n        this.#manager.clearPreFocusMemory(this);\n        this.#container = null;\n    }\n    #handleOpenAutoFocus() {\n        if (!this.#container)\n            return;\n        const event = new CustomEvent(\"focusScope.onOpenAutoFocus\", {\n            bubbles: false,\n            cancelable: true,\n        });\n        this.#opts.onOpenAutoFocus.current(event);\n        if (!event.defaultPrevented) {\n            requestAnimationFrame(() => {\n                if (!this.#container)\n                    return;\n                const firstTabbable = this.#getFirstTabbable();\n                if (firstTabbable) {\n                    firstTabbable.focus();\n                    this.#manager.setFocusMemory(this, firstTabbable);\n                }\n                else {\n                    this.#container.focus();\n                }\n            });\n        }\n    }\n    #handleCloseAutoFocus() {\n        const event = new CustomEvent(\"focusScope.onCloseAutoFocus\", {\n            bubbles: false,\n            cancelable: true,\n        });\n        this.#opts.onCloseAutoFocus.current?.(event);\n        if (!event.defaultPrevented) {\n            // return focus to the element that was focused before this scope opened\n            const preFocusedElement = this.#manager.getPreFocusMemory(this);\n            if (preFocusedElement && document.contains(preFocusedElement)) {\n                // ensure the element is still focusable and in the document\n                try {\n                    preFocusedElement.focus();\n                }\n                catch {\n                    // fallback if focus fails\n                    document.body.focus();\n                }\n            }\n        }\n    }\n    #setupEventListeners() {\n        if (!this.#container || !this.#opts.trap.current)\n            return;\n        const container = this.#container;\n        const doc = container.ownerDocument;\n        const handleFocus = (e) => {\n            if (this.#paused || !this.#manager.isActiveScope(this))\n                return;\n            const target = e.target;\n            if (!target)\n                return;\n            const isInside = container.contains(target);\n            if (isInside) {\n                // store last focused element\n                this.#manager.setFocusMemory(this, target);\n            }\n            else {\n                // focus escaped - bring it back\n                const lastFocused = this.#manager.getFocusMemory(this);\n                if (lastFocused && container.contains(lastFocused) && isFocusable(lastFocused)) {\n                    e.preventDefault();\n                    lastFocused.focus();\n                }\n                else {\n                    // fallback to first tabbable or first focusable or container\n                    const firstTabbable = this.#getFirstTabbable();\n                    const firstFocusable = this.#getAllFocusables()[0];\n                    (firstTabbable || firstFocusable || container).focus();\n                }\n            }\n        };\n        const handleKeydown = (e) => {\n            if (!this.#opts.loop || this.#paused || e.key !== \"Tab\")\n                return;\n            if (!this.#manager.isActiveScope(this))\n                return;\n            const tabbables = this.#getTabbables();\n            if (tabbables.length < 2)\n                return;\n            const first = tabbables[0];\n            const last = tabbables[tabbables.length - 1];\n            if (!e.shiftKey && doc.activeElement === last) {\n                e.preventDefault();\n                first.focus();\n            }\n            else if (e.shiftKey && doc.activeElement === first) {\n                e.preventDefault();\n                last.focus();\n            }\n        };\n        this.#cleanupFns.push(on(doc, \"focusin\", handleFocus, { capture: true }), on(container, \"keydown\", handleKeydown));\n        const observer = new MutationObserver(() => {\n            const lastFocused = this.#manager.getFocusMemory(this);\n            if (lastFocused && !container.contains(lastFocused)) {\n                // last focused element was removed\n                const firstTabbable = this.#getFirstTabbable();\n                const firstFocusable = this.#getAllFocusables()[0];\n                const elementToFocus = firstTabbable || firstFocusable;\n                if (elementToFocus) {\n                    elementToFocus.focus();\n                    this.#manager.setFocusMemory(this, elementToFocus);\n                }\n                else {\n                    // no focusable elements left, focus container\n                    container.focus();\n                }\n            }\n        });\n        observer.observe(container, {\n            childList: true,\n            subtree: true,\n        });\n        this.#cleanupFns.push(() => observer.disconnect());\n    }\n    #getTabbables() {\n        if (!this.#container)\n            return [];\n        return tabbable(this.#container, {\n            includeContainer: false,\n            getShadowRoot: true,\n        });\n    }\n    #getFirstTabbable() {\n        const tabbables = this.#getTabbables();\n        return tabbables[0] || null;\n    }\n    #getAllFocusables() {\n        if (!this.#container)\n            return [];\n        return focusable(this.#container, {\n            includeContainer: false,\n            getShadowRoot: true,\n        });\n    }\n    static use(opts) {\n        let scope = null;\n        watch([() => opts.ref.current, () => opts.enabled.current], ([ref, enabled]) => {\n            if (ref && enabled) {\n                if (!scope) {\n                    scope = new FocusScope(opts);\n                }\n                scope.mount(ref);\n            }\n            else if (scope) {\n                scope.unmount();\n                scope = null;\n            }\n        });\n        onDestroyEffect(() => {\n            scope?.unmount();\n        });\n        return {\n            get props() {\n                return {\n                    tabindex: -1,\n                };\n            },\n        };\n    }\n}\n","import { DOMContext, composeHandlers, contains, executeCallbacks, } from \"svelte-toolbelt\";\nimport { watch } from \"runed\";\nimport { on } from \"svelte/events\";\nimport { noop } from \"../../../internal/noop.js\";\nimport { isHTMLElement } from \"../../../internal/is.js\";\nglobalThis.bitsTextSelectionLayers ??= new Map();\nexport class TextSelectionLayerState {\n    static create(opts) {\n        return new TextSelectionLayerState(opts);\n    }\n    opts;\n    domContext;\n    #unsubSelectionLock = noop;\n    constructor(opts) {\n        this.opts = opts;\n        this.domContext = new DOMContext(opts.ref);\n        let unsubEvents = noop;\n        watch(() => this.opts.enabled.current, (isEnabled) => {\n            if (isEnabled) {\n                globalThis.bitsTextSelectionLayers.set(this, this.opts.enabled);\n                unsubEvents();\n                unsubEvents = this.#addEventListeners();\n            }\n            return () => {\n                unsubEvents();\n                this.#resetSelectionLock();\n                globalThis.bitsTextSelectionLayers.delete(this);\n            };\n        });\n    }\n    #addEventListeners() {\n        return executeCallbacks(on(this.domContext.getDocument(), \"pointerdown\", this.#pointerdown), on(this.domContext.getDocument(), \"pointerup\", composeHandlers(this.#resetSelectionLock, this.opts.onPointerUp.current)));\n    }\n    #pointerdown = (e) => {\n        const node = this.opts.ref.current;\n        const target = e.target;\n        if (!isHTMLElement(node) || !isHTMLElement(target) || !this.opts.enabled.current)\n            return;\n        /**\n         * We only lock user-selection overflow if layer is the top most layer and\n         * pointerdown occurred inside the node. You are still allowed to select text\n         * outside the node provided pointerdown occurs outside the node.\n         */\n        if (!isHighestLayer(this) || !contains(node, target))\n            return;\n        this.opts.onPointerDown.current(e);\n        if (e.defaultPrevented)\n            return;\n        this.#unsubSelectionLock = preventTextSelectionOverflow(node, this.domContext.getDocument().body);\n    };\n    #resetSelectionLock = () => {\n        this.#unsubSelectionLock();\n        this.#unsubSelectionLock = noop;\n    };\n}\nconst getUserSelect = (node) => node.style.userSelect || node.style.webkitUserSelect;\nfunction preventTextSelectionOverflow(node, body) {\n    const originalBodyUserSelect = getUserSelect(body);\n    const originalNodeUserSelect = getUserSelect(node);\n    setUserSelect(body, \"none\");\n    setUserSelect(node, \"text\");\n    return () => {\n        setUserSelect(body, originalBodyUserSelect);\n        setUserSelect(node, originalNodeUserSelect);\n    };\n}\nfunction setUserSelect(node, value) {\n    node.style.userSelect = value;\n    node.style.webkitUserSelect = value;\n}\nfunction isHighestLayer(instance) {\n    const layersArr = [...globalThis.bitsTextSelectionLayers];\n    if (!layersArr.length)\n        return false;\n    const highestLayer = layersArr.at(-1);\n    if (!highestLayer)\n        return false;\n    return highestLayer[0] === instance;\n}\n","globalThis.bitsIdCounter ??= { current: 0 };\n/**\n * Generates a unique ID based on a global counter.\n */\nexport function useId(prefix = \"bits\") {\n    globalThis.bitsIdCounter.current++;\n    return `${prefix}-${globalThis.bitsIdCounter.current}`;\n}\n","export class SharedState {\n    #factory;\n    #subscribers = 0;\n    #state = $state();\n    #scope;\n    constructor(factory) {\n        this.#factory = factory;\n    }\n    #dispose() {\n        this.#subscribers -= 1;\n        if (this.#scope && this.#subscribers <= 0) {\n            this.#scope();\n            this.#state = undefined;\n            this.#scope = undefined;\n        }\n    }\n    get(...args) {\n        this.#subscribers += 1;\n        if (this.#state === undefined) {\n            this.#scope = $effect.root(() => {\n                this.#state = this.#factory(...args);\n            });\n        }\n        $effect(() => {\n            return () => {\n                this.#dispose();\n            };\n        });\n        return this.#state;\n    }\n}\n","import { SvelteMap } from \"svelte/reactivity\";\nimport { afterTick, boxWith, onDestroyEffect, } from \"svelte-toolbelt\";\nimport { isIOS } from \"./is.js\";\nimport { useId } from \"./use-id.js\";\nimport { watch } from \"runed\";\nimport { SharedState } from \"./shared-state.svelte.js\";\nimport { BROWSER } from \"esm-env\";\nimport { on } from \"svelte/events\";\n/** A map of lock ids to their `locked` state. */\nconst lockMap = new SvelteMap();\nlet initialBodyStyle = $state(null);\nlet stopTouchMoveListener = null;\nlet cleanupTimeoutId = null;\nlet isInCleanupTransition = false;\nconst anyLocked = boxWith(() => {\n    for (const value of lockMap.values()) {\n        if (value)\n            return true;\n    }\n    return false;\n});\n/**\n * We track the time we scheduled the cleanup to prevent race conditions\n * when multiple locks are created/destroyed in the same tick, ensuring\n * only the last one to schedule the cleanup will run.\n *\n * reference: https://github.com/huntabyte/bits-ui/issues/1639\n */\nlet cleanupScheduledAt = null;\nconst bodyLockStackCount = new SharedState(() => {\n    function resetBodyStyle() {\n        if (!BROWSER)\n            return;\n        document.body.setAttribute(\"style\", initialBodyStyle ?? \"\");\n        document.body.style.removeProperty(\"--scrollbar-width\");\n        isIOS && stopTouchMoveListener?.();\n        // reset initialBodyStyle so next locker captures the correct styles\n        initialBodyStyle = null;\n    }\n    function cancelPendingCleanup() {\n        if (cleanupTimeoutId === null)\n            return;\n        window.clearTimeout(cleanupTimeoutId);\n        cleanupTimeoutId = null;\n    }\n    function scheduleCleanupIfNoNewLocks(delay, callback) {\n        cancelPendingCleanup();\n        isInCleanupTransition = true;\n        cleanupScheduledAt = Date.now();\n        const currentCleanupId = cleanupScheduledAt;\n        /**\n         * We schedule the cleanup to run after a delay to allow new locks to register\n         * that might have been added in the same tick as the current cleanup.\n         *\n         * If a new lock is added in the same tick, the cleanup will be cancelled and\n         * a new cleanup will be scheduled.\n         *\n         * This is to prevent the cleanup from running too early and resetting the body\n         * style before the new lock has had a chance to apply its styles.\n         */\n        const cleanupFn = () => {\n            cleanupTimeoutId = null;\n            // check if this cleanup is still valid (no newer cleanups scheduled)\n            if (cleanupScheduledAt !== currentCleanupId)\n                return;\n            // ensure no new locks were added during the delay\n            if (!isAnyLocked(lockMap)) {\n                isInCleanupTransition = false;\n                callback();\n            }\n            else {\n                isInCleanupTransition = false;\n            }\n        };\n        const actualDelay = delay === null ? 24 : delay;\n        cleanupTimeoutId = window.setTimeout(cleanupFn, actualDelay);\n    }\n    function ensureInitialStyleCaptured() {\n        // only capture initial style once, when no locks exist and no cleanup is in progress\n        if (initialBodyStyle === null && lockMap.size === 0 && !isInCleanupTransition) {\n            initialBodyStyle = document.body.getAttribute(\"style\");\n        }\n    }\n    watch(() => anyLocked.current, () => {\n        if (!anyLocked.current)\n            return;\n        // ensure we've captured the initial style before applying any lock styles\n        ensureInitialStyleCaptured();\n        // if we're applying lock styles, we're no longer in a cleanup transition\n        isInCleanupTransition = false;\n        const bodyStyle = getComputedStyle(document.body);\n        // TODO: account for RTL direction, etc.\n        const verticalScrollbarWidth = window.innerWidth - document.documentElement.clientWidth;\n        const paddingRight = Number.parseInt(bodyStyle.paddingRight ?? \"0\", 10);\n        const config = {\n            padding: paddingRight + verticalScrollbarWidth,\n            margin: Number.parseInt(bodyStyle.marginRight ?? \"0\", 10),\n        };\n        if (verticalScrollbarWidth > 0) {\n            document.body.style.paddingRight = `${config.padding}px`;\n            document.body.style.marginRight = `${config.margin}px`;\n            document.body.style.setProperty(\"--scrollbar-width\", `${verticalScrollbarWidth}px`);\n            document.body.style.overflow = \"hidden\";\n        }\n        if (isIOS) {\n            // IOS devices are special and require a touchmove listener to prevent scrolling\n            stopTouchMoveListener = on(document, \"touchmove\", (e) => {\n                if (e.target !== document.documentElement)\n                    return;\n                if (e.touches.length > 1)\n                    return;\n                e.preventDefault();\n            }, { passive: false });\n        }\n        /**\n         * We ensure pointer-events: none is applied _after_ DOM updates, so that any focus/\n         * interaction changes from opening overlays/menus complete _before_ we block pointer\n         * events.\n         *\n         * this avoids race conditions where pointer-events could be set too early and break\n         * focus/interaction.\n         */\n        afterTick(() => {\n            document.body.style.pointerEvents = \"none\";\n            document.body.style.overflow = \"hidden\";\n        });\n    });\n    onDestroyEffect(() => {\n        return () => {\n            stopTouchMoveListener?.();\n        };\n    });\n    return {\n        get lockMap() {\n            return lockMap;\n        },\n        resetBodyStyle,\n        scheduleCleanupIfNoNewLocks,\n        cancelPendingCleanup,\n        ensureInitialStyleCaptured,\n    };\n});\nexport class BodyScrollLock {\n    #id = useId();\n    #initialState;\n    #restoreScrollDelay = () => null;\n    #countState;\n    locked;\n    constructor(initialState, restoreScrollDelay = () => null) {\n        this.#initialState = initialState;\n        this.#restoreScrollDelay = restoreScrollDelay;\n        this.#countState = bodyLockStackCount.get();\n        if (!this.#countState)\n            return;\n        /**\n         * Since a new lock is being created, we cancel any pending cleanup to\n         * prevent the cleanup from running too early and resetting the body style\n         * before the new lock has had a chance to apply its styles.\n         *\n         * reference: https://github.com/huntabyte/bits-ui/issues/1639\n         */\n        this.#countState.cancelPendingCleanup();\n        // capture initial style before this lock is registered\n        this.#countState.ensureInitialStyleCaptured();\n        this.#countState.lockMap.set(this.#id, this.#initialState ?? false);\n        this.locked = boxWith(() => this.#countState.lockMap.get(this.#id) ?? false, (v) => this.#countState.lockMap.set(this.#id, v));\n        onDestroyEffect(() => {\n            this.#countState.lockMap.delete(this.#id);\n            // if not the last lock, we don't need to do anything\n            if (isAnyLocked(this.#countState.lockMap))\n                return;\n            const restoreScrollDelay = this.#restoreScrollDelay();\n            /**\n             * We schedule the cleanup to run after a delay to handle same-tick\n             * destroy/create scenarios.\n             *\n             * reference: https://github.com/huntabyte/bits-ui/issues/1639\n             */\n            this.#countState.scheduleCleanupIfNoNewLocks(restoreScrollDelay, () => {\n                this.#countState.resetBodyStyle();\n            });\n        });\n    }\n}\nfunction isAnyLocked(map) {\n    for (const [_, value] of map) {\n        if (value)\n            return true;\n    }\n    return false;\n}\n","<script lang=\"ts\">\n\timport type { ScrollLockProps } from \"./index.js\";\n\timport { BodyScrollLock } from \"../../../internal/body-scroll-lock.svelte.js\";\n\n\tlet { preventScroll = true, restoreScrollDelay = null }: ScrollLockProps = $props();\n\n\tif (preventScroll) {\n\t\tnew BodyScrollLock(preventScroll, () => restoreScrollDelay);\n\t}\n</script>\n","<script lang=\"ts\">\n\timport { boxWith, mergeProps } from \"svelte-toolbelt\";\n\timport { DialogOverlayState } from \"../dialog.svelte.js\";\n\timport type { DialogOverlayProps } from \"../types.js\";\n\timport { createId } from \"../../../internal/create-id.js\";\n\n\tconst uid = $props.id();\n\n\tlet {\n\t\tid = createId(uid),\n\t\tforceMount = false,\n\t\tchild,\n\t\tchildren,\n\t\tref = $bindable(null),\n\t\t...restProps\n\t}: DialogOverlayProps = $props();\n\n\tconst overlayState = DialogOverlayState.create({\n\t\tid: boxWith(() => id),\n\t\tref: boxWith(\n\t\t\t() => ref,\n\t\t\t(v) => (ref = v)\n\t\t),\n\t});\n\n\tconst mergedProps = $derived(mergeProps(restProps, overlayState.props));\n</script>\n\n{#if overlayState.shouldRender || forceMount}\n\t{#if child}\n\t\t{@render child({ props: mergeProps(mergedProps), ...overlayState.snippetProps })}\n\t{:else}\n\t\t<div {...mergeProps(mergedProps)}>\n\t\t\t{@render children?.(overlayState.snippetProps)}\n\t\t</div>\n\t{/if}\n{/if}\n","<script lang=\"ts\">\n\timport { boxWith, mergeProps } from \"svelte-toolbelt\";\n\timport { DialogDescriptionState } from \"../dialog.svelte.js\";\n\timport type { DialogDescriptionProps } from \"../types.js\";\n\timport { createId } from \"../../../internal/create-id.js\";\n\n\tconst uid = $props.id();\n\n\tlet {\n\t\tid = createId(uid),\n\t\tchildren,\n\t\tchild,\n\t\tref = $bindable(null),\n\t\t...restProps\n\t}: DialogDescriptionProps = $props();\n\n\tconst descriptionState = DialogDescriptionState.create({\n\t\tid: boxWith(() => id),\n\t\tref: boxWith(\n\t\t\t() => ref,\n\t\t\t(v) => (ref = v)\n\t\t),\n\t});\n\n\tconst mergedProps = $derived(mergeProps(restProps, descriptionState.props));\n</script>\n\n{#if child}\n\t{@render child({ props: mergedProps })}\n{:else}\n\t<div {...mergedProps}>\n\t\t{@render children?.()}\n\t</div>\n{/if}\n","<script lang=\"ts\">\n\timport { boxWith } from \"svelte-toolbelt\";\n\timport { DialogRootState } from \"../dialog.svelte.js\";\n\timport type { DialogRootProps } from \"../types.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\n\tlet {\n\t\topen = $bindable(false),\n\t\tonOpenChange = noop,\n\t\tonOpenChangeComplete = noop,\n\t\tchildren,\n\t}: DialogRootProps = $props();\n\n\tDialogRootState.create({\n\t\tvariant: boxWith(() => \"dialog\"),\n\t\topen: boxWith(\n\t\t\t() => open,\n\t\t\t(v) => {\n\t\t\t\topen = v;\n\t\t\t\tonOpenChange(v);\n\t\t\t}\n\t\t),\n\t\tonOpenChangeComplete: boxWith(() => onOpenChangeComplete),\n\t});\n</script>\n\n{@render children?.()}\n","<script lang=\"ts\">\n\timport { boxWith, mergeProps } from \"svelte-toolbelt\";\n\timport { DialogCloseState } from \"../dialog.svelte.js\";\n\timport type { DialogCloseProps } from \"../types.js\";\n\timport { createId } from \"../../../internal/create-id.js\";\n\n\tconst uid = $props.id();\n\n\tlet {\n\t\tchildren,\n\t\tchild,\n\t\tid = createId(uid),\n\t\tref = $bindable(null),\n\t\tdisabled = false,\n\t\t...restProps\n\t}: DialogCloseProps = $props();\n\n\tconst closeState = DialogCloseState.create({\n\t\tvariant: boxWith(() => \"close\"),\n\t\tid: boxWith(() => id),\n\t\tref: boxWith(\n\t\t\t() => ref,\n\t\t\t(v) => (ref = v)\n\t\t),\n\t\tdisabled: boxWith(() => Boolean(disabled)),\n\t});\n\n\tconst mergedProps = $derived(mergeProps(restProps, closeState.props));\n</script>\n\n{#if child}\n\t{@render child({ props: mergedProps })}\n{:else}\n\t<button {...mergedProps}>\n\t\t{@render children?.()}\n\t</button>\n{/if}\n","<script lang=\"ts\">\n\timport { boxWith, mergeProps } from \"svelte-toolbelt\";\n\timport { DialogContentState } from \"../dialog.svelte.js\";\n\timport type { DialogContentProps } from \"../types.js\";\n\timport DismissibleLayer from \"../../utilities/dismissible-layer/dismissible-layer.svelte\";\n\timport EscapeLayer from \"../../utilities/escape-layer/escape-layer.svelte\";\n\timport FocusScope from \"../../utilities/focus-scope/focus-scope.svelte\";\n\timport TextSelectionLayer from \"../../utilities/text-selection-layer/text-selection-layer.svelte\";\n\timport { createId } from \"../../../internal/create-id.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\timport ScrollLock from \"../../utilities/scroll-lock/scroll-lock.svelte\";\n\tconst uid = $props.id();\n\n\tlet {\n\t\tid = createId(uid),\n\t\tchildren,\n\t\tchild,\n\t\tref = $bindable(null),\n\t\tforceMount = false,\n\t\tonCloseAutoFocus = noop,\n\t\tonOpenAutoFocus = noop,\n\t\tonEscapeKeydown = noop,\n\t\tonInteractOutside = noop,\n\t\ttrapFocus = true,\n\t\tpreventScroll = true,\n\t\trestoreScrollDelay = null,\n\t\t...restProps\n\t}: DialogContentProps = $props();\n\n\tconst contentState = DialogContentState.create({\n\t\tid: boxWith(() => id),\n\t\tref: boxWith(\n\t\t\t() => ref,\n\t\t\t(v) => (ref = v)\n\t\t),\n\t});\n\n\tconst mergedProps = $derived(mergeProps(restProps, contentState.props));\n</script>\n\n{#if contentState.shouldRender || forceMount}\n\t<FocusScope\n\t\tref={contentState.opts.ref}\n\t\tloop\n\t\t{trapFocus}\n\t\tenabled={contentState.root.opts.open.current}\n\t\t{onOpenAutoFocus}\n\t\t{onCloseAutoFocus}\n\t>\n\t\t{#snippet focusScope({ props: focusScopeProps })}\n\t\t\t<EscapeLayer\n\t\t\t\t{...mergedProps}\n\t\t\t\tenabled={contentState.root.opts.open.current}\n\t\t\t\tref={contentState.opts.ref}\n\t\t\t\tonEscapeKeydown={(e) => {\n\t\t\t\t\tonEscapeKeydown(e);\n\t\t\t\t\tif (e.defaultPrevented) return;\n\t\t\t\t\tcontentState.root.handleClose();\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<DismissibleLayer\n\t\t\t\t\t{...mergedProps}\n\t\t\t\t\tref={contentState.opts.ref}\n\t\t\t\t\tenabled={contentState.root.opts.open.current}\n\t\t\t\t\tonInteractOutside={(e) => {\n\t\t\t\t\t\tonInteractOutside(e);\n\t\t\t\t\t\tif (e.defaultPrevented) return;\n\t\t\t\t\t\tcontentState.root.handleClose();\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\t<TextSelectionLayer\n\t\t\t\t\t\t{...mergedProps}\n\t\t\t\t\t\tref={contentState.opts.ref}\n\t\t\t\t\t\tenabled={contentState.root.opts.open.current}\n\t\t\t\t\t>\n\t\t\t\t\t\t{#if child}\n\t\t\t\t\t\t\t{#if contentState.root.opts.open.current}\n\t\t\t\t\t\t\t\t<ScrollLock {preventScroll} {restoreScrollDelay} />\n\t\t\t\t\t\t\t{/if}\n\t\t\t\t\t\t\t{@render child({\n\t\t\t\t\t\t\t\tprops: mergeProps(mergedProps, focusScopeProps),\n\t\t\t\t\t\t\t\t...contentState.snippetProps,\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t{:else}\n\t\t\t\t\t\t\t<ScrollLock {preventScroll} />\n\t\t\t\t\t\t\t<div {...mergeProps(mergedProps, focusScopeProps)}>\n\t\t\t\t\t\t\t\t{@render children?.()}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{/if}\n\t\t\t\t\t</TextSelectionLayer>\n\t\t\t\t</DismissibleLayer>\n\t\t\t</EscapeLayer>\n\t\t{/snippet}\n\t</FocusScope>\n{/if}\n","<script lang=\"ts\">\n\timport { boxWith } from \"svelte-toolbelt\";\n\timport type { EscapeLayerImplProps } from \"./types.js\";\n\timport { EscapeLayerState } from \"./use-escape-layer.svelte.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\n\tlet {\n\t\tescapeKeydownBehavior = \"close\",\n\t\tonEscapeKeydown = noop,\n\t\tchildren,\n\t\tenabled,\n\t\tref,\n\t}: EscapeLayerImplProps = $props();\n\n\tEscapeLayerState.create({\n\t\tescapeKeydownBehavior: boxWith(() => escapeKeydownBehavior),\n\t\tonEscapeKeydown: boxWith(() => onEscapeKeydown),\n\t\tenabled: boxWith(() => enabled),\n\t\tref,\n\t});\n</script>\n\n{@render children?.()}\n","<script lang=\"ts\">\n\timport { boxWith } from \"svelte-toolbelt\";\n\timport type { DismissibleLayerImplProps } from \"./types.js\";\n\timport { DismissibleLayerState } from \"./use-dismissable-layer.svelte.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\n\tlet {\n\t\tinteractOutsideBehavior = \"close\",\n\t\tonInteractOutside = noop,\n\t\tonFocusOutside = noop,\n\t\tid,\n\t\tchildren,\n\t\tenabled,\n\t\tisValidEvent = () => false,\n\t\tref,\n\t}: DismissibleLayerImplProps = $props();\n\n\tconst dismissibleLayerState = DismissibleLayerState.create({\n\t\tid: boxWith(() => id),\n\t\tinteractOutsideBehavior: boxWith(() => interactOutsideBehavior),\n\t\tonInteractOutside: boxWith(() => onInteractOutside),\n\t\tenabled: boxWith(() => enabled),\n\t\tonFocusOutside: boxWith(() => onFocusOutside),\n\t\tisValidEvent: boxWith(() => isValidEvent),\n\t\tref,\n\t});\n</script>\n\n{@render children?.({ props: dismissibleLayerState.props })}\n","<script lang=\"ts\">\n\timport { boxWith } from \"svelte-toolbelt\";\n\timport type { TextSelectionLayerImplProps } from \"./types.js\";\n\timport { TextSelectionLayerState } from \"./use-text-selection-layer.svelte.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\n\tlet {\n\t\tpreventOverflowTextSelection = true,\n\t\tonPointerDown = noop,\n\t\tonPointerUp = noop,\n\t\tid,\n\t\tchildren,\n\t\tenabled,\n\t\tref,\n\t}: TextSelectionLayerImplProps = $props();\n\n\tTextSelectionLayerState.create({\n\t\tid: boxWith(() => id),\n\t\tonPointerDown: boxWith(() => onPointerDown),\n\t\tonPointerUp: boxWith(() => onPointerUp),\n\t\tenabled: boxWith(() => enabled && preventOverflowTextSelection),\n\t\tref,\n\t});\n</script>\n\n{@render children?.()}\n","<script lang=\"ts\">\n\timport { boxWith } from \"svelte-toolbelt\";\n\timport type { FocusScopeImplProps } from \"./types.js\";\n\timport { noop } from \"../../../internal/noop.js\";\n\timport { FocusScope } from \"./focus-scope.svelte.js\";\n\n\tlet {\n\t\tenabled = false,\n\t\ttrapFocus = false,\n\t\tloop = false,\n\t\tonCloseAutoFocus = noop,\n\t\tonOpenAutoFocus = noop,\n\t\tfocusScope,\n\t\tref,\n\t}: FocusScopeImplProps = $props();\n\n\tconst focusScopeState = FocusScope.use({\n\t\tenabled: boxWith(() => enabled),\n\t\ttrap: boxWith(() => trapFocus),\n\t\tloop: loop,\n\t\tonCloseAutoFocus: boxWith(() => onCloseAutoFocus),\n\t\tonOpenAutoFocus: boxWith(() => onOpenAutoFocus),\n\t\tref,\n\t});\n</script>\n\n{@render focusScope?.({ props: focusScopeState.props })}\n","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils\";\n\timport X from \"$lib/components/ui/icons/X.svelte\";\n\timport DialogPortal from \"./dialog-portal.svelte\";\n\timport DialogOverlay from \"./dialog-overlay.svelte\";\n\ttype $$Props = DialogPrimitive.ContentProps;\n\n\tlet {\n\t\tchildren,\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPortal>\n\t<DialogOverlay />\n\t<DialogPrimitive.Content\n\t\tclass={cn(\n\t\t\t'fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg',\n\t\t\tclassName\n\t\t)}\n\t\t{...rest}\n\t>\n\t\t\t{#if children}\n\t\t\t\t{@render children()}\n\t\t\t{/if}\n\t\t<DialogPrimitive.Close\n\t\t  class=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\"\n\t\t>\n\t\t\t<X class=\"h-4 w-4\" />\n\t\t\t<span class=\"sr-only\">Close</span>\n\t\t</DialogPrimitive.Close>\n\t</DialogPrimitive.Content>\n</DialogPortal>","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\ttype $$Props = DialogPrimitive.PortalProps & { children?: any };\n\n\tlet {\n\t\tchildren,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPrimitive.Portal\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</DialogPrimitive.Portal>","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils\";\n\n\ttype $$Props = DialogPrimitive.OverlayProps;\n\n\tlet {\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPrimitive.Overlay\n\tclass={cn(\n\t\t'fixed inset-0 z-50 bg-background/80 backdrop-blur-sm',\n\t\t'data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0',\n\t\tclassName\n\t)}\n\t{...rest}\n/>","<script lang=\"ts\">\n  // Define props using Svelte 5 Runes syntax\n  let {\n    size = 24,\n    color = 'currentColor',\n    strokeWidth = 2,\n    class: className = '',\n    ...rest\n  } = $props();\n\n  // Icon node data for X icon\n  const iconNode: [string, Record<string, string>][] = [\n    [\"line\", { x1: \"18\", y1: \"6\", x2: \"6\", y2: \"18\" }],\n    [\"line\", { x1: \"6\", y1: \"6\", x2: \"18\", y2: \"18\" }]\n  ];\n</script>\n\n<svg\n  xmlns=\"http://www.w3.org/2000/svg\"\n  width={size}\n  height={size}\n  viewBox=\"0 0 24 24\"\n  fill=\"none\"\n  stroke={color}\n  stroke-width={strokeWidth}\n  stroke-linecap=\"round\"\n  stroke-linejoin=\"round\"\n  class={`lucide-icon lucide-x ${className}`}\n  {...rest}\n>\n  {#each iconNode as [tag, attrs]}\n    <svelte:element this={tag} {...attrs} />\n  {/each}\n</svg>","<script lang=\"ts\">\n  /**\n   * LessonGenerator Component\n   *\n   * Provides a comprehensive interface for generating dynamic lessons with advanced parameters.\n   * Supports all lesson types (vocabulary, grammar, mixed) with detailed customization options.\n   */\n\n  import { enhancedLessonService } from '$lib/services/enhanced-lesson';\n  import { t } from '$lib/services/localization';\n  import { Dialog, DialogContent, DialogHeader, DialogTitle, DialogDescription, DialogFooter } from '$lib/components/ui/dialog';\n  import { Button } from '$lib/components/ui/button';\n  import type { LessonType, LessonDifficulty } from '$lib/schemas/lesson';\n  import type { VocabularyCategory, PartOfSpeech } from '$lib/schemas/vocabulary';\n\n  // Simple error handler\n  function handleError(error: unknown, context: string) {\n    console.error(`[${context}]`, error);\n  }\n\n  // Props\n  let { isOpen = false, onClose = () => {}, onLessonGenerated = () => {} } = $props();\n\n  // State\n  let isGenerating = $state(false);\n  let error = $state<string | null>(null);\n  let successMessage = $state<string | null>(null);\n  let hasError = $state(false);\n\n  // Lesson generation parameters\n  let lessonParams = $state<{\n    title: string;\n    description: string;\n    type: LessonType | '';\n    difficulty: LessonDifficulty | '';\n    category: VocabularyCategory | '';\n    partOfSpeech: PartOfSpeech | '';\n    conceptType: string;\n    limit: number;\n    includePractice: boolean;\n    includeComparison: boolean;\n    includeReview: boolean;\n  }>({\n    title: '',\n    description: '',\n    type: '',\n    difficulty: '',\n    category: '',\n    partOfSpeech: '',\n    conceptType: '',\n    limit: 10,\n    includePractice: true,\n    includeComparison: false,\n    includeReview: false\n  });\n\n  // Computed\n  let isVocabularyLesson = $derived(lessonParams.type === 'vocabulary');\n  let isGrammarLesson = $derived(lessonParams.type === 'grammar');\n  let isMixedLesson = $derived(lessonParams.type === 'mixed');\n  let generateLabel = $derived(t('lesson.generator.generate_lesson') || 'Generate Lesson');\n  let generatingLabel = $derived(t('lesson.generator.generating') || 'Generating...');\n\n  // Methods\n  function resetForm() {\n    lessonParams = {\n      title: '',\n      description: '',\n      type: '',\n      difficulty: '',\n      category: '',\n      partOfSpeech: '',\n      conceptType: '',\n      limit: 10,\n      includePractice: true,\n      includeComparison: false,\n      includeReview: false\n    };\n    error = null;\n    successMessage = null;\n  }\n\n  function closeModal() {\n    resetForm();\n    onClose();\n  }\n\n  /**\n   * Generate a lesson with proper error handling and validation\n   * @throws Error if lesson generation fails\n   */\n  async function generateLesson() {\n    try {\n      isGenerating = true;\n      error = null;\n      successMessage = null;\n      hasError = false;\n\n      // Validate required fields with proper type checking\n      if (!lessonParams.type || typeof lessonParams.type !== 'string') {\n        throw new Error(t('lesson.generator.errors.select_valid_lesson_type'));\n      }\n\n      if (!lessonParams.difficulty || typeof lessonParams.difficulty !== 'string') {\n        throw new Error(t('lesson.generator.errors.select_valid_difficulty'));\n      }\n\n      // Generate appropriate lesson based on type\n      let generatedLesson;\n\n      if (isVocabularyLesson) {\n        // Generate vocabulary lesson\n        const categories = lessonParams.category ? [lessonParams.category] : undefined;\n        generatedLesson = await enhancedLessonService.generateThematicLesson(\n          categories || [],\n          lessonParams.difficulty,\n          {\n            includePractice: lessonParams.includePractice,\n            includeReview: lessonParams.includeReview\n          }\n        );\n      }\n      else if (isGrammarLesson) {\n        // Generate grammar lesson\n        generatedLesson = await enhancedLessonService.generateGrammarLesson(\n          lessonParams.conceptType || 'basic',\n          lessonParams.difficulty,\n          {\n            includePractice: lessonParams.includePractice,\n            includeComparison: lessonParams.includeComparison\n          }\n        );\n      }\n      else if (isMixedLesson) {\n        // Generate mixed lesson\n        const category = lessonParams.category || 'everyday-phrases';\n        generatedLesson = await enhancedLessonService.generateMixedLesson(\n          category,\n          lessonParams.difficulty,\n          {\n            includePractice: lessonParams.includePractice,\n            includeReview: lessonParams.includeReview\n          }\n        );\n      }\n      else {\n        // Fallback to dynamic lesson\n        const params = {\n          type: lessonParams.type,\n          difficulty: lessonParams.difficulty,\n          criteria: {\n            categories: lessonParams.category && (lessonParams.category as string) !== 'uncategorized' ? [lessonParams.category as VocabularyCategory] : [],\n            ...(lessonParams.partOfSpeech ? { partOfSpeech: lessonParams.partOfSpeech as PartOfSpeech } : {}),\n            conceptType: lessonParams.conceptType,\n            limit: lessonParams.limit\n          },\n          userId: 'local-user',\n          metadata: {\n            includePractice: lessonParams.includePractice,\n            includeComparison: lessonParams.includeComparison,\n            includeReview: lessonParams.includeReview\n          }\n        };\n\n        generatedLesson = await enhancedLessonService.generateDynamicLesson(params);\n      }\n\n      // Apply custom title and description if provided\n      if (lessonParams.title) {\n        generatedLesson.title = lessonParams.title;\n      }\n\n      if (lessonParams.description) {\n        generatedLesson.description = lessonParams.description;\n      }\n\n      // Notify parent component\n      onLessonGenerated(generatedLesson);\n\n      // Show success message\n      successMessage = t('lesson.generator.success_message');\n\n      // Close modal after 2 seconds\n      setTimeout(() => {\n        closeModal();\n      }, 2000);\n\n    } catch (err) {\n      handleError(err, 'Failed to generate lesson');\n      error = err instanceof Error ? err.message : t('lesson.generator.errors.generation_failed');\n      hasError = true;\n\n      // Re-throw to allow parent components to handle the error\n      throw err;\n    } finally {\n      isGenerating = false;\n    }\n  }\n\n  function getLessonTypeName(type: string) {\n    const typeNames: Record<string, string> = {\n      'vocabulary': t('lesson.types.vocabulary'),\n      'grammar': t('lesson.types.grammar'),\n      'mixed': t('lesson.types.mixed'),\n      'conversation': t('lesson.types.conversation'),\n      'reading': t('lesson.types.reading'),\n      'listening': t('lesson.types.listening'),\n      'writing': t('lesson.types.writing'),\n      'culture': t('lesson.types.culture'),\n      'contextual': t('lesson.types.contextual')\n    };\n    return typeNames[type] || type;\n  }\n\n  function getCategoryDisplayName(category: string) {\n    const displayNames: Record<string, string> = {\n      'greetings': t('vocabulary.categories.greetings'),\n      'numbers': t('vocabulary.categories.numbers'),\n      'family': t('vocabulary.categories.family'),\n      'food': t('vocabulary.categories.food'),\n      'colors': t('vocabulary.categories.colors'),\n      'animals': t('vocabulary.categories.animals'),\n      'body': t('vocabulary.categories.body_parts'),\n      'clothing': t('vocabulary.categories.clothing'),\n      'house': t('vocabulary.categories.house_home'),\n      'nature': t('vocabulary.categories.nature'),\n      'transport': t('vocabulary.categories.transportation'),\n      'technology': t('vocabulary.categories.technology'),\n      'time': t('vocabulary.categories.time_date'),\n      'weather': t('vocabulary.categories.weather'),\n      'professions': t('vocabulary.categories.professions'),\n      'places': t('vocabulary.categories.places'),\n      'grammar': t('vocabulary.categories.grammar'),\n      'culture': t('vocabulary.categories.culture'),\n      'common_phrases': t('vocabulary.categories.common_phrases'),\n      'uncategorized': t('vocabulary.categories.uncategorized')\n    };\n\n    return displayNames[category] || category;\n  }\n\n  function getPartOfSpeechDisplayName(partOfSpeech: string) {\n    const displayNames: Record<string, string> = {\n      'noun': t('vocabulary.parts_of_speech.nouns'),\n      'verb': t('vocabulary.parts_of_speech.verbs'),\n      'adjective': t('vocabulary.parts_of_speech.adjectives'),\n      'adverb': t('vocabulary.parts_of_speech.adverbs'),\n      'pronoun': t('vocabulary.parts_of_speech.pronouns'),\n      'preposition': t('vocabulary.parts_of_speech.prepositions'),\n      'conjunction': t('vocabulary.parts_of_speech.conjunctions'),\n      'interjection': t('vocabulary.parts_of_speech.interjections'),\n      'article': t('vocabulary.parts_of_speech.articles'),\n      'number': t('vocabulary.parts_of_speech.numbers'),\n      'phrase': t('vocabulary.parts_of_speech.phrases')\n    };\n\n    return displayNames[partOfSpeech] || partOfSpeech;\n  }\n\n  function getDifficultyLevels(): LessonDifficulty[] {\n    return ['A1', 'A2', 'B1', 'B2', 'C1'];\n  }\n\n  function getVocabularyCategories(): VocabularyCategory[] {\n    return [\n      'greetings', 'numbers', 'family', 'food', 'colors', 'animals', 'body-parts',\n      'clothing', 'home', 'nature', 'transport', 'technology', 'time', 'weather',\n      'professions', 'places', 'grammar', 'culture', 'everyday-phrases'\n    ];\n  }\n\n  function getPartsOfSpeech(): PartOfSpeech[] {\n    return ['noun', 'verb', 'adjective', 'adverb', 'pronoun', 'preposition', 'conjunction', 'phrase'];\n  }\n\n  function getLessonTypes(): LessonType[] {\n    return ['vocabulary', 'grammar', 'mixed', 'conversation', 'culture'];\n  }\n</script>\n\n<Dialog open={isOpen} onOpenChange={(open) => {\n  try {\n    if (!open) closeModal();\n  } catch (err) {\n    handleError(err, 'Failed to close lesson generator modal');\n    hasError = true;\n  }\n}}>\n  <DialogContent class=\"lesson-generator-modal\">\n    <DialogHeader>\n      <DialogTitle>{t('lesson.generator.title')}</DialogTitle>\n      <DialogDescription>\n        {t('lesson.generator.description')}\n      </DialogDescription>\n    </DialogHeader>\n\n    <div class=\"lesson-generator-form\">\n      {#if hasError}\n        <div class=\"error-message\">\n          ‚ö†Ô∏è {error}\n          <button\n            class=\"retry-button\"\n            onclick={() => {\n              try {\n                error = null;\n                hasError = false;\n              } catch (err) {\n                handleError(err, 'Failed to clear error state');\n              }\n            }}\n          >\n            {t('common.try_again')}\n          </button>\n        </div>\n      {/if}\n\n      {#if successMessage}\n        <div class=\"success-message\">\n          ‚úÖ {successMessage}\n        </div>\n      {/if}\n\n      <div class=\"form-section\">\n        <h3>{t('lesson.generator.basic_information')}</h3>\n\n        <div class=\"form-group\">\n          <label for=\"lesson-title\">{t('lesson.generator.lesson_title')}</label>\n          <input\n            id=\"lesson-title\"\n            type=\"text\"\n            bind:value={lessonParams.title}\n            placeholder={t('lesson.generator.lesson_title_placeholder')}\n          />\n        </div>\n\n        <div class=\"form-group\">\n          <label for=\"lesson-description\">{t('lesson.generator.description')}</label>\n          <textarea\n            id=\"lesson-description\"\n            bind:value={lessonParams.description}\n            placeholder={t('lesson.generator.description_placeholder')}\n            rows=\"3\"\n          ></textarea>\n        </div>\n      </div>\n\n      <div class=\"form-section\">\n        <h3>{t('lesson.generator.lesson_parameters')}</h3>\n\n        <div class=\"form-row\">\n          <div class=\"form-group\">\n            <label for=\"lesson-type\">{t('lesson.generator.lesson_type_required')}</label>\n            <select id=\"lesson-type\" bind:value={lessonParams.type}>\n              <option value=\"\">{t('lesson.generator.select_lesson_type')}</option>\n              {#each getLessonTypes() as type}\n                <option value={type}>{getLessonTypeName(type)}</option>\n              {/each}\n            </select>\n          </div>\n\n          <div class=\"form-group\">\n            <label for=\"lesson-difficulty\">{t('lesson.generator.difficulty_level_required')}</label>\n            <select id=\"lesson-difficulty\" bind:value={lessonParams.difficulty}>\n              <option value=\"\">{t('lesson.generator.select_difficulty')}</option>\n              {#each getDifficultyLevels() as level}\n                <option value={level}>{level}</option>\n              {/each}\n            </select>\n          </div>\n        </div>\n\n        {#if isVocabularyLesson || isMixedLesson}\n          <div class=\"form-row\">\n            <div class=\"form-group\">\n              <label for=\"lesson-category\">{t('lesson.generator.category')}</label>\n              <select id=\"lesson-category\" bind:value={lessonParams.category}>\n                <option value=\"\">{t('lesson.generator.any_category')}</option>\n                {#each getVocabularyCategories() as category}\n                  <option value={category}>{getCategoryDisplayName(category)}</option>\n                {/each}\n              </select>\n            </div>\n\n            <div class=\"form-group\">\n              <label for=\"lesson-part-of-speech\">{t('lesson.generator.part_of_speech')}</label>\n              <select id=\"lesson-part-of-speech\" bind:value={lessonParams.partOfSpeech}>\n                <option value=\"\">{t('lesson.generator.any_part_of_speech')}</option>\n                {#each getPartsOfSpeech() as partOfSpeech}\n                  <option value={partOfSpeech}>{getPartOfSpeechDisplayName(partOfSpeech)}</option>\n                {/each}\n              </select>\n            </div>\n          </div>\n        {/if}\n\n        {#if isGrammarLesson}\n          <div class=\"form-group\">\n            <label for=\"lesson-concept-type\">{t('lesson.generator.grammar_concept')}</label>\n            <input\n              id=\"lesson-concept-type\"\n              type=\"text\"\n              bind:value={lessonParams.conceptType}\n              placeholder={t('lesson.generator.grammar_concept_placeholder')}\n            />\n          </div>\n        {/if}\n\n        <div class=\"form-group\">\n          <label for=\"lesson-limit\">{t('lesson.generator.number_of_items')}</label>\n          <select id=\"lesson-limit\" bind:value={lessonParams.limit}>\n            <option value=\"5\">5 {t('lesson.generator.items')}</option>\n            <option value=\"8\">8 {t('lesson.generator.items')}</option>\n            <option value=\"10\" selected>10 {t('lesson.generator.items')}</option>\n            <option value=\"15\">15 {t('lesson.generator.items')}</option>\n            <option value=\"20\">20 {t('lesson.generator.items')}</option>\n          </select>\n        </div>\n      </div>\n\n      <div class=\"form-section\">\n        <h3>{t('lesson.generator.options')}</h3>\n\n        <div class=\"form-row\">\n          <div class=\"form-group checkbox-group\">\n            <label>\n              <input type=\"checkbox\" bind:checked={lessonParams.includePractice} />\n              {t('lesson.generator.include_practice_exercises')}\n            </label>\n          </div>\n\n          {#if isGrammarLesson}\n            <div class=\"form-group checkbox-group\">\n              <label>\n                <input type=\"checkbox\" bind:checked={lessonParams.includeComparison} />\n                {t('lesson.generator.include_language_comparison')}\n              </label>\n            </div>\n          {/if}\n\n          {#if isVocabularyLesson || isMixedLesson}\n            <div class=\"form-group checkbox-group\">\n              <label>\n                <input type=\"checkbox\" bind:checked={lessonParams.includeReview} />\n                {t('lesson.generator.include_review_section')}\n              </label>\n            </div>\n          {/if}\n        </div>\n      </div>\n    </div>\n\n    <DialogFooter>\n      <Button\n        variant=\"secondary\"\n        size=\"default\"\n        class=\"\"\n        onclick={() => {\n          try {\n            closeModal();\n          } catch (err) {\n            handleError(err, 'Failed to close modal');\n            hasError = true;\n          }\n        }}\n        disabled={isGenerating}\n      >\n        {t('common.cancel')}\n      </Button>\n      <Button\n        variant=\"default\"\n        size=\"default\"\n        class=\"\"\n        onclick={() => {\n          try {\n            generateLesson();\n          } catch (err) {\n            // Error is already handled in the generateLesson function\n          }\n        }}\n        disabled={isGenerating}\n      >\n            {isGenerating ? generatingLabel : generateLabel}\n      </Button>\n    </DialogFooter>\n  </DialogContent>\n</Dialog>\n\n<style>\n\n  .lesson-generator-form {\n    padding: 1rem 0;\n  }\n\n  .form-section {\n    margin-bottom: 1.5rem;\n    padding-bottom: 1.5rem;\n    border-bottom: 1px solid #e2e8f0;\n  }\n\n  .form-section:last-child {\n    border-bottom: none;\n    margin-bottom: 0;\n  }\n\n  .form-section h3 {\n    font-size: 1rem;\n    font-weight: 600;\n    color: #1e293b;\n    margin-bottom: 1rem;\n  }\n\n  .form-group {\n    margin-bottom: 1rem;\n  }\n\n  .form-group label {\n    display: block;\n    margin-bottom: 0.5rem;\n    font-size: 0.875rem;\n    font-weight: 500;\n    color: #475569;\n  }\n\n  .form-row {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 1rem;\n  }\n\n  input, textarea, select {\n    width: 100%;\n    padding: 0.5rem 1rem;\n    border-radius: 8px;\n    border: 1px solid #e2e8f0;\n    background: white;\n    font-size: 0.875rem;\n  }\n\n  textarea {\n    resize: vertical;\n    min-height: 80px;\n  }\n\n  .checkbox-group {\n    display: flex;\n    align-items: center;\n    gap: 0.5rem;\n  }\n\n  .checkbox-group input {\n    width: auto;\n  }\n\n  .error-message {\n    padding: 0.75rem 1rem;\n    background: #fef2f2;\n    border-radius: 8px;\n    color: #ef4444;\n    margin-bottom: 1rem;\n    font-size: 0.875rem;\n  }\n\n  .success-message {\n    padding: 0.75rem 1rem;\n    background: #f0fdf4;\n    border-radius: 8px;\n    color: #10b981;\n    margin-bottom: 1rem;\n    font-size: 0.875rem;\n  }\n\n  @media (max-width: 768px) {\n    .form-row {\n      grid-template-columns: 1fr;\n    }\n\n  }\n</style>","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\n\ttype $$Props = DialogPrimitive.RootProps & { children?: any };\n\n\tlet {\n\t\tchildren,\n\t\topen = $bindable(false),\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPrimitive.Root\n\tbind:open\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</DialogPrimitive.Root>\n","<script lang=\"ts\">\n\timport { cn } from \"$lib/utils\";\n\timport type { HTMLAttributes } from \"svelte/elements\";\n\timport type { Snippet } from \"svelte\";\n\n\ttype $$Props = HTMLAttributes<HTMLDivElement> & {\n\tchildren?: Snippet;\n};\n\n\tlet {\n\t\tchildren,\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<div\n\tclass={cn('flex flex-col space-y-1.5 text-center sm:text-left', className)}\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</div>","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils\";\n\n\ttype $$Props = DialogPrimitive.TitleProps;\n\n\tlet {\n\t\tchildren,\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPrimitive.Title\n\tclass={cn('text-lg font-semibold leading-none tracking-tight', className)}\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</DialogPrimitive.Title>","<script lang=\"ts\">\n\timport { Dialog as DialogPrimitive } from \"bits-ui\";\n\timport { cn } from \"$lib/utils\";\n\n\ttype $$Props = DialogPrimitive.DescriptionProps;\n\n\tlet {\n\t\tchildren,\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<DialogPrimitive.Description\n\tclass={cn('text-sm text-muted-foreground', className)}\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</DialogPrimitive.Description>","<script lang=\"ts\">\n\timport { cn } from \"$lib/utils\";\n\timport type { HTMLAttributes } from \"svelte/elements\";\n\timport type { Snippet } from \"svelte\";\n\n\ttype $$Props = HTMLAttributes<HTMLDivElement> & {\n\tchildren?: Snippet;\n};\n\n\tlet {\n\t\tchildren,\n\t\tclass: className = undefined,\n\t\t...rest\n\t}: $$Props = $props();\n</script>\n\n<div\n\tclass={cn('flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2', className)}\n\t{...rest}\n>\n\t{#if children}\n\t\t{@render children()}\n\t{/if}\n</div>","<script lang=\"ts\">\n  /**\n   * Lessons Page\n   *\n   * Displays available lessons and allows users to browse and start learning.\n   * Uses the enhanced LessonService for comprehensive lesson generation and management.\n   */\n\n  import LessonCard from '$lib/components/LessonCard.svelte';\n  import GeneratedLesson from '$lib/components/GeneratedLesson.svelte';\n  import LessonGenerator from '$lib/components/LessonGenerator.svelte';\n  import { enhancedLessonService } from '$lib/services/enhanced-lesson';\n  import { lessonService } from '$lib/services/lesson';\n  import { vocabularyDb as db } from '$lib/data/db.svelte';\n  import { appState } from '$lib/state/app-state';\n  import type { VocabularyCategory, PartOfSpeech } from '$lib/schemas/vocabulary';\n  import type { VocabularyItem } from '$lib/types/vocabulary';\n  import type { Lesson, LessonDifficulty } from '$lib/schemas/lesson';\n\n  // State\n  let lessons = $state<Lesson[]>([]);\n  let isLoading = $state(true);\n  let error = $state<string | null>(null);\n  let selectedDifficulty = $state<LessonDifficulty | 'all'>('all');\n  let selectedType = $state<string>('all');\n  let showLessonGenerationModal = $state(false);\n  let showGeneratedLesson = $state<Lesson | null>(null);\n\n  const typeLabels = {\n    de: {\n      vocabulary: 'Vokabular',\n      grammar: 'Grammatik',\n      conversation: 'Konversation',\n      reading: 'Lesen',\n      listening: 'H√∂ren',\n      writing: 'Schreiben',\n      culture: 'Kultur',\n      mixed: 'Gemischt'\n    },\n    bg: {\n      vocabulary: '–†–µ—á–Ω–∏–∫',\n      grammar: '–ì—Ä–∞–º–∞—Ç–∏–∫–∞',\n      conversation: '–†–∞–∑–≥–æ–≤–æ—Ä',\n      reading: '–ß–µ—Ç–µ–Ω–µ',\n      listening: '–°–ª—É—à–∞–Ω–µ',\n      writing: '–ü–∏—Å–∞–Ω–µ',\n      culture: '–ö—É–ª—Ç—É—Ä–∞',\n      mixed: '–°–º–µ—Å–µ–Ω–æ'\n    }\n  } as const;\n\n  const categoryLabels = {\n    de: {\n      greetings: 'Begr√º√üungen',\n      numbers: 'Zahlen',\n      family: 'Familie',\n      food: 'Essen',\n      colors: 'Farben',\n      animals: 'Tiere',\n      'body-parts': 'K√∂rperteile',\n      clothing: 'Kleidung',\n      home: 'Zuhause',\n      nature: 'Natur',\n      transport: 'Verkehr',\n      technology: 'Technologie',\n      time: 'Zeit',\n      weather: 'Wetter',\n      professions: 'Berufe',\n      places: 'Orte',\n      grammar: 'Grammatik',\n      culture: 'Kultur',\n      'everyday-phrases': 'Alltagsphrasen'\n    },\n    bg: {\n      greetings: '–ü–æ–∑–¥—Ä–∞–≤–∏',\n      numbers: '–ß–∏—Å–ª–∞',\n      family: '–°–µ–º–µ–π—Å—Ç–≤–æ',\n      food: '–•—Ä–∞–Ω–∞',\n      colors: '–¶–≤–µ—Ç–æ–≤–µ',\n      animals: '–ñ–∏–≤–æ—Ç–Ω–∏',\n      'body-parts': '–ß–∞—Å—Ç–∏ –Ω–∞ —Ç—è–ª–æ—Ç–æ',\n      clothing: '–û–±–ª–µ–∫–ª–æ',\n      home: '–î–æ–º',\n      nature: '–ü—Ä–∏—Ä–æ–¥–∞',\n      transport: '–¢—Ä–∞–Ω—Å–ø–æ—Ä—Ç',\n      technology: '–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏',\n      time: '–í—Ä–µ–º–µ',\n      weather: '–í—Ä–µ–º–µ—Ç–æ',\n      professions: '–ü—Ä–æ—Ñ–µ—Å–∏–∏',\n      places: '–ú–µ—Å—Ç–∞',\n      grammar: '–ì—Ä–∞–º–∞—Ç–∏–∫–∞',\n      culture: '–ö—É–ª—Ç—É—Ä–∞',\n      'everyday-phrases': '–ß–µ—Å—Ç–æ —Å—Ä–µ—â–∞–Ω–∏ –∏–∑—Ä–∞–∑–∏'\n    }\n  } as const;\n\n  const partOfSpeechLabels = {\n    de: {\n      noun: 'Nomen',\n      verb: 'Verben',\n      adjective: 'Adjektive',\n      adverb: 'Adverbien',\n      pronoun: 'Pronomen',\n      preposition: 'Pr√§positionen',\n      conjunction: 'Konjunktionen',\n      interjection: 'Interjektionen',\n      article: 'Artikel',\n      number: 'Zahlw√∂rter',\n      phrase: 'Redewendungen'\n    },\n    bg: {\n      noun: '–°—ä—â–µ—Å—Ç–≤–∏—Ç–µ–ª–Ω–∏',\n      verb: '–ì–ª–∞–≥–æ–ª–∏',\n      adjective: '–ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª–Ω–∏',\n      adverb: '–ù–∞—Ä–µ—á–∏—è',\n      pronoun: '–ú–µ—Å—Ç–æ–∏–º–µ–Ω–∏—è',\n      preposition: '–ü—Ä–µ–¥–ª–æ–∑–∏',\n      conjunction: '–°—ä—é–∑–∏',\n      interjection: '–ú–µ–∂–¥—É–º–µ—Ç–∏—è',\n      article: '–ß–ª–µ–Ω–æ–≤–µ',\n      number: '–ß–∏—Å–ª–∏—Ç–µ–ª–Ω–∏',\n      phrase: '–ò–∑—Ä–∞–∑–∏'\n    }\n  } as const;\n\n  const ui = $derived(appState.languageMode === 'DE_BG'\n    ? {\n        title: 'Lektionen',\n        subtitle: 'Strukturierte Lernerlebnisse f√ºr Bulgarisch und Deutsch',\n        createDynamicLesson: '‚ú® Dynamische Lektion erstellen',\n        createLesson: '‚ú® Lektion erstellen',\n        createFirstLesson: 'Erstelle deine erste Lektion',\n        loading: 'Lektionen werden geladen...',\n        error: 'Fehler beim Laden. Bitte erneut versuchen.',\n        retry: 'Erneut versuchen',\n        emptyTitle: 'Keine Lektionen verf√ºgbar',\n        emptyDescription: 'Erstelle deine erste individuelle Lektion!',\n        difficultyLabel: 'Niveau',\n        typeLabel: 'Typ',\n        allLevels: 'Alle Niveaus',\n        allTypes: 'Alle Typen',\n        backToLessons: '‚Üê Zur√ºck zu allen Lektionen',\n        showingLessons: (shown: number, total: number) => `Zeige ${shown} von ${total} Lektionen`,\n        resetFilters: 'Filter zur√ºcksetzen',\n        mixedEveryday: 'Gemischt: Allt√§gliche Gespr√§che',\n        basicVocabulary: 'Grundwortschatz',\n        categoryPrefix: 'Kategorie',\n        grammarPrefix: 'Grammatik'\n      }\n    : {\n        title: '–£—Ä–æ—Ü–∏',\n        subtitle: '–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–∞–Ω–∏ —É—Ä–æ—Ü–∏ –ø–æ –±—ä–ª–≥–∞—Ä—Å–∫–∏ –∏ –Ω–µ–º—Å–∫–∏',\n        createDynamicLesson: '‚ú® –°—ä–∑–¥–∞–π –¥–∏–Ω–∞–º–∏—á–µ–Ω —É—Ä–æ–∫',\n        createLesson: '‚ú® –°—ä–∑–¥–∞–π —É—Ä–æ–∫',\n        createFirstLesson: '–°—ä–∑–¥–∞–π –ø—ä—Ä–≤–∏—è —Å–∏ —É—Ä–æ–∫',\n        loading: '–ó–∞—Ä–µ–∂–¥–∞–º–µ —É—Ä–æ—Ü–∏—Ç–µ...',\n        error: '–ì—Ä–µ—à–∫–∞ –ø—Ä–∏ –∑–∞—Ä–µ–∂–¥–∞–Ω–µ. –û–ø–∏—Ç–∞–π—Ç–µ –ø–∞–∫.',\n        retry: '–û–ø–∏—Ç–∞–π –æ—Ç–Ω–æ–≤–æ',\n        emptyTitle: '–ù—è–º–∞ –Ω–∞–ª–∏—á–Ω–∏ —É—Ä–æ—Ü–∏',\n        emptyDescription: '–°—ä–∑–¥–∞–π –ø—ä—Ä–≤–∏—è —Å–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–∞–Ω —É—Ä–æ–∫!',\n        difficultyLabel: '–ù–∏–≤–æ',\n        typeLabel: '–¢–∏–ø',\n        allLevels: '–í—Å–∏—á–∫–∏ –Ω–∏–≤–∞',\n        allTypes: '–í—Å–∏—á–∫–∏ —Ç–∏–ø–æ–≤–µ',\n        backToLessons: '‚Üê –ù–∞–∑–∞–¥ –∫—ä–º –≤—Å–∏—á–∫–∏ —É—Ä–æ—Ü–∏',\n        showingLessons: (shown: number, total: number) => `–ü–æ–∫–∞–∑–∞–Ω–∏ ${shown} –æ—Ç –æ–±—â–æ ${total} —É—Ä–æ–∫–∞`,\n        resetFilters: '–ù—É–ª–∏—Ä–∞–π —Ñ–∏–ª—Ç—Ä–∏—Ç–µ',\n        mixedEveryday: '–°–º–µ—Å–µ–Ω–æ: –ï–∂–µ–¥–Ω–µ–≤–Ω–∏ —Ä–∞–∑–≥–æ–≤–æ—Ä–∏',\n        basicVocabulary: '–û—Å–Ω–æ–≤–Ω–∞ –ª–µ–∫—Å–∏–∫–∞',\n        categoryPrefix: '–ö–∞—Ç–µ–≥–æ—Ä–∏—è',\n        grammarPrefix: '–ì—Ä–∞–º–∞—Ç–∏–∫–∞'\n      });\n\n  // Computed\n  let filteredLessons = $derived(\n    lessons.filter(lesson => {\n      const difficultyMatch = selectedDifficulty === 'all' || lesson.difficulty === selectedDifficulty;\n      const typeMatch = selectedType === 'all' || lesson.type === selectedType;\n      return difficultyMatch && typeMatch;\n    })\n  );\n\n  // Initialize lessons\n  $effect(() => {\n    loadLessons();\n  });\n\n  /**\n   * Load lessons from service\n   */\n  async function loadLessons() {\n    try {\n      isLoading = true;\n      error = null;\n\n      // Initialize enhanced lesson service\n      await enhancedLessonService.initialize();\n\n      // Generate comprehensive lessons using the enhanced service\n      const generatedLessons = await generateComprehensiveLessons();\n\n      lessons = generatedLessons;\n\n    } catch (err) {\n      console.error('Failed to load lessons:', err);\n      error = err instanceof Error ? err.message : ui.error;\n    } finally {\n      isLoading = false;\n    }\n  }\n\n  /**\n   * Generate comprehensive lessons using the enhanced LessonService\n   */\n  async function generateComprehensiveLessons(): Promise<Lesson[]> {\n    const lessons: Lesson[] = [];\n    const vocabularyStats = db.getVocabularyStatsByDifficulty();\n\n    // Generate lessons by difficulty level\n    const difficulties: LessonDifficulty[] = ['A1', 'A2', 'B1', 'B2', 'C1'];\n\n    for (const difficulty of difficulties) {\n      if (vocabularyStats[difficulty] >= 5) {\n        // Generate 2-3 lessons per difficulty level\n        const lessonCount = Math.min(3, Math.floor(vocabularyStats[difficulty] / 5));\n\n        for (let i = 0; i < lessonCount; i++) {\n          try {\n            const lesson = await lessonService.generateLessonFromCriteria({\n              difficulty,\n              limit: 8,\n              type: i === 0 ? 'vocabulary' : (i === 1 ? 'conversation' : 'mixed')\n            });\n            lessons.push(lesson);\n          } catch (error) {\n            console.error(`Failed to generate ${difficulty} lesson ${i + 1}:`, error);\n          }\n        }\n      }\n    }\n\n    // Generate lessons by category\n    const categories: VocabularyCategory[] = [\n      'greetings', 'numbers', 'family', 'food', 'colors', 'animals', 'body-parts', 'clothing'\n    ];\n\n    for (const category of categories) {\n      try {\n        const categoryItems = db.getVocabularyByCategory(category);\n        if (categoryItems.length >= 5) {\n          const lesson = await lessonService.generateLessonFromCriteria({\n            categories: [category],\n            limit: 8,\n            type: 'vocabulary',\n            title: `${ui.categoryPrefix}: ${getCategoryDisplayName(category)}`\n          });\n          lessons.push(lesson);\n        }\n      } catch (error) {\n        console.error(`Failed to generate ${category} category lesson:`, error);\n      }\n    }\n\n    // Generate lessons by part of speech\n    const partsOfSpeech: PartOfSpeech[] = ['noun', 'verb', 'adjective', 'adverb'];\n\n    for (const partOfSpeech of partsOfSpeech) {\n      try {\n        const posItems = db.getVocabularyByPartOfSpeech(partOfSpeech);\n        if (posItems.length >= 5) {\n          const lesson = await lessonService.generateLessonFromCriteria({\n            partOfSpeech,\n            limit: 8,\n            type: 'vocabulary',\n            title: `${ui.grammarPrefix}: ${getPartOfSpeechDisplayName(partOfSpeech)}`\n          });\n          lessons.push(lesson);\n        }\n      } catch (error) {\n        console.error(`Failed to generate ${partOfSpeech} lesson:`, error);\n      }\n    }\n\n    // Generate mixed lessons if we have enough vocabulary\n    if (db.getVocabularyCount() >= 15) {\n      try {\n        const lesson = await lessonService.generateLessonFromCriteria({\n          limit: 10,\n          type: 'mixed',\n          title: ui.mixedEveryday\n        });\n        lessons.push(lesson);\n      } catch (error) {\n        console.error('Failed to generate mixed lesson:', error);\n      }\n    }\n\n    // If no lessons were generated, create fallback lessons\n    if (lessons.length === 0 && db.getVocabularyCount() > 0) {\n      console.warn('No lessons generated, creating fallback lessons');\n      const fallbackLessons = generateFallbackLessons();\n      lessons.push(...fallbackLessons);\n    }\n\n    return lessons;\n  }\n\n  /**\n   * Generate fallback lessons when automatic generation fails\n   */\n  function generateFallbackLessons(): Lesson[] {\n    const lessons: Lesson[] = [];\n    const vocabularyData = db.getVocabulary();\n\n    if (vocabularyData.length >= 5) {\n      // Group vocabulary by difficulty\n      const byDifficulty: Record<LessonDifficulty, VocabularyItem[]> = {\n        A1: [],\n        A2: [],\n        B1: [],\n        B2: [],\n        C1: []\n      };\n\n      vocabularyData.forEach(item => {\n        if (item.difficulty <= 1.5) byDifficulty.A1.push(item);\n        else if (item.difficulty <= 2.5) byDifficulty.A2.push(item);\n        else if (item.difficulty <= 3.5) byDifficulty.B1.push(item);\n        else if (item.difficulty <= 4.5) byDifficulty.B2.push(item);\n        else byDifficulty.C1.push(item);\n      });\n\n      // Create simple fallback lessons\n      for (const [difficulty, items] of Object.entries(byDifficulty)) {\n        if (items.length >= 5) {\n          const lesson = lessonService.generateLessonFromVocabulary(\n            items.slice(0, 8).map((item) => {\n              const transliteration = typeof item.transliteration === 'string'\n                ? { german: item.transliteration }\n                : (item.transliteration ?? {});\n              return {\n                ...item,\n                // Adapt unified vocabulary item to legacy expectations of lesson service\n                isCommon: item.metadata?.isCommon ?? false,\n                isVerified: item.metadata?.isVerified ?? false,\n                learningPhase: item.metadata?.learningPhase ?? 0,\n                cefrLevel: (() => {\n                  const level = item.metadata?.level ?? item.level ?? 'A1';\n                  return (level === 'C1' ? 'B2' : level) as 'A1' | 'A2' | 'B1' | 'B2';\n                })(),\n                transliteration,\n                culturalNotes: item.culturalNotes\n              };\n            }),\n            {\n              title: `${difficulty}: ${ui.basicVocabulary}`,\n              difficulty: difficulty as LessonDifficulty,\n              type: 'vocabulary'\n            }\n          );\n          lessons.push(lesson);\n        }\n      }\n    }\n\n    return lessons;\n  }\n\n  /**\n   * Handle generated lesson\n   */\n  function handleLessonGenerated(lesson: Lesson) {\n    lessons.push(lesson);\n    showGeneratedLesson = lesson;\n    showLessonGenerationModal = false;\n  }\n\n  /**\n   * Close generated lesson view\n   */\n  function closeGeneratedLesson() {\n    showGeneratedLesson = null;\n  }\n\n  /**\n   * Get available lesson types\n   */\n  function getLessonTypes(): string[] {\n    const types = new Set<string>();\n    lessons.forEach(lesson => types.add(lesson.type));\n    return ['all', ...Array.from(types)];\n  }\n\n  /**\n   * Get difficulty levels\n   */\n  function getDifficultyLevels(): LessonDifficulty[] {\n    return ['A1', 'A2', 'B1', 'B2', 'C1'];\n  }\n\n  /**\n   * Get vocabulary categories for lesson generation\n   */\n  // Removed unused getVocabularyCategories to satisfy TS\n  // Use canonical category source from unified schema where needed\n\n  /**\n   * Get parts of speech for lesson generation\n   */\n  // Removed unused helper to satisfy TS and keep file tidy\n  // If needed later, prefer importing from a shared constants module\n  // function getPartsOfSpeech(): PartOfSpeech[] {\n  //   return ['noun', 'verb', 'adjective', 'adverb', 'pronoun', 'preposition', 'conjunction', 'phrase'];\n  // }\n\n  /**\n   * Get lesson type display name\n   */\n  function getLessonTypeName(type: string): string {\n    const labels = appState.languageMode === 'DE_BG' ? typeLabels.de : typeLabels.bg;\n    return labels[type as keyof typeof labels] ?? type;\n  }\n\n  /**\n   * Get category display name\n   */\n  function getCategoryDisplayName(category: VocabularyCategory): string {\n    const labels = appState.languageMode === 'DE_BG' ? categoryLabels.de : categoryLabels.bg;\n    return labels[category] ?? category;\n  }\n\n  /**\n   * Get part of speech display name\n   */\n  function getPartOfSpeechDisplayName(partOfSpeech: PartOfSpeech): string {\n    const labels = appState.languageMode === 'DE_BG' ? partOfSpeechLabels.de : partOfSpeechLabels.bg;\n    // Guard against keys not present in labels (e.g., 'expression', 'article')\n    return (partOfSpeech in labels)\n      ? labels[partOfSpeech as keyof typeof labels]\n      : partOfSpeech;\n  }\n\n  \n</script>\n\n<div class=\"lessons-page\">\n  <header class=\"lessons-header\">\n    <h1>{ui.title}</h1>\n    <p class=\"subtitle\">{ui.subtitle}</p>\n    <button class=\"create-lesson-button\" onclick={() => showLessonGenerationModal = true}>\n      {ui.createDynamicLesson}\n    </button>\n  </header>\n\n  {#if isLoading}\n    <div class=\"loading-state\">\n      <div class=\"spinner\"></div>\n      <p>{ui.loading}</p>\n    </div>\n  {:else if error}\n    <div class=\"error-state\">\n      <div class=\"error-icon\">‚ö†Ô∏è</div>\n      <p>{error}</p>\n      <button class=\"retry-button\" onclick={loadLessons}>{ui.retry}</button>\n    </div>\n  {:else if lessons.length === 0}\n    <div class=\"empty-state\">\n      <div class=\"empty-icon\">üìö</div>\n      <p>{ui.emptyDescription}</p>\n      <button class=\"create-lesson-button\" onclick={() => showLessonGenerationModal = true}>\n        {ui.createFirstLesson}\n      </button>\n    </div>\n  {:else}\n    <div class=\"lessons-filters\">\n      <div class=\"filter-group\">\n        <label for=\"difficulty-filter\">{ui.difficultyLabel}</label>\n        <select id=\"difficulty-filter\" bind:value={selectedDifficulty}>\n          <option value=\"all\">{ui.allLevels}</option>\n          {#each getDifficultyLevels() as level}\n            <option value={level}>{level}</option>\n          {/each}\n        </select>\n      </div>\n\n      <div class=\"filter-group\">\n        <label for=\"type-filter\">{ui.typeLabel}</label>\n        <select id=\"type-filter\" bind:value={selectedType}>\n          <option value=\"all\">{ui.allTypes}</option>\n          {#each getLessonTypes() as type}\n            <option value={type}>{getLessonTypeName(type)}</option>\n          {/each}\n        </select>\n      </div>\n\n      <button class=\"create-lesson-button mobile\" onclick={() => showLessonGenerationModal = true}>\n        {ui.createLesson}\n      </button>\n    </div>\n\n    {#if showGeneratedLesson}\n      <GeneratedLesson lesson={showGeneratedLesson} />\n      <div class=\"back-to-lessons\">\n        <button class=\"back-button\" onclick={closeGeneratedLesson}>\n          {ui.backToLessons}\n        </button>\n      </div>\n    {:else}\n      <div class=\"lessons-grid\">\n        {#each filteredLessons as lesson (lesson.id)}\n          <div class=\"lesson-card-wrapper\">\n            <LessonCard {lesson} />\n          </div>\n        {/each}\n      </div>\n    {/if}\n\n    <div class=\"lessons-summary\">\n      <p>\n        {ui.showingLessons(filteredLessons.length, lessons.length)}\n        {#if selectedDifficulty !== 'all' || selectedType !== 'all'}\n          ‚Ä¢ <button class=\"reset-filters\" onclick={() => { selectedDifficulty = 'all'; selectedType = 'all'; }}>{ui.resetFilters}</button>\n        {/if}\n      </p>\n    </div>\n  {/if}\n\n  <!-- Lesson Generator Component -->\n  <LessonGenerator\n    isOpen={showLessonGenerationModal}\n    onClose={() => showLessonGenerationModal = false}\n    onLessonGenerated={handleLessonGenerated}\n  />\n</div>\n\n<style>\n  .lessons-page {\n    max-width: 1200px;\n    margin: 0 auto;\n    padding: 2rem;\n  }\n\n  .lessons-header {\n    text-align: center;\n    margin-bottom: 2rem;\n  }\n\n  .lessons-header h1 {\n    font-size: 2rem;\n    font-weight: 700;\n    color: #1e293b;\n    margin-bottom: 0.5rem;\n  }\n\n  .subtitle {\n    color: #64748b;\n    font-size: 1rem;\n  }\n\n  .lessons-filters {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 1rem;\n    margin-bottom: 2rem;\n    align-items: center;\n    justify-content: center;\n  }\n\n  .filter-group {\n    display: flex;\n    flex-direction: column;\n    gap: 0.5rem;\n  }\n\n  .filter-group label {\n    font-size: 0.875rem;\n    font-weight: 500;\n    color: #475569;\n  }\n\n  select {\n    padding: 0.5rem 1rem;\n    border-radius: 8px;\n    border: 1px solid #e2e8f0;\n    background: white;\n    font-size: 0.875rem;\n    cursor: pointer;\n    min-width: 150px;\n  }\n\n  .lessons-grid {\n    display: grid;\n    grid-template-columns: repeat(auto-fill, minmax(380px, 1fr));\n    gap: 1.5rem;\n    margin-bottom: 2rem;\n  }\n\n  .lesson-card-wrapper {\n    height: 500px;\n  }\n\n  .loading-state, .error-state, .empty-state {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: center;\n    min-height: 400px;\n    text-align: center;\n  }\n\n  .spinner {\n    width: 50px;\n    height: 50px;\n    border: 4px solid #f3f4f6;\n    border-top: 4px solid #3b82f6;\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n    margin-bottom: 1rem;\n  }\n\n  .error-icon, .empty-icon {\n    font-size: 3rem;\n    margin-bottom: 1rem;\n  }\n\n  .error-state p {\n    color: #ef4444;\n    font-size: 1.125rem;\n    margin-bottom: 1rem;\n  }\n\n  .empty-state p {\n    color: #64748b;\n    font-size: 1.125rem;\n  }\n\n  .retry-button {\n    padding: 0.5rem 1rem;\n    background: #3b82f6;\n    color: white;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.875rem;\n  }\n\n  .lessons-summary {\n    text-align: center;\n    color: #64748b;\n    font-size: 0.875rem;\n  }\n\n  .reset-filters {\n    background: none;\n    border: none;\n    color: #3b82f6;\n    cursor: pointer;\n    text-decoration: underline;\n    padding: 0;\n    font-size: 0.875rem;\n  }\n\n  /* Button Styles */\n  .create-lesson-button {\n    padding: 0.5rem 1rem;\n    background: #3b82f6;\n    color: white;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.875rem;\n    transition: background 0.2s ease;\n    display: inline-flex;\n    align-items: center;\n    gap: 0.5rem;\n  }\n\n  .create-lesson-button:hover {\n    background: #2563eb;\n  }\n\n  .create-lesson-button.mobile {\n    display: none;\n  }\n\n\n  @keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n  }\n\n  .back-to-lessons {\n    text-align: center;\n    margin: 2rem 0;\n  }\n\n  .back-button {\n    padding: 0.5rem 1rem;\n    background: #f1f5f9;\n    color: #475569;\n    border: 1px solid #e2e8f0;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 0.875rem;\n  }\n\n  @media (max-width: 768px) {\n    .lessons-page {\n      padding: 1rem;\n    }\n\n    .lessons-grid {\n      grid-template-columns: 1fr;\n    }\n\n    .lessons-filters {\n      flex-direction: column;\n      align-items: stretch;\n    }\n\n    .filter-group {\n      align-items: stretch;\n    }\n\n    select {\n      min-width: 100%;\n    }\n  }\n</style>"],"names":["createAttachmentKey","Symbol","ATTACHMENT_KEY","lesson","$.prop","$$props","isFlipped","$.state","currentVocabularyIndex","showAllVocabulary","vocabularyItems","$.derived","vocabulary","map","vocab","id","german","split","bulgarian","partOfSpeech","difficulty","Date","now","safeVocabularyItems","$.get","length","currentVocabulary","completionPercentage","Math","round","objectives","filter","obj","isCompleted","toggleFlip","$.set","getDifficultyColor","A1","A2","B1","B2","C1","div","root","div_1","$.child","__keydown","e","key","div_2","div_3","div_4","div_5","h3","p","div_6","div_7","div_8","span","div_9","div_10","$.each","node_1","slice","span_1","root_2","$.set_text","text_5","span_2","root_3","consequent","node_3","span_3","root_5","text_7","button","root_6","__click","text_8","$.reset","$.append","$$anchor","consequent_2","$$render","consequent_1","alternate","div_11","button_1","$.sibling","onStart","div_12","div_13","button_3","div_14","h3_1","div_15","ul","objective","li","root_7","label","input","$.remove_input_defaults","__change","toggleObjective","objectiveId","updatedAt","span_4","classes","completed","text_11","description","div_16","h4","div_17","button_4","span_5","button_5","div_18","div_19","div_20","div_21","span_6","root_8","$.template_effect","text_16","consequent_3","span_7","root_9","$0","text_17","repeat","consequent_4","div_22","$.index","index","div_23","root_10","span_8","span_9","$.set_class","div_24","title","text","duration","type","text_2","text_3","$.set_style","$.set_attribute","$2","text_9","text_10","text_12","disabled","text_13","text_14","text_15","grammar","conversation","reading","listening","writing","culture","mixed","contextual","getSourceText","item","appState","languageMode","hasError","errorMessage","handleError","error","context","console","currentSectionIndex","showAllObjectives","$.proxy","$.user_effect","Error","err","message","sections","content","metadata","currentSection","hasVocabulary","hasObjectives","hasSections","isFallbackLesson","fallback","nextSection","prevSection","getSectionIcon","introduction","exercise","cultural","summary","getSectionTypeName","names","t","root_1","window","location","reload","p_1","text_4","$.first_child","fragment_1","h1","tags","tag","h3_2","button_2","li_1","consequent_5","root_11","h3_3","text_18","root_12","text_20","consequent_6","root_13","root_14","root_15","correctPartOfSpeech","noun","verb","adjective","adverb","preposition","conjunction","pos","consequent_7","root_16","consequent_8","getTargetText","consequent_9","getVocabularyPreview","count","join","consequent_10","root_17","div_25","text_25","div_26","button_6","text_27","div_27","div_28","div_29","h2","div_30","div_31","div_32","div_33","root_18","templateId","consequent_11","div_34","div_35","section","div_36","root_19","div_37","div_38","div_39","text_33","text_26","$3","$4","text_29","$8","replace","div_40","root_20","text_35","consequent_12","div_41","node_13","button_7","history","back","button_8","alert","$1","alternate_1","alternate_2","VocabularyItemBaseSchema","z.object","LegacyIdSchema","z.string","min","max","PartOfSpeechSchema","default","z.number","describe","categories","z.array","VocabularyCategorySchemaWithFallback","VocabularyMetadataSchema","optional","createdAt","z.union","z.date","datetime","transform","str","val","isCommon","z.boolean","isVerified","VocabularyReferenceSchema","omit","uuid","LessonDifficultySchema","z.enum","LessonTypeSchema","LearningObjectiveSchema","LessonMetadataSchema","prerequisites","relatedLessons","isPremium","LessonSchema","catch","_ctx","lessonService","constructor","this","lessons","vocabularyData","initialized","initialize","db","vocabData","getVocabulary","normalizeCategories","learningPhase","cefrLevel","normalizeCefrLevel","_error","isInitialized","generateLessonFromVocabulary","options","createFallbackLesson","lessonTitle","generateLessonTitle","lessonDifficulty","determineLessonDifficulty","createLearningObjectives","crypto","randomUUID","generateLessonDescription","calculateLessonDuration","normalizeVocabularyItem","generateLessonTags","validateLesson","generateLessonFromCriteria","criteria","queryVocabulary","limitedItems","limit","difficultyRange","getDifficultyRange","difficultyMatch","categoryMatch","some","includes","category","partOfSpeechMatch","level","Set","forEach","add","typeName","size","categoryEntry","values","next","done","getCategoryDisplayName","value","partsOfSpeech","partOfSpeechList","Array","from","getPartOfSpeechDisplayName","itemCount","baseDuration","push","greetings","numbers","family","food","colors","animals","clothing","home","nature","transport","technology","time","weather","professions","places","pronoun","interjection","article","number","phrase","expression","allowed","normalized","Boolean","avgDifficulty","reduce","sum","result","safeParse","success","data","_errorMessage","getLessons","getLessonById","find","addLesson","validatedLesson","updateLesson","updates","findIndex","baseLesson","updatedLesson","removeLesson","initialLength","getLessonsByDifficulty","getLessonsByType","getLessonsByTag","getRandomLessons","sort","random","enhancedLessonService","generateDynamicLesson","params","validatedParams","validateLessonGenerationParams","generatedLesson","lessonGenerationEngine","generateLesson","convertGeneratedLessonToLesson","generateThematicLesson","userId","isLessonDifficulty","includePractice","includeReview","generateGrammarLesson","conceptType","includeComparison","generateMixedLesson","defaults","sectionContent","learningObjectives","uuidv4","normalizeDifficulty","normalizeLessonType","normalizeVocabulary","grammarConcepts","concept","name","displayName","difficultyLevel","focusArea","vocabCount","grammarConceptsText","items","isLessonType","normalizedCriteria","isObject","CLASS_VALUE_PRIMITIVE_TYPES","isClassValue","isArray","every","Object","getPrototypeOf","prototype","BoxSymbol","isWritableSymbol","boxWith","getter","setter","derived","current","v","composeHandlers","handlers","handler","defaultPrevented","call","COMMENT_REGEX","NEWLINE_REGEX","WHITESPACE_REGEX","PROPERTY_REGEX","COLON_REGEX","VALUE_REGEX","SEMICOLON_REGEX","TRIM_REGEX","EMPTY_STRING","trim","StyleToObject","style","iterator","styleObject","declarations","TypeError","lineno","column","updatePosition","lines","match","i","lastIndexOf","position","start","line","node","Position","whitespace","end","source","msg","reason","filename","silent","re","m","exec","comments","rules","c","comment","charAt","declaration","prop","ret","property","decl","decls","parse","hasIterator","NUMBER_CHAR_RE","STR_SPLITTERS","isUppercase","char","test","toLowerCase","pascalCase","parts","previousUpper","previousSplitter","buff","isSplitter","isUpper","lastChar","at","splitByCase","toUpperCase","upperFirst","cssToStyleObj","css","styleObj","startsWith","lowerFirst","executeCallbacks","callbacks","args","callback","camelToKebab","matcher","replacer","regex","RegExp","createParser","styleToString","keys","styleToCSS","EVENT_LIST_SET","isEventHandler","has","mergeProps","props","a","b","aIsFunction","bIsFunction","aHandler","bHandler","aIsClassValue","bIsClassValue","clsx","aIsObject","bIsObject","aIsString","bIsString","parsedStyle","parsedStyleA","parsedStyleB","getOwnPropertySymbols","replaceAll","hidden","defaultWindow","_SvelteMap","Map","super","__privateAdd","_SvelteMap_instances","_sources","_version","state","_size","_update_version","update_version","set","__privateGet","sources","s","get","__privateMethod","callbackfn","this_arg","read_all_fn","prev_res","res","version","increment","v_reactions","reactions","r","delete","clear","entries","WeakMap","WeakSet","source_fn","__superGet","SvelteMap","document","__privateSet","_document","createSubscriber","update","cleanupFocusIn","on","cleanupFocusOut","_a","activeElement","shadowRoot","getActiveElement","Context","_name","_key","exists","hasContext","getContext","getOr","setContext","runWatcher","flush","effect","lazy","active","previousValues","$.user_pre_effect","runEffect","cleanup","untrack","watch","onDestroyEffect","fn","afterTick","tick","then","pre","isHTMLElement","nodeType","nodeName","isShadowRoot","isNode","getDocument","isDocument","isWindow","ownerDocument","DOMContext","element","__publicField","getRootNode","defaultView","rootNode","el","selector","querySelector","querySelectorAll","delay","getWindow","setTimeout","timeoutId","clearTimeout","getElementById","attachRef","ref","onChange","isConnected","boolToEmptyStrOrUndef","condition","BitsAttrs","config","_variant","_prefix","getVariant","component","getAttr","bind","attrs","fromEntries","part","variantOverride","createBitsAttrs","bitsAttrs","isBrowser","isIOS","navigator","userAgent","maxTouchPoints","HTMLElement","AnimationsComplete","opts","_AnimationsComplete_instances","_opts","_currentFrame","cleanup_fn","run","getAnimations","requestAnimationFrame","animations","Promise","allSettled","animation","finished","cancelAnimationFrame","executeCallback_fn","execute","PresenceManager","open","enabled","isOpen","_shouldRender","_afterAnimations","onComplete","shouldRender","noop","createId","prefixOrUid","uid","dialogAttrs","DialogRootContext","_triggerNode","_contentNode","_overlayNode","_descriptionNode","_contentId","_titleId","_triggerId","_descriptionId","_cancelNode","_nestedOpenCount","DialogRootState","_DialogRootState","parent","variant","depth","handleOpen","handleClose","contentPresence","contentNode","onOpenChangeComplete","overlayPresence","overlayNode","incrementNested","decrementNested","create","triggerNode","descriptionNode","contentId","titleId","triggerId","descriptionId","cancelNode","nestedOpenCount","sharedProps","DialogCloseState","_DialogCloseState","getBitsAttr","onclick","onkeydown","tabindex","attachment","preventDefault","DialogTitleState","_DialogTitleState","role","DialogDescriptionState","_DialogDescriptionState","DialogContentState","_DialogContentState","pointerEvents","outline","snippetProps","DialogOverlayState","_DialogOverlayState","$.props_id","restProps","$.rest_props","titleState","mergedProps","$.snippet","child","$.attribute_effect","get_key","render_fn","hydrating","hydrate_next","branches","BranchManager","legacy","is_runes","block","ensure","BitsConfigContext","BitsConfigState","resolveConfigOption","currentOpts","createConfigResolver","defaultPortalTo","defaultLocale","resolvePortalToProp","configOption","getProp","getBitsConfig","propValue","option","to","getAllContexts","instance","target","localTarget","unmountInstance","unmount","mount","PortalConsumer","children","debounce","wait","timeout","debounced","destroy","isOrContainsTarget","contains","getOwnerDocument","candidateSelectors","candidateSelector","NoElement","Element","matches","msMatchesSelector","webkitMatchesSelector","_element$getRootNode","_isInert","lookUp","_node$getAttribute","inertAtt","getAttribute","parentNode","getCandidates","includeContainer","candidates","apply","unshift","_getCandidatesIteratively","elements","elementsToCheck","shift","tagName","assigned","assignedElements","nestedCandidates","flatten","scopeParent","getShadowRoot","validShadowRoot","shadowRootFilter","_nestedCandidates","hasTabIndex","isNaN","parseInt","getTabIndex","tabIndex","_node$getAttribute2","attValue","isContentEditable","sortOrderedTabbables","documentOrder","isInput","isNonTabbableRadio","isRadio","radioSet","radioScope","form","queryRadios","CSS","escape","checked","nodes","getCheckedRadio","isTabbableRadio","isZeroArea","_node$getBoundingClie","getBoundingClientRect","width","height","isHidden","_ref","displayCheck","checkVisibility","checkOpacity","opacityProperty","contentVisibilityAuto","visibilityProperty","checkVisibilityCSS","getComputedStyle","visibility","nodeUnderDetails","parentElement","originalNode","assignedSlot","host","_nodeRoot","_nodeRootHost","_nodeRootHost$ownerDo","_node$ownerDocument","nodeRoot","nodeRootHost","attached","_nodeRoot2","_nodeRootHost2","_nodeRootHost2$ownerD","isNodeAttached","getClientRects","isNodeMatchingSelectorFocusable","isHiddenInput","isDetailsWithSummary","isDisabledFromFieldset","isNodeMatchingSelectorTabbable","isShadowRootTabbable","shadowHostNode","_sortByOrder","regularTabbables","orderedTabbables","isScope","candidateTabindex","getSortOrderTabIndex","acc","sortable","concat","focusableCandidateSelector","CONTEXT_MENU_TRIGGER_ATTR","CONTEXT_MENU_CONTENT_ATTR","globalThis","bitsDismissableLayers","_isResponsibleLayer","_isFocusInsideDOMTree","_documentObj","_unsubClickListener","_DismissibleLayerState_instances","addEventListeners_fn","_markInterceptedEvent","_markResponsibleLayer","capture","_markNonInterceptedEvent","_handleFocus","_handleInteractOutside","_resetState","isAnyEventIntercepted_fn","_interceptedEvents","_onfocuscapture","_onblurcapture","DismissibleLayerState","_DismissibleLayerState","pointerdown","event","_isTargetWithinLayer","_onFocusOutside","createWrappedEvent","_interactOutsideProp","isEventValid","isValidEvent","SVGElement","targetIsContextMenuTrigger","closest","nodeIsContextMenu","isValid","documentElement","clientX","clientY","rect","left","right","top","bottom","isClickTrulyOutside","_behaviorType","pointerType","_handleDismiss","once","layersArr","topMostLayer","findLast","_","behaviorType","getTopMostDismissableLayer","firstLayerNode","isResponsibleLayer","eventType","onfocuscapture","onblurcapture","interactOutsideBehavior","onInteractOutside","onFocusOutside","unsubEvents","capturedCurrentTarget","currentTarget","capturedTarget","newEvent","PointerEvent","isPrevented","Proxy","bitsEscapeLayers","_addEventListener","EscapeLayerState","_EscapeLayerState","domContext","_onkeydown","passive","isResponsibleEscapeLayer","clonedEvent","KeyboardEvent","escapeKeydownBehavior","onEscapeKeydown","_FocusScopeManager","_scopeStack","initialValue","simpleBox","_focusHistory","_preFocusHistory","getInstance","register","scope","getActive","pause","body","unregister","resume","setFocusMemory","getFocusMemory","isActiveScope","setPreFocusMemory","getPreFocusMemory","clearPreFocusMemory","FocusScopeManager","_paused","_container","_FocusScope_instances","_cleanupFns","handleOpenAutoFocus_fn","CustomEvent","bubbles","cancelable","onOpenAutoFocus","firstTabbable","getFirstTabbable_fn","focus","handleCloseAutoFocus_fn","onCloseAutoFocus","preFocusedElement","_manager","setupEventListeners_fn","trap","container","doc","lastFocused","isFocusable","firstFocusable","getAllFocusables_fn","loop","tabbables","getTabbables_fn","first","last","shiftKey","observer","MutationObserver","elementToFocus","observe","childList","subtree","disconnect","FocusScope","_FocusScope","paused","use","bitsTextSelectionLayers","_unsubSelectionLock","_TextSelectionLayerState_instances","_pointerdown","_resetSelectionLock","onPointerUp","TextSelectionLayerState","_TextSelectionLayerState","highestLayer","isHighestLayer","onPointerDown","originalBodyUserSelect","getUserSelect","originalNodeUserSelect","setUserSelect","preventTextSelectionOverflow","isEnabled","userSelect","webkitUserSelect","bitsIdCounter","_subscribers","_state","_SharedState_instances","dispose_fn","_scope","lockMap","initialBodyStyle","stopTouchMoveListener","cleanupTimeoutId","isInCleanupTransition","anyLocked","cleanupScheduledAt","bodyLockStackCount","factory","_factory","$.effect_root","cancelPendingCleanup","ensureInitialStyleCaptured","bodyStyle","verticalScrollbarWidth","innerWidth","clientWidth","Number","paddingRight","marginRight","setProperty","overflow","touches","resetBodyStyle","setAttribute","removeProperty","scheduleCleanupIfNoNewLocks","currentCleanupId","actualDelay","isAnyLocked","BodyScrollLock","initialState","restoreScrollDelay","_id","prefix","useId","_restoreScrollDelay","_initialState","_countState","locked","preventScroll","forceMount","overlayState","$.noop","descriptionState","onOpenChange","closeState","trapFocus","contentState","focusScope","$$arg0","focusScopeProps","EscapeLayer","$.spread_props","dismissibleLayerState","DismissibleLayer","preventOverflowTextSelection","TextSelectionLayer","ScrollLock","node_4","focusScopeState","className","rest","DialogPrimitive_Portal","DialogPortal","cn","DialogPrimitive_Overlay","DialogOverlay","DialogPrimitive_Content","DialogPrimitive_Close","color","strokeWidth","iconNode","x1","y1","x2","y2","svg","$$item","$$array","$$element","X","class","onClose","onLessonGenerated","isGenerating","successMessage","lessonParams","isVocabularyLesson","isGrammarLesson","isMixedLesson","generateLabel","generatingLabel","closeModal","getDifficultyLevels","getVocabularyCategories","getPartsOfSpeech","getLessonTypes","DialogPrimitive_Root","$$value","Dialog","DialogContent","DialogHeader","DialogPrimitive_Title","DialogTitle","DialogPrimitive_Description","DialogDescription","text_1","label_1","textarea","$.remove_textarea_child","label_2","select","__value","node_5","option_1","getLessonTypeName","label_3","select_1","option_2","node_6","option_3","label_4","select_2","option_4","node_8","option_5","house","common_phrases","uncategorized","label_5","select_3","option_6","node_9","option_7","$.bind_select_value","label_6","input_1","$.bind_value","node_10","label_7","select_4","option_8","option_9","option_10","option_11","option_12","label_8","input_2","label_9","input_3","text_30","$.bind_checked","label_10","input_4","text_31","DialogFooter","Button","node_14","text_32","node_15","async","isLoading","selectedDifficulty","selectedType","showLessonGenerationModal","showGeneratedLesson","typeLabels","de","bg","categoryLabels","partOfSpeechLabels","ui","subtitle","createDynamicLesson","createLesson","createFirstLesson","loading","retry","emptyTitle","emptyDescription","difficultyLabel","typeLabel","allLevels","allTypes","backToLessons","showingLessons","shown","total","resetFilters","mixedEveryday","basicVocabulary","categoryPrefix","grammarPrefix","filteredLessons","typeMatch","loadLessons","generatedLessons","vocabularyStats","getVocabularyStatsByDifficulty","difficulties","lessonCount","floor","getVocabularyByCategory","getVocabularyByPartOfSpeech","getVocabularyCount","warn","fallbackLessons","byDifficulty","transliteration","culturalNotes","generateFallbackLessons","generateComprehensiveLessons","closeGeneratedLesson","types","labels","header","p_2","p_3","text_6","fragment_2","GeneratedLesson","LessonCard","p_4","fragment_4","alternate_3","LessonGenerator"],"mappings":"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C3B,MAAMC,EAAQC,OAAOH,EAAS,KAC9B,OAAQ7Q,IAEJ,GAAmB,iBAARA,EACP,MAAM,IAAI6M,UAAU,uDAAuD7M,GAG/E,OAAKA,EAAIkN,MAAM6D,GAGR/Q,EAAInC,QAAQkT,EAAOD,GAFf9Q,EAInB,CACqBiR,CAAa,QAAU/D,GAAU,IAAIA,EAAMoC,iBCbzD,SAAS4B,GAAczE,EAAQ,IAClC,ODaG,SAAoB4D,GACvB,IAAKA,GAAgC,iBAAbA,GAAyBxL,MAAM+F,QAAQyF,GAC3D,MAAM,IAAIxD,UAAU,uDAAuDwD,GAE/E,OAAOvF,OAAOqG,KAAKd,GACd7iB,IAAKohB,GAAa,GAAGgC,GAAahC,OAAcyB,EAASzB,OACzDhT,KAAK,KACd,CCpBWwV,CAAW3E,GAAO5O,QAAQ,KAAM,IAC3C,CCHA,MAyGawT,GAAiB,IAAIrN,IAzGf,CACf,UACA,oBACA,iBACA,uBACA,mBACA,aACA,gBACA,iBACA,SACA,WACA,YACA,mBACA,WACA,UACA,UACA,mBACA,qBACA,sBACA,gBACA,gBACA,oBACA,SACA,cACA,QACA,aACA,SACA,YACA,cACA,cACA,aACA,cACA,SACA,mBACA,YACA,UACA,UACA,UACA,YACA,aACA,aACA,sBACA,UACA,YACA,YACA,aACA,UACA,SACA,eACA,mBACA,cACA,uBACA,cACA,eACA,eACA,cACA,aACA,cACA,YACA,UACA,UACA,SACA,YACA,kBACA,gBACA,iBACA,iBACA,gBACA,eACA,gBACA,cACA,aACA,eACA,UACA,WACA,WACA,cACA,4BACA,WACA,YACA,WACA,oBACA,gBACA,eACA,YACA,WACA,YACA,eACA,WACA,gBACA,aACA,cACA,eACA,qBACA,kBACA,kBACA,oBACA,iBACA,YACA,uBACA,6BACA,yBACA,wBACA,YC7FJ,SAASsN,GAAe3hB,GACpB,OAAO0hB,GAAeE,IAAI5hB,EAC9B,CAUO,SAAS6hB,MAAcd,GAC1B,MAAM5J,EAAS,IAAK4J,EAAK,IACzB,IAAA,IAASvD,EAAI,EAAGA,EAAIuD,EAAKtiB,OAAQ+e,IAAK,CAClC,MAA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","x_google_ignoreList":[0,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66]}