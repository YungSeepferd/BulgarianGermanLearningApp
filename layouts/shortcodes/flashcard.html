{{/*
Bidirectional flashcard shortcode for vocabulary practice
Usage: {{< flashcard word="Здравей" translation="Hallo" level="A1" category="Begrüßung" notes="Standard informal greeting" >}}
*/}}

{{ $word := .Get "word" }}
{{ $translation := .Get "translation" }}
{{ $level := .Get "level" | default "A1" }}
{{ $category := .Get "category" | default "" }}
{{ $notes := .Get "notes" | default "" }}
{{ $id := .Get "id" | default (printf "flashcard-%d" (now.Unix)) }}

{{/* Determine display direction based on language switch */}}
{{ $frontText := $word }}
{{ $backText := $translation }}
{{ $frontLang := "bg" }}
{{ $backLang := "de" }}

<div class="flashcard-item" id="{{ $id }}">
  <input type="checkbox" id="flip-{{ $id }}" class="flashcard-toggle" hidden>
  
  <div class="flashcard-container">
    <div class="flashcard">
      <!-- Front Side -->
      <div class="flashcard-front">
        <div class="card-content">
          <div class="word" data-lang="{{ $frontLang }}">{{ $frontText }}</div>
          <div class="meta-info">
            {{ if $level }}<span class="level-badge">{{ $level }}</span>{{ end }}
            {{ if $category }}<span class="category-badge">{{ $category }}</span>{{ end }}
          </div>
        </div>
        <label for="flip-{{ $id }}" class="flip-button">
          <span class="btn-text-bg">Покажи отговора</span>
          <span class="btn-text-de">Antwort zeigen</span>
        </label>
      </div>
      
      <!-- Back Side -->
      <div class="flashcard-back">
        <div class="card-content">
          <div class="translation" data-lang="{{ $backLang }}">{{ $backText }}</div>
          {{ if $notes }}<div class="notes">{{ $notes }}</div>{{ end }}
        </div>
        <div class="response-buttons">
          <button class="btn-incorrect" onclick="this.closest('.flashcard-item').classList.add('answered-incorrect')">
            ✗ Falsch / Грешно
          </button>
          <button class="btn-correct" onclick="this.closest('.flashcard-item').classList.add('answered-correct')">
            ✓ Richtig / Правилно
          </button>
        </div>
        <label for="flip-{{ $id }}" class="flip-button">Zurück / Назад</label>
      </div>
    </div>
  </div>
</div>
