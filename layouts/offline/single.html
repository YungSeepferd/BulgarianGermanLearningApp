{{ define "main" }}
<div class="offline-page">
  <div class="offline-container">
    <div class="offline-icon">
      <svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/>
        <path d="M16 7l1 1"/>
        <path d="M9.5 8.5l-1 1"/>
        <path d="M6 18L4 16"/>
      </svg>
    </div>
    
    <h1 class="offline-title">You're Offline</h1>
    <p class="offline-description">
      Don't worry! You can still access cached vocabulary and continue your learning journey.
    </p>
    
    <div class="offline-features">
      <h2>Available Offline:</h2>
      <ul>
        <li>
          <span class="feature-icon">ðŸ“š</span>
          <span>Previously viewed vocabulary items</span>
        </li>
        <li>
          <span class="feature-icon">ðŸŽ¯</span>
          <span>Practice sessions with cached content</span>
        </li>
        <li>
          <span class="feature-icon">ðŸ“Š</span>
          <span>Your learning progress and statistics</span>
        </li>
        <li>
          <span class="feature-icon">ðŸ”„</span>
          <span>Spaced repetition algorithm continues working</span>
        </li>
      </ul>
    </div>
    
    <div class="offline-actions">
      <a href="/vocabulary/" class="btn btn-primary offline-btn">
        <span class="btn-icon">ðŸ“š</span>
        Browse Vocabulary
      </a>
      
      <a href="/practice/" class="btn btn-secondary offline-btn">
        <span class="btn-icon">ðŸŽ¯</span>
        Continue Practice
      </a>
      
      <button id="retry-connection" class="btn btn-outline offline-btn">
        <span class="btn-icon">ðŸ”„</span>
        <span class="btn-text">Try Again</span>
      </button>
    </div>
    
    <div class="connection-status">
      <div id="connection-indicator" class="status-indicator offline">
        <span class="status-dot"></span>
        <span class="status-text">Offline</span>
      </div>
    </div>
    
    <div class="offline-tips">
      <details>
        <summary>Tips for Offline Learning</summary>
        <div class="tips-content">
          <ul>
            <li>Your progress is saved locally and will sync when you're back online</li>
            <li>Audio pronunciation may not be available for new words</li>
            <li>Use the practice mode to review previously studied vocabulary</li>
            <li>The spaced repetition algorithm works offline with your existing data</li>
          </ul>
        </div>
      </details>
    </div>
  </div>
</div>

<style>
.offline-page {
  min-height: 80vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 2rem;
  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
}

.offline-container {
  max-width: 500px;
  text-align: center;
  background: white;
  padding: 3rem 2rem;
  border-radius: 1rem;
  box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
}

.offline-icon {
  color: #6c757d;
  margin-bottom: 2rem;
}

.offline-title {
  font-size: 2.5rem;
  font-weight: 700;
  color: #2c3e50;
  margin-bottom: 1rem;
}

.offline-description {
  font-size: 1.125rem;
  color: #6c757d;
  margin-bottom: 2rem;
  line-height: 1.6;
}

.offline-features {
  text-align: left;
  margin-bottom: 2rem;
  padding: 1.5rem;
  background: #f8f9fa;
  border-radius: 0.5rem;
}

.offline-features h2 {
  font-size: 1.25rem;
  font-weight: 600;
  color: #2c3e50;
  margin-bottom: 1rem;
  text-align: center;
}

.offline-features ul {
  list-style: none;
  padding: 0;
  margin: 0;
}

.offline-features li {
  display: flex;
  align-items: center;
  gap: 0.75rem;
  padding: 0.5rem 0;
  color: #495057;
}

.feature-icon {
  font-size: 1.25rem;
  width: 2rem;
  text-align: center;
}

.offline-actions {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  margin-bottom: 2rem;
}

.offline-btn {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 0.5rem;
  padding: 0.875rem 1.5rem;
  font-weight: 500;
  text-decoration: none;
  border-radius: 0.5rem;
  transition: all 0.2s ease;
}

.btn-primary {
  background: #007bff;
  color: white;
  border: 2px solid #007bff;
}

.btn-primary:hover {
  background: #0056b3;
  border-color: #0056b3;
  transform: translateY(-1px);
}

.btn-secondary {
  background: #6c757d;
  color: white;
  border: 2px solid #6c757d;
}

.btn-secondary:hover {
  background: #545b62;
  border-color: #545b62;
  transform: translateY(-1px);
}

.btn-outline {
  background: transparent;
  color: #007bff;
  border: 2px solid #007bff;
}

.btn-outline:hover {
  background: #007bff;
  color: white;
}

.connection-status {
  margin-bottom: 1.5rem;
}

.status-indicator {
  display: inline-flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  border-radius: 2rem;
  font-size: 0.875rem;
  font-weight: 500;
}

.status-indicator.offline {
  background: #f8d7da;
  color: #721c24;
}

.status-indicator.online {
  background: #d4edda;
  color: #155724;
}

.status-dot {
  width: 0.5rem;
  height: 0.5rem;
  border-radius: 50%;
  background: currentColor;
}

.offline-tips {
  text-align: left;
}

.offline-tips details {
  border: 1px solid #dee2e6;
  border-radius: 0.5rem;
  padding: 1rem;
}

.offline-tips summary {
  font-weight: 500;
  color: #495057;
  cursor: pointer;
  margin-bottom: 0.5rem;
}

.tips-content ul {
  list-style: disc;
  padding-left: 1.5rem;
  margin: 0.5rem 0 0 0;
}

.tips-content li {
  color: #6c757d;
  line-height: 1.5;
  margin-bottom: 0.5rem;
}

@media (max-width: 768px) {
  .offline-page {
    padding: 1rem;
  }
  
  .offline-container {
    padding: 2rem 1.5rem;
  }
  
  .offline-title {
    font-size: 2rem;
  }
  
  .offline-actions {
    gap: 0.75rem;
  }
}

@media (prefers-reduced-motion: reduce) {
  .offline-btn {
    transition: none;
  }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const retryButton = document.getElementById('retry-connection');
  const connectionIndicator = document.getElementById('connection-indicator');
  
  // Check connection status
  function updateConnectionStatus() {
    const isOnline = navigator.onLine;
    const statusText = connectionIndicator.querySelector('.status-text');
    
    if (isOnline) {
      connectionIndicator.className = 'status-indicator online';
      statusText.textContent = 'Online';
      
      // Redirect to home page if online
      setTimeout(() => {
        window.location.href = '/';
      }, 1000);
    } else {
      connectionIndicator.className = 'status-indicator offline';
      statusText.textContent = 'Offline';
    }
  }
  
  // Retry connection
  retryButton.addEventListener('click', function() {
    const btnText = this.querySelector('.btn-text');
    const originalText = btnText.textContent;
    
    btnText.textContent = 'Checking...';
    this.disabled = true;
    
    // Simulate connection check
    setTimeout(() => {
      updateConnectionStatus();
      btnText.textContent = originalText;
      this.disabled = false;
    }, 1500);
  });
  
  // Listen for connection changes
  window.addEventListener('online', updateConnectionStatus);
  window.addEventListener('offline', updateConnectionStatus);
  
  // Initial status check
  updateConnectionStatus();
  
  // Service worker message handling
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.addEventListener('message', function(event) {
      if (event.data.type === 'SW_ACTIVATED') {
        // Service worker is ready, check if we can go online
        updateConnectionStatus();
      }
    });
  }
});
</script>
{{ end }}
